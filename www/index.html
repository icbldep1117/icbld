


<!DOCTYPE html><html lang="en">
<head>
<title>Inside Coach</title>
<!-- meta http-equiv="Content-Type" content="text/html; charset=utf-8" / -->
<!-- meta name="viewport" content="width=device-width, user-scalable=no, target-densitydpi=device-dpi" / -->
<!-- meta name="format-detection" content="telephone=no" / -->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- meta name="viewport" content="width=device-width initial-scale=1.0 maximum-scale=1.0" -->
<meta name="viewport" content="width=device-width initial-scale=1.0">
<link rel="apple-touch-icon" href="images/logo-touch.svg"/>
<meta name="description" content="">
<meta name="author" content="">
<style>
/**** ALL CSS ****/
@charset "UTF-8";
/* the container element (span) */
@font-face {
  font-family: "Ionicons";
  src: url("fonts/ionicons.eot?v=2.0.0");
  src: url("fonts/ionicons.eot?v=2.0.0#iefix") format("embedded-opentype"), url("fonts/ionicons.ttf?v=2.0.0") format("truetype"), url("fonts/ionicons.woff?v=2.0.0") format("woff"), url("fonts/ionicons.svg?v=2.0.0#Ionicons") format("svg");
  font-weight: normal;
  font-style: normal; }

.icon {
  display: inline-block;
  font-family: "Ionicons";
  text-decoration: none;
  /* 
@font-face {
  font-family: 'Muli';
  src: url(fonts/Muli/Muli-Regular.ttf); }

@font-face {
  font-family: 'Muli Extrabold';
  src: url(fonts/Muli/Muli-ExtraBold.ttf); }

@font-face {
  font-family: 'Muli Light';
  src: url(fonts/Muli/Muli-Light.ttf); }

@font-face {
  font-family: 'Muli Extra Light';
  src: url(fonts/Muli/Muli-ExtraLight.ttf); }


$default-font:Muli;
$light-font: 'Muli Extra Light';
$bold-font:'Muli Extrabold';
*/ }

@font-face {
  font-family: 'Quicksand';
  src: url(fonts/quicksand/Quicksand-Regular.otf); }

@font-face {
  font-family: 'Quicksand Light';
  src: url(fonts/quicksand/Quicksand-Light.otf); }

@font-face {
  font-family: 'Quicksand Bold';
  src: url(fonts/quicksand/Quicksand-Bold.otf); }

.ball_status_widget {
  position: absolute;
  left: 0px; }

.ball_status_widget img {
  width: 34px;
  height: 34px;
  display: inline-block; }

.ball_status_widget canvas {
  width: 35px;
  height: 35px;
  display: inline-block;
  vertical-align: middle; }

.ball_status_widget img.calibrated_icon {
  /* a canvas element with no children */
  /* all ball-position widgets */ }

.ball_position_widget {
  width: 100%;
  display: block;
  margin: auto;
  /*setting the width and height
    here change the display size
    but not the resolution. Do that
    in the width and height attributes 
    of the canvas tag.
  */
  /* the ball-position widget on page A */ }

#ball_position_page_a {
  /* the ball-position widget on page B */ }

#ball_position_page_b {
  /*a canvas element with no children*/
  /* all speedometers */ }

.speedometer_widget {
  max-width: 275px;
  /* the speedometers on page A */ }

.speedometer_page_a {
  width: 52%;
  position: relative; }

#time_dial_page_a {
  left: -50px; }

#kicks_dial_page_a {
  left: 50px;
  top: -25px;
  /* all speedometers on page B */ }

.speedometer_page_b {
  width: 45%;
  margin-bottom: -45px;
  /* the individual speedometers on page B */ }

#spin_dial_page_b {
  /* all speedometers on page D */ }

.speedometer_page_d {
  width: 45%; }

html {
  height: 100%;
  -webkit-text-size-adjust: none;
  margin: 0;
  padding: 0; }

body {
  overflow: auto !important;
  font-family: Quicksand Bold;
  height: 100%;
  background-color: #f0f4f8;
  margin: 0;
  padding: 0;
  padding: 0 !important;
  width: 100% !important;
  font-size: 12pt;
  color: #025fbc; }

th, td {
  text-align: left; }

a, a:hover, a:focus, a:active, a.active {
  outline: none;
  text-decoration: none;
  color: inherit; }

hr {
  border: 0.5px solid #9cafc3;
  /* -------------- pages   ------------- */ }

.page {
  display: none;
  /*padding-bottom:74px;*/
  /* space for bottom menu */
  padding-bottom: 15px;
  max-width: 900px;
  margin: auto;
  text-align: center;
  position: relative; }

.page-title {
  display: block;
  margin: auto;
  text-align: center;
  /* -------------- top menu ------------- */ }

.top_navigation {
  background-color: #025fbc;
  border: none;
  border-radius: 0;
  padding-top: 8px;
  padding-bottom: 8px;
  box-shadow: 0px 0px 8px #444;
  z-index: 10;
  position: fixed;
  top: 0;
  width: 100%;
  margin-bottom: 0;
  text-align: center;
  color: #f0f4f8; }

.back-btn {
  display: inline;
  font-size: inherit;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  float: left;
  font-size: 24pt;
  width: 20px;
  margin-left: 15px; }

.page_title {
  font-family: 'Quicksand Bold';
  text-align: center;
  line-height: 35px; }

.hamburger {
  display: inline;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  float: right;
  font-size: 24pt;
  /*color:$secondary-text-color;*/
  width: 20px;
  cursor: pointer;
  margin-right: 15px; }

.nav-space {
  height: 66px;
  display: block;
  /* ---- hamburgler menu --- */ }

.hamburgler-active .hamburgler-menu {
  opacity: 1;
  display: block; }

body .hamburgler-active {
  display: block;
  opacity: 1; }

.hamburgler-menu {
  transition: all 0.4s ease;
  opacity: 0;
  display: none;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  height: 100%;
  overflow-y: auto;
  z-index: 15;
  background-color: #f0f4f8;
  color: ;
  text-align: center;
  width: 250px;
  padding: 20px 15px 10px;
  box-shadow: 0px 0px 8px #444;
  font-family: 'Quicksand Bold'; }

.hamburger_menu_top_business {
  text-align: center;
  margin: auto;
  position: relative;
  padding-bottom: 20px;
  height: 20px; }

.hamburger_menu_top_business .hamburger {
  position: absolute;
  right: 0px; }

.hamburgler-menu-list {
  display: block;
  transition: all 0.4s ease;
  padding: 0;
  list-style-type: none;
  text-align: left;
  padding-top: 25px;
  width: 100%;
  padding-bottom: 20px;
  position: relative;
  border-top: 1px solid #235406; }

.hamburgler-menu-list li {
  display: block;
  padding-left: 0; }

.hamburgler-menu-list li a {
  display: block;
  padding: 11px 20px 11px 78px;
  background-position: left 34px center;
  background-repeat: no-repeat;
  background-size: 25px 25px; }

.hamburgler-menu-list li ul {
  list-style: none;
  padding-left: 15px;
  display: none;
  font-family: Quicksand Bold; }

.hamburgler-menu-list li.dropdown-item {
  background-position: left top 8px;
  background-repeat: no-repeat;
  background-size: 25px 25px;
  background-image: url("images/side_menu/arrow-right.svg"); }

.hamburgler-menu-list li.dropdown-item.open-submenu {
  background-image: url("images/side_menu/arrow-bottom.svg"); }

.hamburgler-menu-list li.ball-settings-icon > a {
  background-image: url("images/side_menu/ball_settings.svg"); }

.hamburgler-menu-list li.challenge-icon > a {
  background-image: url("images/side_menu/challenge.svg"); }

.hamburgler-menu-list li.coachs-play-book-icon > a {
  background-image: url("images/side_menu/coachs_play_book.svg"); }

.hamburgler-menu-list li.friends-icon > a {
  background-image: url("images/side_menu/friends.svg"); }

.hamburgler-menu-list li.home-icon > a {
  background-image: url("images/side_menu/home.svg"); }

.hamburgler-menu-list li.log-out-icon > a {
  background-image: url("images/side_menu/log_out.svg"); }

.hamburgler-menu-list li.player-settings-icon > a {
  background-image: url("images/side_menu/player_settings.svg"); }

.hamburgler-menu-list li.system-settings-icon > a {
  background-image: url("images/side_menu/system_settings.svg");
  /* -------------- forms ------------- */ }

.server-form, .tabs_table {
  margin: auto;
  text-align: left;
  padding-bottom: 20px;
  /*padding: 15px 20px 15px 20px;*/ }

.server-form {
  padding-left: 15px;
  padding-right: 15px; }

.server-form .avatar-circle {
  display: block;
  width: 72px;
  height: 72px;
  margin: auto;
  margin-bottom: 30px;
  border-radius: 50%; }

.server-form .input-field {
  margin-bottom: 30px;
  width: 100%;
  height: 40px;
  outline: none;
  font: inherit; }

.server-form .input-field::placeholder {
  color: #6c7b8b; }

.server-form input {
  border: none;
  border-bottom: 1px solid #6c7b8b;
  box-shadow: none;
  background: none;
  padding-left: 0;
  padding-right: 0;
  border-radius: 0px;
  color: inherit; }

.server-form textarea {
  border-bottom: 1px solid; }

.server-form select {
  color: inherit; }

.button {
  font-family: inherit;
  font-size: inherit;
  color: #ff7c00;
  /*background: none;*/
  display: block;
  border: 1px solid #6c7b8b;
  background-color: white;
  /*$secondary-background-color;*/
  border-radius: 30px;
  width: 100%;
  text-transform: uppercase;
  text-align: center;
  width: 100%; }

.button:active {
  background-color: #6c7b8b;
  color: white; }

.button:disabled {
  color: red;
  background-color: white; }

.spinny_ball {
  position: relative;
  top: -12px;
  margin: auto;
  width: 60px;
  height: 60px;
  animation-name: spin;
  animation-duration: 2000ms;
  animation-iteration-count: infinite;
  animation-timing-function: linear; }

@keyframes spin {
  from {
    transform: rotate(0deg); }

  to {
    transform: rotate(360deg); } }

.server-form .secondary-form-button {
  text-align: center;
  height: 40px;
  cursor: pointer; }

.server-form select {
  padding: 6px 0px;
  margin: 8px 0;
  width: 100%;
  background-color: transparent;
  border: none;
  border-bottom: 1px solid;
  /* -------------- tables ------------- */ }

table {
  width: 100%;
  layout: fixed; }

.tabs_table_tabs {
  table-layout: fixed;
  width: 100%;
  height: 40px;
  margin-bottom: 36px; }

.tabs_table_tabs td {
  color: #6c7b8b;
  text-align: center;
  width: 1%;
  cursor: pointer; }

.tabs_table_tabs span {
  padding: 3px; }

.tabs_table_tabs span.active {
  border-bottom: 3px solid #ff7c00;
  color: #025fbc; }

.tabs_table_content .inactive {
  display: none; }

.tabs_table_content .active {
  display: block; }

.tabs_table_content_tr {
  position: relative;
  height: 66px;
  cursor: pointer;
  margin-top: 5px;
  margin-left: 10px;
  background-color: white;
  /*border:1px solid $inactive-text-color;*/
  /*border:1px solid rgb(108, 123, 139);*/
  border-right: none;
  line-height: 66px; }

.tabs_table_content_tr img {
  height: 100%;
  width: 74px;
  display: block;
  float: left;
  border-top-left-radius: 4px;
  border-bottom-left-radius: 4px;
  clip-path: polygon(0px 0px, 64px 0px, 74px 50%, 64px 100%, 0% 100%);
  -webkit-clip-path: polygon(0px 0px, 64px 0px, 74px 50%, 64px 100%, 0% 100%); }

.chevron {
  background-color: #ff7c00;
  width: 17px;
  height: 100%;
  float: left;
  clip-path: polygon(0px 0px, 7px 0px, 17px 50%, 7px 100%, 0% 100%, 10px 50%);
  -webkit-clip-path: polygon(0px 0px, 7px 0px, 17px 50%, 7px 100%, 0% 100%, 10px 50%);
  margin-left: -7px; }

.tabs_tr_outline_part {
  border-top: 1px solid #b3b8bd;
  border-bottom: 1px solid #b3b8bd;
  display: inline-block;
  position: absolute;
  right: 0px;
  left: 74px;
  height: 64px;
  padding-left: 25px; }

@media screen and (min-width: 900px) {
  .tabs_tr_outline_part {
    border-right: 1px solid #b3b8bd; } }

.terms_of_service_text {
  color: #6c7b8b;
  padding-left: 20px;
  padding-right: 20px;
  text-align: justify; }

.terms_of_service_text h2 {
  color: #ff7c00; }

.terms_of_service_text h3 {
  color: #025fbc; }

.video_modal_widget {
  background-image: url("widgets/video_modal/play_video.svg");
  background-size: 1.5em 1.5em;
  background-repeat: no-repeat;
  background-position: center;
  width: 1.5em;
  height: 1.5em;
  cursor: pointer;
  /*
  display: block;
  float:right;
  position:absolute;
  right:15px;
  top:-5px;
*/
  display: inline-block;
  vertical-align: middle; }

.video_modal_container {
  color: #ff7a00;
  cursor: pointer; }

.score_log_widget {
  table-layout: fixed;
  display: none; }

.speech_log_widget {
  width: 75%;
  margin: auto;
  text-align: center; }

.carousel_content {
  max-width: 350px;
  padding: 10px;
  padding-top: 0px;
  margin: auto;
  text-align: center; }

.carousel_top_text_div {
  padding-top: 10px;
  font-size: 2em; }

.carousel_image_div {
  font-size: 24pt;
  margin-top: 0px;
  margin-bottom: 15px; }

.carousel_image_div img {
  margin: auto;
  padding-top: 20px;
  padding-bottom: 20px; }

.carousel_bottom_text_div {
  color: #6c7b8b;
  font-size: 14pt;
  line-height: 1.5em; }

.carousel_dots_div {
  line-height: 1em;
  color: #ff7c00; }

.carousel_dot {
  width: 10px;
  height: 10px;
  display: inline-block;
  border-radius: 50%;
  border: 1px solid #ff7c00; }

.carousel_dot_active {
  background-color: #ff7c00; }
</style>

</head>
<body>
<!--HTML-->

<!--PAGES-->
<script>GLOBAL_JS_PAGE_OBJECTS = []</script>
<div id="page-holder">
  <div id="top_business" style="display:none">
    <!-- Navigation -->
    <nav id="mainNav" class="top_navigation">
      <span class="icon back-btn" id="back_button"><a href="#" onclick="navigation_go_back();">&#xf2ca;</a></span>
      <div class="icon hamburger" onclick="navigation_open_menu();">&#xf394;</div>
      <span class="page_title" id="page_title">Games</span>

    </nav>
    <div class="nav-space"></div>
    <div class="hamburgler-menu" id="hamburgler-menu">

      <div class="hamburger_menu_top_business">
        <div id="global_transport" class="transport_widget"></div>
        <span class="icon hamburger" onclick="navigation_close_menu()">&#xf2d7;</span>
        <span id="ball_status_widget" class="ball_status_widget" style="display:none">
          <!-- javascript chooses the image src based on the status rec'd from the ball -->
          <!-- the images are in /build/widgets/ball_status_widget. Dont change these class names -->
          <img class="battery_icon" id="battery_image" src="widgets/ball_status/batt/0.png" alt="">
          <!--img class="wifi_icon" src="widgets/ball_status/wifi/0.png" alt=""-->
          <img class="calibrated_icon" id="ball_image" src="widgets/ball_status/calib/0.png" alt="">
          <!-- img class="server_icon" src="widgets/ball_status/server/0.png" alt="" -->
          <!-- canvas class="data_rate_icon" width="15" height="15" id="data_rate_canvas"></canvas -->
        </span>
      </div>
      <ul class="hamburgler-menu-list">
        <li class="home-icon"><a href="#" onclick="navigation_load_page('games')">Games</a></li>
        <li class="ball-settings-icon dropdown-item"><a href="#">Ball Settings</a>
          <ul>
            <li><a href="#" onclick="navigation_load_page('diagnostic')">Ball Diagnostic</a></li>
            <li><a href="#" onclick="navigation_load_page('setup-guide')">Setup Guide</a></li>
          </ul>
        </li>
        <li class="player-settings-icon dropdown-item"><a href="#">Player Settings</a>
          <ul>
            <li><a href="#" onclick="navigation_load_page('edit-profile')">Edit Profile</a></li>
            <li><a href="#" onclick="navigation_load_page('login')">Switch Accounts</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
<div id="page-change-password" class="page">
  <form class="server-form" id="change_password_form" onsubmit="return false">
    <img class="avatar-circle profile_image" src="images/default_profile_image.png" alt="IC">
    <input class="input-field" type="password" placeholder="Enter Current Password" name="current" required>
    <input class="input-field" type="password" placeholder="Enter New Password" name="new" required>
    <input class="input-field" type="password" placeholder="Repeat Password" name="repeat" required>
    <button type="button" class="input-field button" onclick="change_password.change_password(event, this.form)">Submit Changes</button>
    <div class="secondary-form-button" onclick="navigation_load_page('edit-profile')">
      Cancel
    </div>    
  </form>
</div>

<script>
   var change_password = new ChangePassword();
   GLOBAL_JS_PAGE_OBJECTS["change-password"] = {id:"page-change-password", obj:change_password};
   
  /*--------------------------------------------------------*/
  function ChangePassword()
  {
  
  }

  /*--------------------------------------------------------*/
  ChangePassword.prototype.page_will_unload = function()
  {

  };

  /*--------------------------------------------------------*/
  ChangePassword.prototype.page_load = function()
  {

  };
        
  /*--------------------------------------------------------*/
  ChangePassword.prototype.page_did_unload = function()
  {
    this.clear();
  };
  
  /*--------------------------------------------------------*/
  ChangePassword.prototype.clear = function()
  {
    navigation_clear_form("reset_password_form");
  };
  
  /*--------------------------------------------------------------------*/
  ChangePassword.prototype.change_password = function(e, form)
  {
    e = e || window.event;
    e.preventDefault();

    if(server_validate_user_is_logged_in_and_notify())
      {
        //don't queue this for offline, because you might end up
        //in a state where the user dosen't know their password
        if(server_validate_user_is_online_and_notify())
          {
            server_trim_form(form);
            
            if(!server_validate_empty_string_and_notify(form.current.value, "Your current password"))
              return;
            
            if(!server_validate_passwords_match_and_notify(form.new.value, form.repeat.value))
              return;

            var params = 
              {
                token: server_get_login_token(),
                password: form.new.value,
                old_password: form.current.value,
              };
  
             server_send_request("auth/password/update", params, null);
          }
      }  
  };

</script>
<div id="page-diagnostic" class="page">
  <div class="server-form">
    <button class="input-field button" onclick="diagnostic_page.run_test(event);">Run Test</button>
  </div>
  <div class="server-form">
    <div class="tabs_table_content">
      <table>
        <thead>
          <tr>
            <th>Test</th>
            <th>Value</th>
            <th>Result</th>
          </tr>
        </thead>
        <tbody>
          <tr id="diagnostic_app_version">
            <td>app version</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_ball_api">
            <td>ball api</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_firmware">
            <td>firmware</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_wifi_connected">
            <td>wifi</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_rssi">
            <td>rssi</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_battery">
            <td>battery</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_agm_whoami">
            <td>agm id</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_A_whoami">
            <td>A id</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_G_whoami">
            <td>G id</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_a_value">
            <td>a value</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_g_value">
            <td>g value</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_m_value">
            <td>m value</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
          <tr id="diagnostic_A_value">
            <td>A value</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>          
          <tr id="diagnostic_G_value">
            <td>G value</td>
            <td>&mdash;</td>
            <td>&mdash;</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script>
  var FIRMWARE = 36;
  var RSSI_MIN = -90;
  var RSSI_MAX = -30;
  var BATT_MIN = 3.5;
  
  var MPU_WHOAMI = 0x71;
  var ACC_WHOAMI = 0x32;
  var GYR_WHOAMI = 0x68;

  var MPU_ACC_MIN = 5.0;  // m/sec^2
  var MPU_ACC_MAX = 15.0; // m/sec^2
  var MPU_GYR_MIN = 0;    // rad/sec
  var MPU_GYR_MAX = 0.05; // rad/sec
  var MPU_MAG_MIN = 20;   // uT
  var MPU_MAG_MAX = 100;  // uT
  var BIG_ACC_MIN = 1;    // m/sec^2
  var BIG_ACC_MAX = 30;   // m/sec^2
  var BIG_GYR_MIN = 0;    // rad/sec
  var BIG_GYR_MAX = 0.05; // rad/sec

  var DEG_TO_RAD = Math.PI / 360.0;
  
  GLOBAL_JS_PAGE_OBJECTS['diagnostic'] = {id:"page-diagnostic", obj:new Diagnostic()};
  
  /*--------------------------------------------------------*/
  function Diagnostic()
  {
  
  }

  /*--------------------------------------------------------*/
  Diagnostic.prototype.page_will_unload = function()
  {
    ball_status.stop_receiving_connection_notice();
    console.log("unload diagnostic");
  }

  /*--------------------------------------------------------*/
  Diagnostic.prototype.page_load = function()
  {
    ball_status.receive_connection_notice(this.onopen.bind(this));
    this.run_test(null);
    console.log("load diagnostic");
  }
      
  /*--------------------------------------------------------*/
  Diagnostic.prototype.page_did_unload = function()
  {

  }
  
  /*--------------------------------------------------------*/
  Diagnostic.prototype.log_result = function(row_id, val, did_pass)
  {
    var pass_fail = (did_pass) ? "PASS" : "FAIL";
    var row = document.getElementById(row_id).cells;
    row[1].innerHTML = val;
    row[2].innerHTML = pass_fail;
    
    row[2].style.color = (did_pass) ? "green" : "red";
  };
  
  /*--------------------------------------------------------*/
  Diagnostic.prototype.clear_result = function(row_id)
  {
    var row = document.getElementById(row_id).cells;
    row[1].innerHTML = "&mdash;";
    row[2].innerHTML = "&mdash;";    
  };
  
  /*--------------------------------------------------------*/
  Diagnostic.prototype.in_range = function(x, min, max)
  {
    //not >=, because 0 should be considered wrong for any sensor
    return ((x>min) && (x<max));
  };
  
  /*--------------------------------------------------------*/
  Diagnostic.prototype.onopen = function()
  {
    $IC.stop_tracking();
    
    var registers;
    this.log_result("diagnostic_wifi_connected", "YES", true);

    //$IC.send("$w1823B0"); // 400g mode. Todo: integrate this whole page with IC_LEVEL_2
    registers = "fwv,rssi,batt,mpu_who,GYR_who,ACC_who";
    $IC.exec(registers, this.data_received_callback_1.bind(this));
    
    registers = "aX,aY,aZ,tT,gX,gY,gZ,mX,mY,mZ,AX,AY,AZ,GX,GY,GZ";
    $IC.exec(registers, this.data_received_callback_2.bind(this));
    
    //$IC.disconnect();
  };

  /*--------------------------------------------------------*/
  Diagnostic.prototype.data_received_callback_1 = function(d)
  {
    d.batt *= 0.001;
    d.rssi =  -Math.abs(d.rssi);
    this.log_result("diagnostic_firmware"   , d.fwv, d.fwv>=FIRMWARE);
    this.log_result("diagnostic_rssi"       , d.rssi, this.in_range(d.rssi, RSSI_MIN, RSSI_MAX));
    this.log_result("diagnostic_battery"    , d.batt.toFixed(2), d.batt>BATT_MIN);
    this.log_result("diagnostic_agm_whoami" , d.mpu_who.toString(16), d.mpu_who==MPU_WHOAMI);
    this.log_result("diagnostic_A_whoami"   , d.ACC_who.toString(16), d.ACC_who==ACC_WHOAMI);
    this.log_result("diagnostic_G_whoami"   , d.GYR_who.toString(16), d.GYR_who==GYR_WHOAMI);
  };

  /*--------------------------------------------------------*/
  Diagnostic.prototype.data_received_callback_2 = function(d)
  {
    var a = new Quaternion(0, d.aX, d.aY, d.aZ);
    var g = new Quaternion(0, d.gX, d.gY, d.gZ);
    var m = new Quaternion(0, d.mX, d.mY, d.mZ);
    var A = new Quaternion(0, d.AX, d.AY, d.AZ);
    var G = new Quaternion(0, d.GX, d.GY, d.GZ);      

    a.multiply_real(9.81 * (16 / 32767.0)        , a); //convert to m/sec^2
    g.multiply_real(DEG_TO_RAD * 2000 / 32767.0  , g); //gyro to rad / sec
    m.multiply_real((4912 / 32760.0)             , m); //scale to +- 45 uT
    A.multiply_real(9.81 * (100 / 32767.0)       , A); //convert to 1 g
    G.multiply_real(DEG_TO_RAD * 500 / 32767.0   , G);

    this.log_result("diagnostic_a_value", a.norm().toFixed(2), this.in_range(a.norm(), MPU_ACC_MIN, MPU_ACC_MAX));
    this.log_result("diagnostic_g_value", g.norm().toFixed(2), this.in_range(g.norm(), MPU_GYR_MIN, MPU_GYR_MAX));
    this.log_result("diagnostic_m_value", m.norm().toFixed(2), this.in_range(m.norm(), MPU_MAG_MIN, MPU_MAG_MAX));
    this.log_result("diagnostic_A_value", A.norm().toFixed(2), this.in_range(A.norm(), BIG_ACC_MIN, BIG_ACC_MAX));
    this.log_result("diagnostic_G_value", G.norm().toFixed(2), this.in_range(G.norm(), BIG_GYR_MIN, BIG_GYR_MAX));
  };
  
  /*--------------------------------------------------------*/
  Diagnostic.prototype.run_test = function(e)
  {
    e = e || window.event;
    if(e) e.preventDefault();
    
    this.clear();
    if(!$IC.is_connected())
      //this will connect and configure sensors. Tracking will stop on connection callback
      //this is a little wasteful as we son't really need to stream this data.
      $IC.start_tracking();
    else
      {
        //console.log("ball already connected");
        this.onopen();
      }
  };
  
  /*--------------------------------------------------------*/
  Diagnostic.prototype.clear = function()
  {
    this.log_result("diagnostic_ball_api"   , $IC.version, true);
    this.log_result("diagnostic_app_version", $VERSION, true);

    this.clear_result("diagnostic_wifi_connected"   );
    this.clear_result("diagnostic_firmware"         );
    this.clear_result("diagnostic_rssi"             );
    this.clear_result("diagnostic_battery"          );
    this.clear_result("diagnostic_agm_whoami"       );
    this.clear_result("diagnostic_A_whoami"         );
    this.clear_result("diagnostic_G_whoami"         );
    this.clear_result("diagnostic_a_value"          );
    this.clear_result("diagnostic_g_value"          );
    this.clear_result("diagnostic_m_value"          );
    this.clear_result("diagnostic_A_value"          );
    this.clear_result("diagnostic_G_value"          );
  };
  
</script>
<div id="page-edit-profile" class="page">
  <form class="server-form" id="edit_profile_form" onsubmit="return false">
    <img class="avatar-circle profile_image" src="images/default_profile_image.png" alt="IC">
    <input class="input-field" type="text" placeholder="Enter Your Full Name" name="full_name" >
    <input class="input-field" type="text" placeholder="Enter Your Nickname" name="nickname">
    <input class="input-field" type="email" placeholder="Email"  name="email">
    <input class="input-field" type="text" placeholder="Birth Year" name="year_of_birth">
    <input class="input-field" type="text" placeholder="Enter Your Country" name="country">
    <input class="input-field" type="text" placeholder="Enter your Region" name="region">
    <input class="input-field" type="text" placeholder="Postal Code" name="postal_code">
    <input class="input-field" type="text" placeholder="Phone No" name="phone_no">
    
    <label for="upload" class="input-field button" style="line-height:40px">Choose your avatar</label>
    <input id="upload" name="profile_image" onchange="edit_profile.get_base_64_image(this)" class="input-field button" style="display:none" type="file" accept="image/*">
    <input class="input-field button" type="hidden"  id="uploaded_image" name="uploaded_image">
    
    <button type="submit" class="input-field button" onclick="edit_profile.update_account(event, this.form)">Submit Changes</button>
    <div class="secondary-form-button" onclick="navigation_load_page('change-password');">
      Change Password
    </div>   
  </form>
</div>

<script>
   var edit_profile = new EditProfile();
   GLOBAL_JS_PAGE_OBJECTS["edit-profile"] = {id:"page-edit-profile", obj:edit_profile};
   var EDIT_PROFILE_LOCAL_STORAGE_NAME = "GLOBAL_EDIT_PROFILE_INFO";
   
  /*--------------------------------------------------------*/
  function EditProfile()
  {
  
  }

  /*--------------------------------------------------------*/
  EditProfile.prototype.page_will_unload = function()
  {

  };

  /*--------------------------------------------------------*/
  EditProfile.prototype.page_load = function()
  {
    if(server_validate_user_is_logged_in_and_notify())
      this.get_account_info(window.event, "edit_profile_form");
  };
      
  /*--------------------------------------------------------*/
  EditProfile.prototype.page_did_unload = function()
  {
    
  };

  /*--------------------------------------------------------*/
  EditProfile.prototype.clear = function()
  {
    navigation_clear_form("edit_profile_form");
    localStorage.removeItem(EDIT_PROFILE_LOCAL_STORAGE_NAME);
  };
    
  /*--------------------------------------------------------*/
  EditProfile.prototype.get_account_info = function(e, form_id)
  {
    e = e || window.event;
    if(e) e.preventDefault();

    var params = 
    {
      token: server_get_login_token(),
      form_id: form_id,   //the server dosen't need to know this but it is an easy way of passing it to the callback.
    };

    if(server_user_is_online())
      server_send_request("auth/user-details", params, this.get_account_info_callback.bind(this));

    else
      {
        var saved = JSON.parse( localStorage.getItem(EDIT_PROFILE_LOCAL_STORAGE_NAME));
        if(saved) this.get_account_info_callback(saved.response, saved.params);
      }
  };

  /*--------------------------------------------------------*/
  EditProfile.prototype.get_account_info_callback = function(response, params)
  {
    var form = document.getElementById(params.form_id);
    var details = response["User Details"];
    
    /*focus is workaround for Safari bug*/
    form.nickname.value = (details.nickname) ? details.nickname.trim() : '';
    form.nickname.focus();
    form.email.value = (details.email) ? details.email.trim() : '';
    form.email.focus();
    form.year_of_birth.value = (details.year_of_birth) ? details.year_of_birth.trim() : '';
    form.year_of_birth.focus();
    form.country.value = (details.country) ? details.country.trim() : '';
    form.country.focus();
    form.region.value = (details.region) ? details.region.trim() : '';
    form.region.focus();
    form.postal_code.value = (details.postal_code) ? details.postal_code.trim() : '';
    form.postal_code.focus();
    form.phone_no.value = (details.phone_no) ? details.phone_no.trim() : '';
    form.phone_no.focus();
    form.full_name.value = (details.full_name) ? details.full_name.trim() : '';
    form.full_name.focus();
    form.full_name.blur();
    
    localStorage.setItem(EDIT_PROFILE_LOCAL_STORAGE_NAME, JSON.stringify({"response":response, "params":params}));
  };

  /*--------------------------------------------------------*/
  EditProfile.prototype.get_base_64_image = function(input)
  {
    if(input.files && input.files[0])
      {
        var reader = new FileReader();
        reader.onload = function(e)
          {
            $('#uploaded_image').val(e.target.result);
          };
        reader.readAsDataURL(input.files[0]);
      }
  }
  /*--------------------------------------------------------*/
  EditProfile.prototype.update_account = function(e, form)
  {
    e = e || window.event;
    e.preventDefault();
        
    if(server_validate_user_is_logged_in_and_notify())
      {
        server_trim_form(form);

        if(!server_validate_email_and_notify(form.email.value))
          return;
        if(!server_validate_empty_string_and_notify(form.full_name.value, "Full name"))
          return;
        if(!server_validate_letters_spaces_only_and_notify(form.full_name.value, "Full name"))
          return;
        if(!server_validate_empty_string_and_notify(form.nickname.value, "Nickname"))
          return;
        if(!server_validate_letters_spaces_only_and_notify(form.nickname.value, "Nickname"))
          return;
        
        var params = 
          {
            token: server_get_login_token(),
            full_name: form.full_name.value,
            nickname: form.nickname.value,
            email: form.email.value,
         };
        if(form.year_of_birth.value !== "")
          {
            var y = parseInt(form.year_of_birth.value)
            if(!server_validate_year_and_notify(y))
              return;
            params.year_of_birth = y;
          }
        if(form.country.value !== "")
          {
            if(!server_validate_letters_spaces_only_and_notify(form.country.value, "Country"))
              return;
            params.country = form.country.value;
          }
        if(form.region.value !== "")
          {
            if(!server_validate_letters_spaces_only_and_notify(form.region.value, "Region"))
              return;
            params.region = form.region.value;
          }
        if(form.postal_code.value !== "")
          {
            if(!server_validate_numbers_only_and_notify(form.postal_code.value, "Postal code"))
              return;
            params.postal_code = form.postal_code.value;
          }
        if(form.phone_no.value !== "")
          {
            if(server_validate_phone_and_notify(form.phone_no.value))
              params.phone_no = form.phone_no.value;
            else return;
          }
        if(form.profile_image.value !== "")
          {
            params.profile_image = form.uploaded_image.value;
            server_update_profile_image(form.uploaded_image.value);
          }
        if(server_user_is_online())
          server_send_request("auth/profile/update", params, this.update_account_callback.bind(this));
       else
         {
           server_offline_queue_add("auth/profile/update", params, this.update_account_callback);
           server_generic_notify("Your account will be updated once you re-connect to the internet.");
         }
     }
  };
  
  /*--------------------------------------------------------------------*/
  EditProfile.prototype.update_account_callback = function(response, params)
  {
    edit_profile.get_account_info(window.event, "edit_profile_form");
  }
</script>
<div class="page" id="page-games">
  <div class="tabs_table">
        <table class="tabs_table_tabs">
      <tr>
        <td><span class='active' onclick='tabs_table_show_tab(event, "fundamentals_wrapper");'>Fundamentals</span></td><td><span class='' onclick='tabs_table_show_tab(event, "kicks_wrapper");'>Kicks</span></td><td><span class='' onclick='tabs_table_show_tab(event, "dribbling_wrapper");'>Dribbling</span></td>      </tr>
    </table>
    <div class='tabs_table_content'>
    <div class='active' id='fundamentals_wrapper'><div class='tabs_table_content_tr' onclick='navigation_load_page("Toe Taps")'><img src='images/games_page/Toe_Taps.jpg' alt='Toe_Taps'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Toe Taps</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Ball Taps Clock")'><img src='images/games_page/Ball_Taps_Clock.jpg' alt='Ball_Taps_Clock'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Ball Taps Clock</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Brazilian Sole Flicks")'><img src='images/games_page/Brazilian_Sole_Flicks.jpg' alt='Brazilian_Sole_Flicks'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Brazilian Sole Flicks</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Forward Backward Rolls")'><img src='images/games_page/Forward_Backward_Rolls.jpg' alt='Forward_Backward_Rolls'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Forward Backward Rolls</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Left Right Front Rolls")'><img src='images/games_page/Left_Right_Front_Rolls.jpg' alt='Left_Right_Front_Rolls'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Left Right Front Rolls</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Pull Back Taps")'><img src='images/games_page/Pull_Back_Taps.jpg' alt='Pull_Back_Taps'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Pull Back Taps</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Irish Jig")'><img src='images/games_page/Irish_Jig.jpg' alt='Irish_Jig'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Irish Jig</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Single Leg V Taps")'><img src='images/games_page/Single_Leg_V_Taps.jpg' alt='Single_Leg_V_Taps'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Single Leg V Taps</div></div></div><!-- tabs_table_content --><div class='inactive' id='kicks_wrapper'><div class='tabs_table_content_tr' onclick='navigation_load_page("Wall Kicks")'><img src='images/games_page/Wall_Kicks.jpg' alt='Wall_Kicks'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Wall Kicks</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Penalty Kicks")'><img src='images/games_page/Penalty_Kicks.jpg' alt='Penalty_Kicks'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Penalty Kicks</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Volley Kick")'><img src='images/games_page/Volley_Kick.jpg' alt='Volley_Kick'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Volley Kick</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Drop Kick")'><img src='images/games_page/Drop_Kick.jpg' alt='Drop_Kick'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Drop Kick</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("2-Person Passes")'><img src='images/games_page/2-Person_Passes.jpg' alt='2-Person_Passes'> <div class='chevron'></div><div class='tabs_tr_outline_part'>2-Person Passes</div></div></div><!-- tabs_table_content --><div class='inactive' id='dribbling_wrapper'><div class='tabs_table_content_tr' onclick='navigation_load_page("In Out Dribbling")'><img src='images/games_page/In_Out_Dribbling.jpg' alt='In_Out_Dribbling'> <div class='chevron'></div><div class='tabs_tr_outline_part'>In Out Dribbling</div></div><div class='tabs_table_content_tr' onclick='navigation_load_page("Virtual Coach")'><img src='images/games_page/Virtual_Coach.jpg' alt='Virtual_Coach'> <div class='chevron'></div><div class='tabs_tr_outline_part'>Virtual Coach</div></div></div><!-- tabs_table_content -->    </div><!--tabs_table_content-->
  </div><!-- tabs_table -->
</div><!-- page -->

<script>
  GLOBAL_JS_PAGE_OBJECTS['games'] = {id:"page-games", obj:new GamesPage()};

  function GamesPage()
  {

  }
  
  GamesPage.prototype.page_will_unload = function()
  {
    console.log("games page will unload");
  };
  
  GamesPage.prototype.page_load = function()
  {
    console.log("games page loaded");
  };

  GamesPage.prototype.page_did_unload = function()
  {
    console.log("games did unload");
  }
</script>
<div id="page-intro-carousel" class="page">
  <div class="carousel_body">
    <div class="carousel_content" id="carousel_content">
      <div class="carousel_dots_div">
        <span class="icon" style="float:left; cursor:pointer; font-size:2em;" onclick="carousel.prev_page()">&#xf3d2;</span>
        <div class="carousel_dot .carousel_dot_active"></div>
        <div class="carousel_dot"></div>
        <div class="carousel_dot"></div>
        <div class="carousel_dot"></div>
        <span class="icon" style="float:right; cursor:pointer; font-size:2em;" onclick="carousel.next_page()">&#xf3d3;</span>
      </div>
      <div class="carousel_top_text_div">Welcome to Inside Coach!</div>
      <div class="carousel_image_div">
        <img alt="image" src="images/carousel/page_1.png">
      </div>
      <div class="carousel_bottom_text_div">To get started, you’ll want to charge your ball, connect it to your device, and get it calibrated.</div>
    </div>
  </div>
</div>

<script>
var carousel_pages = [
  {
    //top_text: "Welcome to Inside Coach!",
    top_text: "Welcome to Inside Coach!",
    main_image: "images/carousel/page_1.png",
    image_width: "75%",
    image_display: "block",
    bottom_text: "To get started, you’ll want to charge your ball and connect it to your device.",
  },
  {
    top_text: "Charge your ball.",
    main_image: "images/carousel/page_2.png",
    image_width: "100%",
    image_display: "block",
    bottom_text: "Place your smart ball on the base with the logo facing down. The red indicator light will turn green when charging.",
  },
  {
    top_text: "Find your ball’s wifi.",
    main_image: "images/carousel/page_3.png",
    image_width: "100%",
    image_display: "block",
    bottom_text: "Open the wifi settings on your computer or device. Select the network starting with IC_ and enter the password ic123456.",
  },
  {
    top_text: "Start playing!",
    main_image: "",
    image_width: "0px",
    image_display: "none",
    bottom_text: "Once you’ve charged and connected your ball, you’ll be ready to play!<br><br><div class='server-form'><button class='button input-field' onclick='carousel.lets_do_this();'>Lets do this!</button></div>",
  },
];

   var CAROUSEL_LOCAL_STORAGE_NAME = "GLOBAL_CAROUSEL_STORAGE"
   var carousel = new CarouselPage();
   GLOBAL_JS_PAGE_OBJECTS["setup-guide"] = {id:"page-intro-carousel", obj:carousel};
   
  /*--------------------------------------------------------*/
  function CarouselPage()
  {
    this.current_page = 0;
    this.content = document.getElementById("carousel_content");
  }

  /*--------------------------------------------------------*/
  CarouselPage.prototype.page_will_unload = function()
  {

  };

  /*--------------------------------------------------------*/
  CarouselPage.prototype.page_load = function()
  {
    this.display_page(0);
  };
      
  /*--------------------------------------------------------*/
  CarouselPage.prototype.page_did_unload = function()
  {

  };
  
  /*--------------------------------------------------------*/
  CarouselPage.prototype.display_page = function(page_number)
  {
    if((page_number < 0) || (page_number >= carousel_pages.length))
      return;

    var top_text    = this.content.getElementsByClassName("carousel_top_text_div")[0];
    var image_div   = this.content.getElementsByClassName("carousel_image_div")[0];
    var image       = image_div.getElementsByTagName("img")[0];
    var bottom_text = this.content.getElementsByClassName("carousel_bottom_text_div")[0];
    var dots_div    = this.content.getElementsByClassName("carousel_dots_div")[0];
    var dots        = dots_div.getElementsByClassName("carousel_dot");
    var arrows      = dots_div.getElementsByClassName("icon");
  
    var content = carousel_pages[page_number];
    top_text.innerHTML = content.top_text;
    bottom_text.innerHTML = content.bottom_text;
    image.src = content.main_image;
    image.style.width = content.image_width;
    image.style.display = content.image_display;
  
    for(i=0; i<dots.length; i++)
      {
        if(i == page_number)
          dots[i].className = "carousel_dot carousel_dot_active";
        else
          dots[i].className = "carousel_dot";
      }
    this.current_page = page_number;
  
    arrows[0].style.color = (page_number == 0) ? "transparent" : "inherit";
    arrows[1].style.color = (page_number == carousel_pages.length-1) ? "transparent" : "inherit";
  }

  /*--------------------------------------------------------*/
  CarouselPage.prototype.next_page = function()
  {
    this.display_page(this.current_page + 1);
  }

  /*--------------------------------------------------------*/
  CarouselPage.prototype.prev_page = function()
  {
    this.display_page(this.current_page - 1);
  }

  /*--------------------------------------------------------*/
  CarouselPage.prototype.lets_do_this = function()
  {
    localStorage.setItem(CAROUSEL_LOCAL_STORAGE_NAME, JSON.stringify({viewed:true}));
    
    if(navigation_has_back_history())
      navigation_go_back();
    else
      navigation_load_page("games");
  }
  
  /*--------------------------------------------------------*/
  CarouselPage.prototype.has_been_fully_viewed = function()
  {
    //localStorage.setItem(CAROUSEL_LOCAL_STORAGE_NAME, JSON.stringify({viewed:true}));
    var result = false;
    var storage = localStorage.getItem(CAROUSEL_LOCAL_STORAGE_NAME);
    if(storage) result = true;
    return result;
  }

</script>
<div id="page-login" class="page">
  <form class="server-form" id="login_form" onsubmit="return false">
    <img class="avatar-circle" src="images/default_profile_image.png" alt="IC">
    <input type="text"     class="input-field" id="login_email_input" placeholder="Email" name="email" required>
    <input type="password" class="input-field" id="login_password_input" placeholder="Password" name="password" required>
    <button type="submit"  id="login_form_submit_button" name="submit" class="input-field button" onclick="login_page.login(event, this.form);">Login</button>
    <div class="secondary-form-button" onclick="navigation_load_page('sign-up');">
      <a href="#">Sign Up</a>
    </div>
    <div class="secondary-form-button" onclick="navigation_load_page('reset-password');">
      <a href="#">Reset Password</a>
    </div>
    <div class="secondary-form-button" onclick="navigation_load_page('games');">
      Login as Guest
    </div>
  </form>
</div>

<script>
   var login_page = new LoginPage();
   GLOBAL_JS_PAGE_OBJECTS["login"] = {id:"page-login", obj:login_page};
   
  /*--------------------------------------------------------*/
  function LoginPage()
  {
  
  }

  /*--------------------------------------------------------*/
  LoginPage.prototype.page_will_unload = function()
  {

  };

  /*--------------------------------------------------------*/
  LoginPage.prototype.page_load = function()
  {
    //we are here b/c user logged out
    navigation_clear_back_history();
    change_password.clear();
    sign_up.clear();
    edit_profile.clear();
    reset_password.clear();
    server_clear_login_variables();
    server_clear_offline_queue();
  };
      
  /*--------------------------------------------------------*/
  LoginPage.prototype.page_did_unload = function()
  {
    navigation_clear_form("login_form");
  };

  /*--------------------------------------------------------*/
  LoginPage.prototype.login = function(e, form)
  {
    e = e || window.event;
    e.preventDefault();

    if(server_validate_user_is_online_and_notify())
      {
        server_trim_form(form);
        
        if(!server_validate_email_and_notify(form.email.value))
          return;

        if(!server_validate_empty_string_and_notify(form.password.value, "Password"))
          return;

        var params = 
        {
          email:form.email.value,
          password:form.password.value,
          inactive_button_id:form.submit.id,
        };
        
        server_send_request("auth/login", params, this.login_callback.bind(this));
        server_inactivate_button(form.submit, 10000);
      }
  };

  /*--------------------------------------------------------*/
  LoginPage.prototype.login_callback = function(response, params)
  {
    if(response.token)
      {
        server_set_login_variables(response.token, response.nickname, response.username, response.profile_image)
        navigation_load_page("games");
        edit_profile.get_account_info(window.event, "edit_profile_form");
      }
  };

</script>
<div id="page-playlist" class="page">

  <!-- AUDERO AUDIO PLAYER -->
  
  <div class="server-form"><button class="input-field button" id="update-button">UPDATE LIST</button></div>
  

  <div data-role="content">
    <ul id="files-list" data-role="listview" data-autodividers="true" data-filter="true" data-split-icon="delete">
    </ul>
  </div>
  <div id="waiting-popup" data-role="popup" data-position-to="window" data-dismissible="false">
    <header data-role="header">
      Updating
    </header>
    <div data-role="content">
      <p>Searching audio files, please wait...</p>
    </div>
  </div>
  <!-- AUDERO AUDIO PLAYER -->
          
  <div class="server-form"><button class="input-field button" onclick="navigation_go_back();">RETURN TO GAME</button></div>
</div>

<script>
  GLOBAL_JS_PAGE_OBJECTS['playlist'] = {id:"page-playlist", obj:new Playlist()};
  
  /*--------------------------------------------------------*/
  function Playlist()
  {
  
  }

  /*--------------------------------------------------------*/
  Playlist.prototype.page_will_unload = function()
  {
    console.log(" will unload playlist");
  }

  /*--------------------------------------------------------*/
  Playlist.prototype.page_load = function()
  {
    console.log("load playlist");
  }
      
  /*--------------------------------------------------------*/
  Playlist.prototype.page_did_unload = function()
  {
    console.log(" will unload playlist");
  }

  /*--------------------------------------------------------*/
  Playlist.prototype.refresh_playlist = function()
  {

  }

  /*--------------------------------------------------------*/
  Playlist.prototype.user_did_select_song = function(url)
  {
    rollkick_template.load_song(url);
  }
</script>
<div id="page-reset-password" class="page">
  <form class="server-form" id="reset_password_form" onsubmit="return false">
    <img class="avatar-circle" src="images/default_profile_image.png" alt="IC">
    <input class="input-field" type="text" placeholder="Enter Email" name="email" required>
    <button class="input-field button" id="reset-password-button" name="button" type="submit" onclick="reset_password.reset_password(event, this.form)">Reset</button>
    <div class="secondary-form-button" onclick="navigation_load_page('login')">
      Cancel
    </form>
  </div>
</div>

<script>
   var reset_password = new ResetPassword();
   GLOBAL_JS_PAGE_OBJECTS["reset-password"] = {id:"page-reset-password", obj:reset_password};
   
  /*--------------------------------------------------------*/
  function ResetPassword()
  {
    this.button = null;
  }

  /*--------------------------------------------------------*/
  ResetPassword.prototype.page_will_unload = function()
  {

  };

  /*--------------------------------------------------------*/
  ResetPassword.prototype.page_load = function()
  {

  };
      
  /*--------------------------------------------------------*/
  ResetPassword.prototype.page_did_unload = function()
  {
    this.clear();
  };
  
  /*--------------------------------------------------------*/
  ResetPassword.prototype.clear = function()
  {
    navigation_clear_form("reset_password_form");
    if(this.button != null)
      server_reactivate_button(this.button);
  };

  /*--------------------------------------------------------------------*/
  ResetPassword.prototype.reset_password = function(e, form)
  {
    e = e || window.event;
    e.preventDefault();
  
    e = e || window.event;
    e.preventDefault();

    this.button = form.button;

    if(server_validate_user_is_online_and_notify())
      {
        server_trim_form(form);
        
        if(!server_validate_email_and_notify(form.email.value))
          return;
          
        var params = 
          {
            email:form.email.value,
            inactive_button_id:this.button.id,
          };
  
         server_send_request("auth/password/reset/link", params, this.reset_password_callback.bind(this));
         server_inactivate_button(this.button, 10000);
      }
  }

  /*--------------------------------------------------------------------*/
  ResetPassword.prototype.reset_password_callback = function(response, params)
  {
    navigation_load_page("login");
  }
</script>
<div class="page" id="routine-cones">
  <span class="video_modal_container" onclick="cone_weaving_template.video_modal.show_modal()"><div id="video_modal_page_c" class="video_modal_widget"></div>&nbsp;Watch Training</span><br>
  <div class="speech_log_widget" id="speech_log_page_c">Start when you are ready!</div><br>
  <canvas id="ball_position_page_c" class="ball_position_widget" width="900" height="600"></canvas><br>
  <div class="server-form"><button class="input-field button" onclick="cone_weaving_template.clear();">RESET GAME</button></div>
  <table id="score_log_page_c" class="socore_log_widget"></table>
</div> <!-- page routine-cones -->

<script>
  //the js for this file is in js/cone_weaving_page_template.js
</script>
<div class="page" id="routine-flightkick">
  <span class="video_modal_container" onclick="flightkick_template.video_modal.show_modal()"><div id="video_modal_page_b" class="video_modal_widget"></div>&nbsp;Watch Training</span><br>
  <div id="speech_log_page_b" class="speech_log_widget">The ball is not connected.</div>
  <canvas id="distance_dial_page_b" class="speedometer_widget speedometer_page_b" width="250" height="250"></canvas>
  <canvas id="height_dial_page_b"   class="speedometer_widget speedometer_page_b" width="250" height="250"></canvas><br>
  <canvas id="speed_dial_page_b"    class="speedometer_widget speedometer_page_b" width="250" height="250"></canvas>
  <canvas id="spin_dial_page_b"     class="speedometer_widget speedometer_page_b" width="250" height="250"></canvas><br>
  <div id="ball_position_page_b" style="margin:-30px auto 0px auto;"></div><br>
  <div class="server-form"><button class="input-field button" onclick="flightkick_template.clear();">RESET GAME</button></div>
  <table id="score_log_page_b" class="score_log_widget"></table>
</div>

<script>
  //the js for this file is in js/flightkick_page_template.js
</script>
<div class="page" id="routine-freeplay">
  <span class="video_modal_container" onclick="freeplay_template.video_modal.show_modal()"><div id="video_modal_page_d" class="video_modal_widget"></div>&nbsp;Watch Training</span><br>
  <div class="speech_log_widget" id="speech_log_page_d">Your ball is not connected</div>
  <canvas id="time_dial_page_d"     class="speedometer_widget speedometer_page_d" width="400" height="400"></canvas>
  <canvas id="distance_dial_page_d" class="speedometer_widget speedometer_page_d" width="400" height="400"></canvas>
  <canvas id="ball_position_page_d" class="ball_position_widget" width="900" height="600"></canvas><br>
  <div class="server-form"><button class="input-field button" onclick="freeplay_template.clear();">RESET GAME</button></div>
  <table id="score_log_page_d" class="score_log_widget"></table>
</div> <!-- page routine-freeplay -->

<script>
  //the js for this file is in js/freeplay_page_template.js
</script>
<div class="page" id="routine-rollkick">
  <audio id="audio_player_page_a" style="display:none" loop>
    <source src="sounds/music.mp3" type="audio/mpeg" />
  </audio>
  <div class="icon" style="color:#FF7F00; font-size:35px; position:absolute; right:15px; border:2px solid #FF7F00; border-radius:50%; height:35px; width:35px; line-height:100%; cursor:pointer;" onclick="navigation_load_page('playlist')">&#xf46c;</div>
  <span class="video_modal_container" onclick="rollkick_template.video_modal.show_modal()"><div id="video_modal_page_a" class="video_modal_widget"></div>&nbsp;Watch Training</span><br>
  <div class="speech_log_widget" id="speech_log_page_a">Your ball is not connected</div>
  <canvas id="time_dial_page_a" class="speedometer_widget speedometer_page_a" width="400" height="400"></canvas><br>
  <canvas id="kicks_dial_page_a" class="speedometer_widget speedometer_page_a" width="400" height="400"></canvas>

  <div style="margin:auto; padding-left:20px; padding-right:20px; text-align:left; position:relative; top:-55px;">
  <hr>
    <div style="float:left; color:rgb(140, 144, 148);">Best Score:</div> 
    <span id="best_score_page_a" style="margin-left:20px;">0 kicks / min for 0:00 minutes</span>
    <!-- div class="icon" style="float:right; font-size:1.7em; color:rgb(122, 1, 38); position:relative; top:-0.25em;">&#xf3ac;</div -->
  <hr>
  </div>
  <div class="server-form" style="position:relative; top:-45px;"><button class="input-field button" onclick="rollkick_template.clear();">RESET GAME</button></div>
  <table id="score_log_page_a" class="score_log_widget"></table>
</div> <!-- page routine-rollkick -->

<script>
  //the js for this file is in js/rollkick_page_template.js
</script>
<div id="page-sign-up" class="page">
  <form class="server-form" id="sign_up_form" onsubmit="return false">
    <img class="avatar-circle profile_image" src="images/default_profile_image.png" alt="IC">
    <input class="input-field" type="text" placeholder="Enter Your Full Name" name="full_name" required>
    <input class="input-field" type="text" placeholder="Enter Your Nickname" name="nickname" required>
    <input class="input-field" type="text" placeholder="Enter Email" name="email" required>
    <input class="input-field" type="password" placeholder="Enter Password" name="password" required>
    <input class="input-field" type="password" placeholder="Repeat Password" name="password_repeat" required>
    <button type="submit" name="submit" id="sign_up_button" class="input-field button" onclick="sign_up.create_account(event, this.form);">Sign Up</button>
    <div class="secondary-form-button" onclick="navigation_go_back()">
      Cancel
    </div>
    <div class="secondary-form-button" onclick="navigation_load_page('terms-of-service')">
      By creating an account you agree to our<br>Terms & Privacy
    </div>
  </form>
</div>

<script>
   var sign_up = new SignUp();
   GLOBAL_JS_PAGE_OBJECTS["sign-up"] = {id:"page-sign-up", obj:sign_up};
   
  /*--------------------------------------------------------*/
  function SignUp()
  {
  
  }

  /*--------------------------------------------------------*/
  SignUp.prototype.page_will_unload = function()
  {
    this.button = null;
  };

  /*--------------------------------------------------------*/
  SignUp.prototype.page_load = function()
  {

  };
      
  /*--------------------------------------------------------*/
  SignUp.prototype.page_did_unload = function()
  {
    this.clear();
  };
  
  /*--------------------------------------------------------*/
  SignUp.prototype.clear = function()
  {
    navigation_clear_form("sign_up_form");
    if(this.button)
      server_reactivate_button(this.button);
  };
  
  /*--------------------------------------------------------*/
  SignUp.prototype.create_account = function(e, form)
  {
    e = e || window.event;
    e.preventDefault();

    if(server_validate_user_is_online_and_notify())
      {
        server_trim_form(form);
        this.button = form.submit;
        
        if(!server_validate_empty_string_and_notify(form.full_name.value, "Your full name"))
          return;
        if(!server_validate_letters_spaces_only_and_notify(form.full_name.value, "Your full name"))
          return;
        if(!server_validate_empty_string_and_notify(form.nickname.value, "Your nickname"))
          return;
        if(!server_validate_letters_spaces_only_and_notify(form.nickname.value, "Your nickname"))
          return;
        if(!server_validate_email_and_notify(form.email.value))
          return;

        if(!server_validate_passwords_match_and_notify(form.password.value, form.password_repeat.value))
          return;

        var params = 
        {
          full_name:form.full_name.value,
          nickname:form.nickname.value,
          email:form.email.value,
          password:form.password.value,
          inactive_button_id:this.button.id,
        };
        
        server_send_request("auth/register", params, this.create_account_callback.bind(this));
        server_inactivate_button(this.button, 10000);
      }
  };

/*--------------------------------------------------------*/
  SignUp.prototype.create_account_callback = function(response, params)
  {
    navigation_load_page('login');
  }
</script>
<div id="page-terms-of-service" class="page">
<div class="terms_of_service_text">
<h2>
	Terms and Conditions of Use
</h2>

<h3>
	1. Terms
</h3>

<p>
	By accessing this web site or app, you are agreeing to be bound by these 
	web site or app Terms and Conditions of Use, all applicable laws and regulations, 
	and agree that you are responsible for compliance with any applicable local 
	laws. If you do not agree with any of these terms, you are prohibited from 
	using or accessing this site. The materials contained in this web site or app are 
	protected by applicable copyright and trade mark law.
</p>

<h3>
	2. Use License
</h3>

<ol type="a">
	<li>
		Permission is granted to temporarily download one copy of the materials 
		(information or software) on Inside Coach's web site or app for personal, 
		non-commercial transitory viewing only. This is the grant of a license, 
		not a transfer of title, and under this license you may not:
		
		<ol type="i">
			<li>modify or copy the materials;</li>
			<li>use the materials for any commercial purpose, or for any public display (commercial or non-commercial);</li>
			<li>attempt to decompile or reverse engineer any software contained on Inside Coach's web site or app;</li>
			<li>remove any copyright or other proprietary notations from the materials; or</li>
			<li>transfer the materials to another person or "mirror" the materials on any other server.</li>
		</ol>
	</li>
	<li>
		This license shall automatically terminate if you violate any of these restrictions and may be terminated by Inside Coach at any time. Upon terminating your viewing of these materials or upon the termination of this license, you must destroy any downloaded materials in your possession whether in electronic or printed format.
	</li>
</ol>

<h3>
	3. Disclaimer
</h3>

<ol type="a">
	<li>
		The materials on Inside Coach's web site or app are provided "as is". Inside Coach makes no warranties, expressed or implied, and hereby disclaims and negates all other warranties, including without limitation, implied warranties or conditions of merchantability, fitness for a particular purpose, or non-infringement of intellectual property or other violation of rights. Further, Inside Coach does not warrant or make any representations concerning the accuracy, likely results, or reliability of the use of the materials on its Internet web site or app or otherwise relating to such materials or on any sites linked to this site.
	</li>
</ol>

<h3>
	4. Limitations
</h3>

<p>
	In no event shall Inside Coach or its suppliers be liable for any damages (including, without limitation, damages for loss of data or profit, or due to business interruption,) arising out of the use or inability to use the materials on Inside Coach's Internet site, even if Inside Coach or a Inside Coach authorized representative has been notified orally or in writing of the possibility of such damage. Because some jurisdictions do not allow limitations on implied warranties, or limitations of liability for consequential or incidental damages, these limitations may not apply to you.
</p>
			
<h3>
	5. Revisions and Errata
</h3>

<p>
	The materials appearing on Inside Coach's web site or app could include technical, typographical, or photographic errors. Inside Coach does not warrant that any of the materials on its web site or app are accurate, complete, or current. Inside Coach may make changes to the materials contained on its web site or app at any time without notice. Inside Coach does not, however, make any commitment to update the materials.
</p>

<h3>
	6. Links
</h3>

<p>
	Inside Coach has not reviewed all of the sites linked to its Internet web site or app and is not responsible for the contents of any such linked site. The inclusion of any link does not imply endorsement by Inside Coach of the site. Use of any such linked web site or app is at the user's own risk.
</p>

<h3>
	7. Site Terms of Use Modifications
</h3>

<p>
	Inside Coach may revise these terms of use for its web site or app at any time without notice. By using this web site or app you are agreeing to be bound by the then current version of these Terms and Conditions of Use.
</p>

<h3>
	8. Governing Law
</h3>

<p>
	Any claim relating to Inside Coach's web site or app shall be governed by the laws of the State of Utah without regard to its conflict of law provisions.
</p>

<p>
	General Terms and Conditions applicable to Use of a web site or app.
</p>



<h2>
	Privacy Policy
</h2>

<p>
	Your privacy is very important to us. Accordingly, we have developed this Policy in order for you to understand how we collect, use, communicate and disclose and make use of personal information. The following outlines our privacy policy.
</p>

<ul>
	<li>
		Before or at the time of collecting personal information, we will identify the purposes for which information is being collected.
	</li>
	<li>
		We will collect and use of personal information solely with the objective of fulfilling those purposes specified by us and for other compatible purposes, unless we obtain the consent of the individual concerned or as required by law.		
	</li>
	<li>
		We will only retain personal information as long as necessary for the fulfillment of those purposes. 
	</li>
	<li>
		We will collect personal information by lawful and fair means and, where appropriate, with the knowledge or consent of the individual concerned. 
	</li>
	<li>
		Personal data should be relevant to the purposes for which it is to be used, and, to the extent necessary for those purposes, should be accurate, complete, and up-to-date. 
	</li>
	<li>
		We will protect personal information by reasonable security safeguards against loss or theft, as well as unauthorized access, disclosure, copying, use or modification.
	</li>
	<li>
		We will make readily available to customers information about our policies and practices relating to the management of personal information. 
	</li>
</ul>

<p>
	We are committed to conducting our business in accordance with these principles in order to ensure that the confidentiality of personal information is protected and maintained. 
</p>
</div>		

<div class="server-form"><button class="input-field button" onclick="navigation_go_back();">Agree</button></div>

</div>

<script>
   GLOBAL_JS_PAGE_OBJECTS["terms-of-service"] = {id:"page-terms-of-service", obj:new TermsOfService()};
   
  /*--------------------------------------------------------*/
  function TermsOfService()
  {
  
  }

  /*--------------------------------------------------------*/
  TermsOfService.prototype.page_will_unload = function()
  {

  };

  /*--------------------------------------------------------*/
  TermsOfService.prototype.page_load = function()
  {

  };
      
  /*--------------------------------------------------------*/
  TermsOfService.prototype.page_did_unload = function()
  {
  
  };

</script>
</div><!-- page-holder -->

<!--/HTML-->
<!-- NOTE: Phonegap Build will automatically inject platform-specific phonegap.js  -->
<!--FOR_BUILD_ONLY
<script type="text/javascript" src="phonegap.js"></script>       
/FOR_BUILD_ONLY-->
<script>

var $VERSION = "1512802181";

/**** ALL JS ****/
var $ROUTINES = {"Toe Taps":{"type":"rollkick","video":"videos\/toe_taps.mp4","gyro_motion_thresh":0.01,"impact_sensitivity":4,"min_duration":0.3,"speedometer_num_text":"TAPS","speedometer_level_text":"taps","divide_by":1,"mode":0,"menu_parent":"Fundamentals"},"Ball Taps Clock":{"type":"rollkick","video":"videos\/ball_taps_clock.mp4","gyro_motion_thresh":0.01,"impact_sensitivity":4,"min_duration":0.3,"speedometer_num_text":"TAPS","speedometer_level_text":"taps","divide_by":1,"mode":0,"menu_parent":"Fundamentals"},"Brazilian Sole Flicks":{"type":"rollkick","video":"videos\/brazilian_sole_flicks.mp4","gyro_motion_thresh":0.01,"impact_sensitivity":10,"min_duration":0.3,"speedometer_num_text":"FLICKS","speedometer_level_text":"flicks","divide_by":1,"mode":0,"menu_parent":"Fundamentals"},"Forward Backward Rolls":{"type":"rollkick","video":"videos\/forward_backward_rolls.mp4","gyro_motion_thresh":0.01,"impact_sensitivity":7,"min_duration":0.3,"speedometer_num_text":"TOUCHES","speedometer_level_text":"touches","divide_by":2,"mode":0,"menu_parent":"Fundamentals"},"Left Right Front Rolls":{"type":"rollkick","video":"videos\/left_right_rolls.mp4","gyro_motion_thresh":0.01,"impact_sensitivity":7,"min_duration":0.3,"speedometer_num_text":"TOUCHES","speedometer_level_text":"touches","divide_by":2,"mode":0,"menu_parent":"Fundamentals"},"Pull Back Taps":{"type":"rollkick","video":"videos\/pull_back_taps.mp4","gyro_motion_thresh":0.01,"impact_sensitivity":7,"min_duration":0.3,"speedometer_num_text":"TAPS","speedometer_level_text":"taps","divide_by":4,"mode":0,"menu_parent":"Fundamentals"},"Irish Jig":{"type":"rollkick","video":"videos\/irish_jig.mp4","gyro_motion_thresh":0.01,"impact_sensitivity":4,"min_duration":0.3,"speedometer_num_text":"TAPS","speedometer_level_text":"taps","divide_by":1,"mode":0,"menu_parent":"Fundamentals"},"Single Leg V Taps":{"type":"rollkick","video":"videos\/single_leg_v_taps.mp4","gyro_motion_thresh":0.01,"impact_sensitivity":7,"min_duration":0.3,"speedometer_num_text":"V's","speedometer_level_text":"v's","divide_by":4,"mode":0,"menu_parent":"Fundamentals"},"Wall Kicks":{"type":"rollkick","video":"videos\/wall_kicks.mp4","gyro_motion_thresh":0.05,"impact_sensitivity":40,"min_duration":0.3,"speedometer_num_text":"KICKS","speedometer_level_text":"kicks","divide_by":1,"mode":1,"menu_parent":"Kicks"},"Penalty Kicks":{"type":"flightkick","video":"videos\/penalty_kicks.mp4","menu_parent":"Kicks","flightkick_mode":"freekick"},"Volley Kick":{"type":"flightkick","video":"videos\/volley_kick.mp4","menu_parent":"Kicks","flightkick_mode":"dropkick"},"Drop Kick":{"type":"flightkick","video":"videos\/dropkick.mp4","menu_parent":"Kicks","flightkick_mode":"dropkick"},"In Out Dribbling":{"type":"cones","video":"videos\/in_out_dribbling.mp4","menu_parent":"Dribbling"},"Virtual Coach":{"type":"freeplay","video":"videos\/free_play.mp4","menu_parent":"Dribbling"},"2-Person Passes":{"type":"rollkick","video":"videos\/2_person_passes.mp4","gyro_motion_thresh":0.05,"impact_sensitivity":40,"min_duration":0.5,"speedometer_num_text":"PASSES","speedometer_level_text":"passes","divide_by":1,"mode":1,"menu_parent":"Kicks"}};
if(!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,function(t,e){function n(t){var e=!!t&&"length"in t&&t.length,n=pt.type(t);return"function"!==n&&!pt.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}function i(t,e,n){if(pt.isFunction(e))return pt.grep(t,function(t,i){return!!e.call(t,i,t)!==n});if(e.nodeType)return pt.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(_t.test(e))return pt.filter(e,t,n);e=pt.filter(e,t)}return pt.grep(t,function(t){return pt.inArray(t,e)>-1!==n})}function o(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function s(t){var e={};return pt.each(t.match(Nt)||[],function(t,n){e[n]=!0}),e}function r(){it.addEventListener?(it.removeEventListener("DOMContentLoaded",a),t.removeEventListener("load",a)):(it.detachEvent("onreadystatechange",a),t.detachEvent("onload",a))}function a(){(it.addEventListener||"load"===t.event.type||"complete"===it.readyState)&&(r(),pt.ready())}function l(t,e,n){if(void 0===n&&1===t.nodeType){var i="data-"+e.replace(It,"-$1").toLowerCase();if(n=t.getAttribute(i),"string"==typeof n){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:Ot.test(n)?pt.parseJSON(n):n)}catch(o){}pt.data(t,e,n)}else n=void 0}return n}function c(t){var e;for(e in t)if(("data"!==e||!pt.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function u(t,e,n,i){if(jt(t)){var o,s,r=pt.expando,a=t.nodeType,l=a?pt.cache:t,c=a?t[r]:t[r]&&r;if(c&&l[c]&&(i||l[c].data)||void 0!==n||"string"!=typeof e)return c||(c=a?t[r]=nt.pop()||pt.guid++:r),l[c]||(l[c]=a?{}:{toJSON:pt.noop}),"object"!=typeof e&&"function"!=typeof e||(i?l[c]=pt.extend(l[c],e):l[c].data=pt.extend(l[c].data,e)),s=l[c],i||(s.data||(s.data={}),s=s.data),void 0!==n&&(s[pt.camelCase(e)]=n),"string"==typeof e?(o=s[e],null==o&&(o=s[pt.camelCase(e)])):o=s,o}}function h(t,e,n){if(jt(t)){var i,o,s=t.nodeType,r=s?pt.cache:t,a=s?t[pt.expando]:pt.expando;if(r[a]){if(e&&(i=n?r[a]:r[a].data)){pt.isArray(e)?e=e.concat(pt.map(e,pt.camelCase)):e in i?e=[e]:(e=pt.camelCase(e),e=e in i?[e]:e.split(" ")),o=e.length;for(;o--;)delete i[e[o]];if(n?!c(i):!pt.isEmptyObject(i))return}(n||(delete r[a].data,c(r[a])))&&(s?pt.cleanData([t],!0):ht.deleteExpando||r!=r.window?delete r[a]:r[a]=void 0)}}}function d(t,e,n,i){var o,s=1,r=20,a=i?function(){return i.cur()}:function(){return pt.css(t,e,"")},l=a(),c=n&&n[3]||(pt.cssNumber[e]?"":"px"),u=(pt.cssNumber[e]||"px"!==c&&+l)&&Rt.exec(pt.css(t,e));if(u&&u[3]!==c){c=c||u[3],n=n||[],u=+l||1;do s=s||".5",u/=s,pt.style(t,e,u+c);while(s!==(s=a()/l)&&1!==s&&--r)}return n&&(u=+u||+l||0,o=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=c,i.start=u,i.end=o)),o}function p(t){var e=Bt.split("|"),n=t.createDocumentFragment();if(n.createElement)for(;e.length;)n.createElement(e.pop());return n}function f(t,e){var n,i,o=0,s="undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!=typeof t.querySelectorAll?t.querySelectorAll(e||"*"):void 0;if(!s)for(s=[],n=t.childNodes||t;null!=(i=n[o]);o++)!e||pt.nodeName(i,e)?s.push(i):pt.merge(s,f(i,e));return void 0===e||e&&pt.nodeName(t,e)?pt.merge([t],s):s}function g(t,e){for(var n,i=0;null!=(n=t[i]);i++)pt._data(n,"globalEval",!e||pt._data(e[i],"globalEval"))}function m(t){zt.test(t.type)&&(t.defaultChecked=t.checked)}function v(t,e,n,i,o){for(var s,r,a,l,c,u,h,d=t.length,v=p(e),y=[],b=0;d>b;b++)if(r=t[b],r||0===r)if("object"===pt.type(r))pt.merge(y,r.nodeType?[r]:r);else if(Qt.test(r)){for(l=l||v.appendChild(e.createElement("div")),c=(qt.exec(r)||["",""])[1].toLowerCase(),h=Ut[c]||Ut._default,l.innerHTML=h[1]+pt.htmlPrefilter(r)+h[2],s=h[0];s--;)l=l.lastChild;if(!ht.leadingWhitespace&&Wt.test(r)&&y.push(e.createTextNode(Wt.exec(r)[0])),!ht.tbody)for(r="table"!==c||Vt.test(r)?"<table>"!==h[1]||Vt.test(r)?0:l:l.firstChild,s=r&&r.childNodes.length;s--;)pt.nodeName(u=r.childNodes[s],"tbody")&&!u.childNodes.length&&r.removeChild(u);for(pt.merge(y,l.childNodes),l.textContent="";l.firstChild;)l.removeChild(l.firstChild);l=v.lastChild}else y.push(e.createTextNode(r));for(l&&v.removeChild(l),ht.appendChecked||pt.grep(f(y,"input"),m),b=0;r=y[b++];)if(i&&pt.inArray(r,i)>-1)o&&o.push(r);else if(a=pt.contains(r.ownerDocument,r),l=f(v.appendChild(r),"script"),a&&g(l),n)for(s=0;r=l[s++];)Ft.test(r.type||"")&&n.push(r);return l=null,v}function y(){return!0}function b(){return!1}function w(){try{return it.activeElement}catch(t){}}function x(t,e,n,i,o,s){var r,a;if("object"==typeof e){"string"!=typeof n&&(i=i||n,n=void 0);for(a in e)x(t,a,n,i,e[a],s);return t}if(null==i&&null==o?(o=n,i=n=void 0):null==o&&("string"==typeof n?(o=i,i=void 0):(o=i,i=n,n=void 0)),o===!1)o=b;else if(!o)return t;return 1===s&&(r=o,o=function(t){return pt().off(t),r.apply(this,arguments)},o.guid=r.guid||(r.guid=pt.guid++)),t.each(function(){pt.event.add(this,e,o,i,n)})}function C(t,e){return pt.nodeName(t,"table")&&pt.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function _(t){return t.type=(null!==pt.find.attr(t,"type"))+"/"+t.type,t}function T(t){var e=oe.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function E(t,e){if(1===e.nodeType&&pt.hasData(t)){var n,i,o,s=pt._data(t),r=pt._data(e,s),a=s.events;if(a){delete r.handle,r.events={};for(n in a)for(i=0,o=a[n].length;o>i;i++)pt.event.add(e,n,a[n][i])}r.data&&(r.data=pt.extend({},r.data))}}function $(t,e){var n,i,o;if(1===e.nodeType){if(n=e.nodeName.toLowerCase(),!ht.noCloneEvent&&e[pt.expando]){o=pt._data(e);for(i in o.events)pt.removeEvent(e,i,o.handle);e.removeAttribute(pt.expando)}"script"===n&&e.text!==t.text?(_(e).text=t.text,T(e)):"object"===n?(e.parentNode&&(e.outerHTML=t.outerHTML),ht.html5Clone&&t.innerHTML&&!pt.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===n&&zt.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}}function S(t,e,n,i){e=st.apply([],e);var o,s,r,a,l,c,u=0,h=t.length,d=h-1,p=e[0],g=pt.isFunction(p);if(g||h>1&&"string"==typeof p&&!ht.checkClone&&ie.test(p))return t.each(function(o){var s=t.eq(o);g&&(e[0]=p.call(this,o,s.html())),S(s,e,n,i)});if(h&&(c=v(e,t[0].ownerDocument,!1,t,i),o=c.firstChild,1===c.childNodes.length&&(c=o),o||i)){for(a=pt.map(f(c,"script"),_),r=a.length;h>u;u++)s=c,u!==d&&(s=pt.clone(s,!0,!0),r&&pt.merge(a,f(s,"script"))),n.call(t[u],s,u);if(r)for(l=a[a.length-1].ownerDocument,pt.map(a,T),u=0;r>u;u++)s=a[u],Ft.test(s.type||"")&&!pt._data(s,"globalEval")&&pt.contains(l,s)&&(s.src?pt._evalUrl&&pt._evalUrl(s.src):pt.globalEval((s.text||s.textContent||s.innerHTML||"").replace(se,"")));c=o=null}return t}function k(t,e,n){for(var i,o=e?pt.filter(e,t):t,s=0;null!=(i=o[s]);s++)n||1!==i.nodeType||pt.cleanData(f(i)),i.parentNode&&(n&&pt.contains(i.ownerDocument,i)&&g(f(i,"script")),i.parentNode.removeChild(i));return t}function N(t,e){var n=pt(e.createElement(t)).appendTo(e.body),i=pt.css(n[0],"display");return n.detach(),i}function D(t){var e=it,n=ce[t];return n||(n=N(t,e),"none"!==n&&n||(le=(le||pt("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=(le[0].contentWindow||le[0].contentDocument).document,e.write(),e.close(),n=N(t,e),le.detach()),ce[t]=n),n}function A(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function j(t){if(t in Te)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=_e.length;n--;)if(t=_e[n]+e,t in Te)return t}function O(t,e){for(var n,i,o,s=[],r=0,a=t.length;a>r;r++)i=t[r],i.style&&(s[r]=pt._data(i,"olddisplay"),n=i.style.display,e?(s[r]||"none"!==n||(i.style.display=""),""===i.style.display&&Ht(i)&&(s[r]=pt._data(i,"olddisplay",D(i.nodeName)))):(o=Ht(i),(n&&"none"!==n||!o)&&pt._data(i,"olddisplay",o?n:pt.css(i,"display"))));for(r=0;a>r;r++)i=t[r],i.style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?s[r]||"":"none"));return t}function I(t,e,n){var i=we.exec(e);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):e}function L(t,e,n,i,o){for(var s=n===(i?"border":"content")?4:"width"===e?1:0,r=0;4>s;s+=2)"margin"===n&&(r+=pt.css(t,n+Pt[s],!0,o)),i?("content"===n&&(r-=pt.css(t,"padding"+Pt[s],!0,o)),"margin"!==n&&(r-=pt.css(t,"border"+Pt[s]+"Width",!0,o))):(r+=pt.css(t,"padding"+Pt[s],!0,o),"padding"!==n&&(r+=pt.css(t,"border"+Pt[s]+"Width",!0,o)));return r}function R(t,e,n){var i=!0,o="width"===e?t.offsetWidth:t.offsetHeight,s=fe(t),r=ht.boxSizing&&"border-box"===pt.css(t,"boxSizing",!1,s);if(0>=o||null==o){if(o=ge(t,e,s),(0>o||null==o)&&(o=t.style[e]),he.test(o))return o;i=r&&(ht.boxSizingReliable()||o===t.style[e]),o=parseFloat(o)||0}return o+L(t,e,n||(r?"border":"content"),i,s)+"px"}function P(t,e,n,i,o){return new P.prototype.init(t,e,n,i,o)}function H(){return t.setTimeout(function(){Ee=void 0}),Ee=pt.now()}function M(t,e){var n,i={height:t},o=0;for(e=e?1:0;4>o;o+=2-e)n=Pt[o],i["margin"+n]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function z(t,e,n){for(var i,o=(W.tweeners[e]||[]).concat(W.tweeners["*"]),s=0,r=o.length;r>s;s++)if(i=o[s].call(n,e,t))return i}function q(t,e,n){var i,o,s,r,a,l,c,u,h=this,d={},p=t.style,f=t.nodeType&&Ht(t),g=pt._data(t,"fxshow");n.queue||(a=pt._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,pt.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],c=pt.css(t,"display"),u="none"===c?pt._data(t,"olddisplay")||D(t.nodeName):c,"inline"===u&&"none"===pt.css(t,"float")&&(ht.inlineBlockNeedsLayout&&"inline"!==D(t.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",ht.shrinkWrapBlocks()||h.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(i in e)if(o=e[i],Se.exec(o)){if(delete e[i],s=s||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!g||void 0===g[i])continue;f=!0}d[i]=g&&g[i]||pt.style(t,i)}else c=void 0;if(pt.isEmptyObject(d))"inline"===("none"===c?D(t.nodeName):c)&&(p.display=c);else{g?"hidden"in g&&(f=g.hidden):g=pt._data(t,"fxshow",{}),s&&(g.hidden=!f),f?pt(t).show():h.done(function(){pt(t).hide()}),h.done(function(){var e;pt._removeData(t,"fxshow");for(e in d)pt.style(t,e,d[e])});for(i in d)r=z(f?g[i]:0,i,h),i in g||(g[i]=r.start,f&&(r.end=r.start,r.start="width"===i||"height"===i?1:0))}}function F(t,e){var n,i,o,s,r;for(n in t)if(i=pt.camelCase(n),o=e[i],s=t[n],pt.isArray(s)&&(o=s[1],s=t[n]=s[0]),n!==i&&(t[i]=s,delete t[n]),r=pt.cssHooks[i],r&&"expand"in r){s=r.expand(s),delete t[i];for(n in s)n in t||(t[n]=s[n],e[n]=o)}else e[i]=o}function W(t,e,n){var i,o,s=0,r=W.prefilters.length,a=pt.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=Ee||H(),n=Math.max(0,c.startTime+c.duration-e),i=n/c.duration||0,s=1-i,r=0,l=c.tweens.length;l>r;r++)c.tweens[r].run(s);return a.notifyWith(t,[c,s,n]),1>s&&l?n:(a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:pt.extend({},e),opts:pt.extend(!0,{specialEasing:{},easing:pt.easing._default},n),originalProperties:e,originalOptions:n,startTime:Ee||H(),duration:n.duration,tweens:[],createTween:function(e,n){var i=pt.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(o)return this;for(o=!0;i>n;n++)c.tweens[n].run(1);return e?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,e])):a.rejectWith(t,[c,e]),this}}),u=c.props;for(F(u,c.opts.specialEasing);r>s;s++)if(i=W.prefilters[s].call(c,t,u,c.opts))return pt.isFunction(i.stop)&&(pt._queueHooks(c.elem,c.opts.queue).stop=pt.proxy(i.stop,i)),i;return pt.map(u,z,c),pt.isFunction(c.opts.start)&&c.opts.start.call(t,c),pt.fx.timer(pt.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function B(t){return pt.attr(t,"class")||""}function U(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,o=0,s=e.toLowerCase().match(Nt)||[];if(pt.isFunction(n))for(;i=s[o++];)"+"===i.charAt(0)?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function Q(t,e,n,i){function o(a){var l;return s[a]=!0,pt.each(t[a]||[],function(t,a){var c=a(e,n,i);return"string"!=typeof c||r||s[c]?r?!(l=c):void 0:(e.dataTypes.unshift(c),o(c),!1)}),l}var s={},r=t===Je;return o(e.dataTypes[0])||!s["*"]&&o("*")}function V(t,e){var n,i,o=pt.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n||(n={}))[i]=e[i]);return n&&pt.extend(!0,t,n),t}function X(t,e,n){for(var i,o,s,r,a=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===o&&(o=t.mimeType||e.getResponseHeader("Content-Type"));if(o)for(r in a)if(a[r]&&a[r].test(o)){l.unshift(r);break}if(l[0]in n)s=l[0];else{for(r in n){if(!l[0]||t.converters[r+" "+l[0]]){s=r;break}i||(i=r)}s=s||i}return s?(s!==l[0]&&l.unshift(s),n[s]):void 0}function Y(t,e,n,i){var o,s,r,a,l,c={},u=t.dataTypes.slice();if(u[1])for(r in t.converters)c[r.toLowerCase()]=t.converters[r];for(s=u.shift();s;)if(t.responseFields[s]&&(n[t.responseFields[s]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=u.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(r=c[l+" "+s]||c["* "+s],!r)for(o in c)if(a=o.split(" "),a[1]===s&&(r=c[l+" "+a[0]]||c["* "+a[0]])){r===!0?r=c[o]:c[o]!==!0&&(s=a[0],u.unshift(a[1]));break}if(r!==!0)if(r&&t["throws"])e=r(e);else try{e=r(e)}catch(h){return{state:"parsererror",error:r?h:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}function Z(t){return t.style&&t.style.display||pt.css(t,"display")}function G(t){if(!pt.contains(t.ownerDocument||it,t))return!0;for(;t&&1===t.nodeType;){if("none"===Z(t)||"hidden"===t.type)return!0;t=t.parentNode}return!1}function J(t,e,n,i){var o;if(pt.isArray(e))pt.each(e,function(e,o){n||on.test(t)?i(t,o):J(t+"["+("object"==typeof o&&null!=o?e:"")+"]",o,n,i)});else if(n||"object"!==pt.type(e))i(t,e);else for(o in e)J(t+"["+o+"]",e[o],n,i)}function K(){try{return new t.XMLHttpRequest}catch(e){}}function tt(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function et(t){return pt.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}var nt=[],it=t.document,ot=nt.slice,st=nt.concat,rt=nt.push,at=nt.indexOf,lt={},ct=lt.toString,ut=lt.hasOwnProperty,ht={},dt="1.12.4",pt=function(t,e){return new pt.fn.init(t,e)},ft=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,gt=/^-ms-/,mt=/-([\da-z])/gi,vt=function(t,e){return e.toUpperCase()};pt.fn=pt.prototype={jquery:dt,constructor:pt,selector:"",length:0,toArray:function(){return ot.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:ot.call(this)},pushStack:function(t){var e=pt.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return pt.each(this,t)},map:function(t){return this.pushStack(pt.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(ot.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:rt,sort:nt.sort,splice:nt.splice},pt.extend=pt.fn.extend=function(){var t,e,n,i,o,s,r=arguments[0]||{},a=1,l=arguments.length,c=!1;for("boolean"==typeof r&&(c=r,r=arguments[a]||{},a++),"object"==typeof r||pt.isFunction(r)||(r={}),a===l&&(r=this,a--);l>a;a++)if(null!=(o=arguments[a]))for(i in o)t=r[i],n=o[i],r!==n&&(c&&n&&(pt.isPlainObject(n)||(e=pt.isArray(n)))?(e?(e=!1,s=t&&pt.isArray(t)?t:[]):s=t&&pt.isPlainObject(t)?t:{},r[i]=pt.extend(c,s,n)):void 0!==n&&(r[i]=n));return r},pt.extend({expando:"jQuery"+(dt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===pt.type(t)},isArray:Array.isArray||function(t){return"array"===pt.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){var e=t&&t.toString();return!pt.isArray(t)&&e-parseFloat(e)+1>=0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){var e;if(!t||"object"!==pt.type(t)||t.nodeType||pt.isWindow(t))return!1;try{if(t.constructor&&!ut.call(t,"constructor")&&!ut.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(!ht.ownFirst)for(e in t)return ut.call(t,e);for(e in t);return void 0===e||ut.call(t,e)},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?lt[ct.call(t)]||"object":typeof t},globalEval:function(e){e&&pt.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(gt,"ms-").replace(mt,vt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,o=0;if(n(t))for(i=t.length;i>o&&e.call(t[o],o,t[o])!==!1;o++);else for(o in t)if(e.call(t[o],o,t[o])===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(ft,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(n(Object(t))?pt.merge(i,"string"==typeof t?[t]:t):rt.call(i,t)),i},inArray:function(t,e,n){var i;if(e){if(at)return at.call(e,t,n);for(i=e.length,n=n?0>n?Math.max(0,i+n):n:0;i>n;n++)if(n in e&&e[n]===t)return n}return-1},merge:function(t,e){for(var n=+e.length,i=0,o=t.length;n>i;)t[o++]=e[i++];if(n!==n)for(;void 0!==e[i];)t[o++]=e[i++];return t.length=o,t},grep:function(t,e,n){for(var i,o=[],s=0,r=t.length,a=!n;r>s;s++)i=!e(t[s],s),i!==a&&o.push(t[s]);return o},map:function(t,e,i){var o,s,r=0,a=[];if(n(t))for(o=t.length;o>r;r++)s=e(t[r],r,i),null!=s&&a.push(s);else for(r in t)s=e(t[r],r,i),null!=s&&a.push(s);return st.apply([],a)},guid:1,proxy:function(t,e){var n,i,o;return"string"==typeof e&&(o=t[e],e=t,t=o),pt.isFunction(t)?(n=ot.call(arguments,2),i=function(){return t.apply(e||this,n.concat(ot.call(arguments)))},i.guid=t.guid=t.guid||pt.guid++,i):void 0},now:function(){return+new Date},support:ht}),"function"==typeof Symbol&&(pt.fn[Symbol.iterator]=nt[Symbol.iterator]),pt.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){lt["[object "+e+"]"]=e.toLowerCase()});var yt=function(t){function e(t,e,n,i){var o,s,r,a,l,c,h,p,f=e&&e.ownerDocument,g=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==g&&9!==g&&11!==g)return n;if(!i&&((e?e.ownerDocument||e:z)!==j&&A(e),e=e||j,I)){if(11!==g&&(c=vt.exec(t)))if(o=c[1]){if(9===g){if(!(r=e.getElementById(o)))return n;if(r.id===o)return n.push(r),n}else if(f&&(r=f.getElementById(o))&&H(e,r)&&r.id===o)return n.push(r),n}else{if(c[2])return J.apply(n,e.getElementsByTagName(t)),n;if((o=c[3])&&x.getElementsByClassName&&e.getElementsByClassName)return J.apply(n,e.getElementsByClassName(o)),n}if(x.qsa&&!U[t+" "]&&(!L||!L.test(t))){if(1!==g)f=e,p=t;else if("object"!==e.nodeName.toLowerCase()){for((a=e.getAttribute("id"))?a=a.replace(bt,"\\$&"):e.setAttribute("id",a=M),h=E(t),s=h.length,l=dt.test(a)?"#"+a:"[id='"+a+"']";s--;)h[s]=l+" "+d(h[s]);p=h.join(","),f=yt.test(t)&&u(e.parentNode)||e}if(p)try{return J.apply(n,f.querySelectorAll(p)),n}catch(m){}finally{a===M&&e.removeAttribute("id")}}}return S(t.replace(at,"$1"),e,n,i)}function n(){function t(n,i){return e.push(n+" ")>C.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function i(t){return t[M]=!0,t}function o(t){var e=j.createElement("div");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function s(t,e){for(var n=t.split("|"),i=n.length;i--;)C.attrHandle[n[i]]=e}function r(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||V)-(~t.sourceIndex||V);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function a(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function l(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function c(t){return i(function(e){return e=+e,i(function(n,i){for(var o,s=t([],n.length,e),r=s.length;r--;)n[o=s[r]]&&(n[o]=!(i[o]=n[o]))})})}function u(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function h(){}function d(t){for(var e=0,n=t.length,i="";n>e;e++)i+=t[e].value;return i}function p(t,e,n){var i=e.dir,o=n&&"parentNode"===i,s=F++;return e.first?function(e,n,s){for(;e=e[i];)if(1===e.nodeType||o)return t(e,n,s)}:function(e,n,r){var a,l,c,u=[q,s];if(r){for(;e=e[i];)if((1===e.nodeType||o)&&t(e,n,r))return!0}else for(;e=e[i];)if(1===e.nodeType||o){if(c=e[M]||(e[M]={}),l=c[e.uniqueID]||(c[e.uniqueID]={}),(a=l[i])&&a[0]===q&&a[1]===s)return u[2]=a[2];if(l[i]=u,u[2]=t(e,n,r))return!0}}}function f(t){return t.length>1?function(e,n,i){for(var o=t.length;o--;)if(!t[o](e,n,i))return!1;return!0}:t[0]}function g(t,n,i){for(var o=0,s=n.length;s>o;o++)e(t,n[o],i);return i}function m(t,e,n,i,o){for(var s,r=[],a=0,l=t.length,c=null!=e;l>a;a++)(s=t[a])&&(n&&!n(s,i,o)||(r.push(s),c&&e.push(a)));return r}function v(t,e,n,o,s,r){return o&&!o[M]&&(o=v(o)),s&&!s[M]&&(s=v(s,r)),i(function(i,r,a,l){var c,u,h,d=[],p=[],f=r.length,v=i||g(e||"*",a.nodeType?[a]:a,[]),y=!t||!i&&e?v:m(v,d,t,a,l),b=n?s||(i?t:f||o)?[]:r:y;if(n&&n(y,b,a,l),o)for(c=m(b,p),o(c,[],a,l),u=c.length;u--;)(h=c[u])&&(b[p[u]]=!(y[p[u]]=h));if(i){if(s||t){if(s){for(c=[],u=b.length;u--;)(h=b[u])&&c.push(y[u]=h);s(null,b=[],c,l)}for(u=b.length;u--;)(h=b[u])&&(c=s?tt(i,h):d[u])>-1&&(i[c]=!(r[c]=h))}}else b=m(b===r?b.splice(f,b.length):b),s?s(null,r,b,l):J.apply(r,b)})}function y(t){for(var e,n,i,o=t.length,s=C.relative[t[0].type],r=s||C.relative[" "],a=s?1:0,l=p(function(t){return t===e},r,!0),c=p(function(t){return tt(e,t)>-1},r,!0),u=[function(t,n,i){var o=!s&&(i||n!==k)||((e=n).nodeType?l(t,n,i):c(t,n,i));return e=null,o}];o>a;a++)if(n=C.relative[t[a].type])u=[p(f(u),n)];else{if(n=C.filter[t[a].type].apply(null,t[a].matches),n[M]){for(i=++a;o>i&&!C.relative[t[i].type];i++);return v(a>1&&f(u),a>1&&d(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(at,"$1"),n,i>a&&y(t.slice(a,i)),o>i&&y(t=t.slice(i)),o>i&&d(t))}u.push(n)}return f(u)}function b(t,n){var o=n.length>0,s=t.length>0,r=function(i,r,a,l,c){var u,h,d,p=0,f="0",g=i&&[],v=[],y=k,b=i||s&&C.find.TAG("*",c),w=q+=null==y?1:Math.random()||.1,x=b.length;for(c&&(k=r===j||r||c);f!==x&&null!=(u=b[f]);f++){if(s&&u){for(h=0,r||u.ownerDocument===j||(A(u),a=!I);d=t[h++];)if(d(u,r||j,a)){l.push(u);break}c&&(q=w)}o&&((u=!d&&u)&&p--,i&&g.push(u))}if(p+=f,o&&f!==p){for(h=0;d=n[h++];)d(g,v,r,a);if(i){if(p>0)for(;f--;)g[f]||v[f]||(v[f]=Z.call(l));v=m(v)}J.apply(l,v),c&&!i&&v.length>0&&p+n.length>1&&e.uniqueSort(l)}return c&&(q=w,k=y),g};return o?i(r):r}var w,x,C,_,T,E,$,S,k,N,D,A,j,O,I,L,R,P,H,M="sizzle"+1*new Date,z=t.document,q=0,F=0,W=n(),B=n(),U=n(),Q=function(t,e){return t===e&&(D=!0),0},V=1<<31,X={}.hasOwnProperty,Y=[],Z=Y.pop,G=Y.push,J=Y.push,K=Y.slice,tt=function(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+it+"))|)"+nt+"*\\]",st=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ot+")*)|.*)\\)|)",rt=new RegExp(nt+"+","g"),at=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),lt=new RegExp("^"+nt+"*,"+nt+"*"),ct=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),ut=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),ht=new RegExp(st),dt=new RegExp("^"+it+"$"),pt={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it+"|[*])"),ATTR:new RegExp("^"+ot),PSEUDO:new RegExp("^"+st),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},ft=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,mt=/^[^{]+\{\s*\[native \w/,vt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,bt=/'|\\/g,wt=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),xt=function(t,e,n){var i="0x"+e-65536;return i!==i||n?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},Ct=function(){A()};try{J.apply(Y=K.call(z.childNodes),z.childNodes),Y[z.childNodes.length].nodeType}catch(_t){J={apply:Y.length?function(t,e){G.apply(t,K.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}x=e.support={},T=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},A=e.setDocument=function(t){var e,n,i=t?t.ownerDocument||t:z;return i!==j&&9===i.nodeType&&i.documentElement?(j=i,O=j.documentElement,I=!T(j),(n=j.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",Ct,!1):n.attachEvent&&n.attachEvent("onunload",Ct)),x.attributes=o(function(t){return t.className="i",!t.getAttribute("className")}),x.getElementsByTagName=o(function(t){return t.appendChild(j.createComment("")),!t.getElementsByTagName("*").length}),x.getElementsByClassName=mt.test(j.getElementsByClassName),x.getById=o(function(t){return O.appendChild(t).id=M,!j.getElementsByName||!j.getElementsByName(M).length}),x.getById?(C.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&I){var n=e.getElementById(t);return n?[n]:[]}},C.filter.ID=function(t){var e=t.replace(wt,xt);return function(t){return t.getAttribute("id")===e}}):(delete C.find.ID,C.filter.ID=function(t){var e=t.replace(wt,xt);return function(t){var n="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),C.find.TAG=x.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):x.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],o=0,s=e.getElementsByTagName(t);if("*"===t){for(;n=s[o++];)1===n.nodeType&&i.push(n);return i}return s},C.find.CLASS=x.getElementsByClassName&&function(t,e){return"undefined"!=typeof e.getElementsByClassName&&I?e.getElementsByClassName(t):void 0},R=[],L=[],(x.qsa=mt.test(j.querySelectorAll))&&(o(function(t){O.appendChild(t).innerHTML="<a id='"+M+"'></a><select id='"+M+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&L.push("[*^$]="+nt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||L.push("\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+M+"-]").length||L.push("~="),t.querySelectorAll(":checked").length||L.push(":checked"),t.querySelectorAll("a#"+M+"+*").length||L.push(".#.+[+~]")}),o(function(t){var e=j.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&L.push("name"+nt+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||L.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),L.push(",.*:")})),(x.matchesSelector=mt.test(P=O.matches||O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&o(function(t){x.disconnectedMatch=P.call(t,"div"),P.call(t,"[s!='']:x"),R.push("!=",st)}),L=L.length&&new RegExp(L.join("|")),R=R.length&&new RegExp(R.join("|")),e=mt.test(O.compareDocumentPosition),H=e||mt.test(O.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},Q=e?function(t,e){if(t===e)return D=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!x.sortDetached&&e.compareDocumentPosition(t)===n?t===j||t.ownerDocument===z&&H(z,t)?-1:e===j||e.ownerDocument===z&&H(z,e)?1:N?tt(N,t)-tt(N,e):0:4&n?-1:1)}:function(t,e){if(t===e)return D=!0,0;var n,i=0,o=t.parentNode,s=e.parentNode,a=[t],l=[e];if(!o||!s)return t===j?-1:e===j?1:o?-1:s?1:N?tt(N,t)-tt(N,e):0;if(o===s)return r(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)l.unshift(n);for(;a[i]===l[i];)i++;return i?r(a[i],l[i]):a[i]===z?-1:l[i]===z?1:0},j):j},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==j&&A(t),n=n.replace(ut,"='$1']"),x.matchesSelector&&I&&!U[n+" "]&&(!R||!R.test(n))&&(!L||!L.test(n)))try{var i=P.call(t,n);if(i||x.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(o){}return e(n,j,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==j&&A(t),H(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==j&&A(t);var n=C.attrHandle[e.toLowerCase()],i=n&&X.call(C.attrHandle,e.toLowerCase())?n(t,e,!I):void 0;return void 0!==i?i:x.attributes||!I?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],i=0,o=0;if(D=!x.detectDuplicates,N=!x.sortStable&&t.slice(0),t.sort(Q),D){for(;e=t[o++];)e===t[o]&&(i=n.push(o));for(;i--;)t.splice(n[i],1)}return N=null,t},_=e.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=_(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=_(e);return n},C=e.selectors={cacheLength:50,createPseudo:i,match:pt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(wt,xt),t[3]=(t[3]||t[4]||t[5]||"").replace(wt,xt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return pt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&ht.test(n)&&(e=E(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(wt,xt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=W[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&W(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,n,i){return function(o){var s=e.attr(o,t);return null==s?"!="===n:!n||(s+="","="===n?s===i:"!="===n?s!==i:"^="===n?i&&0===s.indexOf(i):"*="===n?i&&s.indexOf(i)>-1:"$="===n?i&&s.slice(-i.length)===i:"~="===n?(" "+s.replace(rt," ")+" ").indexOf(i)>-1:"|="===n&&(s===i||s.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,n,i,o){var s="nth"!==t.slice(0,3),r="last"!==t.slice(-4),a="of-type"===e;return 1===i&&0===o?function(t){return!!t.parentNode}:function(e,n,l){var c,u,h,d,p,f,g=s!==r?"nextSibling":"previousSibling",m=e.parentNode,v=a&&e.nodeName.toLowerCase(),y=!l&&!a,b=!1;if(m){if(s){for(;g;){for(d=e;d=d[g];)if(a?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=g="only"===t&&!f&&"nextSibling"}return!0}if(f=[r?m.firstChild:m.lastChild],r&&y){for(d=m,h=d[M]||(d[M]={}),u=h[d.uniqueID]||(h[d.uniqueID]={}),c=u[t]||[],p=c[0]===q&&c[1],
b=p&&c[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(b=p=0)||f.pop();)if(1===d.nodeType&&++b&&d===e){u[t]=[q,p,b];break}}else if(y&&(d=e,h=d[M]||(d[M]={}),u=h[d.uniqueID]||(h[d.uniqueID]={}),c=u[t]||[],p=c[0]===q&&c[1],b=p),b===!1)for(;(d=++p&&d&&d[g]||(b=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++b||(y&&(h=d[M]||(d[M]={}),u=h[d.uniqueID]||(h[d.uniqueID]={}),u[t]=[q,b]),d!==e)););return b-=o,b===i||b%i===0&&b/i>=0}}},PSEUDO:function(t,n){var o,s=C.pseudos[t]||C.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return s[M]?s(n):s.length>1?(o=[t,t,"",n],C.setFilters.hasOwnProperty(t.toLowerCase())?i(function(t,e){for(var i,o=s(t,n),r=o.length;r--;)i=tt(t,o[r]),t[i]=!(e[i]=o[r])}):function(t){return s(t,0,o)}):s}},pseudos:{not:i(function(t){var e=[],n=[],o=$(t.replace(at,"$1"));return o[M]?i(function(t,e,n,i){for(var s,r=o(t,null,i,[]),a=t.length;a--;)(s=r[a])&&(t[a]=!(e[a]=s))}):function(t,i,s){return e[0]=t,o(e,null,s,n),e[0]=null,!n.pop()}}),has:i(function(t){return function(n){return e(t,n).length>0}}),contains:i(function(t){return t=t.replace(wt,xt),function(e){return(e.textContent||e.innerText||_(e)).indexOf(t)>-1}}),lang:i(function(t){return dt.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(wt,xt).toLowerCase(),function(e){var n;do if(n=I?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===O},focus:function(t){return t===j.activeElement&&(!j.hasFocus||j.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!C.pseudos.empty(t)},header:function(t){return gt.test(t.nodeName)},input:function(t){return ft.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,n){return[0>n?n+e:n]}),even:c(function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t}),odd:c(function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t}),lt:c(function(t,e,n){for(var i=0>n?n+e:n;--i>=0;)t.push(i);return t}),gt:c(function(t,e,n){for(var i=0>n?n+e:n;++i<e;)t.push(i);return t})}},C.pseudos.nth=C.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[w]=a(w);for(w in{submit:!0,reset:!0})C.pseudos[w]=l(w);return h.prototype=C.filters=C.pseudos,C.setFilters=new h,E=e.tokenize=function(t,n){var i,o,s,r,a,l,c,u=B[t+" "];if(u)return n?0:u.slice(0);for(a=t,l=[],c=C.preFilter;a;){i&&!(o=lt.exec(a))||(o&&(a=a.slice(o[0].length)||a),l.push(s=[])),i=!1,(o=ct.exec(a))&&(i=o.shift(),s.push({value:i,type:o[0].replace(at," ")}),a=a.slice(i.length));for(r in C.filter)!(o=pt[r].exec(a))||c[r]&&!(o=c[r](o))||(i=o.shift(),s.push({value:i,type:r,matches:o}),a=a.slice(i.length));if(!i)break}return n?a.length:a?e.error(t):B(t,l).slice(0)},$=e.compile=function(t,e){var n,i=[],o=[],s=U[t+" "];if(!s){for(e||(e=E(t)),n=e.length;n--;)s=y(e[n]),s[M]?i.push(s):o.push(s);s=U(t,b(o,i)),s.selector=t}return s},S=e.select=function(t,e,n,i){var o,s,r,a,l,c="function"==typeof t&&t,h=!i&&E(t=c.selector||t);if(n=n||[],1===h.length){if(s=h[0]=h[0].slice(0),s.length>2&&"ID"===(r=s[0]).type&&x.getById&&9===e.nodeType&&I&&C.relative[s[1].type]){if(e=(C.find.ID(r.matches[0].replace(wt,xt),e)||[])[0],!e)return n;c&&(e=e.parentNode),t=t.slice(s.shift().value.length)}for(o=pt.needsContext.test(t)?0:s.length;o--&&(r=s[o],!C.relative[a=r.type]);)if((l=C.find[a])&&(i=l(r.matches[0].replace(wt,xt),yt.test(s[0].type)&&u(e.parentNode)||e))){if(s.splice(o,1),t=i.length&&d(s),!t)return J.apply(n,i),n;break}}return(c||$(t,h))(i,e,!I,n,!e||yt.test(t)&&u(e.parentNode)||e),n},x.sortStable=M.split("").sort(Q).join("")===M,x.detectDuplicates=!!D,A(),x.sortDetached=o(function(t){return 1&t.compareDocumentPosition(j.createElement("div"))}),o(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||s("type|href|height|width",function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),x.attributes&&o(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||s("value",function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),o(function(t){return null==t.getAttribute("disabled")})||s(et,function(t,e,n){var i;return n?void 0:t[e]===!0?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),e}(t);pt.find=yt,pt.expr=yt.selectors,pt.expr[":"]=pt.expr.pseudos,pt.uniqueSort=pt.unique=yt.uniqueSort,pt.text=yt.getText,pt.isXMLDoc=yt.isXML,pt.contains=yt.contains;var bt=function(t,e,n){for(var i=[],o=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&pt(t).is(n))break;i.push(t)}return i},wt=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},xt=pt.expr.match.needsContext,Ct=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,_t=/^.[^:#\[\.,]*$/;pt.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?pt.find.matchesSelector(i,t)?[i]:[]:pt.find.matches(t,pt.grep(e,function(t){return 1===t.nodeType}))},pt.fn.extend({find:function(t){var e,n=[],i=this,o=i.length;if("string"!=typeof t)return this.pushStack(pt(t).filter(function(){for(e=0;o>e;e++)if(pt.contains(i[e],this))return!0}));for(e=0;o>e;e++)pt.find(t,i[e],n);return n=this.pushStack(o>1?pt.unique(n):n),n.selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(i(this,t||[],!1))},not:function(t){return this.pushStack(i(this,t||[],!0))},is:function(t){return!!i(this,"string"==typeof t&&xt.test(t)?pt(t):t||[],!1).length}});var Tt,Et=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,$t=pt.fn.init=function(t,e,n){var i,o;if(!t)return this;if(n=n||Tt,"string"==typeof t){if(i="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:Et.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof pt?e[0]:e,pt.merge(this,pt.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:it,!0)),Ct.test(i[1])&&pt.isPlainObject(e))for(i in e)pt.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}if(o=it.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2])return Tt.find(t);this.length=1,this[0]=o}return this.context=it,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):pt.isFunction(t)?"undefined"!=typeof n.ready?n.ready(t):t(pt):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),pt.makeArray(t,this))};$t.prototype=pt.fn,Tt=pt(it);var St=/^(?:parents|prev(?:Until|All))/,kt={children:!0,contents:!0,next:!0,prev:!0};pt.fn.extend({has:function(t){var e,n=pt(t,this),i=n.length;return this.filter(function(){for(e=0;i>e;e++)if(pt.contains(this,n[e]))return!0})},closest:function(t,e){for(var n,i=0,o=this.length,s=[],r=xt.test(t)||"string"!=typeof t?pt(t,e||this.context):0;o>i;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(r?r.index(n)>-1:1===n.nodeType&&pt.find.matchesSelector(n,t))){s.push(n);break}return this.pushStack(s.length>1?pt.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?pt.inArray(this[0],pt(t)):pt.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(pt.uniqueSort(pt.merge(this.get(),pt(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),pt.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return bt(t,"parentNode")},parentsUntil:function(t,e,n){return bt(t,"parentNode",n)},next:function(t){return o(t,"nextSibling")},prev:function(t){return o(t,"previousSibling")},nextAll:function(t){return bt(t,"nextSibling")},prevAll:function(t){return bt(t,"previousSibling")},nextUntil:function(t,e,n){return bt(t,"nextSibling",n)},prevUntil:function(t,e,n){return bt(t,"previousSibling",n)},siblings:function(t){return wt((t.parentNode||{}).firstChild,t)},children:function(t){return wt(t.firstChild)},contents:function(t){return pt.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:pt.merge([],t.childNodes)}},function(t,e){pt.fn[t]=function(n,i){var o=pt.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=pt.filter(i,o)),this.length>1&&(kt[t]||(o=pt.uniqueSort(o)),St.test(t)&&(o=o.reverse())),this.pushStack(o)}});var Nt=/\S+/g;pt.Callbacks=function(t){t="string"==typeof t?s(t):pt.extend({},t);var e,n,i,o,r=[],a=[],l=-1,c=function(){for(o=t.once,i=e=!0;a.length;l=-1)for(n=a.shift();++l<r.length;)r[l].apply(n[0],n[1])===!1&&t.stopOnFalse&&(l=r.length,n=!1);t.memory||(n=!1),e=!1,o&&(r=n?[]:"")},u={add:function(){return r&&(n&&!e&&(l=r.length-1,a.push(n)),function i(e){pt.each(e,function(e,n){pt.isFunction(n)?t.unique&&u.has(n)||r.push(n):n&&n.length&&"string"!==pt.type(n)&&i(n)})}(arguments),n&&!e&&c()),this},remove:function(){return pt.each(arguments,function(t,e){for(var n;(n=pt.inArray(e,r,n))>-1;)r.splice(n,1),l>=n&&l--}),this},has:function(t){return t?pt.inArray(t,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return o=a=[],r=n="",this},disabled:function(){return!r},lock:function(){return o=!0,n||u.disable(),this},locked:function(){return!!o},fireWith:function(t,n){return o||(n=n||[],n=[t,n.slice?n.slice():n],a.push(n),e||c()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},pt.extend({Deferred:function(t){var e=[["resolve","done",pt.Callbacks("once memory"),"resolved"],["reject","fail",pt.Callbacks("once memory"),"rejected"],["notify","progress",pt.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var t=arguments;return pt.Deferred(function(n){pt.each(e,function(e,s){var r=pt.isFunction(t[e])&&t[e];o[s[1]](function(){var t=r&&r.apply(this,arguments);t&&pt.isFunction(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[s[0]+"With"](this===i?n.promise():this,r?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?pt.extend(t,i):i}},o={};return i.pipe=i.then,pt.each(e,function(t,s){var r=s[2],a=s[3];i[s[1]]=r.add,a&&r.add(function(){n=a},e[1^t][2].disable,e[2][2].lock),o[s[0]]=function(){return o[s[0]+"With"](this===o?i:this,arguments),this},o[s[0]+"With"]=r.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(t){var e,n,i,o=0,s=ot.call(arguments),r=s.length,a=1!==r||t&&pt.isFunction(t.promise)?r:0,l=1===a?t:pt.Deferred(),c=function(t,n,i){return function(o){n[t]=this,i[t]=arguments.length>1?ot.call(arguments):o,i===e?l.notifyWith(n,i):--a||l.resolveWith(n,i)}};if(r>1)for(e=new Array(r),n=new Array(r),i=new Array(r);r>o;o++)s[o]&&pt.isFunction(s[o].promise)?s[o].promise().progress(c(o,n,e)).done(c(o,i,s)).fail(l.reject):--a;return a||l.resolveWith(i,s),l.promise()}});var Dt;pt.fn.ready=function(t){return pt.ready.promise().done(t),this},pt.extend({isReady:!1,readyWait:1,holdReady:function(t){t?pt.readyWait++:pt.ready(!0)},ready:function(t){(t===!0?--pt.readyWait:pt.isReady)||(pt.isReady=!0,t!==!0&&--pt.readyWait>0||(Dt.resolveWith(it,[pt]),pt.fn.triggerHandler&&(pt(it).triggerHandler("ready"),pt(it).off("ready"))))}}),pt.ready.promise=function(e){if(!Dt)if(Dt=pt.Deferred(),"complete"===it.readyState||"loading"!==it.readyState&&!it.documentElement.doScroll)t.setTimeout(pt.ready);else if(it.addEventListener)it.addEventListener("DOMContentLoaded",a),t.addEventListener("load",a);else{it.attachEvent("onreadystatechange",a),t.attachEvent("onload",a);var n=!1;try{n=null==t.frameElement&&it.documentElement}catch(i){}n&&n.doScroll&&!function o(){if(!pt.isReady){try{n.doScroll("left")}catch(e){return t.setTimeout(o,50)}r(),pt.ready()}}()}return Dt.promise(e)},pt.ready.promise();var At;for(At in pt(ht))break;ht.ownFirst="0"===At,ht.inlineBlockNeedsLayout=!1,pt(function(){var t,e,n,i;n=it.getElementsByTagName("body")[0],n&&n.style&&(e=it.createElement("div"),i=it.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(e),"undefined"!=typeof e.style.zoom&&(e.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",ht.inlineBlockNeedsLayout=t=3===e.offsetWidth,t&&(n.style.zoom=1)),n.removeChild(i))}),function(){var t=it.createElement("div");ht.deleteExpando=!0;try{delete t.test}catch(e){ht.deleteExpando=!1}t=null}();var jt=function(t){var e=pt.noData[(t.nodeName+" ").toLowerCase()],n=+t.nodeType||1;return(1===n||9===n)&&(!e||e!==!0&&t.getAttribute("classid")===e)},Ot=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,It=/([A-Z])/g;pt.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return t=t.nodeType?pt.cache[t[pt.expando]]:t[pt.expando],!!t&&!c(t)},data:function(t,e,n){return u(t,e,n)},removeData:function(t,e){return h(t,e)},_data:function(t,e,n){return u(t,e,n,!0)},_removeData:function(t,e){return h(t,e,!0)}}),pt.fn.extend({data:function(t,e){var n,i,o,s=this[0],r=s&&s.attributes;if(void 0===t){if(this.length&&(o=pt.data(s),1===s.nodeType&&!pt._data(s,"parsedAttrs"))){for(n=r.length;n--;)r[n]&&(i=r[n].name,0===i.indexOf("data-")&&(i=pt.camelCase(i.slice(5)),l(s,i,o[i])));pt._data(s,"parsedAttrs",!0)}return o}return"object"==typeof t?this.each(function(){pt.data(this,t)}):arguments.length>1?this.each(function(){pt.data(this,t,e)}):s?l(s,t,pt.data(s,t)):void 0},removeData:function(t){return this.each(function(){pt.removeData(this,t)})}}),pt.extend({queue:function(t,e,n){var i;return t?(e=(e||"fx")+"queue",i=pt._data(t,e),n&&(!i||pt.isArray(n)?i=pt._data(t,e,pt.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=pt.queue(t,e),i=n.length,o=n.shift(),s=pt._queueHooks(t,e),r=function(){pt.dequeue(t,e)};"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===e&&n.unshift("inprogress"),delete s.stop,o.call(t,r,s)),!i&&s&&s.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return pt._data(t,n)||pt._data(t,n,{empty:pt.Callbacks("once memory").add(function(){pt._removeData(t,e+"queue"),pt._removeData(t,n)})})}}),pt.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?pt.queue(this[0],t):void 0===e?this:this.each(function(){var n=pt.queue(this,t,e);pt._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&pt.dequeue(this,t)})},dequeue:function(t){return this.each(function(){pt.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,o=pt.Deferred(),s=this,r=this.length,a=function(){--i||o.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";r--;)n=pt._data(s[r],t+"queueHooks"),n&&n.empty&&(i++,n.empty.add(a));return a(),o.promise(e)}}),function(){var t;ht.shrinkWrapBlocks=function(){if(null!=t)return t;t=!1;var e,n,i;return n=it.getElementsByTagName("body")[0],n&&n.style?(e=it.createElement("div"),i=it.createElement("div"),i.style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",n.appendChild(i).appendChild(e),"undefined"!=typeof e.style.zoom&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1",e.appendChild(it.createElement("div")).style.width="5px",t=3!==e.offsetWidth),n.removeChild(i),t):void 0}}();var Lt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Rt=new RegExp("^(?:([+-])=|)("+Lt+")([a-z%]*)$","i"),Pt=["Top","Right","Bottom","Left"],Ht=function(t,e){return t=e||t,"none"===pt.css(t,"display")||!pt.contains(t.ownerDocument,t)},Mt=function(t,e,n,i,o,s,r){var a=0,l=t.length,c=null==n;if("object"===pt.type(n)){o=!0;for(a in n)Mt(t,e,a,n[a],!0,s,r)}else if(void 0!==i&&(o=!0,pt.isFunction(i)||(r=!0),c&&(r?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(pt(t),n)})),e))for(;l>a;a++)e(t[a],n,r?i:i.call(t[a],a,e(t[a],n)));return o?t:c?e.call(t):l?e(t[0],n):s},zt=/^(?:checkbox|radio)$/i,qt=/<([\w:-]+)/,Ft=/^$|\/(?:java|ecma)script/i,Wt=/^\s+/,Bt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";!function(){var t=it.createElement("div"),e=it.createDocumentFragment(),n=it.createElement("input");t.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",ht.leadingWhitespace=3===t.firstChild.nodeType,ht.tbody=!t.getElementsByTagName("tbody").length,ht.htmlSerialize=!!t.getElementsByTagName("link").length,ht.html5Clone="<:nav></:nav>"!==it.createElement("nav").cloneNode(!0).outerHTML,n.type="checkbox",n.checked=!0,e.appendChild(n),ht.appendChecked=n.checked,t.innerHTML="<textarea>x</textarea>",ht.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),n=it.createElement("input"),n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),ht.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,ht.noCloneEvent=!!t.addEventListener,t[pt.expando]=1,ht.attributes=!t.getAttribute(pt.expando)}();var Ut={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ht.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};Ut.optgroup=Ut.option,Ut.tbody=Ut.tfoot=Ut.colgroup=Ut.caption=Ut.thead,Ut.th=Ut.td;var Qt=/<|&#?\w+;/,Vt=/<tbody/i;!function(){var e,n,i=it.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})n="on"+e,(ht[e]=n in t)||(i.setAttribute(n,"t"),ht[e]=i.attributes[n].expando===!1);i=null}();var Xt=/^(?:input|select|textarea)$/i,Yt=/^key/,Zt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Gt=/^(?:focusinfocus|focusoutblur)$/,Jt=/^([^.]*)(?:\.(.+)|)/;pt.event={global:{},add:function(t,e,n,i,o){var s,r,a,l,c,u,h,d,p,f,g,m=pt._data(t);if(m){for(n.handler&&(l=n,n=l.handler,o=l.selector),n.guid||(n.guid=pt.guid++),(r=m.events)||(r=m.events={}),(u=m.handle)||(u=m.handle=function(t){return"undefined"==typeof pt||t&&pt.event.triggered===t.type?void 0:pt.event.dispatch.apply(u.elem,arguments)},u.elem=t),e=(e||"").match(Nt)||[""],a=e.length;a--;)s=Jt.exec(e[a])||[],p=g=s[1],f=(s[2]||"").split(".").sort(),p&&(c=pt.event.special[p]||{},p=(o?c.delegateType:c.bindType)||p,c=pt.event.special[p]||{},h=pt.extend({type:p,origType:g,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&pt.expr.match.needsContext.test(o),namespace:f.join(".")},l),(d=r[p])||(d=r[p]=[],d.delegateCount=0,c.setup&&c.setup.call(t,i,f,u)!==!1||(t.addEventListener?t.addEventListener(p,u,!1):t.attachEvent&&t.attachEvent("on"+p,u))),c.add&&(c.add.call(t,h),h.handler.guid||(h.handler.guid=n.guid)),o?d.splice(d.delegateCount++,0,h):d.push(h),pt.event.global[p]=!0);t=null}},remove:function(t,e,n,i,o){var s,r,a,l,c,u,h,d,p,f,g,m=pt.hasData(t)&&pt._data(t);if(m&&(u=m.events)){for(e=(e||"").match(Nt)||[""],c=e.length;c--;)if(a=Jt.exec(e[c])||[],p=g=a[1],f=(a[2]||"").split(".").sort(),p){for(h=pt.event.special[p]||{},p=(i?h.delegateType:h.bindType)||p,d=u[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=s=d.length;s--;)r=d[s],!o&&g!==r.origType||n&&n.guid!==r.guid||a&&!a.test(r.namespace)||i&&i!==r.selector&&("**"!==i||!r.selector)||(d.splice(s,1),r.selector&&d.delegateCount--,h.remove&&h.remove.call(t,r));l&&!d.length&&(h.teardown&&h.teardown.call(t,f,m.handle)!==!1||pt.removeEvent(t,p,m.handle),delete u[p])}else for(p in u)pt.event.remove(t,p+e[c],n,i,!0);pt.isEmptyObject(u)&&(delete m.handle,pt._removeData(t,"events"))}},trigger:function(e,n,i,o){var s,r,a,l,c,u,h,d=[i||it],p=ut.call(e,"type")?e.type:e,f=ut.call(e,"namespace")?e.namespace.split("."):[];if(a=u=i=i||it,3!==i.nodeType&&8!==i.nodeType&&!Gt.test(p+pt.event.triggered)&&(p.indexOf(".")>-1&&(f=p.split("."),p=f.shift(),f.sort()),r=p.indexOf(":")<0&&"on"+p,e=e[pt.expando]?e:new pt.Event(p,"object"==typeof e&&e),e.isTrigger=o?2:3,e.namespace=f.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:pt.makeArray(n,[e]),c=pt.event.special[p]||{},o||!c.trigger||c.trigger.apply(i,n)!==!1)){if(!o&&!c.noBubble&&!pt.isWindow(i)){for(l=c.delegateType||p,Gt.test(l+p)||(a=a.parentNode);a;a=a.parentNode)d.push(a),u=a;u===(i.ownerDocument||it)&&d.push(u.defaultView||u.parentWindow||t)}for(h=0;(a=d[h++])&&!e.isPropagationStopped();)e.type=h>1?l:c.bindType||p,s=(pt._data(a,"events")||{})[e.type]&&pt._data(a,"handle"),s&&s.apply(a,n),s=r&&a[r],s&&s.apply&&jt(a)&&(e.result=s.apply(a,n),e.result===!1&&e.preventDefault());if(e.type=p,!o&&!e.isDefaultPrevented()&&(!c._default||c._default.apply(d.pop(),n)===!1)&&jt(i)&&r&&i[p]&&!pt.isWindow(i)){u=i[r],u&&(i[r]=null),pt.event.triggered=p;try{i[p]()}catch(g){}pt.event.triggered=void 0,u&&(i[r]=u)}return e.result}},dispatch:function(t){t=pt.event.fix(t);var e,n,i,o,s,r=[],a=ot.call(arguments),l=(pt._data(this,"events")||{})[t.type]||[],c=pt.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,t)!==!1){for(r=pt.event.handlers.call(this,t,l),e=0;(o=r[e++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,n=0;(s=o.handlers[n++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(s.namespace)||(t.handleObj=s,t.data=s.data,i=((pt.event.special[s.origType]||{}).handle||s.handler).apply(o.elem,a),void 0!==i&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,i,o,s,r=[],a=e.delegateCount,l=t.target;if(a&&l.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(l.disabled!==!0||"click"!==t.type)){for(i=[],n=0;a>n;n++)s=e[n],o=s.selector+" ",void 0===i[o]&&(i[o]=s.needsContext?pt(o,this).index(l)>-1:pt.find(o,this,null,[l]).length),i[o]&&i.push(s);i.length&&r.push({elem:l,handlers:i})}return a<e.length&&r.push({elem:this,handlers:e.slice(a)}),r},fix:function(t){if(t[pt.expando])return t;var e,n,i,o=t.type,s=t,r=this.fixHooks[o];for(r||(this.fixHooks[o]=r=Zt.test(o)?this.mouseHooks:Yt.test(o)?this.keyHooks:{}),i=r.props?this.props.concat(r.props):this.props,t=new pt.Event(s),e=i.length;e--;)n=i[e],t[n]=s[n];return t.target||(t.target=s.srcElement||it),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,r.filter?r.filter(t,s):t},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,o,s=e.button,r=e.fromElement;return null==t.pageX&&null!=e.clientX&&(i=t.target.ownerDocument||it,o=i.documentElement,n=i.body,t.pageX=e.clientX+(o&&o.scrollLeft||n&&n.scrollLeft||0)-(o&&o.clientLeft||n&&n.clientLeft||0),t.pageY=e.clientY+(o&&o.scrollTop||n&&n.scrollTop||0)-(o&&o.clientTop||n&&n.clientTop||0)),!t.relatedTarget&&r&&(t.relatedTarget=r===t.target?e.toElement:r),t.which||void 0===s||(t.which=1&s?1:2&s?3:4&s?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==w()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===w()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return pt.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return pt.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n){var i=pt.extend(new pt.Event,n,{type:t,isSimulated:!0});pt.event.trigger(i,null,e),i.isDefaultPrevented()&&n.preventDefault()}},pt.removeEvent=it.removeEventListener?function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)}:function(t,e,n){var i="on"+e;t.detachEvent&&("undefined"==typeof t[i]&&(t[i]=null),t.detachEvent(i,n))},pt.Event=function(t,e){return this instanceof pt.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?y:b):this.type=t,e&&pt.extend(this,e),this.timeStamp=t&&t.timeStamp||pt.now(),void(this[pt.expando]=!0)):new pt.Event(t,e)},pt.Event.prototype={constructor:pt.Event,isDefaultPrevented:b,isPropagationStopped:b,isImmediatePropagationStopped:b,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=y,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=y,t&&!this.isSimulated&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=y,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},pt.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){pt.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,o=t.relatedTarget,s=t.handleObj;return o&&(o===i||pt.contains(i,o))||(t.type=s.origType,n=s.handler.apply(this,arguments),t.type=e),n}}}),ht.submit||(pt.event.special.submit={setup:function(){return!pt.nodeName(this,"form")&&void pt.event.add(this,"click._submit keypress._submit",function(t){var e=t.target,n=pt.nodeName(e,"input")||pt.nodeName(e,"button")?pt.prop(e,"form"):void 0;n&&!pt._data(n,"submit")&&(pt.event.add(n,"submit._submit",function(t){t._submitBubble=!0}),pt._data(n,"submit",!0))})},postDispatch:function(t){t._submitBubble&&(delete t._submitBubble,this.parentNode&&!t.isTrigger&&pt.event.simulate("submit",this.parentNode,t))},teardown:function(){return!pt.nodeName(this,"form")&&void pt.event.remove(this,"._submit")}}),ht.change||(pt.event.special.change={setup:function(){return Xt.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(pt.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._justChanged=!0)}),pt.event.add(this,"click._change",function(t){this._justChanged&&!t.isTrigger&&(this._justChanged=!1),pt.event.simulate("change",this,t)})),!1):void pt.event.add(this,"beforeactivate._change",function(t){var e=t.target;Xt.test(e.nodeName)&&!pt._data(e,"change")&&(pt.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||pt.event.simulate("change",this.parentNode,t)}),pt._data(e,"change",!0))})},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return pt.event.remove(this,"._change"),!Xt.test(this.nodeName)}}),ht.focusin||pt.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){pt.event.simulate(e,t.target,pt.event.fix(t))};pt.event.special[e]={setup:function(){var i=this.ownerDocument||this,o=pt._data(i,e);o||i.addEventListener(t,n,!0),pt._data(i,e,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this,o=pt._data(i,e)-1;o?pt._data(i,e,o):(i.removeEventListener(t,n,!0),pt._removeData(i,e))}}}),pt.fn.extend({on:function(t,e,n,i){return x(this,t,e,n,i)},one:function(t,e,n,i){return x(this,t,e,n,i,1)},off:function(t,e,n){var i,o;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,pt(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return e!==!1&&"function"!=typeof e||(n=e,e=void 0),n===!1&&(n=b),this.each(function(){pt.event.remove(this,t,n,e)})},trigger:function(t,e){return this.each(function(){pt.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];return n?pt.event.trigger(t,e,n,!0):void 0}});var Kt=/ jQuery\d+="(?:null|\d+)"/g,te=new RegExp("<(?:"+Bt+")[\\s/>]","i"),ee=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,ne=/<script|<style|<link/i,ie=/checked\s*(?:[^=]|=\s*.checked.)/i,oe=/^true\/(.*)/,se=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,re=p(it),ae=re.appendChild(it.createElement("div"));pt.extend({htmlPrefilter:function(t){return t.replace(ee,"<$1></$2>")},clone:function(t,e,n){var i,o,s,r,a,l=pt.contains(t.ownerDocument,t);if(ht.html5Clone||pt.isXMLDoc(t)||!te.test("<"+t.nodeName+">")?s=t.cloneNode(!0):(ae.innerHTML=t.outerHTML,ae.removeChild(s=ae.firstChild)),!(ht.noCloneEvent&&ht.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||pt.isXMLDoc(t)))for(i=f(s),a=f(t),r=0;null!=(o=a[r]);++r)i[r]&&$(o,i[r]);if(e)if(n)for(a=a||f(t),i=i||f(s),r=0;null!=(o=a[r]);r++)E(o,i[r]);else E(t,s);return i=f(s,"script"),i.length>0&&g(i,!l&&f(t,"script")),i=a=o=null,s},cleanData:function(t,e){for(var n,i,o,s,r=0,a=pt.expando,l=pt.cache,c=ht.attributes,u=pt.event.special;null!=(n=t[r]);r++)if((e||jt(n))&&(o=n[a],s=o&&l[o])){if(s.events)for(i in s.events)u[i]?pt.event.remove(n,i):pt.removeEvent(n,i,s.handle);l[o]&&(delete l[o],c||"undefined"==typeof n.removeAttribute?n[a]=void 0:n.removeAttribute(a),nt.push(o))}}}),pt.fn.extend({domManip:S,detach:function(t){return k(this,t,!0)},remove:function(t){return k(this,t)},text:function(t){return Mt(this,function(t){return void 0===t?pt.text(this):this.empty().append((this[0]&&this[0].ownerDocument||it).createTextNode(t))},null,t,arguments.length)},append:function(){return S(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=C(this,t);e.appendChild(t)}})},prepend:function(){return S(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=C(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return S(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return S(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&pt.cleanData(f(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&pt.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return pt.clone(this,t,e)})},html:function(t){return Mt(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t)return 1===e.nodeType?e.innerHTML.replace(Kt,""):void 0;if("string"==typeof t&&!ne.test(t)&&(ht.htmlSerialize||!te.test(t))&&(ht.leadingWhitespace||!Wt.test(t))&&!Ut[(qt.exec(t)||["",""])[1].toLowerCase()]){t=pt.htmlPrefilter(t);try{for(;i>n;n++)e=this[n]||{},1===e.nodeType&&(pt.cleanData(f(e,!1)),e.innerHTML=t);e=0}catch(o){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return S(this,arguments,function(e){var n=this.parentNode;pt.inArray(this,t)<0&&(pt.cleanData(f(this)),
n&&n.replaceChild(e,this))},t)}}),pt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){pt.fn[t]=function(t){for(var n,i=0,o=[],s=pt(t),r=s.length-1;r>=i;i++)n=i===r?this:this.clone(!0),pt(s[i])[e](n),rt.apply(o,n.get());return this.pushStack(o)}});var le,ce={HTML:"block",BODY:"block"},ue=/^margin/,he=new RegExp("^("+Lt+")(?!px)[a-z%]+$","i"),de=function(t,e,n,i){var o,s,r={};for(s in e)r[s]=t.style[s],t.style[s]=e[s];o=n.apply(t,i||[]);for(s in e)t.style[s]=r[s];return o},pe=it.documentElement;!function(){function e(){var e,u,h=it.documentElement;h.appendChild(l),c.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",n=o=a=!1,i=r=!0,t.getComputedStyle&&(u=t.getComputedStyle(c),n="1%"!==(u||{}).top,a="2px"===(u||{}).marginLeft,o="4px"===(u||{width:"4px"}).width,c.style.marginRight="50%",i="4px"===(u||{marginRight:"4px"}).marginRight,e=c.appendChild(it.createElement("div")),e.style.cssText=c.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",c.style.width="1px",r=!parseFloat((t.getComputedStyle(e)||{}).marginRight),c.removeChild(e)),c.style.display="none",s=0===c.getClientRects().length,s&&(c.style.display="",c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",c.childNodes[0].style.borderCollapse="separate",e=c.getElementsByTagName("td"),e[0].style.cssText="margin:0;border:0;padding:0;display:none",s=0===e[0].offsetHeight,s&&(e[0].style.display="",e[1].style.display="none",s=0===e[0].offsetHeight)),h.removeChild(l)}var n,i,o,s,r,a,l=it.createElement("div"),c=it.createElement("div");c.style&&(c.style.cssText="float:left;opacity:.5",ht.opacity="0.5"===c.style.opacity,ht.cssFloat=!!c.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",ht.clearCloneStyle="content-box"===c.style.backgroundClip,l=it.createElement("div"),l.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",c.innerHTML="",l.appendChild(c),ht.boxSizing=""===c.style.boxSizing||""===c.style.MozBoxSizing||""===c.style.WebkitBoxSizing,pt.extend(ht,{reliableHiddenOffsets:function(){return null==n&&e(),s},boxSizingReliable:function(){return null==n&&e(),o},pixelMarginRight:function(){return null==n&&e(),i},pixelPosition:function(){return null==n&&e(),n},reliableMarginRight:function(){return null==n&&e(),r},reliableMarginLeft:function(){return null==n&&e(),a}}))}();var fe,ge,me=/^(top|right|bottom|left)$/;t.getComputedStyle?(fe=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},ge=function(t,e,n){var i,o,s,r,a=t.style;return n=n||fe(t),r=n?n.getPropertyValue(e)||n[e]:void 0,""!==r&&void 0!==r||pt.contains(t.ownerDocument,t)||(r=pt.style(t,e)),n&&!ht.pixelMarginRight()&&he.test(r)&&ue.test(e)&&(i=a.width,o=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=n.width,a.width=i,a.minWidth=o,a.maxWidth=s),void 0===r?r:r+""}):pe.currentStyle&&(fe=function(t){return t.currentStyle},ge=function(t,e,n){var i,o,s,r,a=t.style;return n=n||fe(t),r=n?n[e]:void 0,null==r&&a&&a[e]&&(r=a[e]),he.test(r)&&!me.test(e)&&(i=a.left,o=t.runtimeStyle,s=o&&o.left,s&&(o.left=t.currentStyle.left),a.left="fontSize"===e?"1em":r,r=a.pixelLeft+"px",a.left=i,s&&(o.left=s)),void 0===r?r:r+""||"auto"});var ve=/alpha\([^)]*\)/i,ye=/opacity\s*=\s*([^)]*)/i,be=/^(none|table(?!-c[ea]).+)/,we=new RegExp("^("+Lt+")(.*)$","i"),xe={position:"absolute",visibility:"hidden",display:"block"},Ce={letterSpacing:"0",fontWeight:"400"},_e=["Webkit","O","Moz","ms"],Te=it.createElement("div").style;pt.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=ge(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ht.cssFloat?"cssFloat":"styleFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,s,r,a=pt.camelCase(e),l=t.style;if(e=pt.cssProps[a]||(pt.cssProps[a]=j(a)||a),r=pt.cssHooks[e]||pt.cssHooks[a],void 0===n)return r&&"get"in r&&void 0!==(o=r.get(t,!1,i))?o:l[e];if(s=typeof n,"string"===s&&(o=Rt.exec(n))&&o[1]&&(n=d(t,e,o),s="number"),null!=n&&n===n&&("number"===s&&(n+=o&&o[3]||(pt.cssNumber[a]?"":"px")),ht.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),!(r&&"set"in r&&void 0===(n=r.set(t,n,i)))))try{l[e]=n}catch(c){}}},css:function(t,e,n,i){var o,s,r,a=pt.camelCase(e);return e=pt.cssProps[a]||(pt.cssProps[a]=j(a)||a),r=pt.cssHooks[e]||pt.cssHooks[a],r&&"get"in r&&(s=r.get(t,!0,n)),void 0===s&&(s=ge(t,e,i)),"normal"===s&&e in Ce&&(s=Ce[e]),""===n||n?(o=parseFloat(s),n===!0||isFinite(o)?o||0:s):s}}),pt.each(["height","width"],function(t,e){pt.cssHooks[e]={get:function(t,n,i){return n?be.test(pt.css(t,"display"))&&0===t.offsetWidth?de(t,xe,function(){return R(t,e,i)}):R(t,e,i):void 0},set:function(t,n,i){var o=i&&fe(t);return I(t,n,i?L(t,e,i,ht.boxSizing&&"border-box"===pt.css(t,"boxSizing",!1,o),o):0)}}}),ht.opacity||(pt.cssHooks.opacity={get:function(t,e){return ye.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var n=t.style,i=t.currentStyle,o=pt.isNumeric(e)?"alpha(opacity="+100*e+")":"",s=i&&i.filter||n.filter||"";n.zoom=1,(e>=1||""===e)&&""===pt.trim(s.replace(ve,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===e||i&&!i.filter)||(n.filter=ve.test(s)?s.replace(ve,o):s+" "+o)}}),pt.cssHooks.marginRight=A(ht.reliableMarginRight,function(t,e){return e?de(t,{display:"inline-block"},ge,[t,"marginRight"]):void 0}),pt.cssHooks.marginLeft=A(ht.reliableMarginLeft,function(t,e){return e?(parseFloat(ge(t,"marginLeft"))||(pt.contains(t.ownerDocument,t)?t.getBoundingClientRect().left-de(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}):0))+"px":void 0}),pt.each({margin:"",padding:"",border:"Width"},function(t,e){pt.cssHooks[t+e]={expand:function(n){for(var i=0,o={},s="string"==typeof n?n.split(" "):[n];4>i;i++)o[t+Pt[i]+e]=s[i]||s[i-2]||s[0];return o}},ue.test(t)||(pt.cssHooks[t+e].set=I)}),pt.fn.extend({css:function(t,e){return Mt(this,function(t,e,n){var i,o,s={},r=0;if(pt.isArray(e)){for(i=fe(t),o=e.length;o>r;r++)s[e[r]]=pt.css(t,e[r],!1,i);return s}return void 0!==n?pt.style(t,e,n):pt.css(t,e)},t,e,arguments.length>1)},show:function(){return O(this,!0)},hide:function(){return O(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Ht(this)?pt(this).show():pt(this).hide()})}}),pt.Tween=P,P.prototype={constructor:P,init:function(t,e,n,i,o,s){this.elem=t,this.prop=n,this.easing=o||pt.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=s||(pt.cssNumber[n]?"":"px")},cur:function(){var t=P.propHooks[this.prop];return t&&t.get?t.get(this):P.propHooks._default.get(this)},run:function(t){var e,n=P.propHooks[this.prop];return this.options.duration?this.pos=e=pt.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):P.propHooks._default.set(this),this}},P.prototype.init.prototype=P.prototype,P.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=pt.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){pt.fx.step[t.prop]?pt.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[pt.cssProps[t.prop]]&&!pt.cssHooks[t.prop]?t.elem[t.prop]=t.now:pt.style(t.elem,t.prop,t.now+t.unit)}}},P.propHooks.scrollTop=P.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},pt.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},pt.fx=P.prototype.init,pt.fx.step={};var Ee,$e,Se=/^(?:toggle|show|hide)$/,ke=/queueHooks$/;pt.Animation=pt.extend(W,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return d(n.elem,t,Rt.exec(e),n),n}]},tweener:function(t,e){pt.isFunction(t)?(e=t,t=["*"]):t=t.match(Nt);for(var n,i=0,o=t.length;o>i;i++)n=t[i],W.tweeners[n]=W.tweeners[n]||[],W.tweeners[n].unshift(e)},prefilters:[q],prefilter:function(t,e){e?W.prefilters.unshift(t):W.prefilters.push(t)}}),pt.speed=function(t,e,n){var i=t&&"object"==typeof t?pt.extend({},t):{complete:n||!n&&e||pt.isFunction(t)&&t,duration:t,easing:n&&e||e&&!pt.isFunction(e)&&e};return i.duration=pt.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in pt.fx.speeds?pt.fx.speeds[i.duration]:pt.fx.speeds._default,null!=i.queue&&i.queue!==!0||(i.queue="fx"),i.old=i.complete,i.complete=function(){pt.isFunction(i.old)&&i.old.call(this),i.queue&&pt.dequeue(this,i.queue)},i},pt.fn.extend({fadeTo:function(t,e,n,i){return this.filter(Ht).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var o=pt.isEmptyObject(t),s=pt.speed(e,n,i),r=function(){var e=W(this,pt.extend({},t),s);(o||pt._data(this,"finish"))&&e.stop(!0)};return r.finish=r,o||s.queue===!1?this.each(r):this.queue(s.queue,r)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,o=null!=t&&t+"queueHooks",s=pt.timers,r=pt._data(this);if(o)r[o]&&r[o].stop&&i(r[o]);else for(o in r)r[o]&&r[o].stop&&ke.test(o)&&i(r[o]);for(o=s.length;o--;)s[o].elem!==this||null!=t&&s[o].queue!==t||(s[o].anim.stop(n),e=!1,s.splice(o,1));!e&&n||pt.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=pt._data(this),i=n[t+"queue"],o=n[t+"queueHooks"],s=pt.timers,r=i?i.length:0;for(n.finish=!0,pt.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;r>e;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),pt.each(["toggle","show","hide"],function(t,e){var n=pt.fn[e];pt.fn[e]=function(t,i,o){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(M(e,!0),t,i,o)}}),pt.each({slideDown:M("show"),slideUp:M("hide"),slideToggle:M("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){pt.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),pt.timers=[],pt.fx.tick=function(){var t,e=pt.timers,n=0;for(Ee=pt.now();n<e.length;n++)t=e[n],t()||e[n]!==t||e.splice(n--,1);e.length||pt.fx.stop(),Ee=void 0},pt.fx.timer=function(t){pt.timers.push(t),t()?pt.fx.start():pt.timers.pop()},pt.fx.interval=13,pt.fx.start=function(){$e||($e=t.setInterval(pt.fx.tick,pt.fx.interval))},pt.fx.stop=function(){t.clearInterval($e),$e=null},pt.fx.speeds={slow:600,fast:200,_default:400},pt.fn.delay=function(e,n){return e=pt.fx?pt.fx.speeds[e]||e:e,n=n||"fx",this.queue(n,function(n,i){var o=t.setTimeout(n,e);i.stop=function(){t.clearTimeout(o)}})},function(){var t,e=it.createElement("input"),n=it.createElement("div"),i=it.createElement("select"),o=i.appendChild(it.createElement("option"));n=it.createElement("div"),n.setAttribute("className","t"),n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",t=n.getElementsByTagName("a")[0],e.setAttribute("type","checkbox"),n.appendChild(e),t=n.getElementsByTagName("a")[0],t.style.cssText="top:1px",ht.getSetAttribute="t"!==n.className,ht.style=/top/.test(t.getAttribute("style")),ht.hrefNormalized="/a"===t.getAttribute("href"),ht.checkOn=!!e.value,ht.optSelected=o.selected,ht.enctype=!!it.createElement("form").enctype,i.disabled=!0,ht.optDisabled=!o.disabled,e=it.createElement("input"),e.setAttribute("value",""),ht.input=""===e.getAttribute("value"),e.value="t",e.setAttribute("type","radio"),ht.radioValue="t"===e.value}();var Ne=/\r/g,De=/[\x20\t\r\n\f]+/g;pt.fn.extend({val:function(t){var e,n,i,o=this[0];return arguments.length?(i=pt.isFunction(t),this.each(function(n){var o;1===this.nodeType&&(o=i?t.call(this,n,pt(this).val()):t,null==o?o="":"number"==typeof o?o+="":pt.isArray(o)&&(o=pt.map(o,function(t){return null==t?"":t+""})),e=pt.valHooks[this.type]||pt.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))})):o?(e=pt.valHooks[o.type]||pt.valHooks[o.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(n=e.get(o,"value"))?n:(n=o.value,"string"==typeof n?n.replace(Ne,""):null==n?"":n)):void 0}}),pt.extend({valHooks:{option:{get:function(t){var e=pt.find.attr(t,"value");return null!=e?e:pt.trim(pt.text(t)).replace(De," ")}},select:{get:function(t){for(var e,n,i=t.options,o=t.selectedIndex,s="select-one"===t.type||0>o,r=s?null:[],a=s?o+1:i.length,l=0>o?a:s?o:0;a>l;l++)if(n=i[l],(n.selected||l===o)&&(ht.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!pt.nodeName(n.parentNode,"optgroup"))){if(e=pt(n).val(),s)return e;r.push(e)}return r},set:function(t,e){for(var n,i,o=t.options,s=pt.makeArray(e),r=o.length;r--;)if(i=o[r],pt.inArray(pt.valHooks.option.get(i),s)>-1)try{i.selected=n=!0}catch(a){i.scrollHeight}else i.selected=!1;return n||(t.selectedIndex=-1),o}}}}),pt.each(["radio","checkbox"],function(){pt.valHooks[this]={set:function(t,e){return pt.isArray(e)?t.checked=pt.inArray(pt(t).val(),e)>-1:void 0}},ht.checkOn||(pt.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Ae,je,Oe=pt.expr.attrHandle,Ie=/^(?:checked|selected)$/i,Le=ht.getSetAttribute,Re=ht.input;pt.fn.extend({attr:function(t,e){return Mt(this,pt.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){pt.removeAttr(this,t)})}}),pt.extend({attr:function(t,e,n){var i,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return"undefined"==typeof t.getAttribute?pt.prop(t,e,n):(1===s&&pt.isXMLDoc(t)||(e=e.toLowerCase(),o=pt.attrHooks[e]||(pt.expr.match.bool.test(e)?je:Ae)),void 0!==n?null===n?void pt.removeAttr(t,e):o&&"set"in o&&void 0!==(i=o.set(t,n,e))?i:(t.setAttribute(e,n+""),n):o&&"get"in o&&null!==(i=o.get(t,e))?i:(i=pt.find.attr(t,e),null==i?void 0:i))},attrHooks:{type:{set:function(t,e){if(!ht.radioValue&&"radio"===e&&pt.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i,o=0,s=e&&e.match(Nt);if(s&&1===t.nodeType)for(;n=s[o++];)i=pt.propFix[n]||n,pt.expr.match.bool.test(n)?Re&&Le||!Ie.test(n)?t[i]=!1:t[pt.camelCase("default-"+n)]=t[i]=!1:pt.attr(t,n,""),t.removeAttribute(Le?n:i)}}),je={set:function(t,e,n){return e===!1?pt.removeAttr(t,n):Re&&Le||!Ie.test(n)?t.setAttribute(!Le&&pt.propFix[n]||n,n):t[pt.camelCase("default-"+n)]=t[n]=!0,n}},pt.each(pt.expr.match.bool.source.match(/\w+/g),function(t,e){var n=Oe[e]||pt.find.attr;Re&&Le||!Ie.test(e)?Oe[e]=function(t,e,i){var o,s;return i||(s=Oe[e],Oe[e]=o,o=null!=n(t,e,i)?e.toLowerCase():null,Oe[e]=s),o}:Oe[e]=function(t,e,n){return n?void 0:t[pt.camelCase("default-"+e)]?e.toLowerCase():null}}),Re&&Le||(pt.attrHooks.value={set:function(t,e,n){return pt.nodeName(t,"input")?void(t.defaultValue=e):Ae&&Ae.set(t,e,n)}}),Le||(Ae={set:function(t,e,n){var i=t.getAttributeNode(n);return i||t.setAttributeNode(i=t.ownerDocument.createAttribute(n)),i.value=e+="","value"===n||e===t.getAttribute(n)?e:void 0}},Oe.id=Oe.name=Oe.coords=function(t,e,n){var i;return n?void 0:(i=t.getAttributeNode(e))&&""!==i.value?i.value:null},pt.valHooks.button={get:function(t,e){var n=t.getAttributeNode(e);return n&&n.specified?n.value:void 0},set:Ae.set},pt.attrHooks.contenteditable={set:function(t,e,n){Ae.set(t,""!==e&&e,n)}},pt.each(["width","height"],function(t,e){pt.attrHooks[e]={set:function(t,n){return""===n?(t.setAttribute(e,"auto"),n):void 0}}})),ht.style||(pt.attrHooks.style={get:function(t){return t.style.cssText||void 0},set:function(t,e){return t.style.cssText=e+""}});var Pe=/^(?:input|select|textarea|button|object)$/i,He=/^(?:a|area)$/i;pt.fn.extend({prop:function(t,e){return Mt(this,pt.prop,t,e,arguments.length>1)},removeProp:function(t){return t=pt.propFix[t]||t,this.each(function(){try{this[t]=void 0,delete this[t]}catch(e){}})}}),pt.extend({prop:function(t,e,n){var i,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&pt.isXMLDoc(t)||(e=pt.propFix[e]||e,o=pt.propHooks[e]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(t,n,e))?i:t[e]=n:o&&"get"in o&&null!==(i=o.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=pt.find.attr(t,"tabindex");return e?parseInt(e,10):Pe.test(t.nodeName)||He.test(t.nodeName)&&t.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),ht.hrefNormalized||pt.each(["href","src"],function(t,e){pt.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),ht.optSelected||(pt.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),pt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){pt.propFix[this.toLowerCase()]=this}),ht.enctype||(pt.propFix.enctype="encoding");var Me=/[\t\r\n\f]/g;pt.fn.extend({addClass:function(t){var e,n,i,o,s,r,a,l=0;if(pt.isFunction(t))return this.each(function(e){pt(this).addClass(t.call(this,e,B(this)))});if("string"==typeof t&&t)for(e=t.match(Nt)||[];n=this[l++];)if(o=B(n),i=1===n.nodeType&&(" "+o+" ").replace(Me," ")){for(r=0;s=e[r++];)i.indexOf(" "+s+" ")<0&&(i+=s+" ");a=pt.trim(i),o!==a&&pt.attr(n,"class",a)}return this},removeClass:function(t){var e,n,i,o,s,r,a,l=0;if(pt.isFunction(t))return this.each(function(e){pt(this).removeClass(t.call(this,e,B(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(Nt)||[];n=this[l++];)if(o=B(n),i=1===n.nodeType&&(" "+o+" ").replace(Me," ")){for(r=0;s=e[r++];)for(;i.indexOf(" "+s+" ")>-1;)i=i.replace(" "+s+" "," ");a=pt.trim(i),o!==a&&pt.attr(n,"class",a)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):pt.isFunction(t)?this.each(function(n){pt(this).toggleClass(t.call(this,n,B(this),e),e)}):this.each(function(){var e,i,o,s;if("string"===n)for(i=0,o=pt(this),s=t.match(Nt)||[];e=s[i++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==n||(e=B(this),e&&pt._data(this,"__className__",e),pt.attr(this,"class",e||t===!1?"":pt._data(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+B(n)+" ").replace(Me," ").indexOf(e)>-1)return!0;return!1}}),pt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){pt.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),pt.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}});var ze=t.location,qe=pt.now(),Fe=/\?/,We=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;pt.parseJSON=function(e){if(t.JSON&&t.JSON.parse)return t.JSON.parse(e+"");var n,i=null,o=pt.trim(e+"");return o&&!pt.trim(o.replace(We,function(t,e,o,s){return n&&e&&(i=0),0===i?t:(n=o||e,i+=!s-!o,"")}))?Function("return "+o)():pt.error("Invalid JSON: "+e)},pt.parseXML=function(e){var n,i;if(!e||"string"!=typeof e)return null;try{t.DOMParser?(i=new t.DOMParser,n=i.parseFromString(e,"text/xml")):(n=new t.ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(e))}catch(o){n=void 0}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||pt.error("Invalid XML: "+e),n};var Be=/#.*$/,Ue=/([?&])_=[^&]*/,Qe=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ve=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Xe=/^(?:GET|HEAD)$/,Ye=/^\/\//,Ze=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Ge={},Je={},Ke="*/".concat("*"),tn=ze.href,en=Ze.exec(tn.toLowerCase())||[];pt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:tn,type:"GET",isLocal:Ve.test(en[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ke,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":pt.parseJSON,"text xml":pt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?V(V(t,pt.ajaxSettings),e):V(pt.ajaxSettings,t)},ajaxPrefilter:U(Ge),ajaxTransport:U(Je),ajax:function(e,n){function i(e,n,i,o){var s,h,y,b,x,_=n;2!==w&&(w=2,l&&t.clearTimeout(l),u=void 0,a=o||"",C.readyState=e>0?4:0,s=e>=200&&300>e||304===e,i&&(b=X(d,C,i)),b=Y(d,b,C,s),s?(d.ifModified&&(x=C.getResponseHeader("Last-Modified"),x&&(pt.lastModified[r]=x),x=C.getResponseHeader("etag"),x&&(pt.etag[r]=x)),204===e||"HEAD"===d.type?_="nocontent":304===e?_="notmodified":(_=b.state,h=b.data,y=b.error,s=!y)):(y=_,!e&&_||(_="error",0>e&&(e=0))),C.status=e,C.statusText=(n||_)+"",s?g.resolveWith(p,[h,_,C]):g.rejectWith(p,[C,_,y]),C.statusCode(v),v=void 0,c&&f.trigger(s?"ajaxSuccess":"ajaxError",[C,d,s?h:y]),m.fireWith(p,[C,_]),c&&(f.trigger("ajaxComplete",[C,d]),--pt.active||pt.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=void 0),n=n||{};var o,s,r,a,l,c,u,h,d=pt.ajaxSetup({},n),p=d.context||d,f=d.context&&(p.nodeType||p.jquery)?pt(p):pt.event,g=pt.Deferred(),m=pt.Callbacks("once memory"),v=d.statusCode||{},y={},b={},w=0,x="canceled",C={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!h)for(h={};e=Qe.exec(a);)h[e[1].toLowerCase()]=e[2];e=h[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?a:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return w||(t=b[n]=b[n]||t,y[t]=e),this},overrideMimeType:function(t){return w||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>w)for(e in t)v[e]=[v[e],t[e]];else C.always(t[C.status]);return this},abort:function(t){var e=t||x;return u&&u.abort(e),i(0,e),this}};if(g.promise(C).complete=m.add,C.success=C.done,C.error=C.fail,d.url=((e||d.url||tn)+"").replace(Be,"").replace(Ye,en[1]+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=pt.trim(d.dataType||"*").toLowerCase().match(Nt)||[""],null==d.crossDomain&&(o=Ze.exec(d.url.toLowerCase()),d.crossDomain=!(!o||o[1]===en[1]&&o[2]===en[2]&&(o[3]||("http:"===o[1]?"80":"443"))===(en[3]||("http:"===en[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=pt.param(d.data,d.traditional)),Q(Ge,d,n,C),2===w)return C;c=pt.event&&d.global,c&&0===pt.active++&&pt.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Xe.test(d.type),r=d.url,d.hasContent||(d.data&&(r=d.url+=(Fe.test(r)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=Ue.test(r)?r.replace(Ue,"$1_="+qe++):r+(Fe.test(r)?"&":"?")+"_="+qe++)),d.ifModified&&(pt.lastModified[r]&&C.setRequestHeader("If-Modified-Since",pt.lastModified[r]),pt.etag[r]&&C.setRequestHeader("If-None-Match",pt.etag[r])),(d.data&&d.hasContent&&d.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",d.contentType),C.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Ke+"; q=0.01":""):d.accepts["*"]);for(s in d.headers)C.setRequestHeader(s,d.headers[s]);if(d.beforeSend&&(d.beforeSend.call(p,C,d)===!1||2===w))return C.abort();x="abort";for(s in{success:1,error:1,complete:1})C[s](d[s]);if(u=Q(Je,d,n,C)){if(C.readyState=1,c&&f.trigger("ajaxSend",[C,d]),2===w)return C;d.async&&d.timeout>0&&(l=t.setTimeout(function(){C.abort("timeout")},d.timeout));try{w=1,u.send(y,i)}catch(_){if(!(2>w))throw _;i(-1,_)}}else i(-1,"No Transport");return C},getJSON:function(t,e,n){return pt.get(t,e,n,"json")},getScript:function(t,e){return pt.get(t,void 0,e,"script")}}),pt.each(["get","post"],function(t,e){pt[e]=function(t,n,i,o){return pt.isFunction(n)&&(o=o||i,i=n,n=void 0),pt.ajax(pt.extend({url:t,type:e,dataType:o,data:n,success:i},pt.isPlainObject(t)&&t))}}),pt._evalUrl=function(t){return pt.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},pt.fn.extend({wrapAll:function(t){if(pt.isFunction(t))return this.each(function(e){pt(this).wrapAll(t.call(this,e))});if(this[0]){var e=pt(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return pt.isFunction(t)?this.each(function(e){pt(this).wrapInner(t.call(this,e))}):this.each(function(){var e=pt(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=pt.isFunction(t);return this.each(function(n){pt(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){pt.nodeName(this,"body")||pt(this).replaceWith(this.childNodes)}).end()}}),pt.expr.filters.hidden=function(t){return ht.reliableHiddenOffsets()?t.offsetWidth<=0&&t.offsetHeight<=0&&!t.getClientRects().length:G(t)},pt.expr.filters.visible=function(t){return!pt.expr.filters.hidden(t)};var nn=/%20/g,on=/\[\]$/,sn=/\r?\n/g,rn=/^(?:submit|button|image|reset|file)$/i,an=/^(?:input|select|textarea|keygen)/i;pt.param=function(t,e){var n,i=[],o=function(t,e){e=pt.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=pt.ajaxSettings&&pt.ajaxSettings.traditional),pt.isArray(t)||t.jquery&&!pt.isPlainObject(t))pt.each(t,function(){o(this.name,this.value)});else for(n in t)J(n,t[n],e,o);return i.join("&").replace(nn,"+")},pt.fn.extend({serialize:function(){return pt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=pt.prop(this,"elements");return t?pt.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!pt(this).is(":disabled")&&an.test(this.nodeName)&&!rn.test(t)&&(this.checked||!zt.test(t))}).map(function(t,e){var n=pt(this).val();return null==n?null:pt.isArray(n)?pt.map(n,function(t){return{name:e.name,value:t.replace(sn,"\r\n")}}):{name:e.name,value:n.replace(sn,"\r\n")}}).get()}}),pt.ajaxSettings.xhr=void 0!==t.ActiveXObject?function(){return this.isLocal?tt():it.documentMode>8?K():/^(get|post|head|put|delete|options)$/i.test(this.type)&&K()||tt()}:K;var ln=0,cn={},un=pt.ajaxSettings.xhr();t.attachEvent&&t.attachEvent("onunload",function(){for(var t in cn)cn[t](void 0,!0)}),ht.cors=!!un&&"withCredentials"in un,un=ht.ajax=!!un,un&&pt.ajaxTransport(function(e){if(!e.crossDomain||ht.cors){var n;return{send:function(i,o){var s,r=e.xhr(),a=++ln;if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(s in e.xhrFields)r[s]=e.xhrFields[s];e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(s in i)void 0!==i[s]&&r.setRequestHeader(s,i[s]+"");r.send(e.hasContent&&e.data||null),n=function(t,i){var s,l,c;if(n&&(i||4===r.readyState))if(delete cn[a],n=void 0,r.onreadystatechange=pt.noop,i)4!==r.readyState&&r.abort();else{c={},s=r.status,"string"==typeof r.responseText&&(c.text=r.responseText);try{l=r.statusText}catch(u){l=""}s||!e.isLocal||e.crossDomain?1223===s&&(s=204):s=c.text?200:404}c&&o(s,l,c,r.getAllResponseHeaders())},e.async?4===r.readyState?t.setTimeout(n):r.onreadystatechange=cn[a]=n:n()},abort:function(){n&&n(void 0,!0)}}}}),pt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return pt.globalEval(t),t}}}),pt.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),pt.ajaxTransport("script",function(t){if(t.crossDomain){var e,n=it.head||pt("head")[0]||it.documentElement;return{send:function(i,o){e=it.createElement("script"),e.async=!0,t.scriptCharset&&(e.charset=t.scriptCharset),e.src=t.url,e.onload=e.onreadystatechange=function(t,n){(n||!e.readyState||/loaded|complete/.test(e.readyState))&&(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),e=null,n||o(200,"success"))},n.insertBefore(e,n.firstChild)},abort:function(){e&&e.onload(void 0,!0)}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;pt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=hn.pop()||pt.expando+"_"+qe++;return this[t]=!0,t}}),pt.ajaxPrefilter("json jsonp",function(e,n,i){var o,s,r,a=e.jsonp!==!1&&(dn.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(e.data)&&"data");return a||"jsonp"===e.dataTypes[0]?(o=e.jsonpCallback=pt.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(dn,"$1"+o):e.jsonp!==!1&&(e.url+=(Fe.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return r||pt.error(o+" was not called"),r[0]},e.dataTypes[0]="json",s=t[o],t[o]=function(){r=arguments},i.always(function(){void 0===s?pt(t).removeProp(o):t[o]=s,e[o]&&(e.jsonpCallback=n.jsonpCallback,hn.push(o)),r&&pt.isFunction(s)&&s(r[0]),r=s=void 0}),"script"):void 0}),pt.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||it;var i=Ct.exec(t),o=!n&&[];return i?[e.createElement(i[1])]:(i=v([t],e,o),o&&o.length&&pt(o).remove(),pt.merge([],i.childNodes))};var pn=pt.fn.load;pt.fn.load=function(t,e,n){if("string"!=typeof t&&pn)return pn.apply(this,arguments);var i,o,s,r=this,a=t.indexOf(" ");return a>-1&&(i=pt.trim(t.slice(a,t.length)),t=t.slice(0,a)),pt.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(o="POST"),r.length>0&&pt.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done(function(t){s=arguments,r.html(i?pt("<div>").append(pt.parseHTML(t)).find(i):t)}).always(n&&function(t,e){r.each(function(){n.apply(this,s||[t.responseText,e,t])})}),this},pt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){pt.fn[e]=function(t){return this.on(e,t)}}),pt.expr.filters.animated=function(t){return pt.grep(pt.timers,function(e){return t===e.elem}).length},pt.offset={setOffset:function(t,e,n){var i,o,s,r,a,l,c,u=pt.css(t,"position"),h=pt(t),d={};"static"===u&&(t.style.position="relative"),a=h.offset(),s=pt.css(t,"top"),l=pt.css(t,"left"),c=("absolute"===u||"fixed"===u)&&pt.inArray("auto",[s,l])>-1,c?(i=h.position(),r=i.top,o=i.left):(r=parseFloat(s)||0,o=parseFloat(l)||0),pt.isFunction(e)&&(e=e.call(t,n,pt.extend({},a))),null!=e.top&&(d.top=e.top-a.top+r),null!=e.left&&(d.left=e.left-a.left+o),"using"in e?e.using.call(t,d):h.css(d)}},pt.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){pt.offset.setOffset(this,t,e)});var e,n,i={top:0,left:0},o=this[0],s=o&&o.ownerDocument;return s?(e=s.documentElement,pt.contains(e,o)?("undefined"!=typeof o.getBoundingClientRect&&(i=o.getBoundingClientRect()),n=et(s),{top:i.top+(n.pageYOffset||e.scrollTop)-(e.clientTop||0),left:i.left+(n.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}):i):void 0},position:function(){if(this[0]){var t,e,n={top:0,left:0},i=this[0];return"fixed"===pt.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),pt.nodeName(t[0],"html")||(n=t.offset()),n.top+=pt.css(t[0],"borderTopWidth",!0),n.left+=pt.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-pt.css(i,"marginTop",!0),
left:e.left-n.left-pt.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&!pt.nodeName(t,"html")&&"static"===pt.css(t,"position");)t=t.offsetParent;return t||pe})}}),pt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n=/Y/.test(e);pt.fn[t]=function(i){return Mt(this,function(t,i,o){var s=et(t);return void 0===o?s?e in s?s[e]:s.document.documentElement[i]:t[i]:void(s?s.scrollTo(n?pt(s).scrollLeft():o,n?o:pt(s).scrollTop()):t[i]=o)},t,i,arguments.length,null)}}),pt.each(["top","left"],function(t,e){pt.cssHooks[e]=A(ht.pixelPosition,function(t,n){return n?(n=ge(t,e),he.test(n)?pt(t).position()[e]+"px":n):void 0})}),pt.each({Height:"height",Width:"width"},function(t,e){pt.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){pt.fn[i]=function(i,o){var s=arguments.length&&(n||"boolean"!=typeof i),r=n||(i===!0||o===!0?"margin":"border");return Mt(this,function(e,n,i){var o;return pt.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===i?pt.css(e,n,r):pt.style(e,n,i,r)},e,s?i:void 0,s,null)}})}),pt.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),pt.fn.size=function(){return this.length},pt.fn.andSelf=pt.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return pt});var fn=t.jQuery,gn=t.$;return pt.noConflict=function(e){return t.$===pt&&(t.$=gn),e&&t.jQuery===pt&&(t.jQuery=fn),pt},e||(t.jQuery=t.$=pt),pt}),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(t){"use strict";var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||e[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return!1}t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;t(this).one("bsTransitionEnd",function(){n=!0});var o=function(){n||t(i).trigger(t.support.transition.end)};return setTimeout(o,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.alert");o||n.data("bs.alert",o=new i(this)),"string"==typeof e&&o[e].call(n)})}var n='[data-dismiss="alert"]',i=function(e){t(e).on("click",n,this.close)};i.VERSION="3.3.7",i.TRANSITION_DURATION=150,i.prototype.close=function(e){function n(){r.detach().trigger("closed.bs.alert").remove()}var o=t(this),s=o.attr("data-target");s||(s=o.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,""));var r=t("#"===s?[]:s);e&&e.preventDefault(),r.length||(r=o.closest(".alert")),r.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(r.removeClass("in"),t.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n())};var o=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=o,this},t(document).on("click.bs.alert.data-api",n,i.prototype.close)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.button"),s="object"==typeof e&&e;o||i.data("bs.button",o=new n(this,s)),"toggle"==e?o.toggle():e&&o.setState(e)})}var n=function(e,i){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,i),this.isLoading=!1};n.VERSION="3.3.7",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(e){var n="disabled",i=this.$element,o=i.is("input")?"val":"html",s=i.data();e+="Text",null==s.resetText&&i.data("resetText",i[o]()),setTimeout(t.proxy(function(){i[o](null==s[e]?this.options[e]:s[e]),"loadingText"==e?(this.isLoading=!0,i.addClass(n).attr(n,n).prop(n,!0)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n).prop(n,!1))},this),0)},n.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var n=this.$element.find("input");"radio"==n.prop("type")?(n.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var i=t.fn.button;t.fn.button=e,t.fn.button.Constructor=n,t.fn.button.noConflict=function(){return t.fn.button=i,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(n){var i=t(n.target).closest(".btn");e.call(i,"toggle"),t(n.target).is('input[type="radio"], input[type="checkbox"]')||(n.preventDefault(),i.is("input,button")?i.trigger("focus"):i.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.carousel"),s=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e),r="string"==typeof e?e:s.slide;o||i.data("bs.carousel",o=new n(this,s)),"number"==typeof e?o.to(e):r?o[r]():s.interval&&o.pause().cycle()})}var n=function(e,n){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};n.VERSION="3.3.7",n.TRANSITION_DURATION=600,n.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},n.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},n.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},n.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},n.prototype.getItemForDirection=function(t,e){var n=this.getItemIndex(e),i="prev"==t&&0===n||"next"==t&&n==this.$items.length-1;if(i&&!this.options.wrap)return e;var o="prev"==t?-1:1,s=(n+o)%this.$items.length;return this.$items.eq(s)},n.prototype.to=function(t){var e=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",this.$items.eq(t))},n.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},n.prototype.next=function(){if(!this.sliding)return this.slide("next")},n.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},n.prototype.slide=function(e,i){var o=this.$element.find(".item.active"),s=i||this.getItemForDirection(e,o),r=this.interval,a="next"==e?"left":"right",l=this;if(s.hasClass("active"))return this.sliding=!1;var c=s[0],u=t.Event("slide.bs.carousel",{relatedTarget:c,direction:a});if(this.$element.trigger(u),!u.isDefaultPrevented()){if(this.sliding=!0,r&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var h=t(this.$indicators.children()[this.getItemIndex(s)]);h&&h.addClass("active")}var d=t.Event("slid.bs.carousel",{relatedTarget:c,direction:a});return t.support.transition&&this.$element.hasClass("slide")?(s.addClass(e),s[0].offsetWidth,o.addClass(a),s.addClass(a),o.one("bsTransitionEnd",function(){s.removeClass([e,a].join(" ")).addClass("active"),o.removeClass(["active",a].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(d)},0)}).emulateTransitionEnd(n.TRANSITION_DURATION)):(o.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(d)),r&&this.cycle(),this}};var i=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=n,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this};var o=function(n){var i,o=t(this),s=t(o.attr("data-target")||(i=o.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""));if(s.hasClass("carousel")){var r=t.extend({},s.data(),o.data()),a=o.attr("data-slide-to");a&&(r.interval=!1),e.call(s,r),a&&s.data("bs.carousel").to(a),n.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",o).on("click.bs.carousel.data-api","[data-slide-to]",o),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var n=t(this);e.call(n,n.data())})})}(jQuery),+function(t){"use strict";function e(e){var n,i=e.attr("data-target")||(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return t(i)}function n(e){return this.each(function(){var n=t(this),o=n.data("bs.collapse"),s=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);!o&&s.toggle&&/show|hide/.test(e)&&(s.toggle=!1),o||n.data("bs.collapse",o=new i(this,s)),"string"==typeof e&&o[e]()})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};i.VERSION="3.3.7",i.TRANSITION_DURATION=350,i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,o=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(o&&o.length&&(e=o.data("bs.collapse"),e&&e.transitioning))){var s=t.Event("show.bs.collapse");if(this.$element.trigger(s),!s.isDefaultPrevented()){o&&o.length&&(n.call(o,"hide"),e||o.data("bs.collapse",null));var r=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[r](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[r](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var l=t.camelCase(["scroll",r].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(i.TRANSITION_DURATION)[r](this.$element[0][l])}}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[n](0).one("bsTransitionEnd",t.proxy(o,this)).emulateTransitionEnd(i.TRANSITION_DURATION):o.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(n,i){var o=t(i);this.addAriaAndCollapsedClass(e(o),o)},this)).end()},i.prototype.addAriaAndCollapsedClass=function(t,e){var n=t.hasClass("in");t.attr("aria-expanded",n),e.toggleClass("collapsed",!n).attr("aria-expanded",n)};var o=t.fn.collapse;t.fn.collapse=n,t.fn.collapse.Constructor=i,t.fn.collapse.noConflict=function(){return t.fn.collapse=o,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var o=t(this);o.attr("data-target")||i.preventDefault();var s=e(o),r=s.data("bs.collapse"),a=r?"toggle":o.data();n.call(s,a)})}(jQuery),+function(t){"use strict";function e(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent()}function n(n){n&&3===n.which||(t(o).remove(),t(s).each(function(){var i=t(this),o=e(i),s={relatedTarget:this};o.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&t.contains(o[0],n.target)||(o.trigger(n=t.Event("hide.bs.dropdown",s)),n.isDefaultPrevented()||(i.attr("aria-expanded","false"),o.removeClass("open").trigger(t.Event("hidden.bs.dropdown",s)))))}))}function i(e){return this.each(function(){var n=t(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),"string"==typeof e&&i[e].call(n)})}var o=".dropdown-backdrop",s='[data-toggle="dropdown"]',r=function(e){t(e).on("click.bs.dropdown",this.toggle)};r.VERSION="3.3.7",r.prototype.toggle=function(i){var o=t(this);if(!o.is(".disabled, :disabled")){var s=e(o),r=s.hasClass("open");if(n(),!r){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",n);var a={relatedTarget:this};if(s.trigger(i=t.Event("show.bs.dropdown",a)),i.isDefaultPrevented())return;o.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger(t.Event("shown.bs.dropdown",a))}return!1}},r.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var i=t(this);if(n.preventDefault(),n.stopPropagation(),!i.is(".disabled, :disabled")){var o=e(i),r=o.hasClass("open");if(!r&&27!=n.which||r&&27==n.which)return 27==n.which&&o.find(s).trigger("focus"),i.trigger("click");var a=" li:not(.disabled):visible a",l=o.find(".dropdown-menu"+a);if(l.length){var c=l.index(n.target);38==n.which&&c>0&&c--,40==n.which&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var a=t.fn.dropdown;t.fn.dropdown=i,t.fn.dropdown.Constructor=r,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=a,this},t(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,r.prototype.toggle).on("keydown.bs.dropdown.data-api",s,r.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",r.prototype.keydown)}(jQuery),+function(t){"use strict";function e(e,i){return this.each(function(){var o=t(this),s=o.data("bs.modal"),r=t.extend({},n.DEFAULTS,o.data(),"object"==typeof e&&e);s||o.data("bs.modal",s=new n(this,r)),"string"==typeof e?s[e](i):r.show&&s.show(i)})}var n=function(e,n){this.options=n,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.3.7",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},n.prototype.show=function(e){var i=this,o=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(o),this.isShown||o.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var o=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),o&&i.$element[0].offsetWidth,i.$element.addClass("in"),i.enforceFocus();var s=t.Event("shown.bs.modal",{relatedTarget:e});o?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(n.TRANSITION_DURATION):i.$element.trigger("focus").trigger(s)}))},n.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},n.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},n.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(e){var i=this,o=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=t.support.transition&&o;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+o).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;s?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var r=function(){i.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",r).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):r()}else e&&e()},n.prototype.handleUpdate=function(){this.adjustDialog()},n.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},n.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},n.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},n.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var i=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=n,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i=t(this),o=i.attr("href"),s=t(i.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),r=s.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(o)&&o},s.data(),i.data());i.is("a")&&n.preventDefault(),s.one("show.bs.modal",function(t){t.isDefaultPrevented()||s.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),e.call(s,r,this)})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.tooltip"),s="object"==typeof e&&e;!o&&/destroy|hide/.test(e)||(o||i.data("bs.tooltip",o=new n(this,s)),"string"==typeof e&&o[e]())})}var n=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};n.VERSION="3.3.7",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,n,i){if(this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),s=o.length;s--;){var r=o[s];if("click"==r)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=r){var a="hover"==r?"mouseenter":"focusin",l="hover"==r?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,i){n[t]!=i&&(e[t]=i)}),e},n.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusin"==e.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState?void(n.hoverState="in"):(clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show())},n.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},n.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusout"==e.type?"focus":"hover"]=!1),!n.isInStateTrue())return clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide()},n.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var o=this,s=this.tip(),r=this.getUID(this.type);this.setContent(),s.attr("id",r),this.$element.attr("aria-describedby",r),this.options.animation&&s.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,c=l.test(a);c&&(a=a.replace(l,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var u=this.getPosition(),h=s[0].offsetWidth,d=s[0].offsetHeight;if(c){var p=a,f=this.getPosition(this.$viewport);a="bottom"==a&&u.bottom+d>f.bottom?"top":"top"==a&&u.top-d<f.top?"bottom":"right"==a&&u.right+h>f.width?"left":"left"==a&&u.left-h<f.left?"right":a,s.removeClass(p).addClass(a)}var g=this.getCalculatedOffset(a,u,h,d);this.applyPlacement(g,a);var m=function(){var t=o.hoverState;o.$element.trigger("shown.bs."+o.type),o.hoverState=null,"out"==t&&o.leave(o)};t.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",m).emulateTransitionEnd(n.TRANSITION_DURATION):m()}},n.prototype.applyPlacement=function(e,n){var i=this.tip(),o=i[0].offsetWidth,s=i[0].offsetHeight,r=parseInt(i.css("margin-top"),10),a=parseInt(i.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),e.top+=r,e.left+=a,t.offset.setOffset(i[0],t.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),i.addClass("in");var l=i[0].offsetWidth,c=i[0].offsetHeight;"top"==n&&c!=s&&(e.top=e.top+s-c);var u=this.getViewportAdjustedDelta(n,e,l,c);u.left?e.left+=u.left:e.top+=u.top;var h=/top|bottom/.test(n),d=h?2*u.left-o+l:2*u.top-s+c,p=h?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(d,i[0][p],h)},n.prototype.replaceArrow=function(t,e,n){this.arrow().css(n?"left":"top",50*(1-t/e)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},n.prototype.hide=function(e){function i(){"in"!=o.hoverState&&s.detach(),o.$element&&o.$element.removeAttr("aria-describedby").trigger("hidden.bs."+o.type),e&&e()}var o=this,s=t(this.$tip),r=t.Event("hide.bs."+this.type);if(this.$element.trigger(r),!r.isDefaultPrevented())return s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i(),this.hoverState=null,this},n.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(e){e=e||this.$element;var n=e[0],i="BODY"==n.tagName,o=n.getBoundingClientRect();null==o.width&&(o=t.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var s=window.SVGElement&&n instanceof window.SVGElement,r=i?{top:0,left:0}:s?null:e.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},l=i?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},o,a,l,r)},n.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},n.prototype.getViewportAdjustedDelta=function(t,e,n,i){var o={top:0,left:0};if(!this.$viewport)return o;var s=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-s-r.scroll,l=e.top+s-r.scroll+i;a<r.top?o.top=r.top-a:l>r.top+r.height&&(o.top=r.top+r.height-l)}else{var c=e.left-s,u=e.left+s+n;c<r.left?o.left=r.left-c:u>r.right&&(o.left=r.left+r.width-u)}return o},n.prototype.getTitle=function(){var t,e=this.$element,n=this.options;return t=e.attr("data-original-title")||("function"==typeof n.title?n.title.call(e[0]):n.title)},n.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},n.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var n=this;e&&(n=t(e.currentTarget).data("bs."+this.type),n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n))),e?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})};var i=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=n,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.popover"),s="object"==typeof e&&e;!o&&/destroy|hide/.test(e)||(o||i.data("bs.popover",o=new n(this,s)),"string"==typeof e&&o[e]())})}var n=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.3.7",n.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=n,t.fn.popover.noConflict=function(){
return t.fn.popover=i,this}}(jQuery),+function(t){"use strict";function e(n,i){this.$body=t(document.body),this.$scrollElement=t(t(n).is(document.body)?window:n),this.options=t.extend({},e.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function n(n){return this.each(function(){var i=t(this),o=i.data("bs.scrollspy"),s="object"==typeof n&&n;o||i.data("bs.scrollspy",o=new e(this,s)),"string"==typeof n&&o[n]()})}e.VERSION="3.3.7",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,n="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(n="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),o=e.data("target")||e.attr("href"),s=/^#./.test(o)&&t(o);return s&&s.length&&s.is(":visible")&&[[s[n]().top+i,o]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),i=this.options.offset+n-this.$scrollElement.height(),o=this.offsets,s=this.targets,r=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),e>=i)return r!=(t=s[s.length-1])&&this.activate(t);if(r&&e<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)r!=s[t]&&e>=o[t]&&(void 0===o[t+1]||e<o[t+1])&&this.activate(s[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',i=t(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=t.fn.scrollspy;t.fn.scrollspy=n,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);n.call(e,e.data())})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.tab");o||i.data("bs.tab",o=new n(this)),"string"==typeof e&&o[e]()})}var n=function(e){this.element=t(e)};n.VERSION="3.3.7",n.TRANSITION_DURATION=150,n.prototype.show=function(){var e=this.element,n=e.closest("ul:not(.dropdown-menu)"),i=e.data("target");if(i||(i=e.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var o=n.find(".active:last a"),s=t.Event("hide.bs.tab",{relatedTarget:e[0]}),r=t.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(s),e.trigger(r),!r.isDefaultPrevented()&&!s.isDefaultPrevented()){var a=t(i);this.activate(e.closest("li"),n),this.activate(a,a.parent(),function(){o.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:o[0]})})}}},n.prototype.activate=function(e,i,o){function s(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),o&&o()}var r=i.find("> .active"),a=o&&t.support.transition&&(r.length&&r.hasClass("fade")||!!i.find("> .fade").length);r.length&&a?r.one("bsTransitionEnd",s).emulateTransitionEnd(n.TRANSITION_DURATION):s(),r.removeClass("in")};var i=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=n,t.fn.tab.noConflict=function(){return t.fn.tab=i,this};var o=function(n){n.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',o).on("click.bs.tab.data-api",'[data-toggle="pill"]',o)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.affix"),s="object"==typeof e&&e;o||i.data("bs.affix",o=new n(this,s)),"string"==typeof e&&o[e]()})}var n=function(e,i){this.options=t.extend({},n.DEFAULTS,i),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};n.VERSION="3.3.7",n.RESET="affix affix-top affix-bottom",n.DEFAULTS={offset:0,target:window},n.prototype.getState=function(t,e,n,i){var o=this.$target.scrollTop(),s=this.$element.offset(),r=this.$target.height();if(null!=n&&"top"==this.affixed)return o<n&&"top";if("bottom"==this.affixed)return null!=n?!(o+this.unpin<=s.top)&&"bottom":!(o+r<=t-i)&&"bottom";var a=null==this.affixed,l=a?o:s.top,c=a?r:e;return null!=n&&o<=n?"top":null!=i&&l+c>=t-i&&"bottom"},n.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(n.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},n.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},n.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),i=this.options.offset,o=i.top,s=i.bottom,r=Math.max(t(document).height(),t(document.body).height());"object"!=typeof i&&(s=o=i),"function"==typeof o&&(o=i.top(this.$element)),"function"==typeof s&&(s=i.bottom(this.$element));var a=this.getState(r,e,o,s);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var l="affix"+(a?"-"+a:""),c=t.Event(l+".bs.affix");if(this.$element.trigger(c),c.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(n.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:r-e-s})}};var i=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=n,t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var n=t(this),i=n.data();i.offset=i.offset||{},null!=i.offsetBottom&&(i.offset.bottom=i.offsetBottom),null!=i.offsetTop&&(i.offset.top=i.offsetTop),e.call(n,i)})})}(jQuery),+function(t){"use strict";function e(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent()}function n(n){n&&3===n.which||(t(o).remove(),t(s).each(function(){var i=t(this),o=e(i),s={relatedTarget:this};o.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&t.contains(o[0],n.target)||(o.trigger(n=t.Event("hide.bs.dropdown",s)),n.isDefaultPrevented()||(i.attr("aria-expanded","false"),o.removeClass("open").trigger(t.Event("hidden.bs.dropdown",s)))))}))}function i(e){return this.each(function(){var n=t(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),"string"==typeof e&&i[e].call(n)})}var o=".dropdown-backdrop",s='[data-toggle="dropdown"]',r=function(e){t(e).on("click.bs.dropdown",this.toggle)};r.VERSION="3.3.7",r.prototype.toggle=function(i){var o=t(this);if(!o.is(".disabled, :disabled")){var s=e(o),r=s.hasClass("open");if(n(),!r){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",n);var a={relatedTarget:this};if(s.trigger(i=t.Event("show.bs.dropdown",a)),i.isDefaultPrevented())return;o.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger(t.Event("shown.bs.dropdown",a))}return!1}},r.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var i=t(this);if(n.preventDefault(),n.stopPropagation(),!i.is(".disabled, :disabled")){var o=e(i),r=o.hasClass("open");if(!r&&27!=n.which||r&&27==n.which)return 27==n.which&&o.find(s).trigger("focus"),i.trigger("click");var a=" li:not(.disabled):visible a",l=o.find(".dropdown-menu"+a);if(l.length){var c=l.index(n.target);38==n.which&&c>0&&c--,40==n.which&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var a=t.fn.dropdown;t.fn.dropdown=i,t.fn.dropdown.Constructor=r,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=a,this},t(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,r.prototype.toggle).on("keydown.bs.dropdown.data-api",s,r.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",r.prototype.keydown)}(jQuery),+function(t){"use strict";function e(e){var n,i=e.attr("data-target")||(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return t(i)}function n(e){return this.each(function(){var n=t(this),o=n.data("bs.collapse"),s=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);!o&&s.toggle&&/show|hide/.test(e)&&(s.toggle=!1),o||n.data("bs.collapse",o=new i(this,s)),"string"==typeof e&&o[e]()})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};i.VERSION="3.3.7",i.TRANSITION_DURATION=350,i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,o=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(o&&o.length&&(e=o.data("bs.collapse"),e&&e.transitioning))){var s=t.Event("show.bs.collapse");if(this.$element.trigger(s),!s.isDefaultPrevented()){o&&o.length&&(n.call(o,"hide"),e||o.data("bs.collapse",null));var r=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[r](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[r](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var l=t.camelCase(["scroll",r].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(i.TRANSITION_DURATION)[r](this.$element[0][l])}}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[n](0).one("bsTransitionEnd",t.proxy(o,this)).emulateTransitionEnd(i.TRANSITION_DURATION):o.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(n,i){var o=t(i);this.addAriaAndCollapsedClass(e(o),o)},this)).end()},i.prototype.addAriaAndCollapsedClass=function(t,e){var n=t.hasClass("in");t.attr("aria-expanded",n),e.toggleClass("collapsed",!n).attr("aria-expanded",n)};var o=t.fn.collapse;t.fn.collapse=n,t.fn.collapse.Constructor=i,t.fn.collapse.noConflict=function(){return t.fn.collapse=o,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var o=t(this);o.attr("data-target")||i.preventDefault();var s=e(o),r=s.data("bs.collapse"),a=r?"toggle":o.data();n.call(s,a)})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.alert");o||n.data("bs.alert",o=new i(this)),"string"==typeof e&&o[e].call(n)})}var n='[data-dismiss="alert"]',i=function(e){t(e).on("click",n,this.close)};i.VERSION="3.3.7",i.TRANSITION_DURATION=150,i.prototype.close=function(e){function n(){r.detach().trigger("closed.bs.alert").remove()}var o=t(this),s=o.attr("data-target");s||(s=o.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,""));var r=t("#"===s?[]:s);e&&e.preventDefault(),r.length||(r=o.closest(".alert")),r.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(r.removeClass("in"),t.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n())};var o=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=o,this},t(document).on("click.bs.alert.data-api",n,i.prototype.close)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.tab");o||i.data("bs.tab",o=new n(this)),"string"==typeof e&&o[e]()})}var n=function(e){this.element=t(e)};n.VERSION="3.3.7",n.TRANSITION_DURATION=150,n.prototype.show=function(){var e=this.element,n=e.closest("ul:not(.dropdown-menu)"),i=e.data("target");if(i||(i=e.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var o=n.find(".active:last a"),s=t.Event("hide.bs.tab",{relatedTarget:e[0]}),r=t.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(s),e.trigger(r),!r.isDefaultPrevented()&&!s.isDefaultPrevented()){var a=t(i);this.activate(e.closest("li"),n),this.activate(a,a.parent(),function(){o.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:o[0]})})}}},n.prototype.activate=function(e,i,o){function s(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),o&&o()}var r=i.find("> .active"),a=o&&t.support.transition&&(r.length&&r.hasClass("fade")||!!i.find("> .fade").length);r.length&&a?r.one("bsTransitionEnd",s).emulateTransitionEnd(n.TRANSITION_DURATION):s(),r.removeClass("in")};var i=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=n,t.fn.tab.noConflict=function(){return t.fn.tab=i,this};var o=function(n){n.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',o).on("click.bs.tab.data-api",'[data-toggle="pill"]',o)}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return!1}t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;t(this).one("bsTransitionEnd",function(){n=!0});var o=function(){n||t(i).trigger(t.support.transition.end)};return setTimeout(o,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),!function(t,e,n,i){function o(e,n){this.settings=null,this.options=t.extend({},o.Defaults,n),this.$element=t(e),this._handlers={},this._plugins={},this._supress={},this._current=null,this._speed=null,this._coordinates=[],this._breakpoint=null,this._width=null,this._items=[],this._clones=[],this._mergers=[],this._widths=[],this._invalidated={},this._pipe=[],this._drag={time:null,target:null,pointer:null,stage:{start:null,current:null},direction:null},this._states={current:{},tags:{initializing:["busy"],animating:["busy"],dragging:["interacting"]}},t.each(["onResize","onThrottledResize"],t.proxy(function(e,n){this._handlers[n]=t.proxy(this[n],this)},this)),t.each(o.Plugins,t.proxy(function(t,e){this._plugins[t.charAt(0).toLowerCase()+t.slice(1)]=new e(this)},this)),t.each(o.Workers,t.proxy(function(e,n){this._pipe.push({filter:n.filter,run:t.proxy(n.run,this)})},this)),this.setup(),this.initialize()}o.Defaults={items:3,loop:!1,center:!1,rewind:!1,mouseDrag:!0,touchDrag:!0,pullDrag:!0,freeDrag:!1,margin:0,stagePadding:0,merge:!1,mergeFit:!0,autoWidth:!1,startPosition:0,rtl:!1,smartSpeed:250,fluidSpeed:!1,dragEndSpeed:!1,responsive:{},responsiveRefreshRate:200,responsiveBaseElement:e,fallbackEasing:"swing",info:!1,nestedItemSelector:!1,itemElement:"div",stageElement:"div",refreshClass:"owl-refresh",loadedClass:"owl-loaded",loadingClass:"owl-loading",rtlClass:"owl-rtl",responsiveClass:"owl-responsive",dragClass:"owl-drag",itemClass:"owl-item",stageClass:"owl-stage",stageOuterClass:"owl-stage-outer",grabClass:"owl-grab"},o.Width={Default:"default",Inner:"inner",Outer:"outer"},o.Type={Event:"event",State:"state"},o.Plugins={},o.Workers=[{filter:["width","settings"],run:function(){this._width=this.$element.width()}},{filter:["width","items","settings"],run:function(t){t.current=this._items&&this._items[this.relative(this._current)]}},{filter:["items","settings"],run:function(){this.$stage.children(".cloned").remove()}},{filter:["width","items","settings"],run:function(t){var e=this.settings.margin||"",n=!this.settings.autoWidth,i=this.settings.rtl,o={width:"auto","margin-left":i?e:"","margin-right":i?"":e};!n&&this.$stage.children().css(o),t.css=o}},{filter:["width","items","settings"],run:function(t){var e=(this.width()/this.settings.items).toFixed(3)-this.settings.margin,n=null,i=this._items.length,o=!this.settings.autoWidth,s=[];for(t.items={merge:!1,width:e};i--;)n=this._mergers[i],n=this.settings.mergeFit&&Math.min(n,this.settings.items)||n,t.items.merge=n>1||t.items.merge,s[i]=o?e*n:this._items[i].width();this._widths=s}},{filter:["items","settings"],run:function(){var e=[],n=this._items,i=this.settings,o=Math.max(2*i.items,4),s=2*Math.ceil(n.length/2),r=i.loop&&n.length?i.rewind?o:Math.max(o,s):0,a="",l="";for(r/=2;r--;)e.push(this.normalize(e.length/2,!0)),a+=n[e[e.length-1]][0].outerHTML,e.push(this.normalize(n.length-1-(e.length-1)/2,!0)),l=n[e[e.length-1]][0].outerHTML+l;this._clones=e,t(a).addClass("cloned").appendTo(this.$stage),t(l).addClass("cloned").prependTo(this.$stage)}},{filter:["width","items","settings"],run:function(){for(var t=this.settings.rtl?1:-1,e=this._clones.length+this._items.length,n=-1,i=0,o=0,s=[];++n<e;)i=s[n-1]||0,o=this._widths[this.relative(n)]+this.settings.margin,s.push(i+o*t);this._coordinates=s}},{filter:["width","items","settings"],run:function(){var t=this.settings.stagePadding,e=this._coordinates,n={width:Math.ceil(Math.abs(e[e.length-1]))+2*t,"padding-left":t||"","padding-right":t||""};this.$stage.css(n)}},{filter:["width","items","settings"],run:function(t){var e=this._coordinates.length,n=!this.settings.autoWidth,i=this.$stage.children();if(n&&t.items.merge)for(;e--;)t.css.width=this._widths[this.relative(e)],i.eq(e).css(t.css);else n&&(t.css.width=t.items.width,i.css(t.css))}},{filter:["items"],run:function(){this._coordinates.length<1&&this.$stage.removeAttr("style")}},{filter:["width","items","settings"],run:function(t){t.current=t.current?this.$stage.children().index(t.current):0,t.current=Math.max(this.minimum(),Math.min(this.maximum(),t.current)),this.reset(t.current)}},{filter:["position"],run:function(){this.animate(this.coordinates(this._current))}},{filter:["width","position","items","settings"],run:function(){var t,e,n,i,o=this.settings.rtl?1:-1,s=2*this.settings.stagePadding,r=this.coordinates(this.current())+s,a=r+this.width()*o,l=[];for(n=0,i=this._coordinates.length;i>n;n++)t=this._coordinates[n-1]||0,e=Math.abs(this._coordinates[n])+s*o,(this.op(t,"<=",r)&&this.op(t,">",a)||this.op(e,"<",r)&&this.op(e,">",a))&&l.push(n);this.$stage.children(".active").removeClass("active"),this.$stage.children(":eq("+l.join("), :eq(")+")").addClass("active"),this.settings.center&&(this.$stage.children(".center").removeClass("center"),this.$stage.children().eq(this.current()).addClass("center"))}}],o.prototype.initialize=function(){if(this.enter("initializing"),this.trigger("initialize"),this.$element.toggleClass(this.settings.rtlClass,this.settings.rtl),this.settings.autoWidth&&!this.is("pre-loading")){var e,n,o;e=this.$element.find("img"),n=this.settings.nestedItemSelector?"."+this.settings.nestedItemSelector:i,o=this.$element.children(n).width(),e.length&&0>=o&&this.preloadAutoWidthImages(e)}this.$element.addClass(this.options.loadingClass),this.$stage=t("<"+this.settings.stageElement+' class="'+this.settings.stageClass+'"/>').wrap('<div class="'+this.settings.stageOuterClass+'"/>'),this.$element.append(this.$stage.parent()),this.replace(this.$element.children().not(this.$stage.parent())),this.$element.is(":visible")?this.refresh():this.invalidate("width"),this.$element.removeClass(this.options.loadingClass).addClass(this.options.loadedClass),this.registerEventHandlers(),this.leave("initializing"),this.trigger("initialized")},o.prototype.setup=function(){var e=this.viewport(),n=this.options.responsive,i=-1,o=null;n?(t.each(n,function(t){e>=t&&t>i&&(i=Number(t))}),o=t.extend({},this.options,n[i]),delete o.responsive,o.responsiveClass&&this.$element.attr("class",this.$element.attr("class").replace(new RegExp("("+this.options.responsiveClass+"-)\\S+\\s","g"),"$1"+i))):o=t.extend({},this.options),(null===this.settings||this._breakpoint!==i)&&(this.trigger("change",{property:{name:"settings",value:o}}),this._breakpoint=i,this.settings=o,this.invalidate("settings"),this.trigger("changed",{property:{name:"settings",value:this.settings}}))},o.prototype.optionsLogic=function(){this.settings.autoWidth&&(this.settings.stagePadding=!1,this.settings.merge=!1)},o.prototype.prepare=function(e){var n=this.trigger("prepare",{content:e});return n.data||(n.data=t("<"+this.settings.itemElement+"/>").addClass(this.options.itemClass).append(e)),this.trigger("prepared",{content:n.data}),n.data},o.prototype.update=function(){for(var e=0,n=this._pipe.length,i=t.proxy(function(t){return this[t]},this._invalidated),o={};n>e;)(this._invalidated.all||t.grep(this._pipe[e].filter,i).length>0)&&this._pipe[e].run(o),e++;this._invalidated={},!this.is("valid")&&this.enter("valid")},o.prototype.width=function(t){switch(t=t||o.Width.Default){case o.Width.Inner:case o.Width.Outer:return this._width;default:return this._width-2*this.settings.stagePadding+this.settings.margin}},o.prototype.refresh=function(){this.enter("refreshing"),this.trigger("refresh"),this.setup(),this.optionsLogic(),this.$element.addClass(this.options.refreshClass),this.update(),this.$element.removeClass(this.options.refreshClass),this.leave("refreshing"),this.trigger("refreshed")},o.prototype.onThrottledResize=function(){e.clearTimeout(this.resizeTimer),this.resizeTimer=e.setTimeout(this._handlers.onResize,this.settings.responsiveRefreshRate)},o.prototype.onResize=function(){return!!this._items.length&&(this._width!==this.$element.width()&&(!!this.$element.is(":visible")&&(this.enter("resizing"),this.trigger("resize").isDefaultPrevented()?(this.leave("resizing"),!1):(this.invalidate("width"),this.refresh(),this.leave("resizing"),void this.trigger("resized")))))},o.prototype.registerEventHandlers=function(){t.support.transition&&this.$stage.on(t.support.transition.end+".owl.core",t.proxy(this.onTransitionEnd,this)),this.settings.responsive!==!1&&this.on(e,"resize",this._handlers.onThrottledResize),this.settings.mouseDrag&&(this.$element.addClass(this.options.dragClass),this.$stage.on("mousedown.owl.core",t.proxy(this.onDragStart,this)),this.$stage.on("dragstart.owl.core selectstart.owl.core",function(){return!1})),this.settings.touchDrag&&(this.$stage.on("touchstart.owl.core",t.proxy(this.onDragStart,this)),this.$stage.on("touchcancel.owl.core",t.proxy(this.onDragEnd,this)))},o.prototype.onDragStart=function(e){var i=null;3!==e.which&&(t.support.transform?(i=this.$stage.css("transform").replace(/.*\(|\)| /g,"").split(","),i={x:i[16===i.length?12:4],y:i[16===i.length?13:5]}):(i=this.$stage.position(),i={x:this.settings.rtl?i.left+this.$stage.width()-this.width()+this.settings.margin:i.left,y:i.top}),this.is("animating")&&(t.support.transform?this.animate(i.x):this.$stage.stop(),this.invalidate("position")),this.$element.toggleClass(this.options.grabClass,"mousedown"===e.type),this.speed(0),this._drag.time=(new Date).getTime(),this._drag.target=t(e.target),this._drag.stage.start=i,this._drag.stage.current=i,this._drag.pointer=this.pointer(e),t(n).on("mouseup.owl.core touchend.owl.core",t.proxy(this.onDragEnd,this)),t(n).one("mousemove.owl.core touchmove.owl.core",t.proxy(function(e){var i=this.difference(this._drag.pointer,this.pointer(e));t(n).on("mousemove.owl.core touchmove.owl.core",t.proxy(this.onDragMove,this)),Math.abs(i.x)<Math.abs(i.y)&&this.is("valid")||(e.preventDefault(),this.enter("dragging"),this.trigger("drag"))},this)))},o.prototype.onDragMove=function(t){var e=null,n=null,i=null,o=this.difference(this._drag.pointer,this.pointer(t)),s=this.difference(this._drag.stage.start,o);this.is("dragging")&&(t.preventDefault(),this.settings.loop?(e=this.coordinates(this.minimum()),n=this.coordinates(this.maximum()+1)-e,s.x=((s.x-e)%n+n)%n+e):(e=this.coordinates(this.settings.rtl?this.maximum():this.minimum()),n=this.coordinates(this.settings.rtl?this.minimum():this.maximum()),i=this.settings.pullDrag?-1*o.x/5:0,s.x=Math.max(Math.min(s.x,e+i),n+i)),this._drag.stage.current=s,this.animate(s.x))},o.prototype.onDragEnd=function(e){var i=this.difference(this._drag.pointer,this.pointer(e)),o=this._drag.stage.current,s=i.x>0^this.settings.rtl?"left":"right";t(n).off(".owl.core"),this.$element.removeClass(this.options.grabClass),(0!==i.x&&this.is("dragging")||!this.is("valid"))&&(this.speed(this.settings.dragEndSpeed||this.settings.smartSpeed),this.current(this.closest(o.x,0!==i.x?s:this._drag.direction)),this.invalidate("position"),this.update(),this._drag.direction=s,(Math.abs(i.x)>3||(new Date).getTime()-this._drag.time>300)&&this._drag.target.one("click.owl.core",function(){return!1})),this.is("dragging")&&(this.leave("dragging"),this.trigger("dragged"))},o.prototype.closest=function(e,n){var i=-1,o=30,s=this.width(),r=this.coordinates();return this.settings.freeDrag||t.each(r,t.proxy(function(t,a){return e>a-o&&a+o>e?i=t:this.op(e,"<",a)&&this.op(e,">",r[t+1]||a-s)&&(i="left"===n?t+1:t),-1===i},this)),this.settings.loop||(this.op(e,">",r[this.minimum()])?i=e=this.minimum():this.op(e,"<",r[this.maximum()])&&(i=e=this.maximum())),i},o.prototype.animate=function(e){var n=this.speed()>0;this.is("animating")&&this.onTransitionEnd(),n&&(this.enter("animating"),this.trigger("translate")),t.support.transform3d&&t.support.transition?this.$stage.css({transform:"translate3d("+e+"px,0px,0px)",transition:this.speed()/1e3+"s"}):n?this.$stage.animate({left:e+"px"},this.speed(),this.settings.fallbackEasing,t.proxy(this.onTransitionEnd,this)):this.$stage.css({left:e+"px"})},o.prototype.is=function(t){return this._states.current[t]&&this._states.current[t]>0},o.prototype.current=function(t){if(t===i)return this._current;if(0===this._items.length)return i;if(t=this.normalize(t),this._current!==t){var e=this.trigger("change",{property:{name:"position",value:t}});e.data!==i&&(t=this.normalize(e.data)),this._current=t,this.invalidate("position"),this.trigger("changed",{property:{name:"position",value:this._current}})}return this._current},o.prototype.invalidate=function(e){return"string"===t.type(e)&&(this._invalidated[e]=!0,this.is("valid")&&this.leave("valid")),t.map(this._invalidated,function(t,e){return e})},o.prototype.reset=function(t){t=this.normalize(t),t!==i&&(this._speed=0,this._current=t,this.suppress(["translate","translated"]),this.animate(this.coordinates(t)),this.release(["translate","translated"]))},o.prototype.normalize=function(e,n){var o=this._items.length,s=n?0:this._clones.length;return!t.isNumeric(e)||1>o?e=i:(0>e||e>=o+s)&&(e=((e-s/2)%o+o)%o+s/2),e},o.prototype.relative=function(t){return t-=this._clones.length/2,this.normalize(t,!0)},o.prototype.maximum=function(t){var e,n=this.settings,i=this._coordinates.length,o=Math.abs(this._coordinates[i-1])-this._width,s=-1;if(n.loop)i=this._clones.length/2+this._items.length-1;else if(n.autoWidth||n.merge)for(;i-s>1;)Math.abs(this._coordinates[e=i+s>>1])<o?s=e:i=e;else i=n.center?this._items.length-1:this._items.length-n.items;return t&&(i-=this._clones.length/2),Math.max(i,0)},o.prototype.minimum=function(t){return t?0:this._clones.length/2},o.prototype.items=function(t){return t===i?this._items.slice():(t=this.normalize(t,!0),this._items[t])},o.prototype.mergers=function(t){return t===i?this._mergers.slice():(t=this.normalize(t,!0),this._mergers[t])},o.prototype.clones=function(e){var n=this._clones.length/2,o=n+this._items.length,s=function(t){return t%2===0?o+t/2:n-(t+1)/2};return e===i?t.map(this._clones,function(t,e){return s(e)}):t.map(this._clones,function(t,n){return t===e?s(n):null})},o.prototype.speed=function(t){return t!==i&&(this._speed=t),this._speed},o.prototype.coordinates=function(e){var n=null;return e===i?t.map(this._coordinates,t.proxy(function(t,e){return this.coordinates(e)},this)):(this.settings.center?(n=this._coordinates[e],n+=(this.width()-n+(this._coordinates[e-1]||0))/2*(this.settings.rtl?-1:1)):n=this._coordinates[e-1]||0,n)},o.prototype.duration=function(t,e,n){return Math.min(Math.max(Math.abs(e-t),1),6)*Math.abs(n||this.settings.smartSpeed)},o.prototype.to=function(t,e){var n=this.current(),i=null,o=t-this.relative(n),s=(o>0)-(0>o),r=this._items.length,a=this.minimum(),l=this.maximum();this.settings.loop?(!this.settings.rewind&&Math.abs(o)>r/2&&(o+=-1*s*r),t=n+o,i=((t-a)%r+r)%r+a,i!==t&&l>=i-o&&i-o>0&&(n=i-o,t=i,this.reset(n))):this.settings.rewind?(l+=1,t=(t%l+l)%l):t=Math.max(a,Math.min(l,t)),this.speed(this.duration(n,t,e)),this.current(t),this.$element.is(":visible")&&this.update()},o.prototype.next=function(t){t=t||!1,this.to(this.relative(this.current())+1,t)},o.prototype.prev=function(t){t=t||!1,this.to(this.relative(this.current())-1,t)},o.prototype.onTransitionEnd=function(t){return(t===i||(t.stopPropagation(),(t.target||t.srcElement||t.originalTarget)===this.$stage.get(0)))&&(this.leave("animating"),void this.trigger("translated"))},o.prototype.viewport=function(){var i;if(this.options.responsiveBaseElement!==e)i=t(this.options.responsiveBaseElement).width();else if(e.innerWidth)i=e.innerWidth;else{if(!n.documentElement||!n.documentElement.clientWidth)throw"Can not detect viewport width.";i=n.documentElement.clientWidth}return i},o.prototype.replace=function(e){this.$stage.empty(),this._items=[],e&&(e=e instanceof jQuery?e:t(e)),this.settings.nestedItemSelector&&(e=e.find("."+this.settings.nestedItemSelector)),e.filter(function(){return 1===this.nodeType}).each(t.proxy(function(t,e){e=this.prepare(e),this.$stage.append(e),this._items.push(e),this._mergers.push(1*e.find("[data-merge]").andSelf("[data-merge]").attr("data-merge")||1)},this)),this.reset(t.isNumeric(this.settings.startPosition)?this.settings.startPosition:0),this.invalidate("items")},o.prototype.add=function(e,n){var o=this.relative(this._current);n=n===i?this._items.length:this.normalize(n,!0),e=e instanceof jQuery?e:t(e),this.trigger("add",{
content:e,position:n}),e=this.prepare(e),0===this._items.length||n===this._items.length?(0===this._items.length&&this.$stage.append(e),0!==this._items.length&&this._items[n-1].after(e),this._items.push(e),this._mergers.push(1*e.find("[data-merge]").andSelf("[data-merge]").attr("data-merge")||1)):(this._items[n].before(e),this._items.splice(n,0,e),this._mergers.splice(n,0,1*e.find("[data-merge]").andSelf("[data-merge]").attr("data-merge")||1)),this._items[o]&&this.reset(this._items[o].index()),this.invalidate("items"),this.trigger("added",{content:e,position:n})},o.prototype.remove=function(t){t=this.normalize(t,!0),t!==i&&(this.trigger("remove",{content:this._items[t],position:t}),this._items[t].remove(),this._items.splice(t,1),this._mergers.splice(t,1),this.invalidate("items"),this.trigger("removed",{content:null,position:t}))},o.prototype.preloadAutoWidthImages=function(e){e.each(t.proxy(function(e,n){this.enter("pre-loading"),n=t(n),t(new Image).one("load",t.proxy(function(t){n.attr("src",t.target.src),n.css("opacity",1),this.leave("pre-loading"),!this.is("pre-loading")&&!this.is("initializing")&&this.refresh()},this)).attr("src",n.attr("src")||n.attr("data-src")||n.attr("data-src-retina"))},this))},o.prototype.destroy=function(){this.$element.off(".owl.core"),this.$stage.off(".owl.core"),t(n).off(".owl.core"),this.settings.responsive!==!1&&(e.clearTimeout(this.resizeTimer),this.off(e,"resize",this._handlers.onThrottledResize));for(var i in this._plugins)this._plugins[i].destroy();this.$stage.children(".cloned").remove(),this.$stage.unwrap(),this.$stage.children().contents().unwrap(),this.$stage.children().unwrap(),this.$element.removeClass(this.options.refreshClass).removeClass(this.options.loadingClass).removeClass(this.options.loadedClass).removeClass(this.options.rtlClass).removeClass(this.options.dragClass).removeClass(this.options.grabClass).attr("class",this.$element.attr("class").replace(new RegExp(this.options.responsiveClass+"-\\S+\\s","g"),"")).removeData("owl.carousel")},o.prototype.op=function(t,e,n){var i=this.settings.rtl;switch(e){case"<":return i?t>n:n>t;case">":return i?n>t:t>n;case">=":return i?n>=t:t>=n;case"<=":return i?t>=n:n>=t}},o.prototype.on=function(t,e,n,i){t.addEventListener?t.addEventListener(e,n,i):t.attachEvent&&t.attachEvent("on"+e,n)},o.prototype.off=function(t,e,n,i){t.removeEventListener?t.removeEventListener(e,n,i):t.detachEvent&&t.detachEvent("on"+e,n)},o.prototype.trigger=function(e,n,i,s,r){var a={item:{count:this._items.length,index:this.current()}},l=t.camelCase(t.grep(["on",e,i],function(t){return t}).join("-").toLowerCase()),c=t.Event([e,"owl",i||"carousel"].join(".").toLowerCase(),t.extend({relatedTarget:this},a,n));return this._supress[e]||(t.each(this._plugins,function(t,e){e.onTrigger&&e.onTrigger(c)}),this.register({type:o.Type.Event,name:e}),this.$element.trigger(c),this.settings&&"function"==typeof this.settings[l]&&this.settings[l].call(this,c)),c},o.prototype.enter=function(e){t.each([e].concat(this._states.tags[e]||[]),t.proxy(function(t,e){this._states.current[e]===i&&(this._states.current[e]=0),this._states.current[e]++},this))},o.prototype.leave=function(e){t.each([e].concat(this._states.tags[e]||[]),t.proxy(function(t,e){this._states.current[e]--},this))},o.prototype.register=function(e){if(e.type===o.Type.Event){if(t.event.special[e.name]||(t.event.special[e.name]={}),!t.event.special[e.name].owl){var n=t.event.special[e.name]._default;t.event.special[e.name]._default=function(t){return!n||!n.apply||t.namespace&&-1!==t.namespace.indexOf("owl")?t.namespace&&t.namespace.indexOf("owl")>-1:n.apply(this,arguments)},t.event.special[e.name].owl=!0}}else e.type===o.Type.State&&(this._states.tags[e.name]?this._states.tags[e.name]=this._states.tags[e.name].concat(e.tags):this._states.tags[e.name]=e.tags,this._states.tags[e.name]=t.grep(this._states.tags[e.name],t.proxy(function(n,i){return t.inArray(n,this._states.tags[e.name])===i},this)))},o.prototype.suppress=function(e){t.each(e,t.proxy(function(t,e){this._supress[e]=!0},this))},o.prototype.release=function(e){t.each(e,t.proxy(function(t,e){delete this._supress[e]},this))},o.prototype.pointer=function(t){var n={x:null,y:null};return t=t.originalEvent||t||e.event,t=t.touches&&t.touches.length?t.touches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,t.pageX?(n.x=t.pageX,n.y=t.pageY):(n.x=t.clientX,n.y=t.clientY),n},o.prototype.difference=function(t,e){return{x:t.x-e.x,y:t.y-e.y}},t.fn.owlCarousel=function(e){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var i=t(this),s=i.data("owl.carousel");s||(s=new o(this,"object"==typeof e&&e),i.data("owl.carousel",s),t.each(["next","prev","to","destroy","refresh","replace","add","remove"],function(e,n){s.register({type:o.Type.Event,name:n}),s.$element.on(n+".owl.carousel.core",t.proxy(function(t){t.namespace&&t.relatedTarget!==this&&(this.suppress([n]),s[n].apply(this,[].slice.call(arguments,1)),this.release([n]))},s))})),"string"==typeof e&&"_"!==e.charAt(0)&&s[e].apply(s,n)})},t.fn.owlCarousel.Constructor=o}(window.Zepto||window.jQuery,window,document),function(t,e,n,i){var o=function(e){this._core=e,this._interval=null,this._visible=null,this._handlers={"initialized.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.autoRefresh&&this.watch()},this)},this._core.options=t.extend({},o.Defaults,this._core.options),this._core.$element.on(this._handlers)};o.Defaults={autoRefresh:!0,autoRefreshInterval:500},o.prototype.watch=function(){this._interval||(this._visible=this._core.$element.is(":visible"),this._interval=e.setInterval(t.proxy(this.refresh,this),this._core.settings.autoRefreshInterval))},o.prototype.refresh=function(){this._core.$element.is(":visible")!==this._visible&&(this._visible=!this._visible,this._core.$element.toggleClass("owl-hidden",!this._visible),this._visible&&this._core.invalidate("width")&&this._core.refresh())},o.prototype.destroy=function(){var t,n;e.clearInterval(this._interval);for(t in this._handlers)this._core.$element.off(t,this._handlers[t]);for(n in Object.getOwnPropertyNames(this))"function"!=typeof this[n]&&(this[n]=null)},t.fn.owlCarousel.Constructor.Plugins.AutoRefresh=o}(window.Zepto||window.jQuery,window,document),function(t,e,n,i){var o=function(e){this._core=e,this._loaded=[],this._handlers={"initialized.owl.carousel change.owl.carousel":t.proxy(function(e){if(e.namespace&&this._core.settings&&this._core.settings.lazyLoad&&(e.property&&"position"==e.property.name||"initialized"==e.type))for(var n=this._core.settings,i=n.center&&Math.ceil(n.items/2)||n.items,o=n.center&&-1*i||0,s=(e.property&&e.property.value||this._core.current())+o,r=this._core.clones().length,a=t.proxy(function(t,e){this.load(e)},this);o++<i;)this.load(r/2+this._core.relative(s)),r&&t.each(this._core.clones(this._core.relative(s)),a),s++},this)},this._core.options=t.extend({},o.Defaults,this._core.options),this._core.$element.on(this._handlers)};o.Defaults={lazyLoad:!1},o.prototype.load=function(n){var i=this._core.$stage.children().eq(n),o=i&&i.find(".owl-lazy");!o||t.inArray(i.get(0),this._loaded)>-1||(o.each(t.proxy(function(n,i){var o,s=t(i),r=e.devicePixelRatio>1&&s.attr("data-src-retina")||s.attr("data-src");this._core.trigger("load",{element:s,url:r},"lazy"),s.is("img")?s.one("load.owl.lazy",t.proxy(function(){s.css("opacity",1),this._core.trigger("loaded",{element:s,url:r},"lazy")},this)).attr("src",r):(o=new Image,o.onload=t.proxy(function(){s.css({"background-image":"url("+r+")",opacity:"1"}),this._core.trigger("loaded",{element:s,url:r},"lazy")},this),o.src=r)},this)),this._loaded.push(i.get(0)))},o.prototype.destroy=function(){var t,e;for(t in this.handlers)this._core.$element.off(t,this.handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.Lazy=o}(window.Zepto||window.jQuery,window,document),function(t,e,n,i){var o=function(e){this._core=e,this._handlers={"initialized.owl.carousel refreshed.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.autoHeight&&this.update()},this),"changed.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.autoHeight&&"position"==t.property.name&&this.update()},this),"loaded.owl.lazy":t.proxy(function(t){t.namespace&&this._core.settings.autoHeight&&t.element.closest("."+this._core.settings.itemClass).index()===this._core.current()&&this.update()},this)},this._core.options=t.extend({},o.Defaults,this._core.options),this._core.$element.on(this._handlers)};o.Defaults={autoHeight:!1,autoHeightClass:"owl-height"},o.prototype.update=function(){var e=this._core._current,n=e+this._core.settings.items,i=this._core.$stage.children().toArray().slice(e,n);heights=[],maxheight=0,t.each(i,function(e,n){heights.push(t(n).height())}),maxheight=Math.max.apply(null,heights),this._core.$stage.parent().height(maxheight).addClass(this._core.settings.autoHeightClass)},o.prototype.destroy=function(){var t,e;for(t in this._handlers)this._core.$element.off(t,this._handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.AutoHeight=o}(window.Zepto||window.jQuery,window,document),function(t,e,n,i){var o=function(e){this._core=e,this._videos={},this._playing=null,this._handlers={"initialized.owl.carousel":t.proxy(function(t){t.namespace&&this._core.register({type:"state",name:"playing",tags:["interacting"]})},this),"resize.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.video&&this.isInFullScreen()&&t.preventDefault()},this),"refreshed.owl.carousel":t.proxy(function(t){t.namespace&&this._core.is("resizing")&&this._core.$stage.find(".cloned .owl-video-frame").remove()},this),"changed.owl.carousel":t.proxy(function(t){t.namespace&&"position"===t.property.name&&this._playing&&this.stop()},this),"prepared.owl.carousel":t.proxy(function(e){if(e.namespace){var n=t(e.content).find(".owl-video");n.length&&(n.css("display","none"),this.fetch(n,t(e.content)))}},this)},this._core.options=t.extend({},o.Defaults,this._core.options),this._core.$element.on(this._handlers),this._core.$element.on("click.owl.video",".owl-video-play-icon",t.proxy(function(t){this.play(t)},this))};o.Defaults={video:!1,videoHeight:!1,videoWidth:!1},o.prototype.fetch=function(t,e){var n=t.attr("data-vimeo-id")?"vimeo":"youtube",i=t.attr("data-vimeo-id")||t.attr("data-youtube-id"),o=t.attr("data-width")||this._core.settings.videoWidth,s=t.attr("data-height")||this._core.settings.videoHeight,r=t.attr("href");if(!r)throw new Error("Missing video URL.");if(i=r.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),i[3].indexOf("youtu")>-1)n="youtube";else{if(!(i[3].indexOf("vimeo")>-1))throw new Error("Video URL not supported.");n="vimeo"}i=i[6],this._videos[r]={type:n,id:i,width:o,height:s},e.attr("data-video",r),this.thumbnail(t,this._videos[r])},o.prototype.thumbnail=function(e,n){var i,o,s,r=n.width&&n.height?'style="width:'+n.width+"px;height:"+n.height+'px;"':"",a=e.find("img"),l="src",c="",u=this._core.settings,h=function(t){o='<div class="owl-video-play-icon"></div>',i=u.lazyLoad?'<div class="owl-video-tn '+c+'" '+l+'="'+t+'"></div>':'<div class="owl-video-tn" style="opacity:1;background-image:url('+t+')"></div>',e.after(i),e.after(o)};return e.wrap('<div class="owl-video-wrapper"'+r+"></div>"),this._core.settings.lazyLoad&&(l="data-src",c="owl-lazy"),a.length?(h(a.attr(l)),a.remove(),!1):void("youtube"===n.type?(s="http://img.youtube.com/vi/"+n.id+"/hqdefault.jpg",h(s)):"vimeo"===n.type&&t.ajax({type:"GET",url:"http://vimeo.com/api/v2/video/"+n.id+".json",jsonp:"callback",dataType:"jsonp",success:function(t){s=t[0].thumbnail_large,h(s)}}))},o.prototype.stop=function(){this._core.trigger("stop",null,"video"),this._playing.find(".owl-video-frame").remove(),this._playing.removeClass("owl-video-playing"),this._playing=null,this._core.leave("playing"),this._core.trigger("stopped",null,"video")},o.prototype.play=function(e){var n,i=t(e.target),o=i.closest("."+this._core.settings.itemClass),s=this._videos[o.attr("data-video")],r=s.width||"100%",a=s.height||this._core.$stage.height();this._playing||(this._core.enter("playing"),this._core.trigger("play",null,"video"),o=this._core.items(this._core.relative(o.index())),this._core.reset(o.index()),"youtube"===s.type?n='<iframe width="'+r+'" height="'+a+'" src="http://www.youtube.com/embed/'+s.id+"?autoplay=1&v="+s.id+'" frameborder="0" allowfullscreen></iframe>':"vimeo"===s.type&&(n='<iframe src="http://player.vimeo.com/video/'+s.id+'?autoplay=1" width="'+r+'" height="'+a+'" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>'),t('<div class="owl-video-frame">'+n+"</div>").insertAfter(o.find(".owl-video")),this._playing=o.addClass("owl-video-playing"))},o.prototype.isInFullScreen=function(){var e=n.fullscreenElement||n.mozFullScreenElement||n.webkitFullscreenElement;return e&&t(e).parent().hasClass("owl-video-frame")},o.prototype.destroy=function(){var t,e;this._core.$element.off("click.owl.video");for(t in this._handlers)this._core.$element.off(t,this._handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.Video=o}(window.Zepto||window.jQuery,window,document),function(t,e,n,i){var o=function(e){this.core=e,this.core.options=t.extend({},o.Defaults,this.core.options),this.swapping=!0,this.previous=i,this.next=i,this.handlers={"change.owl.carousel":t.proxy(function(t){t.namespace&&"position"==t.property.name&&(this.previous=this.core.current(),this.next=t.property.value)},this),"drag.owl.carousel dragged.owl.carousel translated.owl.carousel":t.proxy(function(t){t.namespace&&(this.swapping="translated"==t.type)},this),"translate.owl.carousel":t.proxy(function(t){t.namespace&&this.swapping&&(this.core.options.animateOut||this.core.options.animateIn)&&this.swap()},this)},this.core.$element.on(this.handlers)};o.Defaults={animateOut:!1,animateIn:!1},o.prototype.swap=function(){if(1===this.core.settings.items&&t.support.animation&&t.support.transition){this.core.speed(0);var e,n=t.proxy(this.clear,this),i=this.core.$stage.children().eq(this.previous),o=this.core.$stage.children().eq(this.next),s=this.core.settings.animateIn,r=this.core.settings.animateOut;this.core.current()!==this.previous&&(r&&(e=this.core.coordinates(this.previous)-this.core.coordinates(this.next),i.one(t.support.animation.end,n).css({left:e+"px"}).addClass("animated owl-animated-out").addClass(r)),s&&o.one(t.support.animation.end,n).addClass("animated owl-animated-in").addClass(s))}},o.prototype.clear=function(e){t(e.target).css({left:""}).removeClass("animated owl-animated-out owl-animated-in").removeClass(this.core.settings.animateIn).removeClass(this.core.settings.animateOut),this.core.onTransitionEnd()},o.prototype.destroy=function(){var t,e;for(t in this.handlers)this.core.$element.off(t,this.handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.Animate=o}(window.Zepto||window.jQuery,window,document),function(t,e,n,i){var o=function(e){this._core=e,this._interval=null,this._paused=!1,this._handlers={"changed.owl.carousel":t.proxy(function(t){t.namespace&&"settings"===t.property.name&&(this._core.settings.autoplay?this.play():this.stop())},this),"initialized.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.autoplay&&this.play()},this),"play.owl.autoplay":t.proxy(function(t,e,n){t.namespace&&this.play(e,n)},this),"stop.owl.autoplay":t.proxy(function(t){t.namespace&&this.stop()},this),"mouseover.owl.autoplay":t.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.pause()},this),"mouseleave.owl.autoplay":t.proxy(function(){this._core.settings.autoplayHoverPause&&this._core.is("rotating")&&this.play()},this)},this._core.$element.on(this._handlers),this._core.options=t.extend({},o.Defaults,this._core.options)};o.Defaults={autoplay:!1,autoplayTimeout:5e3,autoplayHoverPause:!1,autoplaySpeed:!1},o.prototype.play=function(i,o){this._paused=!1,this._core.is("rotating")||(this._core.enter("rotating"),this._interval=e.setInterval(t.proxy(function(){this._paused||this._core.is("busy")||this._core.is("interacting")||n.hidden||this._core.next(o||this._core.settings.autoplaySpeed)},this),i||this._core.settings.autoplayTimeout))},o.prototype.stop=function(){this._core.is("rotating")&&(e.clearInterval(this._interval),this._core.leave("rotating"))},o.prototype.pause=function(){this._core.is("rotating")&&(this._paused=!0)},o.prototype.destroy=function(){var t,e;this.stop();for(t in this._handlers)this._core.$element.off(t,this._handlers[t]);for(e in Object.getOwnPropertyNames(this))"function"!=typeof this[e]&&(this[e]=null)},t.fn.owlCarousel.Constructor.Plugins.autoplay=o}(window.Zepto||window.jQuery,window,document),function(t,e,n,i){"use strict";var o=function(e){this._core=e,this._initialized=!1,this._pages=[],this._controls={},this._templates=[],this.$element=this._core.$element,this._overrides={next:this._core.next,prev:this._core.prev,to:this._core.to},this._handlers={"prepared.owl.carousel":t.proxy(function(e){e.namespace&&this._core.settings.dotsData&&this._templates.push('<div class="'+this._core.settings.dotClass+'">'+t(e.content).find("[data-dot]").andSelf("[data-dot]").attr("data-dot")+"</div>")},this),"added.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.dotsData&&this._templates.splice(t.position,0,this._templates.pop())},this),"remove.owl.carousel":t.proxy(function(t){t.namespace&&this._core.settings.dotsData&&this._templates.splice(t.position,1)},this),"changed.owl.carousel":t.proxy(function(t){t.namespace&&"position"==t.property.name&&this.draw()},this),"initialized.owl.carousel":t.proxy(function(t){t.namespace&&!this._initialized&&(this._core.trigger("initialize",null,"navigation"),this.initialize(),this.update(),this.draw(),this._initialized=!0,this._core.trigger("initialized",null,"navigation"))},this),"refreshed.owl.carousel":t.proxy(function(t){t.namespace&&this._initialized&&(this._core.trigger("refresh",null,"navigation"),this.update(),this.draw(),this._core.trigger("refreshed",null,"navigation"))},this)},this._core.options=t.extend({},o.Defaults,this._core.options),this.$element.on(this._handlers)};o.Defaults={nav:!1,navText:["prev","next"],navSpeed:!1,navElement:"div",navContainer:!1,navContainerClass:"owl-nav",navClass:["owl-prev","owl-next"],slideBy:1,dotClass:"owl-dot",dotsClass:"owl-dots",dots:!0,dotsEach:!1,dotsData:!1,dotsSpeed:!1,dotsContainer:!1},o.prototype.initialize=function(){var e,n=this._core.settings;this._controls.$relative=(n.navContainer?t(n.navContainer):t("<div>").addClass(n.navContainerClass).appendTo(this.$element)).addClass("disabled"),this._controls.$previous=t("<"+n.navElement+">").addClass(n.navClass[0]).html(n.navText[0]).prependTo(this._controls.$relative).on("click",t.proxy(function(t){this.prev(n.navSpeed)},this)),this._controls.$next=t("<"+n.navElement+">").addClass(n.navClass[1]).html(n.navText[1]).appendTo(this._controls.$relative).on("click",t.proxy(function(t){this.next(n.navSpeed)},this)),n.dotsData||(this._templates=[t("<div>").addClass(n.dotClass).append(t("<span>")).prop("outerHTML")]),this._controls.$absolute=(n.dotsContainer?t(n.dotsContainer):t("<div>").addClass(n.dotsClass).appendTo(this.$element)).addClass("disabled"),this._controls.$absolute.on("click","div",t.proxy(function(e){var i=t(e.target).parent().is(this._controls.$absolute)?t(e.target).index():t(e.target).parent().index();e.preventDefault(),this.to(i,n.dotsSpeed)},this));for(e in this._overrides)this._core[e]=t.proxy(this[e],this)},o.prototype.destroy=function(){var t,e,n,i;for(t in this._handlers)this.$element.off(t,this._handlers[t]);for(e in this._controls)this._controls[e].remove();for(i in this.overides)this._core[i]=this._overrides[i];for(n in Object.getOwnPropertyNames(this))"function"!=typeof this[n]&&(this[n]=null)},o.prototype.update=function(){var t,e,n,i=this._core.clones().length/2,o=i+this._core.items().length,s=this._core.maximum(!0),r=this._core.settings,a=r.center||r.autoWidth||r.dotsData?1:r.dotsEach||r.items;if("page"!==r.slideBy&&(r.slideBy=Math.min(r.slideBy,r.items)),r.dots||"page"==r.slideBy)for(this._pages=[],t=i,e=0,n=0;o>t;t++){if(e>=a||0===e){if(this._pages.push({start:Math.min(s,t-i),end:t-i+a-1}),Math.min(s,t-i)===s)break;e=0,++n}e+=this._core.mergers(this._core.relative(t))}},o.prototype.draw=function(){var e,n=this._core.settings,i=this._core.items().length<=n.items,o=this._core.relative(this._core.current()),s=n.loop||n.rewind;this._controls.$relative.toggleClass("disabled",!n.nav||i),n.nav&&(this._controls.$previous.toggleClass("disabled",!s&&o<=this._core.minimum(!0)),this._controls.$next.toggleClass("disabled",!s&&o>=this._core.maximum(!0))),this._controls.$absolute.toggleClass("disabled",!n.dots||i),n.dots&&(e=this._pages.length-this._controls.$absolute.children().length,n.dotsData&&0!==e?this._controls.$absolute.html(this._templates.join("")):e>0?this._controls.$absolute.append(new Array(e+1).join(this._templates[0])):0>e&&this._controls.$absolute.children().slice(e).remove(),this._controls.$absolute.find(".active").removeClass("active"),this._controls.$absolute.children().eq(t.inArray(this.current(),this._pages)).addClass("active"))},o.prototype.onTrigger=function(e){var n=this._core.settings;e.page={index:t.inArray(this.current(),this._pages),count:this._pages.length,size:n&&(n.center||n.autoWidth||n.dotsData?1:n.dotsEach||n.items)}},o.prototype.current=function(){var e=this._core.relative(this._core.current());return t.grep(this._pages,t.proxy(function(t,n){return t.start<=e&&t.end>=e},this)).pop()},o.prototype.getPosition=function(e){var n,i,o=this._core.settings;return"page"==o.slideBy?(n=t.inArray(this.current(),this._pages),i=this._pages.length,e?++n:--n,n=this._pages[(n%i+i)%i].start):(n=this._core.relative(this._core.current()),i=this._core.items().length,e?n+=o.slideBy:n-=o.slideBy),n},o.prototype.next=function(e){t.proxy(this._overrides.to,this._core)(this.getPosition(!0),e)},o.prototype.prev=function(e){t.proxy(this._overrides.to,this._core)(this.getPosition(!1),e)},o.prototype.to=function(e,n,i){var o;i?t.proxy(this._overrides.to,this._core)(e,n):(o=this._pages.length,t.proxy(this._overrides.to,this._core)(this._pages[(e%o+o)%o].start,n))},t.fn.owlCarousel.Constructor.Plugins.Navigation=o}(window.Zepto||window.jQuery,window,document),function(t,e,n,i){"use strict";var o=function(n){this._core=n,this._hashes={},this.$element=this._core.$element,this._handlers={"initialized.owl.carousel":t.proxy(function(n){n.namespace&&"URLHash"===this._core.settings.startPosition&&t(e).trigger("hashchange.owl.navigation")},this),"prepared.owl.carousel":t.proxy(function(e){if(e.namespace){var n=t(e.content).find("[data-hash]").andSelf("[data-hash]").attr("data-hash");if(!n)return;this._hashes[n]=e.content}},this),"changed.owl.carousel":t.proxy(function(n){if(n.namespace&&"position"===n.property.name){var i=this._core.items(this._core.relative(this._core.current())),o=t.map(this._hashes,function(t,e){return t===i?e:null}).join();if(!o||e.location.hash.slice(1)===o)return;e.location.hash=o}},this)},this._core.options=t.extend({},o.Defaults,this._core.options),this.$element.on(this._handlers),t(e).on("hashchange.owl.navigation",t.proxy(function(t){var n=e.location.hash.substring(1),o=this._core.$stage.children(),s=this._hashes[n]&&o.index(this._hashes[n]);s!==i&&s!==this._core.current()&&this._core.to(this._core.relative(s),!1,!0)},this))};o.Defaults={URLhashListener:!1},o.prototype.destroy=function(){var n,i;t(e).off("hashchange.owl.navigation");for(n in this._handlers)this._core.$element.off(n,this._handlers[n]);for(i in Object.getOwnPropertyNames(this))"function"!=typeof this[i]&&(this[i]=null)},t.fn.owlCarousel.Constructor.Plugins.Hash=o}(window.Zepto||window.jQuery,window,document),function(t,e,n,i){function o(e,n){var o=!1,s=e.charAt(0).toUpperCase()+e.slice(1);return t.each((e+" "+a.join(s+" ")+s).split(" "),function(t,e){return r[e]!==i?(o=!n||e,!1):void 0}),o}function s(t){return o(t,!0)}var r=t("<support>").get(0).style,a="Webkit Moz O ms".split(" "),l={transition:{end:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}},animation:{end:{WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd",animation:"animationend"}}},c={csstransforms:function(){return!!o("transform")},csstransforms3d:function(){return!!o("perspective")},csstransitions:function(){return!!o("transition")},cssanimations:function(){return!!o("animation")}};c.csstransitions()&&(t.support.transition=new String(s("transition")),t.support.transition.end=l.transition.end[t.support.transition]),c.cssanimations()&&(t.support.animation=new String(s("animation")),t.support.animation.end=l.animation.end[t.support.animation]),c.csstransforms()&&(t.support.transform=new String(s("transform")),t.support.transform3d=c.csstransforms3d())}(window.Zepto||window.jQuery,window,document);
(function(e){typeof define=="function"&&define.amd?define(["jquery"],e):typeof module=="object"&&module.exports?module.exports=function(t,n){return n===undefined&&(typeof window!="undefined"?n=require("jquery"):n=require("jquery")(t)),e(n),n}:e(jQuery)})(function(e){function A(t,n,i){typeof i=="string"&&(i={className:i}),this.options=E(w,e.isPlainObject(i)?i:{}),this.loadHTML(),this.wrapper=e(h.html),this.options.clickToHide&&this.wrapper.addClass(r+"-hidable"),this.wrapper.data(r,this),this.arrow=this.wrapper.find("."+r+"-arrow"),this.container=this.wrapper.find("."+r+"-container"),this.container.append(this.userContainer),t&&t.length&&(this.elementType=t.attr("type"),this.originalElement=t,this.elem=N(t),this.elem.data(r,this),this.elem.before(this.wrapper)),this.container.hide(),this.run(n)}var t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},n="notify",r=n+"js",i=n+"!blank",s={t:"top",m:"middle",b:"bottom",l:"left",c:"center",r:"right"},o=["l","c","r"],u=["t","m","b"],a=["t","b","l","r"],f={t:"b",m:null,b:"t",l:"r",c:null,r:"l"},l=function(t){var n;return n=[],e.each(t.split(/\W+/),function(e,t){var r;r=t.toLowerCase().charAt(0);if(s[r])return n.push(r)}),n},c={},h={name:"core",html:'<div class="'+r+'-wrapper">\n	<div class="'+r+'-arrow"></div>\n	<div class="'+r+'-container"></div>\n</div>',css:"."+r+"-corner {\n	position: fixed;\n	margin: 5px;\n	z-index: 1050;\n}\n\n."+r+"-corner ."+r+"-wrapper,\n."+r+"-corner ."+r+"-container {\n	position: relative;\n	display: block;\n	height: inherit;\n	width: inherit;\n	margin: 3px;\n}\n\n."+r+"-wrapper {\n	z-index: 1;\n	position: absolute;\n	display: inline-block;\n	height: 0;\n	width: 0;\n}\n\n."+r+"-container {\n	display: none;\n	z-index: 1;\n	position: absolute;\n}\n\n."+r+"-hidable {\n	cursor: pointer;\n}\n\n[data-notify-text],[data-notify-html] {\n	position: relative;\n}\n\n."+r+"-arrow {\n	position: absolute;\n	z-index: 2;\n	width: 0;\n	height: 0;\n}"},p={"border-radius":["-webkit-","-moz-"]},d=function(e){return c[e]},v=function(e){if(!e)throw"Missing Style name";c[e]&&delete c[e]},m=function(t,i){if(!t)throw"Missing Style name";if(!i)throw"Missing Style definition";if(!i.html)throw"Missing Style HTML";var s=c[t];s&&s.cssElem&&(window.console&&console.warn(n+": overwriting style '"+t+"'"),c[t].cssElem.remove()),i.name=t,c[t]=i;var o="";i.classes&&e.each(i.classes,function(t,n){return o+="."+r+"-"+i.name+"-"+t+" {\n",e.each(n,function(t,n){return p[t]&&e.each(p[t],function(e,r){return o+="	"+r+t+": "+n+";\n"}),o+="	"+t+": "+n+";\n"}),o+="}\n"}),i.css&&(o+="/* styles for "+i.name+" */\n"+i.css),o&&(i.cssElem=g(o),i.cssElem.attr("id","notify-"+i.name));var u={},a=e(i.html);y("html",a,u),y("text",a,u),i.fields=u},g=function(t){var n,r,i;r=x("style"),r.attr("type","text/css"),e("head").append(r);try{r.html(t)}catch(s){r[0].styleSheet.cssText=t}return r},y=function(t,n,r){var s;return t!=="html"&&(t="text"),s="data-notify-"+t,b(n,"["+s+"]").each(function(){var n;n=e(this).attr(s),n||(n=i),r[n]=t})},b=function(e,t){return e.is(t)?e:e.find(t)},w={clickToHide:!0,autoHide:!0,autoHideDelay:5e3,arrowShow:!0,arrowSize:5,breakNewLines:!0,elementPosition:"bottom",globalPosition:"top right",style:"bootstrap",className:"error",showAnimation:"slideDown",showDuration:400,hideAnimation:"slideUp",hideDuration:200,gap:5},E=function(t,n){var r;return r=function(){},r.prototype=t,e.extend(!0,new r,n)},S=function(t){return e.extend(w,t)},x=function(t){return e("<"+t+"></"+t+">")},T={},N=function(t){var n;return t.is("[type=radio]")&&(n=t.parents("form:first").find("[type=radio]").filter(function(n,r){return e(r).attr("name")===t.attr("name")}),t=n.first()),t},C=function(e,t,n){var r,i;if(typeof n=="string")n=parseInt(n,10);else if(typeof n!="number")return;if(isNaN(n))return;return r=s[f[t.charAt(0)]],i=t,e[r]!==undefined&&(t=s[r.charAt(0)],n=-n),e[t]===undefined?e[t]=n:e[t]+=n,null},k=function(e,t,n){if(e==="l"||e==="t")return 0;if(e==="c"||e==="m")return n/2-t/2;if(e==="r"||e==="b")return n-t;throw"Invalid alignment"},L=function(e){return L.e=L.e||x("div"),L.e.text(e).html()};A.prototype.loadHTML=function(){var t;t=this.getStyle(),this.userContainer=e(t.html),this.userFields=t.fields},A.prototype.show=function(e,t){var n,r,i,s,o;r=function(n){return function(){!e&&!n.elem&&n.destroy();if(t)return t()}}(this),o=this.container.parent().parents(":hidden").length>0,i=this.container.add(this.arrow),n=[];if(o&&e)s="show";else if(o&&!e)s="hide";else if(!o&&e)s=this.options.showAnimation,n.push(this.options.showDuration);else{if(!!o||!!e)return r();s=this.options.hideAnimation,n.push(this.options.hideDuration)}return n.push(r),i[s].apply(i,n)},A.prototype.setGlobalPosition=function(){var t=this.getPosition(),n=t[0],i=t[1],o=s[n],u=s[i],a=n+"|"+i,f=T[a];if(!f||!document.body.contains(f[0])){f=T[a]=x("div");var l={};l[o]=0,u==="middle"?l.top="45%":u==="center"?l.left="45%":l[u]=0,f.css(l).addClass(r+"-corner"),e("body").append(f)}return f.prepend(this.wrapper)},A.prototype.setElementPosition=function(){var n,r,i,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,L,A,O,M,_,D,P,H,B,j;H=this.getPosition(),_=H[0],O=H[1],M=H[2],g=this.elem.position(),d=this.elem.outerHeight(),y=this.elem.outerWidth(),v=this.elem.innerHeight(),m=this.elem.innerWidth(),j=this.wrapper.position(),c=this.container.height(),h=this.container.width(),T=s[_],L=f[_],A=s[L],p={},p[A]=_==="b"?d:_==="r"?y:0,C(p,"top",g.top-j.top),C(p,"left",g.left-j.left),B=["top","left"];for(w=0,S=B.length;w<S;w++)D=B[w],N=parseInt(this.elem.css("margin-"+D),10),N&&C(p,D,N);b=Math.max(0,this.options.gap-(this.options.arrowShow?i:0)),C(p,A,b);if(!this.options.arrowShow)this.arrow.hide();else{i=this.options.arrowSize,r=e.extend({},p),n=this.userContainer.css("border-color")||this.userContainer.css("border-top-color")||this.userContainer.css("background-color")||"white";for(E=0,x=a.length;E<x;E++){D=a[E],P=s[D];if(D===L)continue;l=P===T?n:"transparent",r["border-"+P]=i+"px solid "+l}C(p,s[L],i),t.call(a,O)>=0&&C(r,s[O],i*2)}t.call(u,_)>=0?(C(p,"left",k(O,h,y)),r&&C(r,"left",k(O,i,m))):t.call(o,_)>=0&&(C(p,"top",k(O,c,d)),r&&C(r,"top",k(O,i,v))),this.container.is(":visible")&&(p.display="block"),this.container.removeAttr("style").css(p);if(r)return this.arrow.removeAttr("style").css(r)},A.prototype.getPosition=function(){var e,n,r,i,s,f,c,h;h=this.options.position||(this.elem?this.options.elementPosition:this.options.globalPosition),e=l(h),e.length===0&&(e[0]="b");if(n=e[0],t.call(a,n)<0)throw"Must be one of ["+a+"]";if(e.length===1||(r=e[0],t.call(u,r)>=0)&&(i=e[1],t.call(o,i)<0)||(s=e[0],t.call(o,s)>=0)&&(f=e[1],t.call(u,f)<0))e[1]=(c=e[0],t.call(o,c)>=0)?"m":"l";return e.length===2&&(e[2]=e[1]),e},A.prototype.getStyle=function(e){var t;e||(e=this.options.style),e||(e="default"),t=c[e];if(!t)throw"Missing style: "+e;return t},A.prototype.updateClasses=function(){var t,n;return t=["base"],e.isArray(this.options.className)?t=t.concat(this.options.className):this.options.className&&t.push(this.options.className),n=this.getStyle(),t=e.map(t,function(e){return r+"-"+n.name+"-"+e}).join(" "),this.userContainer.attr("class",t)},A.prototype.run=function(t,n){var r,s,o,u,a;e.isPlainObject(n)?e.extend(this.options,n):e.type(n)==="string"&&(this.options.className=n);if(this.container&&!t){this.show(!1);return}if(!this.container&&!t)return;s={},e.isPlainObject(t)?s=t:s[i]=t;for(o in s){r=s[o],u=this.userFields[o];if(!u)continue;u==="text"&&(r=L(r),this.options.breakNewLines&&(r=r.replace(/\n/g,"<br/>"))),a=o===i?"":"="+o,b(this.userContainer,"[data-notify-"+u+a+"]").html(r)}this.updateClasses(),this.elem?this.setElementPosition():this.setGlobalPosition(),this.show(!0),this.options.autoHide&&(clearTimeout(this.autohideTimer),this.autohideTimer=setTimeout(this.show.bind(this,!1),this.options.autoHideDelay))},A.prototype.destroy=function(){this.wrapper.data(r,null),this.wrapper.remove()},e[n]=function(t,r,i){return t&&t.nodeName||t.jquery?e(t)[n](r,i):(i=r,r=t,new A(null,r,i)),t},e.fn[n]=function(t,n){return e(this).each(function(){var i=N(e(this)).data(r);i&&i.destroy();var s=new A(e(this),t,n)}),this},e.extend(e[n],{defaults:S,addStyle:m,removeStyle:v,pluginOptions:w,getStyle:d,insertCSS:g}),m("bootstrap",{html:"<div>\n<span data-notify-text></span>\n</div>",classes:{base:{"font-weight":"bold",padding:"8px 15px 8px 14px","text-shadow":"0 1px 0 rgba(255, 255, 255, 0.5)","background-color":"#fcf8e3",border:"1px solid #fbeed5","border-radius":"4px","white-space":"nowrap","padding-left":"25px","background-repeat":"no-repeat","background-position":"3px 7px"},error:{color:"#B94A48","background-color":"#F2DEDE","border-color":"#EED3D7","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAtRJREFUeNqkVc1u00AQHq+dOD+0poIQfkIjalW0SEGqRMuRnHos3DjwAH0ArlyQeANOOSMeAA5VjyBxKBQhgSpVUKKQNGloFdw4cWw2jtfMOna6JOUArDTazXi/b3dm55socPqQhFka++aHBsI8GsopRJERNFlY88FCEk9Yiwf8RhgRyaHFQpPHCDmZG5oX2ui2yilkcTT1AcDsbYC1NMAyOi7zTX2Agx7A9luAl88BauiiQ/cJaZQfIpAlngDcvZZMrl8vFPK5+XktrWlx3/ehZ5r9+t6e+WVnp1pxnNIjgBe4/6dAysQc8dsmHwPcW9C0h3fW1hans1ltwJhy0GxK7XZbUlMp5Ww2eyan6+ft/f2FAqXGK4CvQk5HueFz7D6GOZtIrK+srupdx1GRBBqNBtzc2AiMr7nPplRdKhb1q6q6zjFhrklEFOUutoQ50xcX86ZlqaZpQrfbBdu2R6/G19zX6XSgh6RX5ubyHCM8nqSID6ICrGiZjGYYxojEsiw4PDwMSL5VKsC8Yf4VRYFzMzMaxwjlJSlCyAQ9l0CW44PBADzXhe7xMdi9HtTrdYjFYkDQL0cn4Xdq2/EAE+InCnvADTf2eah4Sx9vExQjkqXT6aAERICMewd/UAp/IeYANM2joxt+q5VI+ieq2i0Wg3l6DNzHwTERPgo1ko7XBXj3vdlsT2F+UuhIhYkp7u7CarkcrFOCtR3H5JiwbAIeImjT/YQKKBtGjRFCU5IUgFRe7fF4cCNVIPMYo3VKqxwjyNAXNepuopyqnld602qVsfRpEkkz+GFL1wPj6ySXBpJtWVa5xlhpcyhBNwpZHmtX8AGgfIExo0ZpzkWVTBGiXCSEaHh62/PoR0p/vHaczxXGnj4bSo+G78lELU80h1uogBwWLf5YlsPmgDEd4M236xjm+8nm4IuE/9u+/PH2JXZfbwz4zw1WbO+SQPpXfwG/BBgAhCNZiSb/pOQAAAAASUVORK5CYII=)"},success:{color:"#468847","background-color":"#DFF0D8","border-color":"#D6E9C6","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAutJREFUeNq0lctPE0Ecx38zu/RFS1EryqtgJFA08YCiMZIAQQ4eRG8eDGdPJiYeTIwHTfwPiAcvXIwXLwoXPaDxkWgQ6islKlJLSQWLUraPLTv7Gme32zoF9KSTfLO7v53vZ3d/M7/fIth+IO6INt2jjoA7bjHCJoAlzCRw59YwHYjBnfMPqAKWQYKjGkfCJqAF0xwZjipQtA3MxeSG87VhOOYegVrUCy7UZM9S6TLIdAamySTclZdYhFhRHloGYg7mgZv1Zzztvgud7V1tbQ2twYA34LJmF4p5dXF1KTufnE+SxeJtuCZNsLDCQU0+RyKTF27Unw101l8e6hns3u0PBalORVVVkcaEKBJDgV3+cGM4tKKmI+ohlIGnygKX00rSBfszz/n2uXv81wd6+rt1orsZCHRdr1Imk2F2Kob3hutSxW8thsd8AXNaln9D7CTfA6O+0UgkMuwVvEFFUbbAcrkcTA8+AtOk8E6KiQiDmMFSDqZItAzEVQviRkdDdaFgPp8HSZKAEAL5Qh7Sq2lIJBJwv2scUqkUnKoZgNhcDKhKg5aH+1IkcouCAdFGAQsuWZYhOjwFHQ96oagWgRoUov1T9kRBEODAwxM2QtEUl+Wp+Ln9VRo6BcMw4ErHRYjH4/B26AlQoQQTRdHWwcd9AH57+UAXddvDD37DmrBBV34WfqiXPl61g+vr6xA9zsGeM9gOdsNXkgpEtTwVvwOklXLKm6+/p5ezwk4B+j6droBs2CsGa/gNs6RIxazl4Tc25mpTgw/apPR1LYlNRFAzgsOxkyXYLIM1V8NMwyAkJSctD1eGVKiq5wWjSPdjmeTkiKvVW4f2YPHWl3GAVq6ymcyCTgovM3FzyRiDe2TaKcEKsLpJvNHjZgPNqEtyi6mZIm4SRFyLMUsONSSdkPeFtY1n0mczoY3BHTLhwPRy9/lzcziCw9ACI+yql0VLzcGAZbYSM5CCSZg1/9oc/nn7+i8N9p/8An4JMADxhH+xHfuiKwAAAABJRU5ErkJggg==)"},info:{color:"#3A87AD","background-color":"#D9EDF7","border-color":"#BCE8F1","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QYFAhkSsdes/QAAA8dJREFUOMvVlGtMW2UYx//POaWHXg6lLaW0ypAtw1UCgbniNOLcVOLmAjHZolOYlxmTGXVZdAnRfXQm+7SoU4mXaOaiZsEpC9FkiQs6Z6bdCnNYruM6KNBw6YWewzl9z+sHImEWv+vz7XmT95f/+3/+7wP814v+efDOV3/SoX3lHAA+6ODeUFfMfjOWMADgdk+eEKz0pF7aQdMAcOKLLjrcVMVX3xdWN29/GhYP7SvnP0cWfS8caSkfHZsPE9Fgnt02JNutQ0QYHB2dDz9/pKX8QjjuO9xUxd/66HdxTeCHZ3rojQObGQBcuNjfplkD3b19Y/6MrimSaKgSMmpGU5WevmE/swa6Oy73tQHA0Rdr2Mmv/6A1n9w9suQ7097Z9lM4FlTgTDrzZTu4StXVfpiI48rVcUDM5cmEksrFnHxfpTtU/3BFQzCQF/2bYVoNbH7zmItbSoMj40JSzmMyX5qDvriA7QdrIIpA+3cdsMpu0nXI8cV0MtKXCPZev+gCEM1S2NHPvWfP/hL+7FSr3+0p5RBEyhEN5JCKYr8XnASMT0xBNyzQGQeI8fjsGD39RMPk7se2bd5ZtTyoFYXftF6y37gx7NeUtJJOTFlAHDZLDuILU3j3+H5oOrD3yWbIztugaAzgnBKJuBLpGfQrS8wO4FZgV+c1IxaLgWVU0tMLEETCos4xMzEIv9cJXQcyagIwigDGwJgOAtHAwAhisQUjy0ORGERiELgG4iakkzo4MYAxcM5hAMi1WWG1yYCJIcMUaBkVRLdGeSU2995TLWzcUAzONJ7J6FBVBYIggMzmFbvdBV44Corg8vjhzC+EJEl8U1kJtgYrhCzgc/vvTwXKSib1paRFVRVORDAJAsw5FuTaJEhWM2SHB3mOAlhkNxwuLzeJsGwqWzf5TFNdKgtY5qHp6ZFf67Y/sAVadCaVY5YACDDb3Oi4NIjLnWMw2QthCBIsVhsUTU9tvXsjeq9+X1d75/KEs4LNOfcdf/+HthMnvwxOD0wmHaXr7ZItn2wuH2SnBzbZAbPJwpPx+VQuzcm7dgRCB57a1uBzUDRL4bfnI0RE0eaXd9W89mpjqHZnUI5Hh2l2dkZZUhOqpi2qSmpOmZ64Tuu9qlz/SEXo6MEHa3wOip46F1n7633eekV8ds8Wxjn37Wl63VVa+ej5oeEZ/82ZBETJjpJ1Rbij2D3Z/1trXUvLsblCK0XfOx0SX2kMsn9dX+d+7Kf6h8o4AIykuffjT8L20LU+w4AZd5VvEPY+XpWqLV327HR7DzXuDnD8r+ovkBehJ8i+y8YAAAAASUVORK5CYII=)"},warn:{color:"#C09853","background-color":"#FCF8E3","border-color":"#FBEED5","background-image":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABJlBMVEXr6eb/2oD/wi7/xjr/0mP/ykf/tQD/vBj/3o7/uQ//vyL/twebhgD/4pzX1K3z8e349vK6tHCilCWbiQymn0jGworr6dXQza3HxcKkn1vWvV/5uRfk4dXZ1bD18+/52YebiAmyr5S9mhCzrWq5t6ufjRH54aLs0oS+qD751XqPhAybhwXsujG3sm+Zk0PTwG6Shg+PhhObhwOPgQL4zV2nlyrf27uLfgCPhRHu7OmLgAafkyiWkD3l49ibiAfTs0C+lgCniwD4sgDJxqOilzDWowWFfAH08uebig6qpFHBvH/aw26FfQTQzsvy8OyEfz20r3jAvaKbhgG9q0nc2LbZxXanoUu/u5WSggCtp1anpJKdmFz/zlX/1nGJiYmuq5Dx7+sAAADoPUZSAAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfdBgUBGhh4aah5AAAAlklEQVQY02NgoBIIE8EUcwn1FkIXM1Tj5dDUQhPU502Mi7XXQxGz5uVIjGOJUUUW81HnYEyMi2HVcUOICQZzMMYmxrEyMylJwgUt5BljWRLjmJm4pI1hYp5SQLGYxDgmLnZOVxuooClIDKgXKMbN5ggV1ACLJcaBxNgcoiGCBiZwdWxOETBDrTyEFey0jYJ4eHjMGWgEAIpRFRCUt08qAAAAAElFTkSuQmCC)"}}}),e(function(){g(h.css).attr("id","core-notify"),e(document).on("click","."+r+"-hidable",function(t){e(this).trigger("notify-hide")}),e(document).on("notify-hide","."+r+"-wrapper",function(t){var n=e(this).data(r);n&&n.show(!1)})})})

$.notify.addStyle("needs-login", 
{
  html: "<div><span data-notify-text/>" + 
          "<button class='input-field button' onclick='navigation_load_page(\"login\");'>Login</button>" + 
          "<button class='input-field button' onclick='navigation_load_page(\"sign-up\");'>Sign Up</button>" + 
        "</div>",
  classes: 
    {
      base: 
        {
          "background-color": "rgb(240, 244, 248)",
          "padding": "10px",
          "opacity": "0.95",
          "border-radius": "7px",
          "box-shadow" : "0px 0px 8px #444",
          "max-width" : "300px",
          "text-align" : "center",
        },
      notification: 
        {
  
        },
      success: 
        {

        },
      error: 
        {

        },
    }
});

$.notify.addStyle("ic", 
{
  html: "<div><span data-notify-text/>" + 
        "</div>",
  classes: 
    {
      base: 
        {
          "background-color": "rgb(240, 244, 248)",
          "padding": "10px",
          "opacity": "0.95",
          "border-radius": "7px",
          "box-shadow" : "0px 0px 8px #444",
          "max-width" : "300px",
          "text-align" : "center",
        },
      notification: 
        {
  
        },
      success: 
        {

        },
      error: 
        {

        },
    }
});

$.notify.defaults
({
  position: "top left", 
  className: "default", 
  style: "needs-login", 
  autoHideDelay:5000
});


// threejs.org/license
'use strict';var THREE={REVISION:"73"};"function"===typeof define&&define.amd?define("three",THREE):"undefined"!==typeof exports&&"undefined"!==typeof module&&(module.exports=THREE);
void 0!==self.requestAnimationFrame&&void 0!==self.cancelAnimationFrame||function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!self.requestAnimationFrame;++c)self.requestAnimationFrame=self[b[c]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[b[c]+"CancelAnimationFrame"]||self[b[c]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(b){var c=Date.now(),g=Math.max(0,16-(c-a)),f=self.setTimeout(function(){b(c+
g)},g);a=c+g;return f});void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(a){self.clearTimeout(a)})}();void 0===self.performance&&(self.performance={});void 0===self.performance.now&&function(){var a=Date.now();self.performance.now=function(){return Date.now()-a}}();void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52));void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});
void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}});THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;
THREE.DoubleSide=2;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.MinEquation=103;THREE.MaxEquation=104;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;
THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.NeverDepth=0;THREE.AlwaysDepth=1;THREE.LessDepth=2;THREE.LessEqualDepth=3;THREE.EqualDepth=4;THREE.GreaterEqualDepth=5;THREE.GreaterDepth=6;THREE.NotEqualDepth=7;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=300;THREE.CubeReflectionMapping=301;
THREE.CubeRefractionMapping=302;THREE.EquirectangularReflectionMapping=303;THREE.EquirectangularRefractionMapping=304;THREE.SphericalReflectionMapping=305;THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;
THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.HalfFloatType=1025;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGBEFormat=THREE.RGBAFormat;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;
THREE.RGBA_S3TC_DXT5_Format=2004;THREE.RGB_PVRTC_4BPPV1_Format=2100;THREE.RGB_PVRTC_2BPPV1_Format=2101;THREE.RGBA_PVRTC_4BPPV1_Format=2102;THREE.RGBA_PVRTC_2BPPV1_Format=2103;THREE.LoopOnce=2200;THREE.LoopRepeat=2201;THREE.LoopPingPong=2202;
THREE.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(a,b){console.warn("THREE.Projector: .projectVector() is now vector.project().");a.project(b)};this.unprojectVector=function(a,b){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");a.unproject(b)};this.pickingRay=function(a,b){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};
THREE.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");this.domElement=document.createElement("canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}};THREE.Color=function(a){return 3===arguments.length?this.fromArray(arguments):this.set(a)};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){a instanceof THREE.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(){function a(a,c,d){0>d&&(d+=1);1<d&&(d-=1);return d<1/6?a+6*(c-a)*d:.5>d?c:d<2/3?a+6*(c-a)*(2/3-d):a}return function(b,
c,d){b=THREE.Math.euclideanModulo(b,1);c=THREE.Math.clamp(c,0,1);d=THREE.Math.clamp(d,0,1);0===c?this.r=this.g=this.b=d:(c=.5>=d?d*(1+c):d+c-d*c,d=2*d-c,this.r=a(d,c,b+1/3),this.g=a(d,c,b),this.b=a(d,c,b-1/3));return this}}(),setStyle:function(a){function b(b){void 0!==b&&1>parseFloat(b)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}var c;if(c=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(a)){var d=c[2];switch(c[1]){case "rgb":case "rgba":if(c=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=
Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,b(c[5]),this;if(c=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,b(c[5]),this;break;case "hsl":case "hsla":if(c=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d)){var d=parseFloat(c[1])/
360,e=parseInt(c[2],10)/100,g=parseInt(c[3],10)/100;b(c[5]);return this.setHSL(d,e,g)}}}else if(c=/^\#([A-Fa-f0-9]+)$/.exec(a)){c=c[1];d=c.length;if(3===d)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===d)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}a&&0<a.length&&(c=THREE.ColorKeywords[a],
void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+a));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){void 0===b&&(b=2);this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);var c=0<b?1/b:1;this.r=Math.pow(a.r,c);this.g=Math.pow(a.g,c);this.b=Math.pow(a.b,c);return this},convertGammaToLinear:function(){var a=
this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),g=Math.min(b,c,d),f,h=(g+e)/2;if(g===e)g=f=0;else{var l=e-g,g=.5>=h?l/(e+g):
l/(2-e-g);switch(e){case b:f=(c-d)/l+(c<d?6:0);break;case c:f=(d-b)/l+2;break;case d:f=(b-c)/l+4}f/=6}a.h=f;a.s=g;a.l=h;return a},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,b,c){var d=this.getHSL();d.h+=a;d.s+=b;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=
a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a,b){void 0===b&&(b=0);this.r=a[b];this.g=a[b+1];this.b=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=
this.r;a[b+1]=this.g;a[b+2]=this.b;return a}};
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get w(){return this._w},set w(a){this._w=a;this.onChangeCallback()},set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},
copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!1===a instanceof THREE.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var c=Math.cos(a._x/2),d=Math.cos(a._y/2),e=Math.cos(a._z/2),g=Math.sin(a._x/2),f=Math.sin(a._y/2),h=Math.sin(a._z/2),l=a.order;"XYZ"===l?(this._x=g*d*e+c*f*h,this._y=c*f*e-g*d*h,this._z=c*d*h+g*f*e,this._w=c*d*e-g*f*h):"YXZ"===
l?(this._x=g*d*e+c*f*h,this._y=c*f*e-g*d*h,this._z=c*d*h-g*f*e,this._w=c*d*e+g*f*h):"ZXY"===l?(this._x=g*d*e-c*f*h,this._y=c*f*e+g*d*h,this._z=c*d*h+g*f*e,this._w=c*d*e-g*f*h):"ZYX"===l?(this._x=g*d*e-c*f*h,this._y=c*f*e+g*d*h,this._z=c*d*h-g*f*e,this._w=c*d*e+g*f*h):"YZX"===l?(this._x=g*d*e+c*f*h,this._y=c*f*e+g*d*h,this._z=c*d*h-g*f*e,this._w=c*d*e-g*f*h):"XZY"===l&&(this._x=g*d*e-c*f*h,this._y=c*f*e-g*d*h,this._z=c*d*h+g*f*e,this._w=c*d*e+g*f*h);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,
b){var c=b/2,d=Math.sin(c);this._x=a.x*d;this._y=a.y*d;this._z=a.z*d;this._w=Math.cos(c);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],g=b[5],f=b[9],h=b[2],l=b[6],b=b[10],k=c+g+b;0<k?(c=.5/Math.sqrt(k+1),this._w=.25/c,this._x=(l-f)*c,this._y=(d-h)*c,this._z=(e-a)*c):c>g&&c>b?(c=2*Math.sqrt(1+c-g-b),this._w=(l-f)/c,this._x=.25*c,this._y=(a+e)/c,this._z=(d+h)/c):g>b?(c=2*Math.sqrt(1+g-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=
.25*c,this._z=(f+l)/c):(c=2*Math.sqrt(1+b-c-g),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(f+l)/c,this._z=.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector3);b=c.dot(d)+1;1E-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,d);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=
-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},
multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z,g=a._w,f=b._x,h=b._y,l=b._z,k=b._w;this._x=c*k+g*f+d*l-e*h;this._y=d*k+g*h+e*f-c*l;this._z=e*k+g*l+c*h-d*f;this._w=g*k-c*f-d*h-e*l;this.onChangeCallback();return this},multiplyVector3:function(a){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");
return a.applyQuaternion(this)},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,g=this._w,f=g*a._w+c*a._x+d*a._y+e*a._z;0>f?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,f=-f):this.copy(a);if(1<=f)return this._w=g,this._x=c,this._y=d,this._z=e,this;var h=Math.acos(f),l=Math.sqrt(1-f*f);if(.001>Math.abs(l))return this._w=.5*(g+this._w),this._x=.5*(c+this._x),this._y=.5*(d+this._y),this._z=.5*(e+this._z),this;f=Math.sin((1-b)*h)/l;h=
Math.sin(b*h)/l;this._w=g*f+this._w*h;this._x=c*f+this._x*h;this._y=d*f+this._y*h;this._z=e*f+this._z*h;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=
a;return this},onChangeCallback:function(){}};THREE.Quaternion.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,get width(){return this.x},set width(a){this.x=a},get height(){return this.y},set height(a){this.y=a},set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+
a);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;return this},
sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){isFinite(a)?(this.x*=a,this.y*=a):this.y=this.x=0;return this},divide:function(a){this.x/=a.x;
this.y/=a.y;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector2,b=new THREE.Vector2);a.set(c,c);b.set(d,d);return this.clamp(a,
b)}}(),clampLength:function(a,b){var c=this.length();this.multiplyScalar(Math.max(a,Math.min(b,c))/c);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=
-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){return this.multiplyScalar(a/
this.length())},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},lerpVectors:function(a,b,c){this.subVectors(b,a).multiplyScalar(c).add(a);return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromAttribute:function(a,b,c){void 0===c&&(c=0);b=b*a.itemSize+c;this.x=a.array[b];this.y=
a.array[b+1];return this},rotateAround:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=this.x-a.x,g=this.y-a.y;this.x=e*c-g*d+a.x;this.y=e*d+g*c+a.y;return this}};THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
a);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(a,
b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),
this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){isFinite(a)?(this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a;return function(b){!1===b instanceof THREE.Euler&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.");void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromEuler(b));
return this}}(),applyAxisAngle:function(){var a;return function(b,c){void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromAxisAngle(b,c));return this}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];
return this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,g=a.y,f=a.z;a=a.w;var h=a*b+g*d-f*c,l=a*c+f*b-e*d,k=a*d+e*c-g*b,b=-e*b-g*c-f*d;this.x=h*a+b*-e+l*-f-k*-g;this.y=l*a+b*-g+k*-e-h*-f;this.z=k*a+b*-f+h*-g-l*-e;return this},project:function(){var a;
return function(b){void 0===a&&(a=new THREE.Matrix4);a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyProjection(a)}}(),unproject:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyProjection(a)}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;this.normalize();
return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){return this.multiplyScalar(1/a)},min:function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,
this.z));return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector3,b=new THREE.Vector3);a.set(c,c,c);b.set(d,d,d);return this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();this.multiplyScalar(Math.max(a,Math.min(b,c))/c);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},
round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},
length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,b,c){this.subVectors(b,a).multiplyScalar(c).add(a);return this},cross:function(a,b){if(void 0!==
b)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,d=this.y,e=this.z;this.x=d*a.z-e*a.y;this.y=e*a.x-c*a.z;this.z=c*a.y-d*a.x;return this},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,g=b.x,f=b.y,h=b.z;this.x=d*h-e*f;this.y=e*g-c*h;this.z=c*f-d*g;return this},projectOnVector:function(){var a,b;return function(c){void 0===a&&(a=new THREE.Vector3);a.copy(c).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),
projectOnPlane:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=
this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},setEulerFromRotationMatrix:function(a,b){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(a,b){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(a)},
getScaleFromMatrix:function(a){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(a,b)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],
a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;return this},setFromMatrixColumn:function(a,b){var c=4*a,d=b.elements;this.x=d[c];this.y=d[c+1];this.z=d[c+2];return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===
a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromAttribute:function(a,b,c){void 0===c&&(c=0);b=b*a.itemSize+c;this.x=a.array[b];this.y=a.array[b+1];this.z=a.array[b+2];return this}};THREE.Vector4=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},
addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(a,b){this.x+=a.x*b;this.y+=a.y*b;this.z+=a.z*b;this.w+=a.w*b;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=
a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){isFinite(a)?(this.x*=a,this.y*=a,this.z*=a,this.w*=a):this.w=this.z=this.y=this.x=0;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},
divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,c,d;a=a.elements;var e=a[0];d=a[4];var g=a[8],f=a[1],h=a[5],l=a[9];c=a[2];b=a[6];var k=a[10];if(.01>Math.abs(d-f)&&.01>Math.abs(g-c)&&.01>Math.abs(l-b)){if(.1>Math.abs(d+f)&&.1>Math.abs(g+c)&&.1>Math.abs(l+b)&&.1>Math.abs(e+
h+k-3))return this.set(1,0,0,0),this;a=Math.PI;e=(e+1)/2;h=(h+1)/2;k=(k+1)/2;d=(d+f)/4;g=(g+c)/4;l=(l+b)/4;e>h&&e>k?.01>e?(b=0,d=c=.707106781):(b=Math.sqrt(e),c=d/b,d=g/b):h>k?.01>h?(b=.707106781,c=0,d=.707106781):(c=Math.sqrt(h),b=d/c,d=l/c):.01>k?(c=b=.707106781,d=0):(d=Math.sqrt(k),b=g/d,c=l/d);this.set(b,c,d,a);return this}a=Math.sqrt((b-l)*(b-l)+(g-c)*(g-c)+(f-d)*(f-d));.001>Math.abs(a)&&(a=1);this.x=(b-l)/a;this.y=(g-c)/a;this.z=(f-d)/a;this.w=Math.acos((e+h+k-1)/2);return this},min:function(a){this.x=
Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.z=Math.min(this.z,a.z);this.w=Math.min(this.w,a.w);return this},max:function(a){this.x=Math.max(this.x,a.x);this.y=Math.max(this.y,a.y);this.z=Math.max(this.z,a.z);this.w=Math.max(this.w,a.w);return this},clamp:function(a,b){this.x=Math.max(a.x,Math.min(b.x,this.x));this.y=Math.max(a.y,Math.min(b.y,this.y));this.z=Math.max(a.z,Math.min(b.z,this.z));this.w=Math.max(a.w,Math.min(b.w,this.w));return this},clampScalar:function(){var a,b;return function(c,
d){void 0===a&&(a=new THREE.Vector4,b=new THREE.Vector4);a.set(c,c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},
roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){return this.multiplyScalar(a/this.length())},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,b,c){this.subVectors(b,a).multiplyScalar(c).add(a);return this},equals:function(a){return a.x===
this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromAttribute:function(a,b,c){void 0===c&&(c=0);b=b*a.itemSize+c;this.x=a.array[b];this.y=a.array[b+1];this.z=a.array[b+2];this.w=a.array[b+3];return this}};
THREE.Euler=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";
THREE.Euler.prototype={constructor:THREE.Euler,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get order(){return this._order},set order(a){this._order=a;this.onChangeCallback()},set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,
this._y,this._z,this._order)},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var d=THREE.Math.clamp,e=a.elements;a=e[0];var g=e[4],f=e[8],h=e[1],l=e[5],k=e[9],m=e[2],p=e[6],e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(d(f,-1,1)),.99999>Math.abs(f)?(this._x=Math.atan2(-k,e),this._z=Math.atan2(-g,a)):(this._x=Math.atan2(p,l),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(k,-1,1)),.99999>Math.abs(k)?
(this._y=Math.atan2(f,e),this._z=Math.atan2(h,l)):(this._y=Math.atan2(-m,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(p,-1,1)),.99999>Math.abs(p)?(this._y=Math.atan2(-m,e),this._z=Math.atan2(-g,l)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(m,-1,1)),.99999>Math.abs(m)?(this._x=Math.atan2(p,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-g,l))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-k,l),this._y=Math.atan2(-m,a)):(this._x=
0,this._y=Math.atan2(f,e))):"XZY"===b?(this._z=Math.asin(-d(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(p,l),this._y=Math.atan2(f,a)):(this._x=Math.atan2(-k,e),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Matrix4);a.makeRotationFromQuaternion(b);this.setFromRotationMatrix(a,c,d);return this}}(),setFromVector3:function(a,
b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new THREE.Quaternion;return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+
3]=this._order;return a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){}};THREE.Line3=function(a,b){this.start=void 0!==a?a:new THREE.Vector3;this.end=void 0!==b?b:new THREE.Vector3};
THREE.Line3.prototype={constructor:THREE.Line3,set:function(a,b){this.start.copy(a);this.end.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},center:function(a){return(a||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(a){return(a||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},
at:function(a,b){var c=b||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);var e=b.dot(b),e=b.dot(a)/e;d&&(e=THREE.Math.clamp(e,0,1));return e}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);c=c||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)}};THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new THREE.Vector2;return function(b,c){var d=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);
return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);
this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>
this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&
a.max.equals(this.max)}};THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},setFromCenterAndSize:function(){var a=new THREE.Vector3;return function(b,c){var d=a.copy(c).multiplyScalar(.5);this.min.copy(b).sub(d);this.max.copy(b).add(d);return this}}(),setFromObject:function(){var a=new THREE.Vector3;return function(b){var c=this;b.updateMatrixWorld(!0);
this.makeEmpty();b.traverse(function(b){var e=b.geometry;if(void 0!==e)if(e instanceof THREE.Geometry)for(var g=e.vertices,e=0,f=g.length;e<f;e++)a.copy(g[e]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a);else if(e instanceof THREE.BufferGeometry&&void 0!==e.attributes.position)for(g=e.attributes.position.array,e=0,f=g.length;e<f;e+=3)a.set(g[e],g[e+1],g[e+2]),a.applyMatrix4(b.matrixWorld),c.expandByPoint(a)});return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.min.copy(a.min);
this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);
this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector3).set((a.x-this.min.x)/(this.max.x-
this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=
new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,
this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);
this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)}};THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,d,e,g,f,h,l){var k=this.elements;k[0]=a;k[3]=b;k[6]=c;k[1]=d;k[4]=e;k[7]=g;k[2]=f;k[5]=h;k[8]=l;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");
return a.applyMatrix3(this)},multiplyVector3Array:function(a){console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(a)},applyToVector3Array:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Vector3);void 0===c&&(c=0);void 0===d&&(d=b.length);for(var e=0;e<d;e+=3,c+=3)a.fromArray(b,c),a.applyMatrix3(this),a.toArray(b,c);return b}}(),applyToBuffer:function(){var a;return function(b,c,d){void 0===
a&&(a=new THREE.Vector3);void 0===c&&(c=0);void 0===d&&(d=b.length/b.itemSize);for(var e=0;e<d;e++,c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(a.x,a.y,a.z);return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],g=a[4],f=a[5],h=a[6],l=a[7],a=a[8];return b*g*a-b*f*l-c*e*a+c*f*h+d*e*l-d*g*h},getInverse:function(a,
b){var c=a.elements,d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/
c);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=
b[2];a[7]=b[5];a[8]=b[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]}};THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,e,g,f,h,l,k,m,p,n,q,s,t){var v=this.elements;v[0]=a;v[4]=b;v[8]=c;v[12]=d;v[1]=e;v[5]=g;v[9]=f;v[13]=h;v[2]=l;v[6]=k;v[10]=m;v[14]=p;v[3]=n;v[7]=q;v[11]=s;v[15]=t;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)},copy:function(a){this.elements.set(a.elements);return this},extractPosition:function(a){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");
return this.copyPosition(a)},copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){var d=this.elements;a.set(d[0],d[1],d[2]);b.set(d[4],d[5],d[6]);c.set(d[8],d[9],d[10]);return this},makeBasis:function(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);var c=this.elements;b=b.elements;var d=1/a.set(b[0],
b[1],b[2]).length(),e=1/a.set(b[4],b[5],b[6]).length(),g=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[4]=b[4]*e;c[5]=b[5]*e;c[6]=b[6]*e;c[8]=b[8]*g;c[9]=b[9]*g;c[10]=b[10]*g;return this}}(),makeRotationFromEuler:function(a){!1===a instanceof THREE.Euler&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,d=a.y,e=a.z,g=Math.cos(c),c=Math.sin(c),f=Math.cos(d),d=Math.sin(d),h=Math.cos(e),
e=Math.sin(e);if("XYZ"===a.order){a=g*h;var l=g*e,k=c*h,m=c*e;b[0]=f*h;b[4]=-f*e;b[8]=d;b[1]=l+k*d;b[5]=a-m*d;b[9]=-c*f;b[2]=m-a*d;b[6]=k+l*d;b[10]=g*f}else"YXZ"===a.order?(a=f*h,l=f*e,k=d*h,m=d*e,b[0]=a+m*c,b[4]=k*c-l,b[8]=g*d,b[1]=g*e,b[5]=g*h,b[9]=-c,b[2]=l*c-k,b[6]=m+a*c,b[10]=g*f):"ZXY"===a.order?(a=f*h,l=f*e,k=d*h,m=d*e,b[0]=a-m*c,b[4]=-g*e,b[8]=k+l*c,b[1]=l+k*c,b[5]=g*h,b[9]=m-a*c,b[2]=-g*d,b[6]=c,b[10]=g*f):"ZYX"===a.order?(a=g*h,l=g*e,k=c*h,m=c*e,b[0]=f*h,b[4]=k*d-l,b[8]=a*d+m,b[1]=f*e,b[5]=
m*d+a,b[9]=l*d-k,b[2]=-d,b[6]=c*f,b[10]=g*f):"YZX"===a.order?(a=g*f,l=g*d,k=c*f,m=c*d,b[0]=f*h,b[4]=m-a*e,b[8]=k*e+l,b[1]=e,b[5]=g*h,b[9]=-c*h,b[2]=-d*h,b[6]=l*e+k,b[10]=a-m*e):"XZY"===a.order&&(a=g*f,l=g*d,k=c*f,m=c*d,b[0]=f*h,b[4]=-e,b[8]=d*h,b[1]=a*e+m,b[5]=g*h,b[9]=l*e-k,b[2]=k*e-l,b[6]=c*h,b[10]=m*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");
return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,g=a.w,f=c+c,h=d+d,l=e+e;a=c*f;var k=c*h,c=c*l,m=d*h,d=d*l,e=e*l,f=g*f,h=g*h,g=g*l;b[0]=1-(m+e);b[4]=k-g;b[8]=c+h;b[1]=k+g;b[5]=1-(a+e);b[9]=d-f;b[2]=c-h;b[6]=d+f;b[10]=1-(a+m);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a,b,c;return function(d,e,g){void 0===a&&(a=new THREE.Vector3);void 0===b&&(b=new THREE.Vector3);void 0===c&&(c=new THREE.Vector3);
var f=this.elements;c.subVectors(d,e).normalize();0===c.lengthSq()&&(c.z=1);a.crossVectors(g,c).normalize();0===a.lengthSq()&&(c.x+=1E-4,a.crossVectors(g,c).normalize());b.crossVectors(c,a);f[0]=a.x;f[4]=b.x;f[8]=c.x;f[1]=a.y;f[5]=b.y;f[9]=c.y;f[2]=a.z;f[6]=b.z;f[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},
multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,g=c[0],f=c[4],h=c[8],l=c[12],k=c[1],m=c[5],p=c[9],n=c[13],q=c[2],s=c[6],t=c[10],v=c[14],u=c[3],w=c[7],D=c[11],c=c[15],x=d[0],B=d[4],y=d[8],z=d[12],A=d[1],J=d[5],F=d[9],C=d[13],N=d[2],L=d[6],Q=d[10],M=d[14],K=d[3],E=d[7],O=d[11],d=d[15];e[0]=g*x+f*A+h*N+l*K;e[4]=g*B+f*J+h*L+l*E;e[8]=g*y+f*F+h*Q+l*O;e[12]=g*z+f*C+h*M+l*d;e[1]=k*x+m*A+p*N+n*K;e[5]=k*B+m*J+p*L+n*E;e[9]=k*y+m*F+p*Q+n*O;e[13]=k*z+m*C+p*M+n*d;e[2]=q*x+s*A+t*N+v*
K;e[6]=q*B+s*J+t*L+v*E;e[10]=q*y+s*F+t*Q+v*O;e[14]=q*z+s*C+t*M+v*d;e[3]=u*x+w*A+D*N+c*K;e[7]=u*B+w*J+D*L+c*E;e[11]=u*y+w*F+D*Q+c*O;e[15]=u*z+w*C+D*M+c*d;return this},multiplyToArray:function(a,b,c){var d=this.elements;this.multiplyMatrices(a,b);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;
b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return a.applyProjection(this)},multiplyVector4:function(a){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(a){console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");
return this.applyToVector3Array(a)},applyToVector3Array:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Vector3);void 0===c&&(c=0);void 0===d&&(d=b.length);for(var e=0;e<d;e+=3,c+=3)a.fromArray(b,c),a.applyMatrix4(this),a.toArray(b,c);return b}}(),applyToBuffer:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Vector3);void 0===c&&(c=0);void 0===d&&(d=b.length/b.itemSize);for(var e=0;e<d;e++,c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix4(this),b.setXYZ(a.x,
a.y,a.z);return b}}(),rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],g=a[1],f=a[5],h=a[9],l=a[13],k=a[2],m=a[6],p=a[10],n=a[14];return a[3]*(+e*h*m-d*l*
m-e*f*p+c*l*p+d*f*n-c*h*n)+a[7]*(+b*h*n-b*l*p+e*g*p-d*g*n+d*l*k-e*h*k)+a[11]*(+b*l*m-b*f*n-e*g*m+c*g*n+e*f*k-c*l*k)+a[15]*(-d*f*k-b*h*m+b*f*p+d*g*m-c*g*p+c*h*k)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=
c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a;return function(){void 0===a&&(a=new THREE.Vector3);console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=
this.elements,d=a.elements,e=d[0],g=d[4],f=d[8],h=d[12],l=d[1],k=d[5],m=d[9],p=d[13],n=d[2],q=d[6],s=d[10],t=d[14],v=d[3],u=d[7],w=d[11],d=d[15];c[0]=m*t*u-p*s*u+p*q*w-k*t*w-m*q*d+k*s*d;c[4]=h*s*u-f*t*u-h*q*w+g*t*w+f*q*d-g*s*d;c[8]=f*p*u-h*m*u+h*k*w-g*p*w-f*k*d+g*m*d;c[12]=h*m*q-f*p*q-h*k*s+g*p*s+f*k*t-g*m*t;c[1]=p*s*v-m*t*v-p*n*w+l*t*w+m*n*d-l*s*d;c[5]=f*t*v-h*s*v+h*n*w-e*t*w-f*n*d+e*s*d;c[9]=h*m*v-f*p*v-h*l*w+e*p*w+f*l*d-e*m*d;c[13]=f*p*n-h*m*n+h*l*s-e*p*s-f*l*t+e*m*t;c[2]=k*t*v-p*q*v+p*n*u-l*t*
u-k*n*d+l*q*d;c[6]=h*q*v-g*t*v-h*n*u+e*t*u+g*n*d-e*q*d;c[10]=g*p*v-h*k*v+h*l*u-e*p*u-g*l*d+e*k*d;c[14]=h*k*n-g*p*n-h*l*q+e*p*q+g*l*t-e*k*t;c[3]=m*q*v-k*s*v-m*n*u+l*s*u+k*n*w-l*q*w;c[7]=g*s*v-f*q*v+f*n*u-e*s*u-g*n*w+e*q*w;c[11]=f*k*v-g*m*v-f*l*u+e*m*u+g*l*w-e*k*w;c[15]=g*m*n-f*k*n+f*l*q-e*m*q-g*l*s+e*k*s;c=e*c[0]+l*c[4]+n*c[8]+v*c[12];if(0===c){if(b)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");
this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(a){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(a){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(a){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(a){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(a,b){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(a){var b=
this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);
return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,g=a.x,f=a.y,h=a.z,l=e*g,k=e*f;this.set(l*g+c,l*f-d*h,l*h+d*f,0,l*f+d*h,k*f+c,k*h-d*g,0,l*h-d*f,k*h+d*g,e*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,
0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a,b;return function(c,d,e){void 0===a&&(a=new THREE.Vector3);void 0===b&&(b=new THREE.Matrix4);var g=this.elements,f=a.set(g[0],g[1],g[2]).length(),h=a.set(g[4],g[5],g[6]).length(),l=a.set(g[8],g[9],g[10]).length();0>this.determinant()&&(f=-f);c.x=g[12];c.y=g[13];c.z=g[14];b.elements.set(this.elements);c=1/f;var g=1/h,k=1/l;b.elements[0]*=c;b.elements[1]*=
c;b.elements[2]*=c;b.elements[4]*=g;b.elements[5]*=g;b.elements[6]*=g;b.elements[8]*=k;b.elements[9]*=k;b.elements[10]*=k;d.setFromRotationMatrix(b);e.x=f;e.y=h;e.z=l;return this}}(),makeFrustum:function(a,b,c,d,e,g){var f=this.elements;f[0]=2*e/(b-a);f[4]=0;f[8]=(b+a)/(b-a);f[12]=0;f[1]=0;f[5]=2*e/(d-c);f[9]=(d+c)/(d-c);f[13]=0;f[2]=0;f[6]=0;f[10]=-(g+e)/(g-e);f[14]=-2*g*e/(g-e);f[3]=0;f[7]=0;f[11]=-1;f[15]=0;return this},makePerspective:function(a,b,c,d){a=c*Math.tan(THREE.Math.degToRad(.5*a));
var e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,g){var f=this.elements,h=b-a,l=c-d,k=g-e;f[0]=2/h;f[4]=0;f[8]=0;f[12]=-((b+a)/h);f[1]=0;f[5]=2/l;f[9]=0;f[13]=-((c+d)/l);f[2]=0;f[6]=0;f[10]=-2/k;f[14]=-((g+e)/k);f[3]=0;f[7]=0;f[11]=0;f[15]=1;return this},equals:function(a){var b=this.elements;a=a.elements;for(var c=0;16>c;c++)if(b[c]!==a[c])return!1;return!0},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],
a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]}};THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,
b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);var d=c.dot(this.direction);return 0>d?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(a){return Math.sqrt(this.distanceSqToPoint(a))},distanceSqToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceToSquared(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceToSquared(b)}}(),
distanceSqToSegment:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,g,f){a.copy(d).add(e).multiplyScalar(.5);b.copy(e).sub(d).normalize();c.copy(this.origin).sub(a);var h=.5*d.distanceTo(e),l=-this.direction.dot(b),k=c.dot(this.direction),m=-c.dot(b),p=c.lengthSq(),n=Math.abs(1-l*l),q;0<n?(d=l*m-k,e=l*k-m,q=h*n,0<=d?e>=-q?e<=q?(h=1/n,d*=h,e*=h,l=d*(d+l*e+2*k)+e*(l*d+e+2*m)+p):(e=h,d=Math.max(0,-(l*e+k)),l=-d*d+e*(e+2*m)+p):(e=-h,d=Math.max(0,-(l*e+k)),
l=-d*d+e*(e+2*m)+p):e<=-q?(d=Math.max(0,-(-l*h+k)),e=0<d?-h:Math.min(Math.max(-h,-m),h),l=-d*d+e*(e+2*m)+p):e<=q?(d=0,e=Math.min(Math.max(-h,-m),h),l=e*(e+2*m)+p):(d=Math.max(0,-(l*h+k)),e=0<d?h:Math.min(Math.max(-h,-m),h),l=-d*d+e*(e+2*m)+p)):(e=0<l?-h:h,d=Math.max(0,-(l*e+k)),l=-d*d+e*(e+2*m)+p);g&&g.copy(this.direction).multiplyScalar(d).add(this.origin);f&&f.copy(b).multiplyScalar(e).add(a);return l}}(),isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},intersectSphere:function(){var a=
new THREE.Vector3;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),e=a.dot(a)-d*d,g=b.radius*b.radius;if(e>g)return null;g=Math.sqrt(g-e);e=d-g;d+=g;return 0>e&&0>d?null:0>e?this.at(d,c):this.at(e,c)}}(),isIntersectionPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+
a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},isIntersectionBox:function(){var a=new THREE.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectBox:function(a,b){var c,d,e,g,f;d=1/this.direction.x;g=1/this.direction.y;f=1/this.direction.z;var h=this.origin;0<=d?(c=(a.min.x-h.x)*d,d*=a.max.x-h.x):(c=(a.max.x-h.x)*d,d*=a.min.x-h.x);0<=g?(e=(a.min.y-h.y)*g,g*=a.max.y-h.y):(e=(a.max.y-h.y)*g,g*=a.min.y-
h.y);if(c>g||e>d)return null;if(e>c||c!==c)c=e;if(g<d||d!==d)d=g;0<=f?(e=(a.min.z-h.z)*f,f*=a.max.z-h.z):(e=(a.max.z-h.z)*f,f*=a.min.z-h.z);if(c>f||e>d)return null;if(e>c||c!==c)c=e;if(f<d||d!==d)d=f;return 0>d?null:this.at(0<=c?c:d,b)},intersectTriangle:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(e,g,f,h,l){b.subVectors(g,e);c.subVectors(f,e);d.crossVectors(b,c);g=this.direction.dot(d);if(0<g){if(h)return null;h=1}else if(0>g)h=-1,
g=-g;else return null;a.subVectors(this.origin,e);e=h*this.direction.dot(c.crossVectors(a,c));if(0>e)return null;f=h*this.direction.dot(b.cross(a));if(0>f||e+f>g)return null;e=-h*a.dot(d);return 0>e?null:this.at(e/g,l)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}};
THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new THREE.Box3;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).center(d);for(var e=0,g=0,f=b.length;g<f;g++)e=Math.max(e,d.distanceToSquared(b[g]));this.radius=Math.sqrt(e);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},
empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new THREE.Vector3;d.copy(a);c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center));
return d},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius}};
THREE.Frustum=function(a,b,c,d,e,g){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==g?g:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,d,e,g){var f=this.planes;f[0].copy(a);f[1].copy(b);f[2].copy(c);f[3].copy(d);f[4].copy(e);f[5].copy(g);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],g=c[3],f=c[4],h=c[5],l=c[6],k=c[7],m=c[8],p=c[9],n=c[10],q=c[11],s=c[12],t=c[13],v=c[14],
c=c[15];b[0].setComponents(g-a,k-f,q-m,c-s).normalize();b[1].setComponents(g+a,k+f,q+m,c+s).normalize();b[2].setComponents(g+d,k+h,q+p,c+t).normalize();b[3].setComponents(g-d,k-h,q-p,c-t).normalize();b[4].setComponents(g-e,k-l,q-n,c-v).normalize();b[5].setComponents(g+e,k+l,q+n,c+v).normalize();return this},intersectsObject:function(){var a=new THREE.Sphere;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);
return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){for(var d=this.planes,e=0;6>e;e++){var g=d[e];a.x=0<g.normal.x?c.min.x:c.max.x;b.x=0<g.normal.x?c.max.x:c.min.x;a.y=0<g.normal.y?c.min.y:c.max.y;b.y=0<g.normal.y?c.max.y:c.min.y;a.z=0<g.normal.z?c.min.z:c.max.z;b.z=0<g.normal.z?c.max.z:c.min.z;
var f=g.distanceToPoint(a),g=g.distanceToPoint(b);if(0>f&&0>g)return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}};THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,
c);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,
b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var d=c||new THREE.Vector3,e=b.delta(a),g=this.normal.dot(e);if(0===g){if(0===this.distanceToPoint(b.start))return d.copy(b.start)}else return g=
-(b.start.dot(this.normal)+this.constant)/g,0>g||1<g?void 0:d.copy(e).multiplyScalar(g).add(b.start)}}(),coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(d,e){var g=e||c.getNormalMatrix(d),g=a.copy(this.normal).applyMatrix3(g),f=this.coplanarPoint(b);f.applyMatrix4(d);this.setFromNormalAndCoplanarPoint(g,f);return this}}(),translate:function(a){this.constant-=
a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}};
THREE.Math={generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,d;return function(){for(var e=0;36>e;e++)8===e||13===e||18===e||23===e?b[e]="-":14===e?b[e]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),d=c&15,c>>=4,b[e]=a[19===e?d&3|8:d]);return b.join("")}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,a))},euclideanModulo:function(a,b){return(a%b+b)%b},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,
b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),
radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}(),isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},nearestPowerOfTwo:function(a){return Math.pow(2,Math.round(Math.log(a)/Math.LN2))},nextPowerOfTwo:function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;return a}};
THREE.Spline=function(a){function b(a,b,c,d,e,g,f){a=.5*(c-a);d=.5*(d-b);return(2*(b-c)+a+d)*f+(-3*(b-c)-2*a-d)*g+a*e+b}this.points=a;var c=[],d={x:0,y:0,z:0},e,g,f,h,l,k,m,p,n;this.initFromArray=function(a){this.points=[];for(var b=0;b<a.length;b++)this.points[b]={x:a[b][0],y:a[b][1],z:a[b][2]}};this.getPoint=function(a){e=(this.points.length-1)*a;g=Math.floor(e);f=e-g;c[0]=0===g?g:g-1;c[1]=g;c[2]=g>this.points.length-2?this.points.length-1:g+1;c[3]=g>this.points.length-3?this.points.length-1:g+
2;k=this.points[c[0]];m=this.points[c[1]];p=this.points[c[2]];n=this.points[c[3]];h=f*f;l=f*h;d.x=b(k.x,m.x,p.x,n.x,f,h,l);d.y=b(k.y,m.y,p.y,n.y,f,h,l);d.z=b(k.z,m.z,p.z,n.z,f,h,l);return d};this.getControlPointsArray=function(){var a,b,c=this.points.length,d=[];for(a=0;a<c;a++)b=this.points[a],d[a]=[b.x,b.y,b.z];return d};this.getLength=function(a){var b,c,d,e=b=b=0,g=new THREE.Vector3,f=new THREE.Vector3,h=[],l=0;h[0]=0;a||(a=100);c=this.points.length*a;g.copy(this.points[0]);for(a=1;a<c;a++)b=
a/c,d=this.getPoint(b),f.copy(d),l+=f.distanceTo(g),g.copy(d),b*=this.points.length-1,b=Math.floor(b),b!==e&&(h[b]=l,e=b);h[h.length]=l;return{chunks:h,total:l}};this.reparametrizeByArcLength=function(a){var b,c,d,e,g,f,h=[],l=new THREE.Vector3,k=this.getLength();h.push(l.copy(this.points[0]).clone());for(b=1;b<this.points.length;b++){c=k.chunks[b]-k.chunks[b-1];f=Math.ceil(a*c/k.total);e=(b-1)/(this.points.length-1);g=b/(this.points.length-1);for(c=1;c<f-1;c++)d=e+1/f*c*(g-e),d=this.getPoint(d),
h.push(l.copy(d).clone());h.push(l.copy(this.points[b]).clone())}this.points=h}};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,d,e){e=e||new THREE.Vector3;e.subVectors(d,c);a.subVectors(b,c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,g,f,h){a.subVectors(f,e);b.subVectors(g,e);c.subVectors(d,e);d=a.dot(a);e=a.dot(b);g=a.dot(c);var l=b.dot(b);f=b.dot(c);var k=d*l-e*e;h=h||new THREE.Vector3;if(0===k)return h.set(-2,-1,-1);k=1/k;l=(l*g-e*f)*k;d=(d*f-e*g)*k;return h.set(1-l-d,d,l)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,d,e){b=THREE.Triangle.barycoordFromPoint(b,c,d,e,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,
this.b);return.5*a.cross(b).length()}}(),midpoint:function(a){return(a||new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},
equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}};THREE.Channels=function(){this.mask=1};THREE.Channels.prototype={constructor:THREE.Channels,set:function(a){this.mask=1<<a},enable:function(a){this.mask|=1<<a},toggle:function(a){this.mask^=1<<a},disable:function(a){this.mask&=~(1<<a)}};THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};
THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=self.performance.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;this.autoStart&&!this.running&&this.start();if(this.running){var b=self.performance.now(),a=.001*(b-this.oldTime);this.oldTime=b;this.elapsedTime+=a}return a}};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(a){a.addEventListener=THREE.EventDispatcher.prototype.addEventListener;a.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;a.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&
c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var c=[],d=b.length,e=0;e<d;e++)c[e]=b[e];for(e=0;e<d;e++)c[e].call(this,a)}}}};
(function(a){function b(a,b){return a.distance-b.distance}function c(a,b,g,f){if(!1!==a.visible&&(a.raycast(b,g),!0===f)){a=a.children;f=0;for(var h=a.length;f<h;f++)c(a[f],b,g,!0)}}a.Raycaster=function(b,c,g,f){this.ray=new a.Ray(b,c);this.near=g||0;this.far=f||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})};
a.Raycaster.prototype={constructor:a.Raycaster,linePrecision:1,set:function(a,b){this.ray.set(a,b)},setFromCamera:function(b,c){c instanceof a.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(b.x,b.y,.5).unproject(c).sub(this.ray.origin).normalize()):c instanceof a.OrthographicCamera?(this.ray.origin.set(b.x,b.y,-1).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},
intersectObject:function(a,e){var g=[];c(a,this,g,e);g.sort(b);return g},intersectObjects:function(a,e){var g=[];if(!1===Array.isArray(a))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),g;for(var f=0,h=a.length;f<h;f++)c(a[f],this,g,e);g.sort(b);return g}}})(THREE);
THREE.Object3D=function(){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.channels=new THREE.Channels;this.children=[];this.up=THREE.Object3D.DefaultUp.clone();var a=new THREE.Vector3,b=new THREE.Euler,c=new THREE.Quaternion,d=new THREE.Vector3(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)});c.onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,
value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:c},scale:{enumerable:!0,value:d},modelViewMatrix:{value:new THREE.Matrix4},normalMatrix:{value:new THREE.Matrix3}});this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}};
THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0);THREE.Object3D.DefaultMatrixAutoUpdate=!0;
THREE.Object3D.prototype={constructor:THREE.Object3D,get eulerOrder(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set eulerOrder(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=a},get useQuaternion(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(a){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set renderDepth(a){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},
applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new THREE.Quaternion;return function(b,c){a.setFromAxisAngle(b,
c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new THREE.Vector3;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));
return this}}(),translate:function(a,b){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,
b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add: object can't be added as a child of itself.",
a),this;a instanceof THREE.Object3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);b=this.children.indexOf(a);-1!==b&&(a.parent=null,a.dispatchEvent({type:"removed"}),this.children.splice(b,1))},getChildByName:function(a){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");
return this.getObjectByName(a)},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){a=a||new THREE.Vector3;this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=
new THREE.Vector3,b=new THREE.Vector3;return function(c){c=c||new THREE.Quaternion;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,b);return c}}(),getWorldRotation:function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Euler;this.getWorldQuaternion(a);return b.setFromQuaternion(a,this.rotation.order,!1)}}(),getWorldScale:function(){var a=new THREE.Vector3,b=new THREE.Quaternion;return function(c){c=c||new THREE.Vector3;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,
b,c);return c}}(),getWorldDirection:function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Vector3;this.getWorldQuaternion(a);return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=this.children,c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}},traverseAncestors:function(a){var b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))},
updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},toJSON:function(a){function b(a){var b=
[],c;for(c in a){var d=a[c];delete d.metadata;b.push(d)}return b}var c=void 0===a,d={};c&&(a={geometries:{},materials:{},textures:{},images:{}},d.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var e={};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);"{}"!==JSON.stringify(this.userData)&&(e.userData=this.userData);!0===this.castShadow&&(e.castShadow=!0);!0===this.receiveShadow&&(e.receiveShadow=!0);!1===this.visible&&(e.visible=!1);e.matrix=this.matrix.toArray();
void 0!==this.geometry&&(void 0===a.geometries[this.geometry.uuid]&&(a.geometries[this.geometry.uuid]=this.geometry.toJSON(a)),e.geometry=this.geometry.uuid);void 0!==this.material&&(void 0===a.materials[this.material.uuid]&&(a.materials[this.material.uuid]=this.material.toJSON(a)),e.material=this.material.uuid);if(0<this.children.length){e.children=[];for(var g=0;g<this.children.length;g++)e.children.push(this.children[g].toJSON(a).object)}if(c){var c=b(a.geometries),g=b(a.materials),f=b(a.textures);
a=b(a.images);0<c.length&&(d.geometries=c);0<g.length&&(d.materials=g);0<f.length&&(d.textures=f);0<a.length&&(d.images=a)}d.object=e;return d},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,b){void 0===b&&(b=!0);this.name=a.name;this.up.copy(a.up);this.position.copy(a.position);this.quaternion.copy(a.quaternion);this.scale.copy(a.scale);this.rotationAutoUpdate=a.rotationAutoUpdate;this.matrix.copy(a.matrix);this.matrixWorld.copy(a.matrixWorld);this.matrixAutoUpdate=
a.matrixAutoUpdate;this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate;this.visible=a.visible;this.castShadow=a.castShadow;this.receiveShadow=a.receiveShadow;this.frustumCulled=a.frustumCulled;this.renderOrder=a.renderOrder;this.userData=JSON.parse(JSON.stringify(a.userData));if(!0===b)for(var c=0;c<a.children.length;c++)this.add(a.children[c].clone());return this}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;
THREE.Face3=function(a,b,c,d,e,g){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=Array.isArray(d)?d:[];this.color=e instanceof THREE.Color?e:new THREE.Color;this.vertexColors=Array.isArray(e)?e:[];this.materialIndex=void 0!==g?g:0};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.a=a.a;this.b=a.b;this.c=a.c;this.normal.copy(a.normal);this.color.copy(a.color);this.materialIndex=a.materialIndex;for(var b=0,c=a.vertexNormals.length;b<c;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();b=0;for(c=a.vertexColors.length;b<c;b++)this.vertexColors[b]=a.vertexColors[b].clone();return this}};
THREE.Face4=function(a,b,c,d,e,g,f){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(a,b,c,e,g,f)};THREE.BufferAttribute=function(a,b){this.uuid=THREE.Math.generateUUID();this.array=a;this.itemSize=b;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0};
THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get length(){console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count.");return this.array.length},get count(){return this.array.length/this.itemSize},set needsUpdate(a){!0===a&&this.version++},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.itemSize=a.itemSize;this.dynamic=a.dynamic;return this},copyAt:function(a,b,c){a*=this.itemSize;
c*=b.itemSize;for(var d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this},copyArray:function(a){this.array.set(a);return this},copyColorsArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var g=a[d];void 0===g&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",d),g=new THREE.Color);b[c++]=g.r;b[c++]=g.g;b[c++]=g.b}return this},copyIndicesArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var g=a[d];b[c++]=g.a;b[c++]=g.b;b[c++]=
g.c}return this},copyVector2sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var g=a[d];void 0===g&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",d),g=new THREE.Vector2);b[c++]=g.x;b[c++]=g.y}return this},copyVector3sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var g=a[d];void 0===g&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",d),g=new THREE.Vector3);b[c++]=g.x;b[c++]=g.y;b[c++]=g.z}return this},
copyVector4sArray:function(a){for(var b=this.array,c=0,d=0,e=a.length;d<e;d++){var g=a[d];void 0===g&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),g=new THREE.Vector4);b[c++]=g.x;b[c++]=g.y;b[c++]=g.z;b[c++]=g.w}return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){this.array[a*this.itemSize]=b;return this},getY:function(a){return this.array[a*this.itemSize+1]},
setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,b){this.array[a*this.itemSize+3]=b;return this},setXY:function(a,b,c){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;return this},setXYZW:function(a,
b,c,d,e){a*=this.itemSize;this.array[a+0]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+3]=e;return this},clone:function(){return(new this.constructor).copy(this)}};THREE.Int8Attribute=function(a,b){return new THREE.BufferAttribute(new Int8Array(a),b)};THREE.Uint8Attribute=function(a,b){return new THREE.BufferAttribute(new Uint8Array(a),b)};THREE.Uint8ClampedAttribute=function(a,b){return new THREE.BufferAttribute(new Uint8ClampedArray(a),b)};
THREE.Int16Attribute=function(a,b){return new THREE.BufferAttribute(new Int16Array(a),b)};THREE.Uint16Attribute=function(a,b){return new THREE.BufferAttribute(new Uint16Array(a),b)};THREE.Int32Attribute=function(a,b){return new THREE.BufferAttribute(new Int32Array(a),b)};THREE.Uint32Attribute=function(a,b){return new THREE.BufferAttribute(new Uint32Array(a),b)};THREE.Float32Attribute=function(a,b){return new THREE.BufferAttribute(new Float32Array(a),b)};
THREE.Float64Attribute=function(a,b){return new THREE.BufferAttribute(new Float64Array(a),b)};THREE.DynamicBufferAttribute=function(a,b){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new THREE.BufferAttribute(a,b)).setDynamic(!0)};THREE.InstancedBufferAttribute=function(a,b,c){THREE.BufferAttribute.call(this,a,b);this.meshPerAttribute=c||1};THREE.InstancedBufferAttribute.prototype=Object.create(THREE.BufferAttribute.prototype);
THREE.InstancedBufferAttribute.prototype.constructor=THREE.InstancedBufferAttribute;THREE.InstancedBufferAttribute.prototype.copy=function(a){THREE.BufferAttribute.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this};THREE.InterleavedBuffer=function(a,b){this.uuid=THREE.Math.generateUUID();this.array=a;this.stride=b;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0};
THREE.InterleavedBuffer.prototype={constructor:THREE.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(a){!0===a&&this.version++},setDynamic:function(a){this.dynamic=a;return this},copy:function(a){this.array=new a.array.constructor(a.array);this.stride=a.stride;this.dynamic=a.dynamic},copyAt:function(a,b,c){a*=this.stride;c*=b.stride;for(var d=0,e=this.stride;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,
b){void 0===b&&(b=0);this.array.set(a,b);return this},clone:function(){return(new this.constructor).copy(this)}};THREE.InstancedInterleavedBuffer=function(a,b,c){THREE.InterleavedBuffer.call(this,a,b);this.meshPerAttribute=c||1};THREE.InstancedInterleavedBuffer.prototype=Object.create(THREE.InterleavedBuffer.prototype);THREE.InstancedInterleavedBuffer.prototype.constructor=THREE.InstancedInterleavedBuffer;
THREE.InstancedInterleavedBuffer.prototype.copy=function(a){THREE.InterleavedBuffer.prototype.copy.call(this,a);this.meshPerAttribute=a.meshPerAttribute;return this};THREE.InterleavedBufferAttribute=function(a,b,c){this.uuid=THREE.Math.generateUUID();this.data=a;this.itemSize=b;this.offset=c};
THREE.InterleavedBufferAttribute.prototype={constructor:THREE.InterleavedBufferAttribute,get length(){console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count.");return this.array.length},get count(){return this.data.array.length/this.data.stride},setX:function(a,b){this.data.array[a*this.data.stride+this.offset]=b;return this},setY:function(a,b){this.data.array[a*this.data.stride+this.offset+1]=b;return this},setZ:function(a,b){this.data.array[a*this.data.stride+this.offset+
2]=b;return this},setW:function(a,b){this.data.array[a*this.data.stride+this.offset+3]=b;return this},getX:function(a){return this.data.array[a*this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,c){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;
return this},setXYZ:function(a,b,c,d){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a=a*this.data.stride+this.offset;this.data.array[a+0]=b;this.data.array[a+1]=c;this.data.array[a+2]=d;this.data.array[a+3]=e;return this}};
THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.elementsNeedUpdate=
this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(a){for(var b=(new THREE.Matrix3).getNormalMatrix(a),c=0,d=this.vertices.length;c<d;c++)this.vertices[c].applyMatrix4(a);c=0;for(d=this.faces.length;c<d;c++){a=this.faces[c];a.normal.applyMatrix3(b).normalize();for(var e=0,g=a.vertexNormals.length;e<g;e++)a.vertexNormals[e].applyMatrix3(b).normalize()}null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere();this.normalsNeedUpdate=
this.verticesNeedUpdate=!0},rotateX:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Matrix4);
a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Matrix4);a.makeScale(b,c,d);this.applyMatrix(a);return this}}(),lookAt:function(){var a;return function(b){void 0===a&&(a=new THREE.Object3D);a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),fromBufferGeometry:function(a){function b(a,b,d){var e=void 0!==f?[m[a].clone(),m[b].clone(),m[d].clone()]:[],g=void 0!==h?[c.colors[a].clone(),c.colors[b].clone(),c.colors[d].clone()]:
[],e=new THREE.Face3(a,b,d,e,g);c.faces.push(e);void 0!==l&&c.faceVertexUvs[0].push([p[a].clone(),p[b].clone(),p[d].clone()]);void 0!==k&&c.faceVertexUvs[1].push([n[a].clone(),n[b].clone(),n[d].clone()])}var c=this,d=null!==a.index?a.index.array:void 0,e=a.attributes,g=e.position.array,f=void 0!==e.normal?e.normal.array:void 0,h=void 0!==e.color?e.color.array:void 0,l=void 0!==e.uv?e.uv.array:void 0,k=void 0!==e.uv2?e.uv2.array:void 0;void 0!==k&&(this.faceVertexUvs[1]=[]);for(var m=[],p=[],n=[],
q=e=0;e<g.length;e+=3,q+=2)c.vertices.push(new THREE.Vector3(g[e],g[e+1],g[e+2])),void 0!==f&&m.push(new THREE.Vector3(f[e],f[e+1],f[e+2])),void 0!==h&&c.colors.push(new THREE.Color(h[e],h[e+1],h[e+2])),void 0!==l&&p.push(new THREE.Vector2(l[q],l[q+1])),void 0!==k&&n.push(new THREE.Vector2(k[q],k[q+1]));if(void 0!==d)if(g=a.groups,0<g.length)for(e=0;e<g.length;e++)for(var q=g[e],s=q.start,t=q.count,q=s,s=s+t;q<s;q+=3)b(d[q],d[q+1],d[q+2]);else for(e=0;e<d.length;e+=3)b(d[e],d[e+1],d[e+2]);else for(e=
0;e<g.length/3;e+=3)b(e,e+1,e+2);this.computeFaceNormals();null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());return this},center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.translate(a.x,a.y,a.z);return a},normalize:function(){this.computeBoundingSphere();var a=this.boundingSphere.center,b=this.boundingSphere.radius,b=0===b?1:1/b,c=new THREE.Matrix4;c.set(b,0,0,-b*a.x,0,b,0,
-b*a.y,0,0,b,-b*a.z,0,0,0,1);this.applyMatrix(c);return this},computeFaceNormals:function(){for(var a=new THREE.Vector3,b=new THREE.Vector3,c=0,d=this.faces.length;c<d;c++){var e=this.faces[c],g=this.vertices[e.a],f=this.vertices[e.b];a.subVectors(this.vertices[e.c],f);b.subVectors(g,f);a.cross(b);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(a){var b,c,d;d=Array(this.vertices.length);b=0;for(c=this.vertices.length;b<c;b++)d[b]=new THREE.Vector3;if(a){var e,g,f,h=new THREE.Vector3,
l=new THREE.Vector3;a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],e=this.vertices[c.a],g=this.vertices[c.b],f=this.vertices[c.c],h.subVectors(f,g),l.subVectors(e,g),h.cross(l),d[c.a].add(h),d[c.b].add(h),d[c.c].add(h)}else for(a=0,b=this.faces.length;a<b;a++)c=this.faces[a],d[c.a].add(c.normal),d[c.b].add(c.normal),d[c.c].add(c.normal);b=0;for(c=this.vertices.length;b<c;b++)d[b].normalize();a=0;for(b=this.faces.length;a<b;a++)c=this.faces[a],e=c.vertexNormals,3===e.length?(e[0].copy(d[c.a]),
e[1].copy(d[c.b]),e[2].copy(d[c.c])):(e[0]=d[c.a].clone(),e[1]=d[c.b].clone(),e[2]=d[c.c].clone())},computeMorphNormals:function(){var a,b,c,d,e;c=0;for(d=this.faces.length;c<d;c++)for(e=this.faces[c],e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]),a=0,b=e.vertexNormals.length;a<b;a++)e.__originalVertexNormals[a]?e.__originalVertexNormals[a].copy(e.vertexNormals[a]):e.__originalVertexNormals[a]=
e.vertexNormals[a].clone();var g=new THREE.Geometry;g.faces=this.faces;a=0;for(b=this.morphTargets.length;a<b;a++){if(!this.morphNormals[a]){this.morphNormals[a]={};this.morphNormals[a].faceNormals=[];this.morphNormals[a].vertexNormals=[];e=this.morphNormals[a].faceNormals;var f=this.morphNormals[a].vertexNormals,h,l;c=0;for(d=this.faces.length;c<d;c++)h=new THREE.Vector3,l={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3},e.push(h),f.push(l)}f=this.morphNormals[a];g.vertices=this.morphTargets[a].vertices;
g.computeFaceNormals();g.computeVertexNormals();c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],h=f.faceNormals[c],l=f.vertexNormals[c],h.copy(e.normal),l.a.copy(e.vertexNormals[0]),l.b.copy(e.vertexNormals[1]),l.c.copy(e.vertexNormals[2])}c=0;for(d=this.faces.length;c<d;c++)e=this.faces[c],e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){for(var a=
0,b=this.vertices,c=0,d=b.length;c<d;c++)0<c&&(a+=b[c].distanceTo(b[c-1])),this.lineDistances[c]=a},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);this.boundingSphere.setFromPoints(this.vertices)},merge:function(a,b,c){if(!1===a instanceof THREE.Geometry)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",
a);else{var d,e=this.vertices.length,g=this.vertices,f=a.vertices,h=this.faces,l=a.faces,k=this.faceVertexUvs[0];a=a.faceVertexUvs[0];void 0===c&&(c=0);void 0!==b&&(d=(new THREE.Matrix3).getNormalMatrix(b));for(var m=0,p=f.length;m<p;m++){var n=f[m].clone();void 0!==b&&n.applyMatrix4(b);g.push(n)}m=0;for(p=l.length;m<p;m++){var f=l[m],q,s=f.vertexNormals,t=f.vertexColors,n=new THREE.Face3(f.a+e,f.b+e,f.c+e);n.normal.copy(f.normal);void 0!==d&&n.normal.applyMatrix3(d).normalize();b=0;for(g=s.length;b<
g;b++)q=s[b].clone(),void 0!==d&&q.applyMatrix3(d).normalize(),n.vertexNormals.push(q);n.color.copy(f.color);b=0;for(g=t.length;b<g;b++)q=t[b],n.vertexColors.push(q.clone());n.materialIndex=f.materialIndex+c;h.push(n)}m=0;for(p=a.length;m<p;m++)if(c=a[m],d=[],void 0!==c){b=0;for(g=c.length;b<g;b++)d.push(c[b].clone());k.push(d)}}},mergeMesh:function(a){!1===a instanceof THREE.Mesh?console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",a):(a.matrixAutoUpdate&&a.updateMatrix(),
this.merge(a.geometry,a.matrix))},mergeVertices:function(){var a={},b=[],c=[],d,e=Math.pow(10,4),g,f;g=0;for(f=this.vertices.length;g<f;g++)d=this.vertices[g],d=Math.round(d.x*e)+"_"+Math.round(d.y*e)+"_"+Math.round(d.z*e),void 0===a[d]?(a[d]=g,b.push(this.vertices[g]),c[g]=b.length-1):c[g]=c[a[d]];a=[];g=0;for(f=this.faces.length;g<f;g++)for(e=this.faces[g],e.a=c[e.a],e.b=c[e.b],e.c=c[e.c],e=[e.a,e.b,e.c],d=0;3>d;d++)if(e[d]===e[(d+1)%3]){a.push(g);break}for(g=a.length-1;0<=g;g--)for(e=a[g],this.faces.splice(e,
1),c=0,f=this.faceVertexUvs.length;c<f;c++)this.faceVertexUvs[c].splice(e,1);g=this.vertices.length-b.length;this.vertices=b;return g},sortFacesByMaterialIndex:function(){for(var a=this.faces,b=a.length,c=0;c<b;c++)a[c]._id=c;a.sort(function(a,b){return a.materialIndex-b.materialIndex});var d=this.faceVertexUvs[0],e=this.faceVertexUvs[1],g,f;d&&d.length===b&&(g=[]);e&&e.length===b&&(f=[]);for(c=0;c<b;c++){var h=a[c]._id;g&&g.push(d[h]);f&&f.push(e[h])}g&&(this.faceVertexUvs[0]=g);f&&(this.faceVertexUvs[1]=
f)},toJSON:function(){function a(a,b,c){return c?a|1<<b:a&~(1<<b)}function b(a){var b=a.x.toString()+a.y.toString()+a.z.toString();if(void 0!==k[b])return k[b];k[b]=l.length/3;l.push(a.x,a.y,a.z);return k[b]}function c(a){var b=a.r.toString()+a.g.toString()+a.b.toString();if(void 0!==p[b])return p[b];p[b]=m.length;m.push(a.getHex());return p[b]}function d(a){var b=a.x.toString()+a.y.toString();if(void 0!==q[b])return q[b];q[b]=n.length/2;n.push(a.x,a.y);return q[b]}var e={metadata:{version:4.4,type:"Geometry",
generator:"Geometry.toJSON"}};e.uuid=this.uuid;e.type=this.type;""!==this.name&&(e.name=this.name);if(void 0!==this.parameters){var g=this.parameters,f;for(f in g)void 0!==g[f]&&(e[f]=g[f]);return e}g=[];for(f=0;f<this.vertices.length;f++){var h=this.vertices[f];g.push(h.x,h.y,h.z)}var h=[],l=[],k={},m=[],p={},n=[],q={};for(f=0;f<this.faces.length;f++){var s=this.faces[f],t=void 0!==this.faceVertexUvs[0][f],v=0<s.normal.length(),u=0<s.vertexNormals.length,w=1!==s.color.r||1!==s.color.g||1!==s.color.b,
D=0<s.vertexColors.length,x=0,x=a(x,0,0),x=a(x,1,!1),x=a(x,2,!1),x=a(x,3,t),x=a(x,4,v),x=a(x,5,u),x=a(x,6,w),x=a(x,7,D);h.push(x);h.push(s.a,s.b,s.c);t&&(t=this.faceVertexUvs[0][f],h.push(d(t[0]),d(t[1]),d(t[2])));v&&h.push(b(s.normal));u&&(v=s.vertexNormals,h.push(b(v[0]),b(v[1]),b(v[2])));w&&h.push(c(s.color));D&&(s=s.vertexColors,h.push(c(s[0]),c(s[1]),c(s[2])))}e.data={};e.data.vertices=g;e.data.normals=l;0<m.length&&(e.data.colors=m);0<n.length&&(e.data.uvs=[n]);e.data.faces=h;return e},clone:function(){return(new this.constructor).copy(this)},
copy:function(a){this.vertices=[];this.faces=[];this.faceVertexUvs=[[]];for(var b=a.vertices,c=0,d=b.length;c<d;c++)this.vertices.push(b[c].clone());b=a.faces;c=0;for(d=b.length;c<d;c++)this.faces.push(b[c].clone());c=0;for(d=a.faceVertexUvs.length;c<d;c++){b=a.faceVertexUvs[c];void 0===this.faceVertexUvs[c]&&(this.faceVertexUvs[c]=[]);for(var e=0,g=b.length;e<g;e++){for(var f=b[e],h=[],l=0,k=f.length;l<k;l++)h.push(f[l].clone());this.faceVertexUvs[c].push(h)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};
THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;
THREE.DirectGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="DirectGeometry";this.indices=[];this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.DirectGeometry.prototype={constructor:THREE.DirectGeometry,computeBoundingBox:THREE.Geometry.prototype.computeBoundingBox,computeBoundingSphere:THREE.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(a){var b,c=[],
d;a=a.faces;for(var e=0;e<a.length;e++){var g=a[e];g.materialIndex!==d&&(d=g.materialIndex,void 0!==b&&(b.count=3*e-b.start,c.push(b)),b={start:3*e,materialIndex:d})}void 0!==b&&(b.count=3*e-b.start,c.push(b));this.groups=c},fromGeometry:function(a){var b=a.faces,c=a.vertices,d=a.faceVertexUvs,e=d[0]&&0<d[0].length,g=d[1]&&0<d[1].length,f=a.morphTargets,h=f.length;if(0<h){for(var l=[],k=0;k<h;k++)l[k]=[];this.morphTargets.position=l}var m=a.morphNormals,p=m.length;if(0<p){for(var n=[],k=0;k<p;k++)n[k]=
[];this.morphTargets.normal=n}for(var q=a.skinIndices,s=a.skinWeights,t=q.length===c.length,v=s.length===c.length,k=0;k<b.length;k++){var u=b[k];this.vertices.push(c[u.a],c[u.b],c[u.c]);var w=u.vertexNormals;3===w.length?this.normals.push(w[0],w[1],w[2]):(w=u.normal,this.normals.push(w,w,w));w=u.vertexColors;3===w.length?this.colors.push(w[0],w[1],w[2]):(w=u.color,this.colors.push(w,w,w));!0===e&&(w=d[0][k],void 0!==w?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",
k),this.uvs.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2)));!0===g&&(w=d[1][k],void 0!==w?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",k),this.uvs2.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2)));for(w=0;w<h;w++){var D=f[w].vertices;l[w].push(D[u.a],D[u.b],D[u.c])}for(w=0;w<p;w++)D=m[w].vertexNormals[k],n[w].push(D.a,D.b,D.c);t&&this.skinIndices.push(q[u.a],q[u.b],q[u.c]);v&&this.skinWeights.push(s[u.a],s[u.b],
s[u.c])}this.computeGroups(a);this.verticesNeedUpdate=a.verticesNeedUpdate;this.normalsNeedUpdate=a.normalsNeedUpdate;this.colorsNeedUpdate=a.colorsNeedUpdate;this.uvsNeedUpdate=a.uvsNeedUpdate;this.groupsNeedUpdate=a.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.DirectGeometry.prototype);
THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity}};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addIndex:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(a)},getIndex:function(){return this.index},setIndex:function(a){this.index=a},addAttribute:function(a,b,c){!1===b instanceof THREE.BufferAttribute&&!1===b instanceof THREE.InterleavedBufferAttribute?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(a,new THREE.BufferAttribute(b,
c))):"index"===a?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(b)):this.attributes[a]=b},getAttribute:function(a){return this.attributes[a]},removeAttribute:function(a){delete this.attributes[a]},get drawcalls(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups},get offsets(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");return this.groups},addDrawCall:function(a,
b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(a,b)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");this.clearGroups()},addGroup:function(a,b,c){this.groups.push({start:a,count:b,materialIndex:void 0!==c?c:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a;this.drawRange.count=
b},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToVector3Array(b.array),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new THREE.Matrix3).getNormalMatrix(a).applyToVector3Array(b.array),b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere()},rotateX:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.makeRotationX(b);this.applyMatrix(a);return this}}(),rotateY:function(){var a;
return function(b){void 0===a&&(a=new THREE.Matrix4);a.makeRotationY(b);this.applyMatrix(a);return this}}(),rotateZ:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.makeRotationZ(b);this.applyMatrix(a);return this}}(),translate:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Matrix4);a.makeTranslation(b,c,d);this.applyMatrix(a);return this}}(),scale:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Matrix4);a.makeScale(b,c,d);this.applyMatrix(a);
return this}}(),lookAt:function(){var a;return function(b){void 0===a&&(a=new THREE.Object3D);a.lookAt(b);a.updateMatrix();this.applyMatrix(a.matrix)}}(),center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.translate(a.x,a.y,a.z);return a},setFromObject:function(a){var b=a.geometry;if(a instanceof THREE.Points||a instanceof THREE.Line){a=new THREE.Float32Attribute(3*b.vertices.length,3);var c=new THREE.Float32Attribute(3*b.colors.length,3);this.addAttribute("position",
a.copyVector3sArray(b.vertices));this.addAttribute("color",c.copyColorsArray(b.colors));b.lineDistances&&b.lineDistances.length===b.vertices.length&&(a=new THREE.Float32Attribute(b.lineDistances.length,1),this.addAttribute("lineDistance",a.copyArray(b.lineDistances)));null!==b.boundingSphere&&(this.boundingSphere=b.boundingSphere.clone());null!==b.boundingBox&&(this.boundingBox=b.boundingBox.clone())}else a instanceof THREE.Mesh&&b instanceof THREE.Geometry&&this.fromGeometry(b);return this},updateFromObject:function(a){var b=
a.geometry;if(a instanceof THREE.Mesh){var c=b.__directGeometry;if(void 0===c)return this.fromGeometry(b);c.verticesNeedUpdate=b.verticesNeedUpdate;c.normalsNeedUpdate=b.normalsNeedUpdate;c.colorsNeedUpdate=b.colorsNeedUpdate;c.uvsNeedUpdate=b.uvsNeedUpdate;c.groupsNeedUpdate=b.groupsNeedUpdate;b.verticesNeedUpdate=!1;b.normalsNeedUpdate=!1;b.colorsNeedUpdate=!1;b.uvsNeedUpdate=!1;b.groupsNeedUpdate=!1;b=c}!0===b.verticesNeedUpdate&&(c=this.attributes.position,void 0!==c&&(c.copyVector3sArray(b.vertices),
c.needsUpdate=!0),b.verticesNeedUpdate=!1);!0===b.normalsNeedUpdate&&(c=this.attributes.normal,void 0!==c&&(c.copyVector3sArray(b.normals),c.needsUpdate=!0),b.normalsNeedUpdate=!1);!0===b.colorsNeedUpdate&&(c=this.attributes.color,void 0!==c&&(c.copyColorsArray(b.colors),c.needsUpdate=!0),b.colorsNeedUpdate=!1);b.uvsNeedUpdate&&(c=this.attributes.uv,void 0!==c&&(c.copyVector2sArray(b.uvs),c.needsUpdate=!0),b.uvsNeedUpdate=!1);b.lineDistancesNeedUpdate&&(c=this.attributes.lineDistance,void 0!==c&&
(c.copyArray(b.lineDistances),c.needsUpdate=!0),b.lineDistancesNeedUpdate=!1);b.groupsNeedUpdate&&(b.computeGroups(a.geometry),this.groups=b.groups,b.groupsNeedUpdate=!1);return this},fromGeometry:function(a){a.__directGeometry=(new THREE.DirectGeometry).fromGeometry(a);return this.fromDirectGeometry(a.__directGeometry)},fromDirectGeometry:function(a){var b=new Float32Array(3*a.vertices.length);this.addAttribute("position",(new THREE.BufferAttribute(b,3)).copyVector3sArray(a.vertices));0<a.normals.length&&
(b=new Float32Array(3*a.normals.length),this.addAttribute("normal",(new THREE.BufferAttribute(b,3)).copyVector3sArray(a.normals)));0<a.colors.length&&(b=new Float32Array(3*a.colors.length),this.addAttribute("color",(new THREE.BufferAttribute(b,3)).copyColorsArray(a.colors)));0<a.uvs.length&&(b=new Float32Array(2*a.uvs.length),this.addAttribute("uv",(new THREE.BufferAttribute(b,2)).copyVector2sArray(a.uvs)));0<a.uvs2.length&&(b=new Float32Array(2*a.uvs2.length),this.addAttribute("uv2",(new THREE.BufferAttribute(b,
2)).copyVector2sArray(a.uvs2)));0<a.indices.length&&(b=new (65535<a.vertices.length?Uint32Array:Uint16Array)(3*a.indices.length),this.setIndex((new THREE.BufferAttribute(b,1)).copyIndicesArray(a.indices)));this.groups=a.groups;for(var c in a.morphTargets){for(var b=[],d=a.morphTargets[c],e=0,g=d.length;e<g;e++){var f=d[e],h=new THREE.Float32Attribute(3*f.length,3);b.push(h.copyVector3sArray(f))}this.morphAttributes[c]=b}0<a.skinIndices.length&&(c=new THREE.Float32Attribute(4*a.skinIndices.length,
4),this.addAttribute("skinIndex",c.copyVector4sArray(a.skinIndices)));0<a.skinWeights.length&&(c=new THREE.Float32Attribute(4*a.skinWeights.length,4),this.addAttribute("skinWeight",c.copyVector4sArray(a.skinWeights)));null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone());null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone());return this},computeBoundingBox:function(){var a=new THREE.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var b=
this.attributes.position.array;if(b){var c=this.boundingBox;c.makeEmpty();for(var d=0,e=b.length;d<e;d+=3)a.fromArray(b,d),c.expandByPoint(a)}if(void 0===b||0===b.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0);(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}(),computeBoundingSphere:function(){var a=
new THREE.Box3,b=new THREE.Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var c=this.attributes.position.array;if(c){a.makeEmpty();for(var d=this.boundingSphere.center,e=0,g=c.length;e<g;e+=3)b.fromArray(c,e),a.expandByPoint(b);a.center(d);for(var f=0,e=0,g=c.length;e<g;e+=3)b.fromArray(c,e),f=Math.max(f,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(f);isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',
this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var a=this.index,b=this.attributes,c=this.groups;if(b.position){var d=b.position.array;if(void 0===b.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(d.length),3));else for(var e=b.normal.array,g=0,f=e.length;g<f;g++)e[g]=0;var e=b.normal.array,h,l,k,m=new THREE.Vector3,p=new THREE.Vector3,n=new THREE.Vector3,q=new THREE.Vector3,s=new THREE.Vector3;if(a){a=a.array;0===c.length&&this.addGroup(0,a.length);
for(var t=0,v=c.length;t<v;++t)for(g=c[t],f=g.start,h=g.count,g=f,f+=h;g<f;g+=3)h=3*a[g+0],l=3*a[g+1],k=3*a[g+2],m.fromArray(d,h),p.fromArray(d,l),n.fromArray(d,k),q.subVectors(n,p),s.subVectors(m,p),q.cross(s),e[h]+=q.x,e[h+1]+=q.y,e[h+2]+=q.z,e[l]+=q.x,e[l+1]+=q.y,e[l+2]+=q.z,e[k]+=q.x,e[k+1]+=q.y,e[k+2]+=q.z}else for(g=0,f=d.length;g<f;g+=9)m.fromArray(d,g),p.fromArray(d,g+3),n.fromArray(d,g+6),q.subVectors(n,p),s.subVectors(m,p),q.cross(s),e[g]=q.x,e[g+1]=q.y,e[g+2]=q.z,e[g+3]=q.x,e[g+4]=q.y,
e[g+5]=q.z,e[g+6]=q.x,e[g+7]=q.y,e[g+8]=q.z;this.normalizeNormals();b.normal.needsUpdate=!0}},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(a){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},merge:function(a,b){if(!1===a instanceof THREE.BufferGeometry)console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a);else{void 0===b&&(b=0);var c=this.attributes,
d;for(d in c)if(void 0!==a.attributes[d])for(var e=c[d].array,g=a.attributes[d],f=g.array,h=0,g=g.itemSize*b;h<f.length;h++,g++)e[g]=f[h];return this}},normalizeNormals:function(){for(var a=this.attributes.normal.array,b,c,d,e=0,g=a.length;e<g;e+=3)b=a[e],c=a[e+1],d=a[e+2],b=1/Math.sqrt(b*b+c*c+d*d),a[e]*=b,a[e+1]*=b,a[e+2]*=b},toJSON:function(){var a={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};a.uuid=this.uuid;a.type=this.type;""!==this.name&&(a.name=this.name);
if(void 0!==this.parameters){var b=this.parameters,c;for(c in b)void 0!==b[c]&&(a[c]=b[c]);return a}a.data={attributes:{}};var d=this.index;null!==d&&(b=Array.prototype.slice.call(d.array),a.data.index={type:d.array.constructor.name,array:b});d=this.attributes;for(c in d){var e=d[c],b=Array.prototype.slice.call(e.array);a.data.attributes[c]={itemSize:e.itemSize,type:e.array.constructor.name,array:b}}c=this.groups;0<c.length&&(a.data.groups=JSON.parse(JSON.stringify(c)));c=this.boundingSphere;null!==
c&&(a.data.boundingSphere={center:c.center.toArray(),radius:c.radius});return a},clone:function(){return(new this.constructor).copy(this)},copy:function(a){var b=a.index;null!==b&&this.setIndex(b.clone());var b=a.attributes,c;for(c in b)this.addAttribute(c,b[c].clone());a=a.groups;c=0;for(b=a.length;c<b;c++){var d=a[c];this.addGroup(d.start,d.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);
THREE.BufferGeometry.MaxIndex=65535;THREE.InstancedBufferGeometry=function(){THREE.BufferGeometry.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=void 0};THREE.InstancedBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.InstancedBufferGeometry.prototype.constructor=THREE.InstancedBufferGeometry;THREE.InstancedBufferGeometry.prototype.addGroup=function(a,b,c){this.groups.push({start:a,count:b,instances:c})};
THREE.InstancedBufferGeometry.prototype.copy=function(a){var b=a.index;null!==b&&this.setIndex(b.clone());var b=a.attributes,c;for(c in b)this.addAttribute(c,b[c].clone());a=a.groups;c=0;for(b=a.length;c<b;c++){var d=a[c];this.addGroup(d.start,d.count,d.instances)}return this};THREE.EventDispatcher.prototype.apply(THREE.InstancedBufferGeometry.prototype);
THREE.AnimationAction=function(a,b,c,d,e){if(void 0===a)throw Error("clip is null");this.clip=a;this.localRoot=null;this.startTime=b||0;this.timeScale=c||1;this.weight=d||1;this.loop=e||THREE.LoopRepeat;this.loopCount=0;this.enabled=!0;this.actionTime=-this.startTime;this.clipTime=0;this.propertyBindings=[]};
THREE.AnimationAction.prototype={constructor:THREE.AnimationAction,setLocalRoot:function(a){this.localRoot=a;return this},updateTime:function(a){var b=this.clipTime,c=this.loopCount,d=this.clip.duration;this.actionTime+=a;if(this.loop===THREE.LoopOnce)return this.loopCount=0,this.clipTime=Math.min(Math.max(this.actionTime,0),d),this.clipTime!==b&&(this.clipTime===d?this.mixer.dispatchEvent({type:"finished",action:this,direction:1}):0===this.clipTime&&this.mixer.dispatchEvent({type:"finished",action:this,
direction:-1})),this.clipTime;this.loopCount=Math.floor(this.actionTime/d);a=this.actionTime-this.loopCount*d;a%=d;this.loop==THREE.LoopPingPong&&1===Math.abs(this.loopCount%2)&&(a=d-a);this.clipTime=a;this.loopCount!==c&&this.mixer.dispatchEvent({type:"loop",action:this,loopDelta:this.loopCount-this.loopCount});return this.clipTime},syncWith:function(a){this.actionTime=a.actionTime;this.timeScale=a.timeScale;return this},warpToDuration:function(a){this.timeScale=this.clip.duration/a;return this},
init:function(a){this.clipTime=a-this.startTime;return this},update:function(a){this.updateTime(a);return this.clip.getAt(this.clipTime)},getTimeScaleAt:function(a){return this.timeScale.getAt?this.timeScale.getAt(a):this.timeScale},getWeightAt:function(a){return this.weight.getAt?this.weight.getAt(a):this.weight}};
THREE.AnimationClip=function(a,b,c){this.name=a;this.tracks=c;this.duration=void 0!==b?b:-1;if(0>this.duration)for(a=0;a<this.tracks.length;a++)b=this.tracks[a],this.duration=Math.max(b.keys[b.keys.length-1].time);this.trim();this.optimize();this.results=[]};
THREE.AnimationClip.prototype={constructor:THREE.AnimationClip,getAt:function(a){a=Math.max(0,Math.min(a,this.duration));for(var b=0;b<this.tracks.length;b++)this.results[b]=this.tracks[b].getAt(a);return this.results},trim:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},optimize:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this}};
THREE.AnimationClip.CreateFromMorphTargetSequence=function(a,b,c){for(var d=b.length,e=[],g=0;g<d;g++){var f=[];f.push({time:(g+d-1)%d,value:0});f.push({time:g,value:1});f.push({time:(g+1)%d,value:0});f.sort(THREE.KeyframeTrack.keyComparer);0===f[0].time&&f.push({time:d,value:f[0].value});e.push((new THREE.NumberKeyframeTrack(".morphTargetInfluences["+b[g].name+"]",f)).scale(1/c))}return new THREE.AnimationClip(a,-1,e)};
THREE.AnimationClip.findByName=function(a,b){for(var c=0;c<a.length;c++)if(a[c].name===b)return a[c];return null};THREE.AnimationClip.CreateClipsFromMorphTargetSequences=function(a,b){for(var c={},d=/^([\w-]*?)([\d]+)$/,e=0,g=a.length;e<g;e++){var f=a[e],h=f.name.match(d);if(h&&1<h.length){var l=h[1];(h=c[l])||(c[l]=h=[]);h.push(f)}}d=[];for(l in c)d.push(THREE.AnimationClip.CreateFromMorphTargetSequence(l,c[l],b));return d};
THREE.AnimationClip.parse=function(a){for(var b=[],c=0;c<a.tracks.length;c++)b.push(THREE.KeyframeTrack.parse(a.tracks[c]).scale(1/a.fps));return new THREE.AnimationClip(a.name,a.duration,b)};
THREE.AnimationClip.parseAnimation=function(a,b,c){if(!a)return console.error("  no animation in JSONLoader data"),null;var d=function(a,b,c,d,e){for(var g=[],f=0;f<b.length;f++){var h=b[f];void 0!==h[c]&&g.push({time:h.time,value:e(h)})}return 0<g.length?new d(a,g):null},e=[],g=a.name||"default",f=a.length||-1,h=a.fps||30;a=a.hierarchy||[];for(var l=0;l<a.length;l++){var k=a[l].keys;if(k&&0!=k.length)if(k[0].morphTargets){for(var f={},m=0;m<k.length;m++)if(k[m].morphTargets)for(var p=0;p<k[m].morphTargets.length;p++)f[k[m].morphTargets[p]]=
-1;for(var n in f){for(var q=[],p=0;p<k[m].morphTargets.length;p++){var s=k[m];q.push({time:s.time,value:s.morphTarget===n?1:0})}e.push(new THREE.NumberKeyframeTrack(c+".morphTargetInfluence["+n+"]",q))}f=f.length*(h||1)}else m=c+".bones["+b[l].name+"]",(p=d(m+".position",k,"pos",THREE.VectorKeyframeTrack,function(a){return(new THREE.Vector3).fromArray(a.pos)}))&&e.push(p),(p=d(m+".quaternion",k,"rot",THREE.QuaternionKeyframeTrack,function(a){return a.rot.slerp?a.rot.clone():(new THREE.Quaternion).fromArray(a.rot)}))&&
e.push(p),(k=d(m+".scale",k,"scl",THREE.VectorKeyframeTrack,function(a){return(new THREE.Vector3).fromArray(a.scl)}))&&e.push(k)}return 0===e.length?null:new THREE.AnimationClip(g,f,e)};THREE.AnimationMixer=function(a){this.root=a;this.time=0;this.timeScale=1;this.actions=[];this.propertyBindingMap={}};
THREE.AnimationMixer.prototype={constructor:THREE.AnimationMixer,addAction:function(a){this.actions.push(a);a.init(this.time);a.mixer=this;for(var b=a.clip.tracks,c=a.localRoot||this.root,d=0;d<b.length;d++){var e=b[d],g=c.uuid+"-"+e.name,f=this.propertyBindingMap[g];void 0===f&&(f=new THREE.PropertyBinding(c,e.name),this.propertyBindingMap[g]=f);a.propertyBindings.push(f);f.referenceCount+=1}},removeAllActions:function(){for(var a=0;a<this.actions.length;a++)this.actions[a].mixer=null;for(var b in this.propertyBindingMap)this.propertyBindingMap[b].unbind();
this.actions=[];this.propertyBindingMap={};return this},removeAction:function(a){var b=this.actions.indexOf(a);-1!==b&&(this.actions.splice(b,1),a.mixer=null);b=a.localRoot||this.root;a=a.clip.tracks;for(var c=0;c<a.length;c++){var d=b.uuid+"-"+a[c].name,e=this.propertyBindingMap[d];e.referenceCount-=1;0>=e.referenceCount&&(e.unbind(),delete this.propertyBindingMap[d])}return this},findActionByName:function(a){for(var b=0;b<this.actions.length;b++)if(this.actions[b].name===a)return this.actions[b];
return null},play:function(a,b){a.startTime=this.time;this.addAction(a);return this},fadeOut:function(a,b){var c=[];c.push({time:this.time,value:1});c.push({time:this.time+b,value:0});a.weight=new THREE.NumberKeyframeTrack("weight",c);return this},fadeIn:function(a,b){var c=[];c.push({time:this.time,value:0});c.push({time:this.time+b,value:1});a.weight=new THREE.NumberKeyframeTrack("weight",c);return this},warp:function(a,b,c,d){var e=[];e.push({time:this.time,value:b});e.push({time:this.time+d,value:c});
a.timeScale=new THREE.NumberKeyframeTrack("timeScale",e);return this},crossFade:function(a,b,c,d){this.fadeOut(a,c);this.fadeIn(b,c);if(d){d=a.clip.duration/b.clip.duration;var e=1/d;this.warp(a,1,d,c);this.warp(b,e,1,c)}return this},update:function(a){a*=this.timeScale;this.time+=a;for(var b=0;b<this.actions.length;b++){var c=this.actions[b],d=c.getWeightAt(this.time),e=c.getTimeScaleAt(this.time),e=c.update(a*e);if(!(0>=c.weight)&&c.enabled)for(var g=0;g<e.length;g++)c.propertyBindings[g].accumulate(e[g],
d)}for(var f in this.propertyBindingMap)this.propertyBindingMap[f].apply();return this}};THREE.EventDispatcher.prototype.apply(THREE.AnimationMixer.prototype);
THREE.AnimationUtils={getEqualsFunc:function(a){return a.equals?function(a,c){return a.equals(c)}:function(a,c){return a===c}},clone:function(a){if("object"===typeof a){if(a.clone)return a.clone();console.error("can not figure out how to copy exemplarValue",a)}return a},lerp:function(a,b,c,d){return THREE.AnimationUtils.getLerpFunc(a,d)(a,b,c)},lerp_object:function(a,b,c){return a.lerp(b,c)},slerp_object:function(a,b,c){return a.slerp(b,c)},lerp_number:function(a,b,c){return a*(1-c)+b*c},lerp_boolean:function(a,
b,c){return.5>c?a:b},lerp_boolean_immediate:function(a,b,c){return a},lerp_string:function(a,b,c){return.5>c?a:b},lerp_string_immediate:function(a,b,c){return a},getLerpFunc:function(a,b){if(void 0===a||null===a)throw Error("examplarValue is null");switch(typeof a){case "object":if(a.lerp)return THREE.AnimationUtils.lerp_object;if(a.slerp)return THREE.AnimationUtils.slerp_object;break;case "number":return THREE.AnimationUtils.lerp_number;case "boolean":return b?THREE.AnimationUtils.lerp_boolean:THREE.AnimationUtils.lerp_boolean_immediate;
case "string":return b?THREE.AnimationUtils.lerp_string:THREE.AnimationUtils.lerp_string_immediate}}};THREE.KeyframeTrack=function(a,b){if(void 0===a)throw Error("track name is undefined");if(void 0===b||0===b.length)throw Error("no keys in track named "+a);this.name=a;this.keys=b;this.lastIndex=0;this.validate();this.optimize()};
THREE.KeyframeTrack.prototype={constructor:THREE.KeyframeTrack,getAt:function(a){for(;this.lastIndex<this.keys.length&&a>=this.keys[this.lastIndex].time;)this.lastIndex++;for(;0<this.lastIndex&&a<this.keys[this.lastIndex-1].time;)this.lastIndex--;if(this.lastIndex>=this.keys.length)return this.setResult(this.keys[this.keys.length-1].value),this.result;if(0===this.lastIndex)return this.setResult(this.keys[0].value),this.result;var b=this.keys[this.lastIndex-1];this.setResult(b.value);if(b.constantToNext)return this.result;
var c=this.keys[this.lastIndex];return this.result=this.lerpValues(this.result,c.value,(a-b.time)/(c.time-b.time))},shift:function(a){if(0!==a)for(var b=0;b<this.keys.length;b++)this.keys[b].time+=a;return this},scale:function(a){if(1!==a)for(var b=0;b<this.keys.length;b++)this.keys[b].time*=a;return this},trim:function(a,b){for(var c=0,d=1;d<this.keys.length;d++)this.keys[d]<=a&&c++;for(var e=0,d=this.keys.length-2;0<d;d++)if(this.keys[d]>=b)e++;else break;0<c+e&&(this.keys=this.keys.splice(c,this.keys.length-
e-c));return this},validate:function(){var a=null;if(0===this.keys.length)console.error("  track is empty, no keys",this);else{for(var b=0;b<this.keys.length;b++){var c=this.keys[b];if(!c){console.error("  key is null in track",this,b);return}if("number"!==typeof c.time||isNaN(c.time)){console.error("  key.time is not a valid number",this,b,c);return}if(void 0===c.value||null===c.value){console.error("  key.value is null in track",this,b,c);return}if(a&&a.time>c.time){console.error("  key.time is less than previous key time, out of order keys",
this,b,c,a);return}a=c}return this}},optimize:function(){var a=[],b=this.keys[0];a.push(b);THREE.AnimationUtils.getEqualsFunc(b.value);for(var c=1;c<this.keys.length-1;c++){var d=this.keys[c],e=this.keys[c+1];b.time===d.time||this.compareValues(b.value,d.value)&&this.compareValues(d.value,e.value)||(b.constantToNext=this.compareValues(b.value,d.value),a.push(d),b=d)}a.push(this.keys[this.keys.length-1]);this.keys=a;return this}};THREE.KeyframeTrack.keyComparer=function(a,b){return a.time-b.time};
THREE.KeyframeTrack.parse=function(a){if(void 0===a.type)throw Error("track type undefined, can not parse");return THREE.KeyframeTrack.GetTrackTypeForTypeName(a.type).parse(a)};
THREE.KeyframeTrack.GetTrackTypeForTypeName=function(a){switch(a.toLowerCase()){case "vector":case "vector2":case "vector3":case "vector4":return THREE.VectorKeyframeTrack;case "quaternion":return THREE.QuaternionKeyframeTrack;case "integer":case "scalar":case "double":case "float":case "number":return THREE.NumberKeyframeTrack;case "bool":case "boolean":return THREE.BooleanKeyframeTrack;case "string":return THREE.StringKeyframeTrack}throw Error("Unsupported typeName: "+a);};
THREE.PropertyBinding=function(a,b){this.rootNode=a;this.trackName=b;this.referenceCount=0;this.originalValue=null;var c=THREE.PropertyBinding.parseTrackName(b);this.directoryName=c.directoryName;this.nodeName=c.nodeName;this.objectName=c.objectName;this.objectIndex=c.objectIndex;this.propertyName=c.propertyName;this.propertyIndex=c.propertyIndex;this.node=THREE.PropertyBinding.findNode(a,this.nodeName)||a;this.cumulativeValue=null;this.cumulativeWeight=0};
THREE.PropertyBinding.prototype={constructor:THREE.PropertyBinding,reset:function(){this.cumulativeValue=null;this.cumulativeWeight=0},accumulate:function(a,b){this.isBound||this.bind();0===this.cumulativeWeight?0<b&&(null===this.cumulativeValue&&(this.cumulativeValue=THREE.AnimationUtils.clone(a)),this.cumulativeWeight=b):(this.cumulativeValue=this.lerpValue(this.cumulativeValue,a,b/(this.cumulativeWeight+b)),this.cumulativeWeight+=b)},unbind:function(){this.isBound&&(this.setValue(this.originalValue),
this.triggerDirty=this.equalsValue=this.lerpValue=this.getValue=this.setValue=null,this.isBound=!1)},bind:function(){if(!this.isBound){var a=this.node;if(a){if(this.objectName){if("materials"===this.objectName){if(!a.material){console.error("  can not bind to material as node does not have a material",this);return}if(!a.material.materials){console.error("  can not bind to material.materials as node.material does not have a materials array",this);return}a=a.material.materials}else if("bones"===this.objectName){if(!a.skeleton){console.error("  can not bind to bones as node does not have a skeleton",
this);return}for(var a=a.skeleton.bones,b=0;b<a.length;b++)if(a[b].name===this.objectIndex){this.objectIndex=b;break}}else{if(void 0===a[this.objectName]){console.error("  can not bind to objectName of node, undefined",this);return}a=a[this.objectName]}if(void 0!==this.objectIndex){if(void 0===a[this.objectIndex]){console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,a);return}a=a[this.objectIndex]}}var c=a[this.propertyName];if(c){if(void 0!==this.propertyIndex){if("morphTargetInfluences"===
this.propertyName)for(a.geometry||console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this),a.geometry.morphTargets||console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",this),b=0;b<this.node.geometry.morphTargets.length;b++)if(a.geometry.morphTargets[b].name===this.propertyIndex){this.propertyIndex=b;break}this.setValue=function(a){return this.equalsValue(c[this.propertyIndex],a)?!1:(c[this.propertyIndex]=
a,!0)};this.getValue=function(){return c[this.propertyIndex]}}else c.copy?(this.setValue=function(a){return this.equalsValue(c,a)?!1:(c.copy(a),!0)},this.getValue=function(){return c}):(this.setValue=function(b){return this.equalsValue(a[this.propertyName],b)?!1:(a[this.propertyName]=b,!0)},this.getValue=function(){return a[this.propertyName]});void 0!==a.needsUpdate?this.triggerDirty=function(){this.node.needsUpdate=!0}:void 0!==a.matrixWorldNeedsUpdate&&(this.triggerDirty=function(){a.matrixWorldNeedsUpdate=
!0});this.originalValue=this.getValue();this.equalsValue=THREE.AnimationUtils.getEqualsFunc(this.originalValue);this.lerpValue=THREE.AnimationUtils.getLerpFunc(this.originalValue,!0);this.isBound=!0}else console.error("  trying to update property for track: "+this.nodeName+"."+this.propertyName+" but it wasn't found.",a)}else console.error("  trying to update node for track: "+this.trackName+" but it wasn't found.")}},apply:function(){this.isBound||this.bind();if(0<this.cumulativeWeight){if(1>this.cumulativeWeight){var a=
1-this.cumulativeWeight;this.cumulativeValue=this.lerpValue(this.cumulativeValue,this.originalValue,a/(this.cumulativeWeight+a))}this.setValue(this.cumulativeValue)&&this.triggerDirty&&this.triggerDirty();this.cumulativeValue=null;this.cumulativeWeight=0}}};
THREE.PropertyBinding.parseTrackName=function(a){var b=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_. ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,c=b.exec(a);if(!c)throw Error("cannot parse trackName at all: "+a);c.index===b.lastIndex&&b.lastIndex++;b={directoryName:c[1],nodeName:c[3],objectName:c[5],objectIndex:c[7],propertyName:c[9],propertyIndex:c[11]};if(null===b.propertyName||0===b.propertyName.length)throw Error("can not parse propertyName from trackName: "+a);return b};
THREE.PropertyBinding.findNode=function(a,b){function c(a){for(var c=0;c<a.bones.length;c++){var d=a.bones[c];if(d.name===b)return d}return null}function d(a){for(var c=0;c<a.length;c++){var e=a[c];if(e.name===b||e.uuid===b||(e=d(e.children)))return e}return null}if(!b||""===b||"root"===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){var e=c(a.skeleton);if(e)return e}return a.children&&(e=d(a.children))?e:null};
THREE.VectorKeyframeTrack=function(a,b){THREE.KeyframeTrack.call(this,a,b);this.result=this.keys[0].value.clone()};THREE.VectorKeyframeTrack.prototype=Object.create(THREE.KeyframeTrack.prototype);THREE.VectorKeyframeTrack.prototype.constructor=THREE.VectorKeyframeTrack;THREE.VectorKeyframeTrack.prototype.setResult=function(a){this.result.copy(a)};THREE.VectorKeyframeTrack.prototype.lerpValues=function(a,b,c){return a.lerp(b,c)};THREE.VectorKeyframeTrack.prototype.compareValues=function(a,b){return a.equals(b)};
THREE.VectorKeyframeTrack.prototype.clone=function(){for(var a=[],b=0;b<this.keys.length;b++){var c=this.keys[b];a.push({time:c.time,value:c.value.clone()})}return new THREE.VectorKeyframeTrack(this.name,a)};THREE.VectorKeyframeTrack.parse=function(a){for(var b=THREE["Vector"+a.keys[0].value.length],c=[],d=0;d<a.keys.length;d++){var e=a.keys[d];c.push({value:(new b).fromArray(e.value),time:e.time})}return new THREE.VectorKeyframeTrack(a.name,c)};
THREE.QuaternionKeyframeTrack=function(a,b){THREE.KeyframeTrack.call(this,a,b);this.result=this.keys[0].value.clone()};THREE.QuaternionKeyframeTrack.prototype=Object.create(THREE.KeyframeTrack.prototype);THREE.QuaternionKeyframeTrack.prototype.constructor=THREE.QuaternionKeyframeTrack;THREE.QuaternionKeyframeTrack.prototype.setResult=function(a){this.result.copy(a)};THREE.QuaternionKeyframeTrack.prototype.lerpValues=function(a,b,c){return a.slerp(b,c)};
THREE.QuaternionKeyframeTrack.prototype.compareValues=function(a,b){return a.equals(b)};THREE.QuaternionKeyframeTrack.prototype.multiply=function(a){for(var b=0;b<this.keys.length;b++)this.keys[b].value.multiply(a);return this};THREE.QuaternionKeyframeTrack.prototype.clone=function(){for(var a=[],b=0;b<this.keys.length;b++){var c=this.keys[b];a.push({time:c.time,value:c.value.clone()})}return new THREE.QuaternionKeyframeTrack(this.name,a)};
THREE.QuaternionKeyframeTrack.parse=function(a){for(var b=[],c=0;c<a.keys.length;c++){var d=a.keys[c];b.push({value:(new THREE.Quaternion).fromArray(d.value),time:d.time})}return new THREE.QuaternionKeyframeTrack(a.name,b)};THREE.StringKeyframeTrack=function(a,b){THREE.KeyframeTrack.call(this,a,b);this.result=this.keys[0].value};THREE.StringKeyframeTrack.prototype=Object.create(THREE.KeyframeTrack.prototype);THREE.StringKeyframeTrack.prototype.constructor=THREE.StringKeyframeTrack;
THREE.StringKeyframeTrack.prototype.setResult=function(a){this.result=a};THREE.StringKeyframeTrack.prototype.lerpValues=function(a,b,c){return 1>c?a:b};THREE.StringKeyframeTrack.prototype.compareValues=function(a,b){return a===b};THREE.StringKeyframeTrack.prototype.clone=function(){for(var a=[],b=0;b<this.keys.length;b++){var c=this.keys[b];a.push({time:c.time,value:c.value})}return new THREE.StringKeyframeTrack(this.name,a)};
THREE.StringKeyframeTrack.parse=function(a){return new THREE.StringKeyframeTrack(a.name,a.keys)};THREE.BooleanKeyframeTrack=function(a,b){THREE.KeyframeTrack.call(this,a,b);this.result=this.keys[0].value};THREE.BooleanKeyframeTrack.prototype=Object.create(THREE.KeyframeTrack.prototype);THREE.BooleanKeyframeTrack.prototype.constructor=THREE.BooleanKeyframeTrack;THREE.BooleanKeyframeTrack.prototype.setResult=function(a){this.result=a};
THREE.BooleanKeyframeTrack.prototype.lerpValues=function(a,b,c){return 1>c?a:b};THREE.BooleanKeyframeTrack.prototype.compareValues=function(a,b){return a===b};THREE.BooleanKeyframeTrack.prototype.clone=function(){for(var a=[],b=0;b<this.keys.length;b++){var c=this.keys[b];a.push({time:c.time,value:c.value})}return new THREE.BooleanKeyframeTrack(this.name,a)};THREE.BooleanKeyframeTrack.parse=function(a){return new THREE.BooleanKeyframeTrack(a.name,a.keys)};
THREE.NumberKeyframeTrack=function(a,b){THREE.KeyframeTrack.call(this,a,b);this.result=this.keys[0].value};THREE.NumberKeyframeTrack.prototype=Object.create(THREE.KeyframeTrack.prototype);THREE.NumberKeyframeTrack.prototype.constructor=THREE.NumberKeyframeTrack;THREE.NumberKeyframeTrack.prototype.setResult=function(a){this.result=a};THREE.NumberKeyframeTrack.prototype.lerpValues=function(a,b,c){return a*(1-c)+b*c};THREE.NumberKeyframeTrack.prototype.compareValues=function(a,b){return a===b};
THREE.NumberKeyframeTrack.prototype.clone=function(){for(var a=[],b=0;b<this.keys.length;b++){var c=this.keys[b];a.push({time:c.time,value:c.value})}return new THREE.NumberKeyframeTrack(this.name,a)};THREE.NumberKeyframeTrack.parse=function(a){return new THREE.NumberKeyframeTrack(a.name,a.keys)};THREE.Camera=function(){THREE.Object3D.call(this);this.type="Camera";this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);
THREE.Camera.prototype.constructor=THREE.Camera;THREE.Camera.prototype.getWorldDirection=function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Vector3;this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}();THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();THREE.Camera.prototype.clone=function(){return(new this.constructor).copy(this)};
THREE.Camera.prototype.copy=function(a){THREE.Object3D.prototype.copy.call(this,a);this.matrixWorldInverse.copy(a.matrixWorldInverse);this.projectionMatrix.copy(a.projectionMatrix);return this};
THREE.CubeCamera=function(a,b,c){THREE.Object3D.call(this);this.type="CubeCamera";var d=new THREE.PerspectiveCamera(90,1,a,b);d.up.set(0,-1,0);d.lookAt(new THREE.Vector3(1,0,0));this.add(d);var e=new THREE.PerspectiveCamera(90,1,a,b);e.up.set(0,-1,0);e.lookAt(new THREE.Vector3(-1,0,0));this.add(e);var g=new THREE.PerspectiveCamera(90,1,a,b);g.up.set(0,0,1);g.lookAt(new THREE.Vector3(0,1,0));this.add(g);var f=new THREE.PerspectiveCamera(90,1,a,b);f.up.set(0,0,-1);f.lookAt(new THREE.Vector3(0,-1,0));
this.add(f);var h=new THREE.PerspectiveCamera(90,1,a,b);h.up.set(0,-1,0);h.lookAt(new THREE.Vector3(0,0,1));this.add(h);var l=new THREE.PerspectiveCamera(90,1,a,b);l.up.set(0,-1,0);l.lookAt(new THREE.Vector3(0,0,-1));this.add(l);this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(a,b){null===this.parent&&this.updateMatrixWorld();var c=this.renderTarget,n=c.texture.generateMipmaps;c.texture.generateMipmaps=
!1;c.activeCubeFace=0;a.render(b,d,c);c.activeCubeFace=1;a.render(b,e,c);c.activeCubeFace=2;a.render(b,g,c);c.activeCubeFace=3;a.render(b,f,c);c.activeCubeFace=4;a.render(b,h,c);c.texture.generateMipmaps=n;c.activeCubeFace=5;a.render(b,l,c);a.setRenderTarget(null)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CubeCamera.prototype.constructor=THREE.CubeCamera;
THREE.OrthographicCamera=function(a,b,c,d,e,g){THREE.Camera.call(this);this.type="OrthographicCamera";this.zoom=1;this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:.1;this.far=void 0!==g?g:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera;
THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(c-a,c+a,d+b,d-b,this.near,this.far)};THREE.OrthographicCamera.prototype.copy=function(a){THREE.Camera.prototype.copy.call(this,a);this.left=a.left;this.right=a.right;this.top=a.top;this.bottom=a.bottom;this.near=a.near;this.far=a.far;this.zoom=a.zoom;return this};
THREE.OrthographicCamera.prototype.toJSON=function(a){a=THREE.Object3D.prototype.toJSON.call(this,a);a.object.zoom=this.zoom;a.object.left=this.left;a.object.right=this.right;a.object.top=this.top;a.object.bottom=this.bottom;a.object.near=this.near;a.object.far=this.far;return a};THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this);this.type="PerspectiveCamera";this.zoom=1;this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:.1;this.far=void 0!==d?d:2E3;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera;THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,g){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=d;this.width=e;this.height=g;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var a=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var b=this.fullWidth/this.fullHeight,a=Math.tan(THREE.Math.degToRad(.5*a))*this.near,c=-a,d=b*c,b=Math.abs(b*a-d),c=Math.abs(a-c);this.projectionMatrix.makeFrustum(d+this.x*b/this.fullWidth,d+(this.x+this.width)*b/this.fullWidth,a-(this.y+this.height)*c/this.fullHeight,a-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(a,
this.aspect,this.near,this.far)};THREE.PerspectiveCamera.prototype.copy=function(a){THREE.Camera.prototype.copy.call(this,a);this.fov=a.fov;this.aspect=a.aspect;this.near=a.near;this.far=a.far;this.zoom=a.zoom;return this};THREE.PerspectiveCamera.prototype.toJSON=function(a){a=THREE.Object3D.prototype.toJSON.call(this,a);a.object.zoom=this.zoom;a.object.fov=this.fov;a.object.aspect=this.aspect;a.object.near=this.near;a.object.far=this.far;return a};
THREE.Light=function(a){THREE.Object3D.call(this);this.type="Light";this.color=new THREE.Color(a);this.receiveShadow=void 0};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.constructor=THREE.Light;
Object.defineProperties(THREE.Light.prototype,{onlyShadow:{set:function(a){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){this.shadow.camera.near=
a}},shadowCameraFar:{set:function(a){this.shadow.camera.far=a}},shadowCameraVisible:{set:function(a){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow ) instead.")}},shadowBias:{set:function(a){this.shadow.bias=a}},shadowDarkness:{set:function(a){this.shadow.darkness=a}},shadowMapWidth:{set:function(a){this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){this.shadow.mapSize.height=a}}});
THREE.Light.prototype.copy=function(a){THREE.Object3D.prototype.copy.call(this,a);this.color.copy(a.color);return this};
THREE.Light.prototype.toJSON=function(a){a=THREE.Object3D.prototype.toJSON.call(this,a);a.object.color=this.color.getHex();void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex());void 0!==this.intensity&&(a.object.intensity=this.intensity);void 0!==this.distance&&(a.object.distance=this.distance);void 0!==this.angle&&(a.object.angle=this.angle);void 0!==this.decay&&(a.object.decay=this.decay);void 0!==this.exponent&&(a.object.exponent=this.exponent);return a};
THREE.LightShadow=function(a){this.camera=a;this.bias=0;this.darkness=1;this.mapSize=new THREE.Vector2(512,512);this.matrix=this.map=null};THREE.LightShadow.prototype={constructor:THREE.LightShadow,copy:function(a){this.camera=a.camera.clone();this.bias=a.bias;this.darkness=a.darkness;this.mapSize.copy(a.mapSize)},clone:function(){return(new this.constructor).copy(this)}};THREE.AmbientLight=function(a){THREE.Light.call(this,a);this.type="AmbientLight";this.castShadow=void 0};
THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.constructor=THREE.AmbientLight;THREE.DirectionalLight=function(a,b){THREE.Light.call(this,a);this.type="DirectionalLight";this.position.set(0,1,0);this.updateMatrix();this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.shadow=new THREE.LightShadow(new THREE.OrthographicCamera(-500,500,500,-500,50,5E3))};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight;THREE.DirectionalLight.prototype.copy=function(a){THREE.Light.prototype.copy.call(this,a);this.intensity=a.intensity;this.target=a.target.clone();this.shadow=a.shadow.clone();return this};THREE.HemisphereLight=function(a,b,c){THREE.Light.call(this,a);this.type="HemisphereLight";this.castShadow=void 0;this.position.set(0,1,0);this.updateMatrix();this.groundColor=new THREE.Color(b);this.intensity=void 0!==c?c:1};
THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);THREE.HemisphereLight.prototype.constructor=THREE.HemisphereLight;THREE.HemisphereLight.prototype.copy=function(a){THREE.Light.prototype.copy.call(this,a);this.groundColor.copy(a.groundColor);this.intensity=a.intensity;return this};
THREE.PointLight=function(a,b,c,d){THREE.Light.call(this,a);this.type="PointLight";this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.decay=void 0!==d?d:1;this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(90,1,1,500))};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);THREE.PointLight.prototype.constructor=THREE.PointLight;
THREE.PointLight.prototype.copy=function(a){THREE.Light.prototype.copy.call(this,a);this.intensity=a.intensity;this.distance=a.distance;this.decay=a.decay;this.shadow=a.shadow.clone();return this};
THREE.SpotLight=function(a,b,c,d,e,g){THREE.Light.call(this,a);this.type="SpotLight";this.position.set(0,1,0);this.updateMatrix();this.target=new THREE.Object3D;this.intensity=void 0!==b?b:1;this.distance=void 0!==c?c:0;this.angle=void 0!==d?d:Math.PI/3;this.exponent=void 0!==e?e:10;this.decay=void 0!==g?g:1;this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(50,1,50,5E3))};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.constructor=THREE.SpotLight;
THREE.SpotLight.prototype.copy=function(a){THREE.Light.prototype.copy.call(this,a);this.intensity=a.intensity;this.distance=a.distance;this.angle=a.angle;this.exponent=a.exponent;this.decay=a.decay;this.target=a.target.clone();this.shadow=a.shadow.clone();return this};THREE.Cache={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};
THREE.Loader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:void 0,extractUrlBase:function(a){a=a.split("/");if(1===a.length)return"./";a.pop();return a.join("/")+"/"},initMaterials:function(a,b,c){for(var d=[],e=0;e<a.length;++e)d[e]=this.createMaterial(a[e],b,c);return d},createMaterial:function(){var a,b,c;return function(d,e,g){function f(a,c,d,f,l){a=e+a;var k=THREE.Loader.Handlers.get(a);null!==k?a=k.load(a):(b.setCrossOrigin(g),a=b.load(a));void 0!==c&&(a.repeat.fromArray(c),1!==c[0]&&(a.wrapS=
THREE.RepeatWrapping),1!==c[1]&&(a.wrapT=THREE.RepeatWrapping));void 0!==d&&a.offset.fromArray(d);void 0!==f&&("repeat"===f[0]&&(a.wrapS=THREE.RepeatWrapping),"mirror"===f[0]&&(a.wrapS=THREE.MirroredRepeatWrapping),"repeat"===f[1]&&(a.wrapT=THREE.RepeatWrapping),"mirror"===f[1]&&(a.wrapT=THREE.MirroredRepeatWrapping));void 0!==l&&(a.anisotropy=l);c=THREE.Math.generateUUID();h[c]=a;return c}void 0===a&&(a=new THREE.Color);void 0===b&&(b=new THREE.TextureLoader);void 0===c&&(c=new THREE.MaterialLoader);
var h={},l={uuid:THREE.Math.generateUUID(),type:"MeshLambertMaterial"},k;for(k in d){var m=d[k];switch(k){case "DbgColor":l.color=m;break;case "DbgIndex":case "opticalDensity":case "illumination":break;case "DbgName":l.name=m;break;case "blending":l.blending=THREE[m];break;case "colorDiffuse":l.color=a.fromArray(m).getHex();break;case "colorSpecular":l.specular=a.fromArray(m).getHex();break;case "colorEmissive":l.emissive=a.fromArray(m).getHex();break;case "specularCoef":l.shininess=m;break;case "shading":"basic"===
m.toLowerCase()&&(l.type="MeshBasicMaterial");"phong"===m.toLowerCase()&&(l.type="MeshPhongMaterial");break;case "mapDiffuse":l.map=f(m,d.mapDiffuseRepeat,d.mapDiffuseOffset,d.mapDiffuseWrap,d.mapDiffuseAnisotropy);break;case "mapDiffuseRepeat":case "mapDiffuseOffset":case "mapDiffuseWrap":case "mapDiffuseAnisotropy":break;case "mapLight":l.lightMap=f(m,d.mapLightRepeat,d.mapLightOffset,d.mapLightWrap,d.mapLightAnisotropy);break;case "mapLightRepeat":case "mapLightOffset":case "mapLightWrap":case "mapLightAnisotropy":break;
case "mapAO":l.aoMap=f(m,d.mapAORepeat,d.mapAOOffset,d.mapAOWrap,d.mapAOAnisotropy);break;case "mapAORepeat":case "mapAOOffset":case "mapAOWrap":case "mapAOAnisotropy":break;case "mapBump":l.bumpMap=f(m,d.mapBumpRepeat,d.mapBumpOffset,d.mapBumpWrap,d.mapBumpAnisotropy);break;case "mapBumpScale":l.bumpScale=m;break;case "mapBumpRepeat":case "mapBumpOffset":case "mapBumpWrap":case "mapBumpAnisotropy":break;case "mapNormal":l.normalMap=f(m,d.mapNormalRepeat,d.mapNormalOffset,d.mapNormalWrap,d.mapNormalAnisotropy);
break;case "mapNormalFactor":l.normalScale=[m,m];break;case "mapNormalRepeat":case "mapNormalOffset":case "mapNormalWrap":case "mapNormalAnisotropy":break;case "mapSpecular":l.specularMap=f(m,d.mapSpecularRepeat,d.mapSpecularOffset,d.mapSpecularWrap,d.mapSpecularAnisotropy);break;case "mapSpecularRepeat":case "mapSpecularOffset":case "mapSpecularWrap":case "mapSpecularAnisotropy":break;case "mapAlpha":l.alphaMap=f(m,d.mapAlphaRepeat,d.mapAlphaOffset,d.mapAlphaWrap,d.mapAlphaAnisotropy);break;case "mapAlphaRepeat":case "mapAlphaOffset":case "mapAlphaWrap":case "mapAlphaAnisotropy":break;
case "flipSided":l.side=THREE.BackSide;break;case "doubleSided":l.side=THREE.DoubleSide;break;case "transparency":console.warn("THREE.Loader: transparency has been renamed to opacity");l.opacity=m;break;case "opacity":case "transparent":case "depthTest":case "depthWrite":case "transparent":case "visible":case "wireframe":l[k]=m;break;case "vertexColors":!0===m&&(l.vertexColors=THREE.VertexColors);"face"===m&&(l.vertexColors=THREE.FaceColors);break;default:console.error("Loader.createMaterial: Unsupported",
k,m)}}"MeshPhongMaterial"!==l.type&&delete l.specular;1>l.opacity&&(l.transparent=!0);c.setTextures(h);return c.parse(l)}}()};THREE.Loader.Handlers={handlers:[],add:function(a,b){this.handlers.push(a,b)},get:function(a){for(var b=this.handlers,c=0,d=b.length;c<d;c+=2){var e=b[c+1];if(b[c].test(a))return e}return null}};THREE.XHRLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(a,b,c,d){var e=this,g=THREE.Cache.get(a);if(void 0!==g)return b&&setTimeout(function(){b(g)},0),g;var f=new XMLHttpRequest;f.open("GET",a,!0);f.addEventListener("load",function(c){c=c.target.response;THREE.Cache.add(a,c);b&&b(c);e.manager.itemEnd(a)},!1);void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1);f.addEventListener("error",function(b){d&&d(b);e.manager.itemError(a)},!1);void 0!==this.crossOrigin&&(f.crossOrigin=
this.crossOrigin);void 0!==this.responseType&&(f.responseType=this.responseType);void 0!==this.withCredentials&&(f.withCredentials=this.withCredentials);f.send(null);e.manager.itemStart(a);return f},setResponseType:function(a){this.responseType=a},setCrossOrigin:function(a){this.crossOrigin=a},setWithCredentials:function(a){this.withCredentials=a}};THREE.ImageLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,b,c,d){var e=this,g=THREE.Cache.get(a);if(void 0!==g)return e.manager.itemStart(a),b?setTimeout(function(){b(g);e.manager.itemEnd(a)},0):e.manager.itemEnd(a),g;var f=document.createElement("img");f.addEventListener("load",function(c){THREE.Cache.add(a,this);b&&b(this);e.manager.itemEnd(a)},!1);void 0!==c&&f.addEventListener("progress",function(a){c(a)},!1);f.addEventListener("error",function(b){d&&d(b);e.manager.itemError(a)},
!1);void 0!==this.crossOrigin&&(f.crossOrigin=this.crossOrigin);e.manager.itemStart(a);f.src=a;return f},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.JSONLoader=function(a){"boolean"===typeof a&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),a=void 0);this.manager=void 0!==a?a:THREE.DefaultLoadingManager;this.withCredentials=!1};
THREE.JSONLoader.prototype={constructor:THREE.JSONLoader,get statusDomElement(){void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div"));console.warn("THREE.JSONLoader: .statusDomElement has been removed.");return this._statusDomElement},load:function(a,b,c,d){var e=this,g=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:THREE.Loader.prototype.extractUrlBase(a);c=new THREE.XHRLoader(this.manager);c.setCrossOrigin(this.crossOrigin);c.setWithCredentials(this.withCredentials);
c.load(a,function(c){c=JSON.parse(c);var d=c.metadata;if(void 0!==d){if("object"===d.type){console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.ObjectLoader instead.");return}if("scene"===d.type){console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.SceneLoader instead.");return}}c=e.parse(c,g);b(c.geometry,c.materials)})},setCrossOrigin:function(a){this.crossOrigin=a},setTexturePath:function(a){this.texturePath=a},parse:function(a,b){var c=new THREE.Geometry,d=void 0!==
a.scale?1/a.scale:1;(function(b){var d,f,h,l,k,m,p,n,q,s,t,v,u,w=a.faces;m=a.vertices;var D=a.normals,x=a.colors,B=0;if(void 0!==a.uvs){for(d=0;d<a.uvs.length;d++)a.uvs[d].length&&B++;for(d=0;d<B;d++)c.faceVertexUvs[d]=[]}l=0;for(k=m.length;l<k;)d=new THREE.Vector3,d.x=m[l++]*b,d.y=m[l++]*b,d.z=m[l++]*b,c.vertices.push(d);l=0;for(k=w.length;l<k;)if(b=w[l++],q=b&1,h=b&2,d=b&8,p=b&16,s=b&32,m=b&64,b&=128,q){q=new THREE.Face3;q.a=w[l];q.b=w[l+1];q.c=w[l+3];t=new THREE.Face3;t.a=w[l+1];t.b=w[l+2];t.c=
w[l+3];l+=4;h&&(h=w[l++],q.materialIndex=h,t.materialIndex=h);h=c.faces.length;if(d)for(d=0;d<B;d++)for(v=a.uvs[d],c.faceVertexUvs[d][h]=[],c.faceVertexUvs[d][h+1]=[],f=0;4>f;f++)n=w[l++],u=v[2*n],n=v[2*n+1],u=new THREE.Vector2(u,n),2!==f&&c.faceVertexUvs[d][h].push(u),0!==f&&c.faceVertexUvs[d][h+1].push(u);p&&(p=3*w[l++],q.normal.set(D[p++],D[p++],D[p]),t.normal.copy(q.normal));if(s)for(d=0;4>d;d++)p=3*w[l++],s=new THREE.Vector3(D[p++],D[p++],D[p]),2!==d&&q.vertexNormals.push(s),0!==d&&t.vertexNormals.push(s);
m&&(m=w[l++],m=x[m],q.color.setHex(m),t.color.setHex(m));if(b)for(d=0;4>d;d++)m=w[l++],m=x[m],2!==d&&q.vertexColors.push(new THREE.Color(m)),0!==d&&t.vertexColors.push(new THREE.Color(m));c.faces.push(q);c.faces.push(t)}else{q=new THREE.Face3;q.a=w[l++];q.b=w[l++];q.c=w[l++];h&&(h=w[l++],q.materialIndex=h);h=c.faces.length;if(d)for(d=0;d<B;d++)for(v=a.uvs[d],c.faceVertexUvs[d][h]=[],f=0;3>f;f++)n=w[l++],u=v[2*n],n=v[2*n+1],u=new THREE.Vector2(u,n),c.faceVertexUvs[d][h].push(u);p&&(p=3*w[l++],q.normal.set(D[p++],
D[p++],D[p]));if(s)for(d=0;3>d;d++)p=3*w[l++],s=new THREE.Vector3(D[p++],D[p++],D[p]),q.vertexNormals.push(s);m&&(m=w[l++],q.color.setHex(x[m]));if(b)for(d=0;3>d;d++)m=w[l++],q.vertexColors.push(new THREE.Color(x[m]));c.faces.push(q)}})(d);(function(){var b=void 0!==a.influencesPerVertex?a.influencesPerVertex:2;if(a.skinWeights)for(var d=0,f=a.skinWeights.length;d<f;d+=b)c.skinWeights.push(new THREE.Vector4(a.skinWeights[d],1<b?a.skinWeights[d+1]:0,2<b?a.skinWeights[d+2]:0,3<b?a.skinWeights[d+3]:
0));if(a.skinIndices)for(d=0,f=a.skinIndices.length;d<f;d+=b)c.skinIndices.push(new THREE.Vector4(a.skinIndices[d],1<b?a.skinIndices[d+1]:0,2<b?a.skinIndices[d+2]:0,3<b?a.skinIndices[d+3]:0));c.bones=a.bones;c.bones&&0<c.bones.length&&(c.skinWeights.length!==c.skinIndices.length||c.skinIndices.length!==c.vertices.length)&&console.warn("When skinning, number of vertices ("+c.vertices.length+"), skinIndices ("+c.skinIndices.length+"), and skinWeights ("+c.skinWeights.length+") should match.")})();(function(b){if(void 0!==
a.morphTargets)for(var d=0,f=a.morphTargets.length;d<f;d++){c.morphTargets[d]={};c.morphTargets[d].name=a.morphTargets[d].name;c.morphTargets[d].vertices=[];for(var h=c.morphTargets[d].vertices,l=a.morphTargets[d].vertices,k=0,m=l.length;k<m;k+=3){var p=new THREE.Vector3;p.x=l[k]*b;p.y=l[k+1]*b;p.z=l[k+2]*b;h.push(p)}}if(void 0!==a.morphColors&&0<a.morphColors.length)for(console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.'),b=c.faces,h=a.morphColors[0].colors,
d=0,f=b.length;d<f;d++)b[d].color.fromArray(h,3*d)})(d);(function(){var b=[],d=[];void 0!==a.animation&&d.push(a.animation);void 0!==a.animations&&(a.animations.length?d=d.concat(a.animations):d.push(a.animations));for(var f=0;f<d.length;f++){var h=THREE.AnimationClip.parseAnimation(d[f],c.bones);h&&b.push(h)}c.morphTargets&&(d=THREE.AnimationClip.CreateClipsFromMorphTargetSequences(c.morphTargets,10),b=b.concat(d));0<b.length&&(c.animations=b)})();c.computeFaceNormals();c.computeBoundingSphere();
if(void 0===a.materials||0===a.materials.length)return{geometry:c};d=THREE.Loader.prototype.initMaterials(a.materials,b,this.crossOrigin);return{geometry:c,materials:d}}};
THREE.LoadingManager=function(a,b,c){var d=this,e=!1,g=0,f=0;this.onStart=void 0;this.onLoad=a;this.onProgress=b;this.onError=c;this.itemStart=function(a){f++;if(!1===e&&void 0!==d.onStart)d.onStart(a,g,f);e=!0};this.itemEnd=function(a){g++;if(void 0!==d.onProgress)d.onProgress(a,g,f);if(g===f&&(e=!1,void 0!==d.onLoad))d.onLoad()};this.itemError=function(a){if(void 0!==d.onError)d.onError(a)}};THREE.DefaultLoadingManager=new THREE.LoadingManager;
THREE.BufferGeometryLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(a,b,c,d){var e=this,g=new THREE.XHRLoader(e.manager);g.setCrossOrigin(this.crossOrigin);g.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a){var b=new THREE.BufferGeometry,c=a.data.index;void 0!==c&&(c=new self[c.type](c.array),b.setIndex(new THREE.BufferAttribute(c,1)));var d=a.data.attributes,e;for(e in d){var g=d[e],c=new self[g.type](g.array);
b.addAttribute(e,new THREE.BufferAttribute(c,g.itemSize))}e=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==e)for(c=0,d=e.length;c!==d;++c)g=e[c],b.addGroup(g.start,g.count);a=a.data.boundingSphere;void 0!==a&&(e=new THREE.Vector3,void 0!==a.center&&e.fromArray(a.center),b.boundingSphere=new THREE.Sphere(e,a.radius));return b}};THREE.MaterialLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager;this.textures={}};
THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(a,b,c,d){var e=this,g=new THREE.XHRLoader(e.manager);g.setCrossOrigin(this.crossOrigin);g.load(a,function(a){b(e.parse(JSON.parse(a)))},c,d)},setCrossOrigin:function(a){this.crossOrigin=a},setTextures:function(a){this.textures=a},getTexture:function(a){var b=this.textures;void 0===b[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a);return b[a]},parse:function(a){var b=new THREE[a.type];b.uuid=a.uuid;void 0!==
a.name&&(b.name=a.name);void 0!==a.color&&b.color.setHex(a.color);void 0!==a.emissive&&b.emissive.setHex(a.emissive);void 0!==a.specular&&b.specular.setHex(a.specular);void 0!==a.shininess&&(b.shininess=a.shininess);void 0!==a.uniforms&&(b.uniforms=a.uniforms);void 0!==a.vertexShader&&(b.vertexShader=a.vertexShader);void 0!==a.fragmentShader&&(b.fragmentShader=a.fragmentShader);void 0!==a.vertexColors&&(b.vertexColors=a.vertexColors);void 0!==a.shading&&(b.shading=a.shading);void 0!==a.blending&&
(b.blending=a.blending);void 0!==a.side&&(b.side=a.side);void 0!==a.opacity&&(b.opacity=a.opacity);void 0!==a.transparent&&(b.transparent=a.transparent);void 0!==a.alphaTest&&(b.alphaTest=a.alphaTest);void 0!==a.depthTest&&(b.depthTest=a.depthTest);void 0!==a.depthWrite&&(b.depthWrite=a.depthWrite);void 0!==a.wireframe&&(b.wireframe=a.wireframe);void 0!==a.wireframeLinewidth&&(b.wireframeLinewidth=a.wireframeLinewidth);void 0!==a.size&&(b.size=a.size);void 0!==a.sizeAttenuation&&(b.sizeAttenuation=
a.sizeAttenuation);void 0!==a.map&&(b.map=this.getTexture(a.map));void 0!==a.alphaMap&&(b.alphaMap=this.getTexture(a.alphaMap),b.transparent=!0);void 0!==a.bumpMap&&(b.bumpMap=this.getTexture(a.bumpMap));void 0!==a.bumpScale&&(b.bumpScale=a.bumpScale);void 0!==a.normalMap&&(b.normalMap=this.getTexture(a.normalMap));a.normalScale&&(b.normalScale=new THREE.Vector2(a.normalScale,a.normalScale));void 0!==a.displacementMap&&(b.displacementMap=this.getTexture(a.displacementMap));void 0!==a.displacementScale&&
(b.displacementScale=a.displacementScale);void 0!==a.displacementBias&&(b.displacementBias=a.displacementBias);void 0!==a.specularMap&&(b.specularMap=this.getTexture(a.specularMap));void 0!==a.envMap&&(b.envMap=this.getTexture(a.envMap),b.combine=THREE.MultiplyOperation);a.reflectivity&&(b.reflectivity=a.reflectivity);void 0!==a.lightMap&&(b.lightMap=this.getTexture(a.lightMap));void 0!==a.lightMapIntensity&&(b.lightMapIntensity=a.lightMapIntensity);void 0!==a.aoMap&&(b.aoMap=this.getTexture(a.aoMap));
void 0!==a.aoMapIntensity&&(b.aoMapIntensity=a.aoMapIntensity);if(void 0!==a.materials)for(var c=0,d=a.materials.length;c<d;c++)b.materials.push(this.parse(a.materials[c]));return b}};THREE.ObjectLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager;this.texturePath=""};
THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(a,b,c,d){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var e=this,g=new THREE.XHRLoader(e.manager);g.setCrossOrigin(this.crossOrigin);g.load(a,function(a){e.parse(JSON.parse(a),b)},c,d)},setTexturePath:function(a){this.texturePath=a},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a,b){var c=this.parseGeometries(a.geometries),d=this.parseImages(a.images,function(){void 0!==b&&b(e)}),
d=this.parseTextures(a.textures,d),d=this.parseMaterials(a.materials,d),e=this.parseObject(a.object,c,d);a.animations&&(e.animations=this.parseAnimations(a.animations));void 0!==a.images&&0!==a.images.length||void 0===b||b(e);return e},parseGeometries:function(a){var b={};if(void 0!==a)for(var c=new THREE.JSONLoader,d=new THREE.BufferGeometryLoader,e=0,g=a.length;e<g;e++){var f,h=a[e];switch(h.type){case "PlaneGeometry":case "PlaneBufferGeometry":f=new THREE[h.type](h.width,h.height,h.widthSegments,
h.heightSegments);break;case "BoxGeometry":case "CubeGeometry":f=new THREE.BoxGeometry(h.width,h.height,h.depth,h.widthSegments,h.heightSegments,h.depthSegments);break;case "CircleBufferGeometry":f=new THREE.CircleBufferGeometry(h.radius,h.segments,h.thetaStart,h.thetaLength);break;case "CircleGeometry":f=new THREE.CircleGeometry(h.radius,h.segments,h.thetaStart,h.thetaLength);break;case "CylinderGeometry":f=new THREE.CylinderGeometry(h.radiusTop,h.radiusBottom,h.height,h.radialSegments,h.heightSegments,
h.openEnded,h.thetaStart,h.thetaLength);break;case "SphereGeometry":f=new THREE.SphereGeometry(h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case "SphereBufferGeometry":f=new THREE.SphereBufferGeometry(h.radius,h.widthSegments,h.heightSegments,h.phiStart,h.phiLength,h.thetaStart,h.thetaLength);break;case "DodecahedronGeometry":f=new THREE.DodecahedronGeometry(h.radius,h.detail);break;case "IcosahedronGeometry":f=new THREE.IcosahedronGeometry(h.radius,
h.detail);break;case "OctahedronGeometry":f=new THREE.OctahedronGeometry(h.radius,h.detail);break;case "TetrahedronGeometry":f=new THREE.TetrahedronGeometry(h.radius,h.detail);break;case "RingGeometry":f=new THREE.RingGeometry(h.innerRadius,h.outerRadius,h.thetaSegments,h.phiSegments,h.thetaStart,h.thetaLength);break;case "TorusGeometry":f=new THREE.TorusGeometry(h.radius,h.tube,h.radialSegments,h.tubularSegments,h.arc);break;case "TorusKnotGeometry":f=new THREE.TorusKnotGeometry(h.radius,h.tube,
h.radialSegments,h.tubularSegments,h.p,h.q,h.heightScale);break;case "BufferGeometry":f=d.parse(h);break;case "Geometry":f=c.parse(h.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+h.type+'"');continue}f.uuid=h.uuid;void 0!==h.name&&(f.name=h.name);b[h.uuid]=f}return b},parseMaterials:function(a,b){var c={};if(void 0!==a){var d=new THREE.MaterialLoader;d.setTextures(b);for(var e=0,g=a.length;e<g;e++){var f=d.parse(a[e]);c[f.uuid]=f}}return c},
parseAnimations:function(a){for(var b=[],c=0;c<a.length;c++){var d=THREE.AnimationClip.parse(a[c]);b.push(d)}return b},parseImages:function(a,b){function c(a){d.manager.itemStart(a);return f.load(a,function(){d.manager.itemEnd(a)})}var d=this,e={};if(void 0!==a&&0<a.length){var g=new THREE.LoadingManager(b),f=new THREE.ImageLoader(g);f.setCrossOrigin(this.crossOrigin);for(var g=0,h=a.length;g<h;g++){var l=a[g],k=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:d.texturePath+l.url;e[l.uuid]=c(k)}}return e},
parseTextures:function(a,b){function c(a){if("number"===typeof a)return a;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",a);return THREE[a]}var d={};if(void 0!==a)for(var e=0,g=a.length;e<g;e++){var f=a[e];void 0===f.image&&console.warn('THREE.ObjectLoader: No "image" specified for',f.uuid);void 0===b[f.image]&&console.warn("THREE.ObjectLoader: Undefined image",f.image);var h=new THREE.Texture(b[f.image]);h.needsUpdate=!0;h.uuid=f.uuid;void 0!==f.name&&(h.name=
f.name);void 0!==f.mapping&&(h.mapping=c(f.mapping));void 0!==f.offset&&(h.offset=new THREE.Vector2(f.offset[0],f.offset[1]));void 0!==f.repeat&&(h.repeat=new THREE.Vector2(f.repeat[0],f.repeat[1]));void 0!==f.minFilter&&(h.minFilter=c(f.minFilter));void 0!==f.magFilter&&(h.magFilter=c(f.magFilter));void 0!==f.anisotropy&&(h.anisotropy=f.anisotropy);Array.isArray(f.wrap)&&(h.wrapS=c(f.wrap[0]),h.wrapT=c(f.wrap[1]));d[f.uuid]=h}return d},parseObject:function(){var a=new THREE.Matrix4;return function(b,
c,d){function e(a){void 0===c[a]&&console.warn("THREE.ObjectLoader: Undefined geometry",a);return c[a]}function g(a){if(void 0!==a)return void 0===d[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),d[a]}var f;switch(b.type){case "Scene":f=new THREE.Scene;break;case "PerspectiveCamera":f=new THREE.PerspectiveCamera(b.fov,b.aspect,b.near,b.far);break;case "OrthographicCamera":f=new THREE.OrthographicCamera(b.left,b.right,b.top,b.bottom,b.near,b.far);break;case "AmbientLight":f=new THREE.AmbientLight(b.color);
break;case "DirectionalLight":f=new THREE.DirectionalLight(b.color,b.intensity);break;case "PointLight":f=new THREE.PointLight(b.color,b.intensity,b.distance,b.decay);break;case "SpotLight":f=new THREE.SpotLight(b.color,b.intensity,b.distance,b.angle,b.exponent,b.decay);break;case "HemisphereLight":f=new THREE.HemisphereLight(b.color,b.groundColor,b.intensity);break;case "Mesh":f=new THREE.Mesh(e(b.geometry),g(b.material));break;case "LOD":f=new THREE.LOD;break;case "Line":f=new THREE.Line(e(b.geometry),
g(b.material),b.mode);break;case "PointCloud":case "Points":f=new THREE.Points(e(b.geometry),g(b.material));break;case "Sprite":f=new THREE.Sprite(g(b.material));break;case "Group":f=new THREE.Group;break;default:f=new THREE.Object3D}f.uuid=b.uuid;void 0!==b.name&&(f.name=b.name);void 0!==b.matrix?(a.fromArray(b.matrix),a.decompose(f.position,f.quaternion,f.scale)):(void 0!==b.position&&f.position.fromArray(b.position),void 0!==b.rotation&&f.rotation.fromArray(b.rotation),void 0!==b.scale&&f.scale.fromArray(b.scale));
void 0!==b.castShadow&&(f.castShadow=b.castShadow);void 0!==b.receiveShadow&&(f.receiveShadow=b.receiveShadow);void 0!==b.visible&&(f.visible=b.visible);void 0!==b.userData&&(f.userData=b.userData);if(void 0!==b.children)for(var h in b.children)f.add(this.parseObject(b.children[h],c,d));if("LOD"===b.type){b=b.levels;for(var l=0;l<b.length;l++){var k=b[l];h=f.getObjectByProperty("uuid",k.object);void 0!==h&&f.addLevel(h,k.distance)}}return f}}()};
THREE.TextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(a,b,c,d){var e=new THREE.Texture,g=new THREE.ImageLoader(this.manager);g.setCrossOrigin(this.crossOrigin);g.load(a,function(a){e.image=a;e.needsUpdate=!0;void 0!==b&&b(e)},c,d);return e},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.CubeTextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager};
THREE.CubeTextureLoader.prototype={constructor:THREE.CubeTextureLoader,load:function(a,b,c,d){function e(c){f.load(a[c],function(a){g.images[c]=a;h++;6===h&&(g.needsUpdate=!0,b&&b(g))},void 0,d)}var g=new THREE.CubeTexture([]),f=new THREE.ImageLoader;f.setCrossOrigin(this.crossOrigin);var h=0;for(c=0;c<a.length;++c)e(c);return g},setCrossOrigin:function(a){this.crossOrigin=a}};
THREE.DataTextureLoader=THREE.BinaryTextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager;this._parser=null};
THREE.BinaryTextureLoader.prototype={constructor:THREE.BinaryTextureLoader,load:function(a,b,c,d){var e=this,g=new THREE.DataTexture,f=new THREE.XHRLoader(this.manager);f.setCrossOrigin(this.crossOrigin);f.setResponseType("arraybuffer");f.load(a,function(a){if(a=e._parser(a))void 0!==a.image?g.image=a.image:void 0!==a.data&&(g.image.width=a.width,g.image.height=a.height,g.image.data=a.data),g.wrapS=void 0!==a.wrapS?a.wrapS:THREE.ClampToEdgeWrapping,g.wrapT=void 0!==a.wrapT?a.wrapT:THREE.ClampToEdgeWrapping,
g.magFilter=void 0!==a.magFilter?a.magFilter:THREE.LinearFilter,g.minFilter=void 0!==a.minFilter?a.minFilter:THREE.LinearMipMapLinearFilter,g.anisotropy=void 0!==a.anisotropy?a.anisotropy:1,void 0!==a.format&&(g.format=a.format),void 0!==a.type&&(g.type=a.type),void 0!==a.mipmaps&&(g.mipmaps=a.mipmaps),1===a.mipmapCount&&(g.minFilter=THREE.LinearFilter),g.needsUpdate=!0,b&&b(g,a)},c,d);return g},setCrossOrigin:function(a){this.crossOrigin=a}};
THREE.CompressedTextureLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager;this._parser=null};
THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function(a,b,c,d){var e=this,g=[],f=new THREE.CompressedTexture;f.image=g;var h=new THREE.XHRLoader(this.manager);h.setCrossOrigin(this.crossOrigin);h.setResponseType("arraybuffer");if(Array.isArray(a))for(var l=0,k=function(k){h.load(a[k],function(a){a=e._parser(a,!0);g[k]={width:a.width,height:a.height,format:a.format,mipmaps:a.mipmaps};l+=1;6===l&&(1===a.mipmapCount&&(f.minFilter=THREE.LinearFilter),f.format=
a.format,f.needsUpdate=!0,b&&b(f))},c,d)},m=0,p=a.length;m<p;++m)k(m);else h.load(a,function(a){a=e._parser(a,!0);if(a.isCubemap)for(var c=a.mipmaps.length/a.mipmapCount,d=0;d<c;d++){g[d]={mipmaps:[]};for(var h=0;h<a.mipmapCount;h++)g[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+h]),g[d].format=a.format,g[d].width=a.width,g[d].height=a.height}else f.image.width=a.width,f.image.height=a.height,f.mipmaps=a.mipmaps;1===a.mipmapCount&&(f.minFilter=THREE.LinearFilter);f.format=a.format;f.needsUpdate=!0;b&&
b(f)},c,d);return f},setCrossOrigin:function(a){this.crossOrigin=a}};
THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Material";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=THREE.LessEqualDepth;this.colorWrite=this.depthWrite=
this.depthTest=!0;this.precision=null;this.polygonOffset=!1;this.overdraw=this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this._needsUpdate=this.visible=!0};
THREE.Material.prototype={constructor:THREE.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},setValues:function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("THREE.Material: '"+b+"' parameter is undefined.");else{var d=this[b];void 0===d?console.warn("THREE."+this.type+": '"+b+"' is not a property of this material."):d instanceof THREE.Color?d.set(c):d instanceof THREE.Vector3&&c instanceof THREE.Vector3?d.copy(c):
this[b]="overdraw"===b?Number(c):c}}},toJSON:function(a){var b={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};b.uuid=this.uuid;b.type=this.type;""!==this.name&&(b.name=this.name);this.color instanceof THREE.Color&&(b.color=this.color.getHex());this.emissive instanceof THREE.Color&&(b.emissive=this.emissive.getHex());this.specular instanceof THREE.Color&&(b.specular=this.specular.getHex());void 0!==this.shininess&&(b.shininess=this.shininess);this.map instanceof THREE.Texture&&
(b.map=this.map.toJSON(a).uuid);this.alphaMap instanceof THREE.Texture&&(b.alphaMap=this.alphaMap.toJSON(a).uuid);this.lightMap instanceof THREE.Texture&&(b.lightMap=this.lightMap.toJSON(a).uuid);this.bumpMap instanceof THREE.Texture&&(b.bumpMap=this.bumpMap.toJSON(a).uuid,b.bumpScale=this.bumpScale);this.normalMap instanceof THREE.Texture&&(b.normalMap=this.normalMap.toJSON(a).uuid,b.normalScale=this.normalScale);this.displacementMap instanceof THREE.Texture&&(b.displacementMap=this.displacementMap.toJSON(a).uuid,
b.displacementScale=this.displacementScale,b.displacementBias=this.displacementBias);this.specularMap instanceof THREE.Texture&&(b.specularMap=this.specularMap.toJSON(a).uuid);this.envMap instanceof THREE.Texture&&(b.envMap=this.envMap.toJSON(a).uuid,b.reflectivity=this.reflectivity);void 0!==this.size&&(b.size=this.size);void 0!==this.sizeAttenuation&&(b.sizeAttenuation=this.sizeAttenuation);void 0!==this.vertexColors&&this.vertexColors!==THREE.NoColors&&(b.vertexColors=this.vertexColors);void 0!==
this.shading&&this.shading!==THREE.SmoothShading&&(b.shading=this.shading);void 0!==this.blending&&this.blending!==THREE.NormalBlending&&(b.blending=this.blending);void 0!==this.side&&this.side!==THREE.FrontSide&&(b.side=this.side);1>this.opacity&&(b.opacity=this.opacity);!0===this.transparent&&(b.transparent=this.transparent);0<this.alphaTest&&(b.alphaTest=this.alphaTest);!0===this.wireframe&&(b.wireframe=this.wireframe);1<this.wireframeLinewidth&&(b.wireframeLinewidth=this.wireframeLinewidth);return b},
clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.name=a.name;this.side=a.side;this.opacity=a.opacity;this.transparent=a.transparent;this.blending=a.blending;this.blendSrc=a.blendSrc;this.blendDst=a.blendDst;this.blendEquation=a.blendEquation;this.blendSrcAlpha=a.blendSrcAlpha;this.blendDstAlpha=a.blendDstAlpha;this.blendEquationAlpha=a.blendEquationAlpha;this.depthFunc=a.depthFunc;this.depthTest=a.depthTest;this.depthWrite=a.depthWrite;this.precision=a.precision;this.polygonOffset=
a.polygonOffset;this.polygonOffsetFactor=a.polygonOffsetFactor;this.polygonOffsetUnits=a.polygonOffsetUnits;this.alphaTest=a.alphaTest;this.overdraw=a.overdraw;this.visible=a.visible;return this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})},get wrapAround(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set wrapAround(a){console.warn("THREE."+this.type+": .wrapAround has been removed.")},get wrapRGB(){console.warn("THREE."+
this.type+": .wrapRGB has been removed.");return new THREE.Color}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.type="LineBasicMaterial";this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=THREE.NoColors;this.fog=!0;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial;THREE.LineBasicMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.linewidth=a.linewidth;this.linecap=a.linecap;this.linejoin=a.linejoin;this.vertexColors=a.vertexColors;this.fog=a.fog;return this};
THREE.LineDashedMaterial=function(a){THREE.Material.call(this);this.type="LineDashedMaterial";this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(a)};THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.constructor=THREE.LineDashedMaterial;
THREE.LineDashedMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.linewidth=a.linewidth;this.scale=a.scale;this.dashSize=a.dashSize;this.gapSize=a.gapSize;this.vertexColors=a.vertexColors;this.fog=a.fog;return this};
THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.type="MeshBasicMaterial";this.color=new THREE.Color(16777215);this.aoMap=this.map=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=
!1;this.setValues(a)};THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial;
THREE.MeshBasicMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;
this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;return this};
THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.type="MeshLambertMaterial";this.color=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.envMap=this.alphaMap=this.specularMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};
THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial;
THREE.MeshLambertMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.emissive.copy(a.emissive);this.map=a.map;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;
this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};
THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.type="MeshPhongMaterial";this.color=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=!1;this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.bumpMap=this.emissiveMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.displacementMap=null;this.displacementScale=1;this.displacementBias=
0;this.envMap=this.alphaMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial;
THREE.MeshPhongMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.emissive.copy(a.emissive);this.specular.copy(a.specular);this.shininess=a.shininess;this.metal=a.metal;this.map=a.map;this.lightMap=a.lightMap;this.lightMapIntensity=a.lightMapIntensity;this.aoMap=a.aoMap;this.aoMapIntensity=a.aoMapIntensity;this.emissiveMap=a.emissiveMap;this.bumpMap=a.bumpMap;this.bumpScale=a.bumpScale;this.normalMap=a.normalMap;this.normalScale.copy(a.normalScale);
this.displacementMap=a.displacementMap;this.displacementScale=a.displacementScale;this.displacementBias=a.displacementBias;this.specularMap=a.specularMap;this.alphaMap=a.alphaMap;this.envMap=a.envMap;this.combine=a.combine;this.reflectivity=a.reflectivity;this.refractionRatio=a.refractionRatio;this.fog=a.fog;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.wireframeLinecap=a.wireframeLinecap;this.wireframeLinejoin=a.wireframeLinejoin;this.vertexColors=
a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=a.morphNormals;return this};THREE.MeshDepthMaterial=function(a){THREE.Material.call(this);this.type="MeshDepthMaterial";this.wireframe=this.morphTargets=!1;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial;
THREE.MeshDepthMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.type="MeshNormalMaterial";this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial;
THREE.MeshNormalMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;return this};THREE.MultiMaterial=function(a){this.uuid=THREE.Math.generateUUID();this.type="MultiMaterial";this.materials=a instanceof Array?a:[];this.visible=!0};
THREE.MultiMaterial.prototype={constructor:THREE.MultiMaterial,toJSON:function(){for(var a={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},b=0,c=this.materials.length;b<c;b++)a.materials.push(this.materials[b].toJSON());a.visible=this.visible;return a},clone:function(){for(var a=new this.constructor,b=0;b<this.materials.length;b++)a.materials.push(this.materials[b].clone());a.visible=this.visible;return a}};THREE.MeshFaceMaterial=THREE.MultiMaterial;
THREE.PointsMaterial=function(a){THREE.Material.call(this);this.type="PointsMaterial";this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=THREE.NoColors;this.fog=!0;this.setValues(a)};THREE.PointsMaterial.prototype=Object.create(THREE.Material.prototype);THREE.PointsMaterial.prototype.constructor=THREE.PointsMaterial;
THREE.PointsMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.size=a.size;this.sizeAttenuation=a.sizeAttenuation;this.vertexColors=a.vertexColors;this.fog=a.fog;return this};THREE.PointCloudMaterial=function(a){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new THREE.PointsMaterial(a)};
THREE.ParticleBasicMaterial=function(a){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");return new THREE.PointsMaterial(a)};THREE.ParticleSystemMaterial=function(a){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");return new THREE.PointsMaterial(a)};
THREE.ShaderMaterial=function(a){THREE.Material.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.derivatives=this.morphNormals=
this.morphTargets=this.skinning=!1;this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;void 0!==a&&(void 0!==a.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial;
THREE.ShaderMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.fragmentShader=a.fragmentShader;this.vertexShader=a.vertexShader;this.uniforms=THREE.UniformsUtils.clone(a.uniforms);this.attributes=a.attributes;this.defines=a.defines;this.shading=a.shading;this.wireframe=a.wireframe;this.wireframeLinewidth=a.wireframeLinewidth;this.fog=a.fog;this.lights=a.lights;this.vertexColors=a.vertexColors;this.skinning=a.skinning;this.morphTargets=a.morphTargets;this.morphNormals=
a.morphNormals;this.derivatives=a.derivatives;return this};THREE.ShaderMaterial.prototype.toJSON=function(a){a=THREE.Material.prototype.toJSON.call(this,a);a.uniforms=this.uniforms;a.attributes=this.attributes;a.vertexShader=this.vertexShader;a.fragmentShader=this.fragmentShader;return a};THREE.RawShaderMaterial=function(a){THREE.ShaderMaterial.call(this,a);this.type="RawShaderMaterial"};THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype);
THREE.RawShaderMaterial.prototype.constructor=THREE.RawShaderMaterial;THREE.SpriteMaterial=function(a){THREE.Material.call(this);this.type="SpriteMaterial";this.color=new THREE.Color(16777215);this.map=null;this.rotation=0;this.fog=!1;this.setValues(a)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.constructor=THREE.SpriteMaterial;
THREE.SpriteMaterial.prototype.copy=function(a){THREE.Material.prototype.copy.call(this,a);this.color.copy(a.color);this.map=a.map;this.rotation=a.rotation;this.fog=a.fog;return this};
THREE.Texture=function(a,b,c,d,e,g,f,h,l){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++});this.uuid=THREE.Math.generateUUID();this.sourceFile=this.name="";this.image=void 0!==a?a:THREE.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:THREE.Texture.DEFAULT_MAPPING;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==e?e:THREE.LinearFilter;this.minFilter=void 0!==g?g:THREE.LinearMipMapLinearFilter;
this.anisotropy=void 0!==l?l:1;this.format=void 0!==f?f:THREE.RGBAFormat;this.type=void 0!==h?h:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.version=0;this.onUpdate=null};THREE.Texture.DEFAULT_IMAGE=void 0;THREE.Texture.DEFAULT_MAPPING=THREE.UVMapping;
THREE.Texture.prototype={constructor:THREE.Texture,set needsUpdate(a){!0===a&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.image=a.image;this.mipmaps=a.mipmaps.slice(0);this.mapping=a.mapping;this.wrapS=a.wrapS;this.wrapT=a.wrapT;this.magFilter=a.magFilter;this.minFilter=a.minFilter;this.anisotropy=a.anisotropy;this.format=a.format;this.type=a.type;this.offset.copy(a.offset);this.repeat.copy(a.repeat);this.generateMipmaps=a.generateMipmaps;this.premultiplyAlpha=
a.premultiplyAlpha;this.flipY=a.flipY;this.unpackAlignment=a.unpackAlignment;return this},toJSON:function(a){if(void 0!==a.textures[this.uuid])return a.textures[this.uuid];var b={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var c=
this.image;void 0===c.uuid&&(c.uuid=THREE.Math.generateUUID());if(void 0===a.images[c.uuid]){var d=a.images,e=c.uuid,g=c.uuid,f;void 0!==c.toDataURL?f=c:(f=document.createElement("canvas"),f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0,c.width,c.height));f=2048<f.width||2048<f.height?f.toDataURL("image/jpeg",.6):f.toDataURL("image/png");d[e]={uuid:g,url:f}}b.image=c.uuid}return a.textures[this.uuid]=b},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(this.mapping===
THREE.UVMapping){a.multiply(this.repeat);a.add(this.offset);if(0>a.x||1<a.x)switch(this.wrapS){case THREE.RepeatWrapping:a.x-=Math.floor(a.x);break;case THREE.ClampToEdgeWrapping:a.x=0>a.x?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x-=Math.floor(a.x)}if(0>a.y||1<a.y)switch(this.wrapT){case THREE.RepeatWrapping:a.y-=Math.floor(a.y);break;case THREE.ClampToEdgeWrapping:a.y=0>a.y?0:1;break;case THREE.MirroredRepeatWrapping:1===Math.abs(Math.floor(a.y)%
2)?a.y=Math.ceil(a.y)-a.y:a.y-=Math.floor(a.y)}this.flipY&&(a.y=1-a.y)}}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CanvasTexture=function(a,b,c,d,e,g,f,h,l){THREE.Texture.call(this,a,b,c,d,e,g,f,h,l);this.needsUpdate=!0};THREE.CanvasTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CanvasTexture.prototype.constructor=THREE.CanvasTexture;
THREE.CubeTexture=function(a,b,c,d,e,g,f,h,l){b=void 0!==b?b:THREE.CubeReflectionMapping;THREE.Texture.call(this,a,b,c,d,e,g,f,h,l);this.images=a;this.flipY=!1};THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CubeTexture.prototype.constructor=THREE.CubeTexture;THREE.CubeTexture.prototype.copy=function(a){THREE.Texture.prototype.copy.call(this,a);this.images=a.images;return this};
THREE.CompressedTexture=function(a,b,c,d,e,g,f,h,l,k,m){THREE.Texture.call(this,null,g,f,h,l,k,d,e,m);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.constructor=THREE.CompressedTexture;
THREE.DataTexture=function(a,b,c,d,e,g,f,h,l,k,m){THREE.Texture.call(this,null,g,f,h,l,k,d,e,m);this.image={data:a,width:b,height:c};this.magFilter=void 0!==l?l:THREE.NearestFilter;this.minFilter=void 0!==k?k:THREE.NearestFilter;this.generateMipmaps=this.flipY=!1};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.constructor=THREE.DataTexture;
THREE.VideoTexture=function(a,b,c,d,e,g,f,h,l){function k(){requestAnimationFrame(k);a.readyState===a.HAVE_ENOUGH_DATA&&(m.needsUpdate=!0)}THREE.Texture.call(this,a,b,c,d,e,g,f,h,l);this.generateMipmaps=!1;var m=this;k()};THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype);THREE.VideoTexture.prototype.constructor=THREE.VideoTexture;THREE.Group=function(){THREE.Object3D.call(this);this.type="Group"};THREE.Group.prototype=Object.create(THREE.Object3D.prototype);
THREE.Group.prototype.constructor=THREE.Group;THREE.Points=function(a,b){THREE.Object3D.call(this);this.type="Points";this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.PointsMaterial({color:16777215*Math.random()})};THREE.Points.prototype=Object.create(THREE.Object3D.prototype);THREE.Points.prototype.constructor=THREE.Points;
THREE.Points.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray;return function(c,d){function e(a,e){var f=b.distanceSqToPoint(a);if(f<l){var h=b.closestPointToPoint(a);h.applyMatrix4(g.matrixWorld);var k=c.ray.origin.distanceTo(h);k<c.near||k>c.far||d.push({distance:k,distanceToRay:Math.sqrt(f),point:h.clone(),index:e,face:null,object:g})}}var g=this,f=g.geometry,h=c.params.Points.threshold;a.getInverse(this.matrixWorld);b.copy(c.ray).applyMatrix4(a);if(null===f.boundingBox||!1!==
b.isIntersectionBox(f.boundingBox)){var h=h/((this.scale.x+this.scale.y+this.scale.z)/3),l=h*h,h=new THREE.Vector3;if(f instanceof THREE.BufferGeometry){var k=f.index,f=f.attributes.position.array;if(null!==k)for(var m=k.array,k=0,p=m.length;k<p;k++){var n=m[k];h.fromArray(f,3*n);e(h,n)}else for(k=0,m=f.length/3;k<m;k++)h.fromArray(f,3*k),e(h,k)}else for(h=f.vertices,k=0,m=h.length;k<m;k++)e(h[k],k)}}}();THREE.Points.prototype.clone=function(){return(new this.constructor(this.geometry,this.material)).copy(this)};
THREE.PointCloud=function(a,b){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new THREE.Points(a,b)};THREE.ParticleSystem=function(a,b){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");return new THREE.Points(a,b)};
THREE.Line=function(a,b,c){if(1===c)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new THREE.LineSegments(a,b);THREE.Object3D.call(this);this.type="Line";this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.LineBasicMaterial({color:16777215*Math.random()})};THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.constructor=THREE.Line;
THREE.Line.prototype.raycast=function(){var a=new THREE.Matrix4,b=new THREE.Ray,c=new THREE.Sphere;return function(d,e){var g=d.linePrecision,g=g*g,f=this.geometry;null===f.boundingSphere&&f.computeBoundingSphere();c.copy(f.boundingSphere);c.applyMatrix4(this.matrixWorld);if(!1!==d.ray.isIntersectionSphere(c)){a.getInverse(this.matrixWorld);b.copy(d.ray).applyMatrix4(a);var h=new THREE.Vector3,l=new THREE.Vector3,k=new THREE.Vector3,m=new THREE.Vector3,p=this instanceof THREE.LineSegments?2:1;if(f instanceof
THREE.BufferGeometry){var n=f.index,q=f.attributes;if(null!==n)for(var f=n.array,q=q.position.array,n=0,s=f.length-1;n<s;n+=p){var t=f[n+1];h.fromArray(q,3*f[n]);l.fromArray(q,3*t);t=b.distanceSqToSegment(h,l,m,k);t>g||(m.applyMatrix4(this.matrixWorld),t=d.ray.origin.distanceTo(m),t<d.near||t>d.far||e.push({distance:t,point:k.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this}))}else for(q=q.position.array,n=0,s=q.length/3-1;n<s;n+=p)h.fromArray(q,3*n),l.fromArray(q,
3*n+3),t=b.distanceSqToSegment(h,l,m,k),t>g||(m.applyMatrix4(this.matrixWorld),t=d.ray.origin.distanceTo(m),t<d.near||t>d.far||e.push({distance:t,point:k.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this}))}else if(f instanceof THREE.Geometry)for(h=f.vertices,l=h.length,n=0;n<l-1;n+=p)t=b.distanceSqToSegment(h[n],h[n+1],m,k),t>g||(m.applyMatrix4(this.matrixWorld),t=d.ray.origin.distanceTo(m),t<d.near||t>d.far||e.push({distance:t,point:k.clone().applyMatrix4(this.matrixWorld),
index:n,face:null,faceIndex:null,object:this}))}}}();THREE.Line.prototype.clone=function(){return(new this.constructor(this.geometry,this.material)).copy(this)};THREE.LineStrip=0;THREE.LinePieces=1;THREE.LineSegments=function(a,b){THREE.Line.call(this,a,b);this.type="LineSegments"};THREE.LineSegments.prototype=Object.create(THREE.Line.prototype);THREE.LineSegments.prototype.constructor=THREE.LineSegments;
THREE.Mesh=function(a,b){THREE.Object3D.call(this);this.type="Mesh";this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);THREE.Mesh.prototype.constructor=THREE.Mesh;
THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};
THREE.Mesh.prototype.raycast=function(){function a(a,b,c,d,e,f,g){THREE.Triangle.barycoordFromPoint(a,b,c,d,t);e.multiplyScalar(t.x);f.multiplyScalar(t.y);g.multiplyScalar(t.z);e.add(f).add(g);return e.clone()}function b(a,b,c,d,e,f,g){var h=a.material;if(null===(h.side===THREE.BackSide?c.intersectTriangle(f,e,d,!0,g):c.intersectTriangle(d,e,f,h.side!==THREE.DoubleSide,g)))return null;u.copy(g);u.applyMatrix4(a.matrixWorld);c=b.ray.origin.distanceTo(u);return c<b.near||c>b.far?null:{distance:c,point:u.clone(),
object:a}}function c(c,d,e,g,k,m,p,u){f.fromArray(g,3*m);h.fromArray(g,3*p);l.fromArray(g,3*u);if(c=b(c,d,e,f,h,l,v))k&&(n.fromArray(k,2*m),q.fromArray(k,2*p),s.fromArray(k,2*u),c.uv=a(v,f,h,l,n,q,s)),c.face=new THREE.Face3(m,p,u,THREE.Triangle.normal(f,h,l)),c.faceIndex=m;return c}var d=new THREE.Matrix4,e=new THREE.Ray,g=new THREE.Sphere,f=new THREE.Vector3,h=new THREE.Vector3,l=new THREE.Vector3,k=new THREE.Vector3,m=new THREE.Vector3,p=new THREE.Vector3,n=new THREE.Vector2,q=new THREE.Vector2,
s=new THREE.Vector2,t=new THREE.Vector3,v=new THREE.Vector3,u=new THREE.Vector3;return function(u,t){var x=this.geometry,B=this.material;if(void 0!==B){null===x.boundingSphere&&x.computeBoundingSphere();var y=this.matrixWorld;g.copy(x.boundingSphere);g.applyMatrix4(y);if(!1!==u.ray.isIntersectionSphere(g)&&(d.getInverse(y),e.copy(u.ray).applyMatrix4(d),null===x.boundingBox||!1!==e.isIntersectionBox(x.boundingBox))){var z,A;if(x instanceof THREE.BufferGeometry){var J,F,B=x.index,y=x.attributes,x=y.position.array;
void 0!==y.uv&&(z=y.uv.array);if(null!==B)for(var y=B.array,C=0,N=y.length;C<N;C+=3){if(B=y[C],J=y[C+1],F=y[C+2],A=c(this,u,e,x,z,B,J,F))A.faceIndex=Math.floor(C/3),t.push(A)}else for(C=0,N=x.length;C<N;C+=9)if(B=C/3,J=B+1,F=B+2,A=c(this,u,e,x,z,B,J,F))A.index=B,t.push(A)}else if(x instanceof THREE.Geometry){var L,Q,y=B instanceof THREE.MeshFaceMaterial,C=!0===y?B.materials:null,N=x.vertices;J=x.faces;F=x.faceVertexUvs[0];0<F.length&&(z=F);for(var M=0,K=J.length;M<K;M++){var E=J[M];A=!0===y?C[E.materialIndex]:
B;if(void 0!==A){F=N[E.a];L=N[E.b];Q=N[E.c];if(!0===A.morphTargets){A=x.morphTargets;var O=this.morphTargetInfluences;f.set(0,0,0);h.set(0,0,0);l.set(0,0,0);for(var T=0,H=A.length;T<H;T++){var R=O[T];if(0!==R){var G=A[T].vertices;f.addScaledVector(k.subVectors(G[E.a],F),R);h.addScaledVector(m.subVectors(G[E.b],L),R);l.addScaledVector(p.subVectors(G[E.c],Q),R)}}f.add(F);h.add(L);l.add(Q);F=f;L=h;Q=l}if(A=b(this,u,e,F,L,Q,v))z&&(O=z[M],n.copy(O[0]),q.copy(O[1]),s.copy(O[2]),A.uv=a(v,F,L,Q,n,q,s)),A.face=
E,A.faceIndex=M,t.push(A)}}}}}}}();THREE.Mesh.prototype.clone=function(){return(new this.constructor(this.geometry,this.material)).copy(this)};THREE.Bone=function(a){THREE.Object3D.call(this);this.type="Bone";this.skin=a};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.constructor=THREE.Bone;THREE.Bone.prototype.copy=function(a){THREE.Object3D.prototype.copy.call(this,a);this.skin=a.skin;return this};
THREE.Skeleton=function(a,b,c){this.useVertexTexture=void 0!==c?c:!0;this.identityMatrix=new THREE.Matrix4;a=a||[];this.bones=a.slice(0);this.useVertexTexture?(a=Math.sqrt(4*this.bones.length),a=THREE.Math.nextPowerOfTwo(Math.ceil(a)),this.boneTextureHeight=this.boneTextureWidth=a=Math.max(a,4),this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType)):
this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===b)this.calculateInverses();else if(this.bones.length===b.length)this.boneInverses=b.slice(0);else for(console.warn("THREE.Skeleton bonInverses is the wrong length."),this.boneInverses=[],b=0,a=this.bones.length;b<a;b++)this.boneInverses.push(new THREE.Matrix4)};
THREE.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var a=0,b=this.bones.length;a<b;a++){var c=new THREE.Matrix4;this.bones[a]&&c.getInverse(this.bones[a].matrixWorld);this.boneInverses.push(c)}};
THREE.Skeleton.prototype.pose=function(){for(var a,b=0,c=this.bones.length;b<c;b++)(a=this.bones[b])&&a.matrixWorld.getInverse(this.boneInverses[b]);b=0;for(c=this.bones.length;b<c;b++)if(a=this.bones[b])a.parent?(a.matrix.getInverse(a.parent.matrixWorld),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale)};
THREE.Skeleton.prototype.update=function(){var a=new THREE.Matrix4;return function(){for(var b=0,c=this.bones.length;b<c;b++)a.multiplyMatrices(this.bones[b]?this.bones[b].matrixWorld:this.identityMatrix,this.boneInverses[b]),a.flattenToArrayOffset(this.boneMatrices,16*b);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}}();THREE.Skeleton.prototype.clone=function(){return new THREE.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)};
THREE.SkinnedMesh=function(a,b,c){THREE.Mesh.call(this,a,b);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new THREE.Matrix4;this.bindMatrixInverse=new THREE.Matrix4;a=[];if(this.geometry&&void 0!==this.geometry.bones){for(var d,e=0,g=this.geometry.bones.length;e<g;++e)d=this.geometry.bones[e],b=new THREE.Bone(this),a.push(b),b.name=d.name,b.position.fromArray(d.pos),b.quaternion.fromArray(d.rotq),void 0!==d.scl&&b.scale.fromArray(d.scl);e=0;for(g=this.geometry.bones.length;e<g;++e)d=
this.geometry.bones[e],-1!==d.parent&&null!==d.parent?a[d.parent].add(a[e]):this.add(a[e])}this.normalizeSkinWeights();this.updateMatrixWorld(!0);this.bind(new THREE.Skeleton(a,void 0,c),this.matrixWorld)};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh;
THREE.SkinnedMesh.prototype.bind=function(a,b){this.skeleton=a;void 0===b&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),b=this.matrixWorld);this.bindMatrix.copy(b);this.bindMatrixInverse.getInverse(b)};THREE.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()};
THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry)for(var a=0;a<this.geometry.skinIndices.length;a++){var b=this.geometry.skinWeights[a],c=1/b.lengthManhattan();Infinity!==c?b.multiplyScalar(c):b.set(1)}};
THREE.SkinnedMesh.prototype.updateMatrixWorld=function(a){THREE.Mesh.prototype.updateMatrixWorld.call(this,!0);"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)};THREE.SkinnedMesh.prototype.clone=function(){return(new this.constructor(this.geometry,this.material,this.useVertexTexture)).copy(this)};
THREE.LOD=function(){THREE.Object3D.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:!0,value:[]},objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}})};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.constructor=THREE.LOD;
THREE.LOD.prototype.addLevel=function(a,b){void 0===b&&(b=0);b=Math.abs(b);for(var c=this.levels,d=0;d<c.length&&!(b<c[d].distance);d++);c.splice(d,0,{distance:b,object:a});this.add(a)};THREE.LOD.prototype.getObjectForDistance=function(a){for(var b=this.levels,c=1,d=b.length;c<d&&!(a<b[c].distance);c++);return b[c-1].object};
THREE.LOD.prototype.raycast=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var d=b.ray.origin.distanceTo(a);this.getObjectForDistance(d).raycast(b,c)}}();
THREE.LOD.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){var d=this.levels;if(1<d.length){a.setFromMatrixPosition(c.matrixWorld);b.setFromMatrixPosition(this.matrixWorld);c=a.distanceTo(b);d[0].object.visible=!0;for(var e=1,g=d.length;e<g;e++)if(c>=d[e].distance)d[e-1].object.visible=!1,d[e].object.visible=!0;else break;for(;e<g;e++)d[e].object.visible=!1}}}();
THREE.LOD.prototype.copy=function(a){THREE.Object3D.prototype.copy.call(this,a,!1);a=a.levels;for(var b=0,c=a.length;b<c;b++){var d=a[b];this.addLevel(d.object.clone(),d.distance)}return this};THREE.LOD.prototype.toJSON=function(a){a=THREE.Object3D.prototype.toJSON.call(this,a);a.object.levels=[];for(var b=this.levels,c=0,d=b.length;c<d;c++){var e=b[c];a.object.levels.push({object:e.object.uuid,distance:e.distance})}return a};
THREE.Sprite=function(){var a=new Uint16Array([0,1,2,0,2,3]),b=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),c=new Float32Array([0,0,1,0,1,1,0,1]),d=new THREE.BufferGeometry;d.setIndex(new THREE.BufferAttribute(a,1));d.addAttribute("position",new THREE.BufferAttribute(b,3));d.addAttribute("uv",new THREE.BufferAttribute(c,2));return function(a){THREE.Object3D.call(this);this.type="Sprite";this.geometry=d;this.material=void 0!==a?a:new THREE.SpriteMaterial}}();THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);
THREE.Sprite.prototype.constructor=THREE.Sprite;THREE.Sprite.prototype.raycast=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixPosition(this.matrixWorld);var d=b.ray.distanceSqToPoint(a);d>this.scale.x*this.scale.y||c.push({distance:Math.sqrt(d),point:this.position,face:null,object:this})}}();THREE.Sprite.prototype.clone=function(){return(new this.constructor(this.material)).copy(this)};THREE.Particle=THREE.Sprite;
THREE.LensFlare=function(a,b,c,d,e){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==a&&this.add(a,b,c,d,e)};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare.prototype.constructor=THREE.LensFlare;
THREE.LensFlare.prototype.add=function(a,b,c,d,e,g){void 0===b&&(b=-1);void 0===c&&(c=0);void 0===g&&(g=1);void 0===e&&(e=new THREE.Color(16777215));void 0===d&&(d=THREE.NormalBlending);c=Math.min(c,Math.max(0,c));this.lensFlares.push({texture:a,size:b,distance:c,x:0,y:0,z:0,scale:1,rotation:0,opacity:g,color:e,blending:d})};
THREE.LensFlare.prototype.updateLensFlares=function(){var a,b=this.lensFlares.length,c,d=2*-this.positionScreen.x,e=2*-this.positionScreen.y;for(a=0;a<b;a++)c=this.lensFlares[a],c.x=this.positionScreen.x+d*c.distance,c.y=this.positionScreen.y+e*c.distance,c.wantedRotation=c.x*Math.PI*.25,c.rotation+=.25*(c.wantedRotation-c.rotation)};
THREE.LensFlare.prototype.copy=function(a){THREE.Object3D.prototype.copy.call(this,a);this.positionScreen.copy(a.positionScreen);this.customUpdateCallback=a.customUpdateCallback;for(var b=0,c=a.lensFlares.length;b<c;b++)this.lensFlares.push(a.lensFlares[b]);return this};THREE.Scene=function(){THREE.Object3D.call(this);this.type="Scene";this.overrideMaterial=this.fog=null;this.autoUpdate=!0};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);THREE.Scene.prototype.constructor=THREE.Scene;
THREE.Scene.prototype.copy=function(a){THREE.Object3D.prototype.copy.call(this,a);null!==a.fog&&(this.fog=a.fog.clone());null!==a.overrideMaterial&&(this.overrideMaterial=a.overrideMaterial.clone());this.autoUpdate=a.autoUpdate;this.matrixAutoUpdate=a.matrixAutoUpdate;return this};THREE.Fog=function(a,b,c){this.name="";this.color=new THREE.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};
THREE.FogExp2=function(a,b){this.name="";this.color=new THREE.Color(a);this.density=void 0!==b?b:2.5E-4};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};THREE.ShaderChunk={};THREE.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n";THREE.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n";THREE.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n";
THREE.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\n\ttotalAmbientLight *= ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n#endif\n";THREE.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif";THREE.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n";THREE.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n";THREE.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n";
THREE.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif";THREE.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n";THREE.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif";THREE.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\n\tvColor.xyz = color.xyz;\n\n#endif";THREE.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\n\nvec3 transformDirection( in vec3 normal, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( normal, 0.0 ) ).xyz );\n\n}\n\nvec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {\n\n\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nfloat calcLightAttenuation( float lightDistance, float cutoffDistance, float decayExponent ) {\n\n\tif ( decayExponent > 0.0 ) {\n\n\t  return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t}\n\n\treturn 1.0;\n\n}\n\nvec3 F_Schlick( in vec3 specularColor, in float dotLH ) {\n\n\n\tfloat fresnel = exp2( ( -5.55437 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n}\n\nfloat G_BlinnPhong_Implicit( /* in float dotNL, in float dotNV */ ) {\n\n\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( in float shininess, in float dotNH ) {\n\n\n\treturn ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_BlinnPhong( in vec3 specularColor, in float shininess, in vec3 normal, in vec3 lightDir, in vec3 viewDir ) {\n\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( lightDir, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * G * D;\n\n}\n\nvec3 inputToLinear( in vec3 a ) {\n\n\t#ifdef GAMMA_INPUT\n\n\t\treturn pow( a, vec3( float( GAMMA_FACTOR ) ) );\n\n\t#else\n\n\t\treturn a;\n\n\t#endif\n\n}\n\nvec3 linearToOutput( in vec3 a ) {\n\n\t#ifdef GAMMA_OUTPUT\n\n\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );\n\n\t#else\n\n\t\treturn a;\n\n\t#endif\n\n}\n";
THREE.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;\n";THREE.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n\n#endif\n";THREE.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n";
THREE.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = inputToLinear( emissiveColor.rgb );\n\n\ttotalEmissiveLight *= emissiveColor.rgb;\n\n#endif\n";THREE.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n";THREE.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\n\tenvColor.xyz = inputToLinear( envColor.xyz );\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\tuniform float refractionRatio;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\n\t#endif\n\n#endif\n";THREE.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvarying vec3 vReflect;\n\n\tuniform float refractionRatio;\n\n#endif\n";
THREE.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG )\n\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t#else\n\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t#else\n\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t#endif\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\n\t#endif\n\t\n\toutgoingLight = mix( outgoingLight, fogColor, fogFactor );\n\n#endif";
THREE.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n\n#endif";THREE.ShaderChunk.hemilight_fragment="#if MAX_HEMI_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\n\n\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvec3 lightColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\ttotalAmbientLight += lightColor;\n\n\t}\n\n#endif\n\n";
THREE.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n\ttotalAmbientLight += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\n#endif\n";THREE.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif";THREE.ShaderChunk.lights_lambert_pars_vertex="#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n";
THREE.ShaderChunk.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vec3( 0.0 );\n\n#endif\n\nvec3 normal = normalize( transformedNormal );\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = pointLightColor[ i ];\n\n\t\tvec3 lVector = pointLightPosition[ i ] - mvPosition.xyz;\n\t\tvec3 lightDir = normalize( lVector );\n\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\n\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = spotLightColor[ i ];\n\n\t\tvec3 lightPosition = spotLightPosition[ i ];\n\t\tvec3 lVector = lightPosition - mvPosition.xyz;\n\t\tvec3 lightDir = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\n\n\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\t\tattenuation *= spotEffect;\n\n\n\t\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\t\tvLightFront += lightColor * attenuation * saturate( dotProduct );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvLightBack += lightColor * attenuation * saturate( - dotProduct );\n\n\t\t\t#endif\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = directionalLightColor[ i ];\n\n\t\tvec3 lightDir = directionalLightDirection[ i ];\n\n\n\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\tvLightFront += lightColor * saturate( dotProduct );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += lightColor * saturate( - dotProduct );\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec3 lightDir = hemisphereLightDirection[ i ];\n\n\n\t\tfloat dotProduct = dot( normal, lightDir );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tfloat hemiDiffuseWeightBack = - 0.5 * dotProduct + 0.5;\n\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n\t\t#endif\n\n\t}\n\n#endif\n";
THREE.ShaderChunk.lights_phong_fragment="vec3 viewDir = normalize( vViewPosition );\n\nvec3 totalDiffuseLight = vec3( 0.0 );\nvec3 totalSpecularLight = vec3( 0.0 );\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = pointLightColor[ i ];\n\n\t\tvec3 lightPosition = pointLightPosition[ i ];\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\n\t\tvec3 lightDir = normalize( lVector );\n\n\n\t\tfloat attenuation = calcLightAttenuation( length( lVector ), pointLightDistance[ i ], pointLightDecay[ i ] );\n\n\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\n\n\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\n\n\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\n\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = spotLightColor[ i ];\n\n\t\tvec3 lightPosition = spotLightPosition[ i ];\n\t\tvec3 lVector = lightPosition + vViewPosition.xyz;\n\t\tvec3 lightDir = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], lightDir );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = saturate( pow( saturate( spotEffect ), spotLightExponent[ i ] ) );\n\n\n\t\t\tfloat attenuation = calcLightAttenuation( length( lVector ), spotLightDistance[ i ], spotLightDecay[ i ] );\n\n\t\t\tattenuation *= spotEffect;\n\n\n\t\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\n\n\t\t\ttotalDiffuseLight += lightColor * attenuation * cosineTerm;\n\n\n\t\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n\t\t\ttotalSpecularLight += brdf * specularStrength * lightColor * attenuation * cosineTerm;\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tfor ( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec3 lightColor = directionalLightColor[ i ];\n\n\t\tvec3 lightDir = directionalLightDirection[ i ];\n\n\n\t\tfloat cosineTerm = saturate( dot( normal, lightDir ) );\n\n\t\ttotalDiffuseLight += lightColor * cosineTerm;\n\n\n\t\tvec3 brdf = BRDF_BlinnPhong( specular, shininess, normal, lightDir, viewDir );\n\n\t\ttotalSpecularLight += brdf * specularStrength * lightColor * cosineTerm;\n\n\t}\n\n#endif\n";
THREE.ShaderChunk.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDecay[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDecay[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n";
THREE.ShaderChunk.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\n#endif\n";THREE.ShaderChunk.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_ENVMAP )\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif\n";THREE.ShaderChunk.linear_to_gamma_fragment="\n\toutgoingLight = linearToOutput( outgoingLight );\n";
THREE.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif";THREE.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif\n";THREE.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif";
THREE.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif";THREE.ShaderChunk.map_fragment="#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor.xyz = inputToLinear( texelColor.xyz );\n\n\tdiffuseColor *= texelColor;\n\n#endif\n";
THREE.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif";THREE.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\n\tdiffuseColor *= texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\n#endif\n";THREE.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n\n#endif\n";THREE.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n#endif\n";
THREE.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif";THREE.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.normal_phong_fragment="#ifndef FLAT_SHADED\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n\t#endif\n\n#else\n\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\n";
THREE.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n";
THREE.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\n\tvec4 mvPosition = modelViewMatrix * skinned;\n\n#else\n\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;\n";THREE.ShaderChunk.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n\tfor ( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tfloat texelSizeY =  1.0 / shadowMapSize[ i ].y;\n\n\t\tfloat shadow = 0.0;\n\n#if defined( POINT_LIGHT_SHADOWS )\n\n\t\tbool isPointLight = shadowDarkness[ i ] < 0.0;\n\n\t\tif ( isPointLight ) {\n\n\t\t\tfloat realShadowDarkness = abs( shadowDarkness[ i ] );\n\n\t\t\tvec3 lightToPosition = vShadowCoord[ i ].xyz;\n\n\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tfloat dp = length( lightToPosition );\n\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D, texelSizeY ) ), shadowBias[ i ], shadow );\n\n\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tconst float Dr = 1.25;\n\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tconst float Dr = 2.25;\n\t#endif\n\n\t\t\tfloat os = Dr *  2.0 * texelSizeY;\n\n\t\t\tconst vec3 Gsd = vec3( - 1, 0, 1 );\n\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zzy * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zxy * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xxy * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xzy * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zyz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xyz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.zyx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.xyx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yzz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yxz * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yxx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D + Gsd.yzx * os, texelSizeY ) ), shadowBias[ i ], shadow );\n\n\t\t\tshadow *= realShadowDarkness * ( 1.0 / 21.0 );\n\n\t#else \n\t\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t\tfloat dp = length( lightToPosition );\n\n\t\t\tadjustShadowValue1K( dp, texture2D( shadowMap[ i ], cubeToUV( bd3D, texelSizeY ) ), shadowBias[ i ], shadow );\n\n\t\t\tshadow *= realShadowDarkness;\n\n\t#endif\n\n\t\t} else {\n\n#endif \n\t\t\tfloat texelSizeX =  1.0 / shadowMapSize[ i ].x;\n\n\t\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n\n\t\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\t\tbool inFrustum = all( inFrustumVec );\n\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\t\tbool frustumTest = all( frustumTestVec );\n\n\t\t\tif ( frustumTest ) {\n\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\n\t\t\t\t/*\n\t\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\n\t\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\t\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\t\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\t\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\t\t\t\tshadow += 1.0;\n\t\t\t\t\t}\n\t\t\t\t\tshadow /= 9.0;\n\t\t\t\t*/\n\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t\tconst float ShadowDelta = 1.0 / 9.0;\n\n\t\t\t\tfloat xPixelOffset = texelSizeX;\n\t\t\t\tfloat yPixelOffset = texelSizeY;\n\n\t\t\t\tfloat dx0 = - 1.25 * xPixelOffset;\n\t\t\t\tfloat dy0 = - 1.25 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\n\n\t\t\t\tfloat fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += ShadowDelta;\n\n\t\t\t\tshadow *= shadowDarkness[ i ];\n\n\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\n\t\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t\tfloat xPixelOffset = texelSizeX;\n\t\t\t\tfloat yPixelOffset = texelSizeY;\n\n\t\t\t\tfloat dx0 = - 1.0 * xPixelOffset;\n\t\t\t\tfloat dy0 = - 1.0 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\n\n\t\t\t\tmat3 shadowKernel;\n\t\t\t\tmat3 depthKernel;\n\n\t\t\t\tdepthKernel[ 0 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tdepthKernel[ 0 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tdepthKernel[ 0 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tdepthKernel[ 1 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tdepthKernel[ 1 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tdepthKernel[ 1 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tdepthKernel[ 2 ][ 0 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tdepthKernel[ 2 ][ 1 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tdepthKernel[ 2 ][ 2 ] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\n\t\t\t\tshadowKernel[ 0 ] = vec3( lessThan( depthKernel[ 0 ], shadowZ ) );\n\t\t\t\tshadowKernel[ 0 ] *= vec3( 0.25 );\n\n\t\t\t\tshadowKernel[ 1 ] = vec3( lessThan( depthKernel[ 1 ], shadowZ ) );\n\t\t\t\tshadowKernel[ 1 ] *= vec3( 0.25 );\n\n\t\t\t\tshadowKernel[ 2 ] = vec3( lessThan( depthKernel[ 2 ], shadowZ ) );\n\t\t\t\tshadowKernel[ 2 ] *= vec3( 0.25 );\n\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[ i ].xy );\n\n\t\t\t\tshadowKernel[ 0 ] = mix( shadowKernel[ 1 ], shadowKernel[ 0 ], fractionalCoord.x );\n\t\t\t\tshadowKernel[ 1 ] = mix( shadowKernel[ 2 ], shadowKernel[ 1 ], fractionalCoord.x );\n\n\t\t\t\tvec4 shadowValues;\n\t\t\t\tshadowValues.x = mix( shadowKernel[ 0 ][ 1 ], shadowKernel[ 0 ][ 0 ], fractionalCoord.y );\n\t\t\t\tshadowValues.y = mix( shadowKernel[ 0 ][ 2 ], shadowKernel[ 0 ][ 1 ], fractionalCoord.y );\n\t\t\t\tshadowValues.z = mix( shadowKernel[ 1 ][ 1 ], shadowKernel[ 1 ][ 0 ], fractionalCoord.y );\n\t\t\t\tshadowValues.w = mix( shadowKernel[ 1 ][ 2 ], shadowKernel[ 1 ][ 1 ], fractionalCoord.y );\n\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) ) * shadowDarkness[ i ];\n\n\t#else \n\t\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\tshadow = shadowDarkness[ i ];\n\n\t#endif\n\n\t\t\t}\n\n#ifdef SHADOWMAP_DEBUG\n\n\t\t\tif ( inFrustum ) {\n\n\t\t\t\tif ( i == 0 ) {\n\n\t\t\t\t\toutgoingLight *= vec3( 1.0, 0.5, 0.0 );\n\n\t\t\t\t} else if ( i == 1 ) {\n\n\t\t\t\t\toutgoingLight *= vec3( 0.0, 1.0, 0.8 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\toutgoingLight *= vec3( 0.0, 0.5, 1.0 );\n\n\t\t\t\t}\n\n\t\t\t}\n\n#endif\n\n#if defined( POINT_LIGHT_SHADOWS )\n\n\t\t}\n\n#endif\n\n\t\tshadowMask = shadowMask * vec3( 1.0 - shadow );\n\n\t}\n\n#endif\n";
THREE.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform float shadowBias[ MAX_SHADOWS ];\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\tfloat depth = dot( rgba_depth, bit_shift );\n\t\treturn depth;\n\n\t}\n\n\t#if defined(POINT_LIGHT_SHADOWS)\n\n\n\t\tvoid adjustShadowValue1K( const float testDepth, const vec4 textureData, const float bias, inout float shadowValue ) {\n\n\t\t\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\t\tif ( testDepth >= dot( textureData, bitSh ) * 1000.0 + bias )\n\t\t\t\tshadowValue += 1.0;\n\n\t\t}\n\n\n\t\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n\n\t\t\tvec3 absV = abs( v );\n\n\n\t\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\t\tabsV *= scaleToCube;\n\n\n\t\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n\n\n\t\t\tvec2 planar = v.xy;\n\n\t\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\t\tif ( absV.z >= almostOne ) {\n\n\t\t\t\tif ( v.z > 0.0 )\n\t\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\t\tfloat signX = sign( v.x );\n\t\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\t\tfloat signY = sign( v.y );\n\t\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t\t}\n\n\n\t\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t\t}\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n#endif";THREE.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n\tfor ( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n\t}\n\n#endif";THREE.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif";
THREE.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n";
THREE.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n";THREE.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n#endif\n";
THREE.ShaderChunk.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif";THREE.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif";THREE.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif";
THREE.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n#endif";THREE.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = uv2;\n\n#endif";THREE.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n\tvarying vec2 vUv;\n\n#endif";
THREE.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n";THREE.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif";
THREE.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#else\n\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\n\t#endif\n\n#endif\n";
THREE.UniformsUtils={merge:function(a){for(var b={},c=0;c<a.length;c++){var d=this.clone(a[c]),e;for(e in d)b[e]=d[e]}return b},clone:function(a){var b={},c;for(c in a){b[c]={};for(var d in a[c]){var e=a[c][d];e instanceof THREE.Color||e instanceof THREE.Vector2||e instanceof THREE.Vector3||e instanceof THREE.Vector4||e instanceof THREE.Matrix3||e instanceof THREE.Matrix4||e instanceof THREE.Texture?b[c][d]=e.clone():Array.isArray(e)?b[c][d]=e.slice():b[c][d]=e}}return b}};
THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",
value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},fog:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},
lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},pointLightDecay:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},
spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]},spotLightDecay:{type:"fv1",value:[]}},points:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},
fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,
"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"\t#ifdef USE_ENVMAP",THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"\t#endif",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,
THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,
THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tvec3 totalAmbientLight = vec3( 1.0 );\n\tvec3 shadowMask = vec3( 1.0 );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.aomap_fragment,
THREE.ShaderChunk.shadowmap_fragment,"\toutgoingLight = diffuseColor.rgb * totalAmbientLight * shadowMask;",THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{emissive:{type:"c",value:new THREE.Color(0)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",
THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.beginnormal_vertex,
THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nuniform vec3 ambientLightColor;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",
THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tvec3 totalAmbientLight = ambientLightColor;\n\tvec3 shadowMask = vec3( 1.0 );",
THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.shadowmap_fragment,"\t#ifdef DOUBLE_SIDED\n\t\tif ( gl_FrontFacing )\n\t\t\toutgoingLight += diffuseColor.rgb * ( vLightFront * shadowMask + totalAmbientLight ) + emissive;\n\t\telse\n\t\t\toutgoingLight += diffuseColor.rgb * ( vLightBack * shadowMask + totalAmbientLight ) + emissive;\n\t#else\n\t\toutgoingLight += diffuseColor.rgb * ( vLightFront * shadowMask + totalAmbientLight ) + emissive;\n\t#endif",
THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.aomap,THREE.UniformsLib.lightmap,THREE.UniformsLib.emissivemap,THREE.UniformsLib.bumpmap,THREE.UniformsLib.normalmap,THREE.UniformsLib.displacementmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{emissive:{type:"c",
value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif",THREE.ShaderChunk.common,THREE.ShaderChunk.uv_pars_vertex,THREE.ShaderChunk.uv2_pars_vertex,THREE.ShaderChunk.displacementmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,
THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.uv_vertex,THREE.ShaderChunk.uv2_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.beginnormal_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif",THREE.ShaderChunk.begin_vertex,
THREE.ShaderChunk.displacementmap_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"\tvViewPosition = - mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;",
THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.uv_pars_fragment,THREE.ShaderChunk.uv2_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.alphamap_pars_fragment,THREE.ShaderChunk.aomap_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.emissivemap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,
THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tvec3 totalAmbientLight = ambientLightColor;\n\tvec3 totalEmissiveLight = emissive;\n\tvec3 shadowMask = vec3( 1.0 );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphamap_fragment,THREE.ShaderChunk.alphatest_fragment,
THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.normal_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.hemilight_fragment,THREE.ShaderChunk.aomap_fragment,THREE.ShaderChunk.emissivemap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.shadowmap_fragment,"totalDiffuseLight *= shadowMask;\ntotalSpecularLight *= shadowMask;\n#ifdef METAL\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) * specular + totalSpecularLight + totalEmissiveLight;\n#else\n\toutgoingLight += diffuseColor.rgb * ( totalDiffuseLight + totalAmbientLight ) + totalSpecularLight + totalEmissiveLight;\n#endif",
THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},points:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.points,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,
"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\tgl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.logdepthbuf_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,
THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( psColor, opacity );\n\tvec3 shadowMask = vec3( 1.0 );",THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.shadowmap_fragment,"\toutgoingLight = diffuseColor.rgb * shadowMask;",THREE.ShaderChunk.fog_fragment,
"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;",
THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.common,THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );",
THREE.ShaderChunk.logdepthbuf_fragment,THREE.ShaderChunk.color_fragment,"\toutgoingLight = diffuseColor.rgb;",THREE.ShaderChunk.fog_fragment,"\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",value:1}},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,
THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float mNear;\nuniform float mFar;\nuniform float opacity;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {",THREE.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\n\tgl_FragColor = vec4( vec3( color ), opacity );\n}"].join("\n")},
normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vNormal;",THREE.ShaderChunk.common,
THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;",
THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.logdepthbuf_pars_fragment,"void main() {\nvec3 direction = normalize( vWorldPosition );\nvec2 sampleUV;\nsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\nsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\ngl_FragColor = texture2D( tEquirect, sampleUV );",
THREE.ShaderChunk.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.logdepthbuf_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.logdepthbuf_vertex,"}"].join("\n"),fragmentShader:[THREE.ShaderChunk.common,
THREE.ShaderChunk.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main() {",THREE.ShaderChunk.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n\t#else\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n\t#endif\n}"].join("\n")},
distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new THREE.Vector3(0,0,0)}},vertexShader:["varying vec4 vWorldPosition;",THREE.ShaderChunk.common,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.begin_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.project_vertex,THREE.ShaderChunk.worldpos_vertex,"vWorldPosition = worldPosition;\n}"].join("\n"),fragmentShader:["uniform vec3 lightPos;\nvarying vec4 vWorldPosition;",
THREE.ShaderChunk.common,"vec4 pack1K ( float depth ) {\n   depth /= 1000.0;\n   const vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = fract( depth * bitSh );\n\tres -= res.xxyz * bitMsk;\n\treturn res; \n}\nfloat unpack1K ( vec4 color ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( color, bitSh ) * 1000.0;\n}\nvoid main () {\n\tgl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\n}"].join("\n")}};
THREE.WebGLRenderer=function(a){function b(a,b,c,d){!0===G&&(a*=d,b*=d,c*=d);r.clearColor(a,b,c,d)}function c(){I.init();r.viewport(na,oa,pa,qa);b(U.r,U.g,U.b,X)}function d(){ra=Aa=null;sa="";ta=-1;wa=!0;I.reset()}function e(a){a.preventDefault();d();c();W.clear()}function g(a){a=a.target;a.removeEventListener("dispose",g);a:{var b=W.get(a);if(a.image&&b.__image__webglTextureCube)r.deleteTexture(b.__image__webglTextureCube);else{if(void 0===b.__webglInit)break a;r.deleteTexture(b.__webglTexture)}W.delete(a)}la.textures--}
function f(a){a=a.target;a.removeEventListener("dispose",f);var b=W.get(a),c=W.get(a.texture);if(a&&void 0!==c.__webglTexture){r.deleteTexture(c.__webglTexture);if(a instanceof THREE.WebGLRenderTargetCube)for(c=0;6>c;c++)r.deleteFramebuffer(b.__webglFramebuffer[c]),r.deleteRenderbuffer(b.__webglRenderbuffer[c]);else r.deleteFramebuffer(b.__webglFramebuffer),r.deleteRenderbuffer(b.__webglRenderbuffer);W.delete(a.texture);W.delete(a)}la.textures--}function h(a){a=a.target;a.removeEventListener("dispose",
h);l(a);W.delete(a)}function l(a){var b=W.get(a).program;a.program=void 0;void 0!==b&&ua.releaseProgram(b)}function k(a,b){return b[0]-a[0]}function m(a,b){return a.object.renderOrder!==b.object.renderOrder?a.object.renderOrder-b.object.renderOrder:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function p(a,b){return a.object.renderOrder!==b.object.renderOrder?a.object.renderOrder-b.object.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function n(a,b,c,d,e){var f;c.transparent?
(d=Z,f=++fa):(d=ca,f=++ga);f=d[f];void 0!==f?(f.id=a.id,f.object=a,f.geometry=b,f.material=c,f.z=V.z,f.group=e):(f={id:a.id,object:a,geometry:b,material:c,z:V.z,group:e},d.push(f))}function q(a,b){if(!1!==a.visible){if(0!==(a.channels.mask&b.channels.mask))if(a instanceof THREE.Light)da.push(a);else if(a instanceof THREE.Sprite)ea.push(a);else if(a instanceof THREE.LensFlare)ja.push(a);else if(a instanceof THREE.ImmediateRenderObject)!0===aa.sortObjects&&(V.setFromMatrixPosition(a.matrixWorld),V.applyProjection(xa)),
n(a,null,a.material,V.z,null);else if(a instanceof THREE.Mesh||a instanceof THREE.Line||a instanceof THREE.Points)if(a instanceof THREE.SkinnedMesh&&a.skeleton.update(),!1===a.frustumCulled||!0===Ba.intersectsObject(a)){var c=a.material;if(!0===c.visible){!0===aa.sortObjects&&(V.setFromMatrixPosition(a.matrixWorld),V.applyProjection(xa));var d=va.update(a);if(c instanceof THREE.MeshFaceMaterial)for(var e=d.groups,f=c.materials,c=0,g=e.length;c<g;c++){var h=e[c],l=f[h.materialIndex];!0===l.visible&&
n(a,d,l,V.z,h)}else n(a,d,c,V.z,null)}}d=a.children;c=0;for(g=d.length;c<g;c++)q(d[c],b)}}function s(a,b,c,d,e){for(var f=0,g=a.length;f<g;f++){var h=a[f],l=h.object,k=h.geometry,n=void 0===e?h.material:e,h=h.group;l.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,l.matrixWorld);l.normalMatrix.getNormalMatrix(l.modelViewMatrix);if(l instanceof THREE.ImmediateRenderObject){t(n);var m=v(b,c,d,n,l);sa="";l.render(function(a){aa.renderBufferImmediate(a,m,n)})}else aa.renderBufferDirect(b,c,d,k,
n,l,h)}}function t(a){a.side!==THREE.DoubleSide?I.enable(r.CULL_FACE):I.disable(r.CULL_FACE);I.setFlipSided(a.side===THREE.BackSide);!0===a.transparent?I.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst,a.blendEquationAlpha,a.blendSrcAlpha,a.blendDstAlpha):I.setBlending(THREE.NoBlending);I.setDepthFunc(a.depthFunc);I.setDepthTest(a.depthTest);I.setDepthWrite(a.depthWrite);I.setColorWrite(a.colorWrite);I.setPolygonOffset(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)}function v(a,
b,c,d,e){ya=0;var f=W.get(d);if(d.needsUpdate||!f.program){a:{var g=W.get(d),k=ua.getParameters(d,b,c,e),n=ua.getProgramCode(d,k),m=g.program,q=!0;if(void 0===m)d.addEventListener("dispose",h);else if(m.code!==n)l(d);else if(void 0!==k.shaderID)break a;else q=!1;q&&(k.shaderID?(m=THREE.ShaderLib[k.shaderID],g.__webglShader={name:d.type,uniforms:THREE.UniformsUtils.clone(m.uniforms),vertexShader:m.vertexShader,fragmentShader:m.fragmentShader}):g.__webglShader={name:d.type,uniforms:d.uniforms,vertexShader:d.vertexShader,
fragmentShader:d.fragmentShader},d.__webglShader=g.__webglShader,m=ua.acquireProgram(d,k,n),g.program=m,d.program=m);k=m.getAttributes();if(d.morphTargets)for(n=d.numSupportedMorphTargets=0;n<aa.maxMorphTargets;n++)0<=k["morphTarget"+n]&&d.numSupportedMorphTargets++;if(d.morphNormals)for(n=d.numSupportedMorphNormals=0;n<aa.maxMorphNormals;n++)0<=k["morphNormal"+n]&&d.numSupportedMorphNormals++;g.uniformsList=[];var k=g.program.getUniforms(),p;for(p in g.__webglShader.uniforms)(n=k[p])&&g.uniformsList.push([g.__webglShader.uniforms[p],
n])}d.needsUpdate=!1}n=m=q=!1;g=f.program;p=g.getUniforms();k=f.__webglShader.uniforms;g.id!==Aa&&(r.useProgram(g.program),Aa=g.id,n=m=q=!0);d.id!==ta&&(-1===ta&&(n=!0),ta=d.id,m=!0);if(q||a!==ra)r.uniformMatrix4fv(p.projectionMatrix,!1,a.projectionMatrix.elements),ha.logarithmicDepthBuffer&&r.uniform1f(p.logDepthBufFC,2/(Math.log(a.far+1)/Math.LN2)),a!==ra&&(ra=a),(d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&void 0!==p.cameraPosition&&(V.setFromMatrixPosition(a.matrixWorld),
r.uniform3f(p.cameraPosition,V.x,V.y,V.z)),(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshBasicMaterial||d instanceof THREE.ShaderMaterial||d.skinning)&&void 0!==p.viewMatrix&&r.uniformMatrix4fv(p.viewMatrix,!1,a.matrixWorldInverse.elements);d.skinning&&(e.bindMatrix&&void 0!==p.bindMatrix&&r.uniformMatrix4fv(p.bindMatrix,!1,e.bindMatrix.elements),e.bindMatrixInverse&&void 0!==p.bindMatrixInverse&&r.uniformMatrix4fv(p.bindMatrixInverse,!1,e.bindMatrixInverse.elements),
ha.floatVertexTextures&&e.skeleton&&e.skeleton.useVertexTexture?(void 0!==p.boneTexture&&(q=w(),r.uniform1i(p.boneTexture,q),aa.setTexture(e.skeleton.boneTexture,q)),void 0!==p.boneTextureWidth&&r.uniform1i(p.boneTextureWidth,e.skeleton.boneTextureWidth),void 0!==p.boneTextureHeight&&r.uniform1i(p.boneTextureHeight,e.skeleton.boneTextureHeight)):e.skeleton&&e.skeleton.boneMatrices&&void 0!==p.boneGlobalMatrices&&r.uniformMatrix4fv(p.boneGlobalMatrices,!1,e.skeleton.boneMatrices));if(m){c&&d.fog&&
(k.fogColor.value=c.color,c instanceof THREE.Fog?(k.fogNear.value=c.near,k.fogFar.value=c.far):c instanceof THREE.FogExp2&&(k.fogDensity.value=c.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights){if(wa){var n=!0,s,t=q=0,x=0,v,F,C,y=Ca,E=a.matrixWorldInverse,B=y.directional.colors,K=y.directional.positions,O=y.point.colors,N=y.point.positions,M=y.point.distances,G=y.point.decays,J=y.spot.colors,H=y.spot.positions,Q=y.spot.distances,I=y.spot.directions,
da=y.spot.anglesCos,T=y.spot.exponents,R=y.spot.decays,Z=y.hemi.skyColors,ga=y.hemi.groundColors,S=y.hemi.positions,ca=0,U=0,ea=0,fa=0,ja=0,ma=0,X=0,$=0,ba=s=0;c=C=ba=0;for(m=b.length;c<m;c++)s=b[c],v=s.color,F=s.intensity,C=s.distance,s instanceof THREE.AmbientLight?s.visible&&(q+=v.r,t+=v.g,x+=v.b):s instanceof THREE.DirectionalLight?(ja+=1,s.visible&&(Y.setFromMatrixPosition(s.matrixWorld),V.setFromMatrixPosition(s.target.matrixWorld),Y.sub(V),Y.transformDirection(E),s=3*ca,K[s+0]=Y.x,K[s+1]=Y.y,
K[s+2]=Y.z,D(B,s,v,F),ca+=1)):s instanceof THREE.PointLight?(ma+=1,s.visible&&(ba=3*U,D(O,ba,v,F),V.setFromMatrixPosition(s.matrixWorld),V.applyMatrix4(E),N[ba+0]=V.x,N[ba+1]=V.y,N[ba+2]=V.z,M[U]=C,G[U]=0===s.distance?0:s.decay,U+=1)):s instanceof THREE.SpotLight?(X+=1,s.visible&&(ba=3*ea,D(J,ba,v,F),Y.setFromMatrixPosition(s.matrixWorld),V.copy(Y).applyMatrix4(E),H[ba+0]=V.x,H[ba+1]=V.y,H[ba+2]=V.z,Q[ea]=C,V.setFromMatrixPosition(s.target.matrixWorld),Y.sub(V),Y.transformDirection(E),I[ba+0]=Y.x,
I[ba+1]=Y.y,I[ba+2]=Y.z,da[ea]=Math.cos(s.angle),T[ea]=s.exponent,R[ea]=0===s.distance?0:s.decay,ea+=1)):s instanceof THREE.HemisphereLight&&($+=1,s.visible&&(Y.setFromMatrixPosition(s.matrixWorld),Y.transformDirection(E),C=3*fa,S[C+0]=Y.x,S[C+1]=Y.y,S[C+2]=Y.z,v=s.color,s=s.groundColor,D(Z,C,v,F),D(ga,C,s,F),fa+=1));c=3*ca;for(m=Math.max(B.length,3*ja);c<m;c++)B[c]=0;c=3*U;for(m=Math.max(O.length,3*ma);c<m;c++)O[c]=0;c=3*ea;for(m=Math.max(J.length,3*X);c<m;c++)J[c]=0;c=3*fa;for(m=Math.max(Z.length,
3*$);c<m;c++)Z[c]=0;c=3*fa;for(m=Math.max(ga.length,3*$);c<m;c++)ga[c]=0;y.directional.length=ca;y.point.length=U;y.spot.length=ea;y.hemi.length=fa;y.ambient[0]=q;y.ambient[1]=t;y.ambient[2]=x;wa=!1}n?(n=Ca,k.ambientLightColor.value=n.ambient,k.directionalLightColor.value=n.directional.colors,k.directionalLightDirection.value=n.directional.positions,k.pointLightColor.value=n.point.colors,k.pointLightPosition.value=n.point.positions,k.pointLightDistance.value=n.point.distances,k.pointLightDecay.value=
n.point.decays,k.spotLightColor.value=n.spot.colors,k.spotLightPosition.value=n.spot.positions,k.spotLightDistance.value=n.spot.distances,k.spotLightDirection.value=n.spot.directions,k.spotLightAngleCos.value=n.spot.anglesCos,k.spotLightExponent.value=n.spot.exponents,k.spotLightDecay.value=n.spot.decays,k.hemisphereLightSkyColor.value=n.hemi.skyColors,k.hemisphereLightGroundColor.value=n.hemi.groundColors,k.hemisphereLightDirection.value=n.hemi.positions,u(k,!0)):u(k,!1)}if(d instanceof THREE.MeshBasicMaterial||
d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial){k.opacity.value=d.opacity;k.diffuse.value=d.color;d.emissive&&(k.emissive.value=d.emissive);k.map.value=d.map;k.specularMap.value=d.specularMap;k.alphaMap.value=d.alphaMap;d.aoMap&&(k.aoMap.value=d.aoMap,k.aoMapIntensity.value=d.aoMapIntensity);var P;d.map?P=d.map:d.specularMap?P=d.specularMap:d.displacementMap?P=d.displacementMap:d.normalMap?P=d.normalMap:d.bumpMap?P=d.bumpMap:d.alphaMap?P=d.alphaMap:d.emissiveMap&&(P=
d.emissiveMap);void 0!==P&&(P instanceof THREE.WebGLRenderTarget&&(P=P.texture),n=P.offset,P=P.repeat,k.offsetRepeat.value.set(n.x,n.y,P.x,P.y));k.envMap.value=d.envMap;k.flipEnvMap.value=d.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;k.reflectivity.value=d.reflectivity;k.refractionRatio.value=d.refractionRatio}d instanceof THREE.LineBasicMaterial?(k.diffuse.value=d.color,k.opacity.value=d.opacity):d instanceof THREE.LineDashedMaterial?(k.diffuse.value=d.color,k.opacity.value=d.opacity,k.dashSize.value=
d.dashSize,k.totalSize.value=d.dashSize+d.gapSize,k.scale.value=d.scale):d instanceof THREE.PointsMaterial?(k.psColor.value=d.color,k.opacity.value=d.opacity,k.size.value=d.size,k.scale.value=L.height/2,k.map.value=d.map,null!==d.map&&(a=d.map.offset,P=d.map.repeat,k.offsetRepeat.value.set(a.x,a.y,P.x,P.y))):d instanceof THREE.MeshPhongMaterial?(k.specular.value=d.specular,k.shininess.value=Math.max(d.shininess,1E-4),d.lightMap&&(k.lightMap.value=d.lightMap,k.lightMapIntensity.value=d.lightMapIntensity),
d.emissiveMap&&(k.emissiveMap.value=d.emissiveMap),d.bumpMap&&(k.bumpMap.value=d.bumpMap,k.bumpScale.value=d.bumpScale),d.normalMap&&(k.normalMap.value=d.normalMap,k.normalScale.value.copy(d.normalScale)),d.displacementMap&&(k.displacementMap.value=d.displacementMap,k.displacementScale.value=d.displacementScale,k.displacementBias.value=d.displacementBias)):d instanceof THREE.MeshDepthMaterial?(k.mNear.value=a.near,k.mFar.value=a.far,k.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&
(k.opacity.value=d.opacity);if(e.receiveShadow&&!d._shadowPass&&k.shadowMatrix)for(a=d=0,P=b.length;a<P;a++)n=b[a],!0===n.castShadow&&(n instanceof THREE.PointLight||n instanceof THREE.SpotLight||n instanceof THREE.DirectionalLight)&&(c=n.shadow,n instanceof THREE.PointLight?(V.setFromMatrixPosition(n.matrixWorld).negate(),c.matrix.identity().setPosition(V),k.shadowDarkness.value[d]=-c.darkness):k.shadowDarkness.value[d]=c.darkness,k.shadowMatrix.value[d]=c.matrix,k.shadowMap.value[d]=c.map,k.shadowMapSize.value[d]=
c.mapSize,k.shadowBias.value[d]=c.bias,d++);b=f.uniformsList;f=0;for(d=b.length;f<d;f++)if(a=b[f][0],!1!==a.needsUpdate)switch(k=a.type,c=a.value,P=b[f][1],k){case "1i":r.uniform1i(P,c);break;case "1f":r.uniform1f(P,c);break;case "2f":r.uniform2f(P,c[0],c[1]);break;case "3f":r.uniform3f(P,c[0],c[1],c[2]);break;case "4f":r.uniform4f(P,c[0],c[1],c[2],c[3]);break;case "1iv":r.uniform1iv(P,c);break;case "3iv":r.uniform3iv(P,c);break;case "1fv":r.uniform1fv(P,c);break;case "2fv":r.uniform2fv(P,c);break;
case "3fv":r.uniform3fv(P,c);break;case "4fv":r.uniform4fv(P,c);break;case "Matrix3fv":r.uniformMatrix3fv(P,!1,c);break;case "Matrix4fv":r.uniformMatrix4fv(P,!1,c);break;case "i":r.uniform1i(P,c);break;case "f":r.uniform1f(P,c);break;case "v2":r.uniform2f(P,c.x,c.y);break;case "v3":r.uniform3f(P,c.x,c.y,c.z);break;case "v4":r.uniform4f(P,c.x,c.y,c.z,c.w);break;case "c":r.uniform3f(P,c.r,c.g,c.b);break;case "iv1":r.uniform1iv(P,c);break;case "iv":r.uniform3iv(P,c);break;case "fv1":r.uniform1fv(P,c);
break;case "fv":r.uniform3fv(P,c);break;case "v2v":void 0===a._array&&(a._array=new Float32Array(2*c.length));m=k=0;for(n=c.length;k<n;k++,m+=2)a._array[m+0]=c[k].x,a._array[m+1]=c[k].y;r.uniform2fv(P,a._array);break;case "v3v":void 0===a._array&&(a._array=new Float32Array(3*c.length));m=k=0;for(n=c.length;k<n;k++,m+=3)a._array[m+0]=c[k].x,a._array[m+1]=c[k].y,a._array[m+2]=c[k].z;r.uniform3fv(P,a._array);break;case "v4v":void 0===a._array&&(a._array=new Float32Array(4*c.length));m=k=0;for(n=c.length;k<
n;k++,m+=4)a._array[m+0]=c[k].x,a._array[m+1]=c[k].y,a._array[m+2]=c[k].z,a._array[m+3]=c[k].w;r.uniform4fv(P,a._array);break;case "m3":r.uniformMatrix3fv(P,!1,c.elements);break;case "m3v":void 0===a._array&&(a._array=new Float32Array(9*c.length));k=0;for(n=c.length;k<n;k++)c[k].flattenToArrayOffset(a._array,9*k);r.uniformMatrix3fv(P,!1,a._array);break;case "m4":r.uniformMatrix4fv(P,!1,c.elements);break;case "m4v":void 0===a._array&&(a._array=new Float32Array(16*c.length));k=0;for(n=c.length;k<n;k++)c[k].flattenToArrayOffset(a._array,
16*k);r.uniformMatrix4fv(P,!1,a._array);break;case "t":m=w();r.uniform1i(P,m);if(!c)continue;c instanceof THREE.CubeTexture||Array.isArray(c.image)&&6===c.image.length?z(c,m):c instanceof THREE.WebGLRenderTargetCube?A(c.texture,m):c instanceof THREE.WebGLRenderTarget?aa.setTexture(c.texture,m):aa.setTexture(c,m);break;case "tv":void 0===a._array&&(a._array=[]);k=0;for(n=a.value.length;k<n;k++)a._array[k]=w();r.uniform1iv(P,a._array);k=0;for(n=a.value.length;k<n;k++)c=a.value[k],m=a._array[k],c&&(c instanceof
THREE.CubeTexture||c.image instanceof Array&&6===c.image.length?z(c,m):c instanceof THREE.WebGLRenderTarget?aa.setTexture(c.texture,m):c instanceof THREE.WebGLRenderTargetCube?A(c.texture,m):aa.setTexture(c,m));break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+k)}}r.uniformMatrix4fv(p.modelViewMatrix,!1,e.modelViewMatrix.elements);p.normalMatrix&&r.uniformMatrix3fv(p.normalMatrix,!1,e.normalMatrix.elements);void 0!==p.modelMatrix&&r.uniformMatrix4fv(p.modelMatrix,!1,e.matrixWorld.elements);
return g}function u(a,b){a.ambientLightColor.needsUpdate=b;a.directionalLightColor.needsUpdate=b;a.directionalLightDirection.needsUpdate=b;a.pointLightColor.needsUpdate=b;a.pointLightPosition.needsUpdate=b;a.pointLightDistance.needsUpdate=b;a.pointLightDecay.needsUpdate=b;a.spotLightColor.needsUpdate=b;a.spotLightPosition.needsUpdate=b;a.spotLightDistance.needsUpdate=b;a.spotLightDirection.needsUpdate=b;a.spotLightAngleCos.needsUpdate=b;a.spotLightExponent.needsUpdate=b;a.spotLightDecay.needsUpdate=
b;a.hemisphereLightSkyColor.needsUpdate=b;a.hemisphereLightGroundColor.needsUpdate=b;a.hemisphereLightDirection.needsUpdate=b}function w(){var a=ya;a>=ha.maxTextures&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+ha.maxTextures);ya+=1;return a}function D(a,b,c,d){a[b+0]=c.r*d;a[b+1]=c.g*d;a[b+2]=c.b*d}function x(a,b,c){c?(r.texParameteri(a,r.TEXTURE_WRAP_S,N(b.wrapS)),r.texParameteri(a,r.TEXTURE_WRAP_T,N(b.wrapT)),r.texParameteri(a,r.TEXTURE_MAG_FILTER,
N(b.magFilter)),r.texParameteri(a,r.TEXTURE_MIN_FILTER,N(b.minFilter))):(r.texParameteri(a,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(a,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),b.wrapS===THREE.ClampToEdgeWrapping&&b.wrapT===THREE.ClampToEdgeWrapping||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",b),r.texParameteri(a,r.TEXTURE_MAG_FILTER,C(b.magFilter)),r.texParameteri(a,r.TEXTURE_MIN_FILTER,C(b.minFilter)),
b.minFilter!==THREE.NearestFilter&&b.minFilter!==THREE.LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",b));!(c=S.get("EXT_texture_filter_anisotropic"))||b.type===THREE.FloatType&&null===S.get("OES_texture_float_linear")||b.type===THREE.HalfFloatType&&null===S.get("OES_texture_half_float_linear")||!(1<b.anisotropy||W.get(b).__currentAnisotropy)||(r.texParameterf(a,c.TEXTURE_MAX_ANISOTROPY_EXT,
Math.min(b.anisotropy,aa.getMaxAnisotropy())),W.get(b).__currentAnisotropy=b.anisotropy)}function B(a,b){if(a.width>b||a.height>b){var c=b/Math.max(a.width,a.height),d=document.createElement("canvas");d.width=Math.floor(a.width*c);d.height=Math.floor(a.height*c);d.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,d.width,d.height);console.warn("THREE.WebGLRenderer: image is too big ("+a.width+"x"+a.height+"). Resized to "+d.width+"x"+d.height,a);return d}return a}function y(a){return THREE.Math.isPowerOfTwo(a.width)&&
THREE.Math.isPowerOfTwo(a.height)}function z(a,b){var c=W.get(a);if(6===a.image.length)if(0<a.version&&c.__version!==a.version){c.__image__webglTextureCube||(a.addEventListener("dispose",g),c.__image__webglTextureCube=r.createTexture(),la.textures++);I.activeTexture(r.TEXTURE0+b);I.bindTexture(r.TEXTURE_CUBE_MAP,c.__image__webglTextureCube);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,a.flipY);for(var d=a instanceof THREE.CompressedTexture,e=a.image[0]instanceof THREE.DataTexture,f=[],h=0;6>h;h++)f[h]=!aa.autoScaleCubemaps||
d||e?e?a.image[h].image:a.image[h]:B(a.image[h],ha.maxCubemapSize);var k=y(f[0]),l=N(a.format),n=N(a.type);x(r.TEXTURE_CUBE_MAP,a,k);for(h=0;6>h;h++)if(d)for(var m,q=f[h].mipmaps,p=0,s=q.length;p<s;p++)m=q[p],a.format!==THREE.RGBAFormat&&a.format!==THREE.RGBFormat?-1<I.getCompressedTextureFormats().indexOf(l)?I.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+h,p,l,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setCubeTexture()"):
I.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+h,p,l,m.width,m.height,0,l,n,m.data);else e?I.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,l,f[h].width,f[h].height,0,l,n,f[h].data):I.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,l,l,n,f[h]);a.generateMipmaps&&k&&r.generateMipmap(r.TEXTURE_CUBE_MAP);c.__version=a.version;if(a.onUpdate)a.onUpdate(a)}else I.activeTexture(r.TEXTURE0+b),I.bindTexture(r.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)}function A(a,b){I.activeTexture(r.TEXTURE0+b);I.bindTexture(r.TEXTURE_CUBE_MAP,
W.get(a).__webglTexture)}function J(a,b,c){r.bindFramebuffer(r.FRAMEBUFFER,a);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,c,W.get(b.texture).__webglTexture,0)}function F(a,b){r.bindRenderbuffer(r.RENDERBUFFER,a);b.depthBuffer&&!b.stencilBuffer?(r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,b.width,b.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,a)):b.depthBuffer&&b.stencilBuffer?(r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,b.width,
b.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,a)):r.renderbufferStorage(r.RENDERBUFFER,r.RGBA4,b.width,b.height)}function C(a){return a===THREE.NearestFilter||a===THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?r.NEAREST:r.LINEAR}function N(a){var b;if(a===THREE.RepeatWrapping)return r.REPEAT;if(a===THREE.ClampToEdgeWrapping)return r.CLAMP_TO_EDGE;if(a===THREE.MirroredRepeatWrapping)return r.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return r.NEAREST;
if(a===THREE.NearestMipMapNearestFilter)return r.NEAREST_MIPMAP_NEAREST;if(a===THREE.NearestMipMapLinearFilter)return r.NEAREST_MIPMAP_LINEAR;if(a===THREE.LinearFilter)return r.LINEAR;if(a===THREE.LinearMipMapNearestFilter)return r.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return r.LINEAR_MIPMAP_LINEAR;if(a===THREE.UnsignedByteType)return r.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return r.UNSIGNED_SHORT_4_4_4_4;if(a===THREE.UnsignedShort5551Type)return r.UNSIGNED_SHORT_5_5_5_1;
if(a===THREE.UnsignedShort565Type)return r.UNSIGNED_SHORT_5_6_5;if(a===THREE.ByteType)return r.BYTE;if(a===THREE.ShortType)return r.SHORT;if(a===THREE.UnsignedShortType)return r.UNSIGNED_SHORT;if(a===THREE.IntType)return r.INT;if(a===THREE.UnsignedIntType)return r.UNSIGNED_INT;if(a===THREE.FloatType)return r.FLOAT;b=S.get("OES_texture_half_float");if(null!==b&&a===THREE.HalfFloatType)return b.HALF_FLOAT_OES;if(a===THREE.AlphaFormat)return r.ALPHA;if(a===THREE.RGBFormat)return r.RGB;if(a===THREE.RGBAFormat)return r.RGBA;
if(a===THREE.LuminanceFormat)return r.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return r.LUMINANCE_ALPHA;if(a===THREE.AddEquation)return r.FUNC_ADD;if(a===THREE.SubtractEquation)return r.FUNC_SUBTRACT;if(a===THREE.ReverseSubtractEquation)return r.FUNC_REVERSE_SUBTRACT;if(a===THREE.ZeroFactor)return r.ZERO;if(a===THREE.OneFactor)return r.ONE;if(a===THREE.SrcColorFactor)return r.SRC_COLOR;if(a===THREE.OneMinusSrcColorFactor)return r.ONE_MINUS_SRC_COLOR;if(a===THREE.SrcAlphaFactor)return r.SRC_ALPHA;
if(a===THREE.OneMinusSrcAlphaFactor)return r.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return r.DST_ALPHA;if(a===THREE.OneMinusDstAlphaFactor)return r.ONE_MINUS_DST_ALPHA;if(a===THREE.DstColorFactor)return r.DST_COLOR;if(a===THREE.OneMinusDstColorFactor)return r.ONE_MINUS_DST_COLOR;if(a===THREE.SrcAlphaSaturateFactor)return r.SRC_ALPHA_SATURATE;b=S.get("WEBGL_compressed_texture_s3tc");if(null!==b){if(a===THREE.RGB_S3TC_DXT1_Format)return b.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT1_Format)return b.COMPRESSED_RGBA_S3TC_DXT1_EXT;
if(a===THREE.RGBA_S3TC_DXT3_Format)return b.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return b.COMPRESSED_RGBA_S3TC_DXT5_EXT}b=S.get("WEBGL_compressed_texture_pvrtc");if(null!==b){if(a===THREE.RGB_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===THREE.RGB_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===THREE.RGBA_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===THREE.RGBA_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=
S.get("EXT_blend_minmax");if(null!==b){if(a===THREE.MinEquation)return b.MIN_EXT;if(a===THREE.MaxEquation)return b.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);a=a||{};var L=void 0!==a.canvas?a.canvas:document.createElement("canvas"),Q=void 0!==a.context?a.context:null,M=L.width,K=L.height,E=1,O=void 0!==a.alpha?a.alpha:!1,T=void 0!==a.depth?a.depth:!0,H=void 0!==a.stencil?a.stencil:!0,R=void 0!==a.antialias?a.antialias:!1,G=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:
!0,ia=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,U=new THREE.Color(0),X=0,da=[],ca=[],ga=-1,Z=[],fa=-1,ma=new Float32Array(8),ea=[],ja=[];this.domElement=L;this.context=null;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.gammaFactor=2;this.gammaOutput=this.gammaInput=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;var aa=this,Aa=null,za=null,ta=-1,sa="",ra=null,ya=0,na=0,oa=0,pa=L.width,qa=L.height,
Da=0,Ea=0,Ba=new THREE.Frustum,xa=new THREE.Matrix4,V=new THREE.Vector3,Y=new THREE.Vector3,wa=!0,Ca={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[],decays:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[],decays:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},la={geometries:0,textures:0},ka={calls:0,vertices:0,faces:0,points:0};this.info={render:ka,memory:la,programs:null};
var r;try{O={alpha:O,depth:T,stencil:H,antialias:R,premultipliedAlpha:G,preserveDrawingBuffer:ia};r=Q||L.getContext("webgl",O)||L.getContext("experimental-webgl",O);if(null===r){if(null!==L.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context.";}L.addEventListener("webglcontextlost",e,!1)}catch(Fa){console.error("THREE.WebGLRenderer: "+Fa)}var S=new THREE.WebGLExtensions(r);S.get("OES_texture_float");S.get("OES_texture_float_linear");
S.get("OES_texture_half_float");S.get("OES_texture_half_float_linear");S.get("OES_standard_derivatives");S.get("ANGLE_instanced_arrays");S.get("OES_element_index_uint")&&(THREE.BufferGeometry.MaxIndex=4294967296);var ha=new THREE.WebGLCapabilities(r,S,a),I=new THREE.WebGLState(r,S,N),W=new THREE.WebGLProperties,va=new THREE.WebGLObjects(r,W,this.info),ua=new THREE.WebGLPrograms(this,ha);this.info.programs=ua.programs;var Ga=new THREE.WebGLBufferRenderer(r,S,ka),Ha=new THREE.WebGLIndexedBufferRenderer(r,
S,ka);c();this.context=r;this.capabilities=ha;this.extensions=S;this.state=I;var $=new THREE.WebGLShadowMap(this,da,va);this.shadowMap=$;var Ia=new THREE.SpritePlugin(this,ea),Ja=new THREE.LensFlarePlugin(this,ja);this.getContext=function(){return r};this.getContextAttributes=function(){return r.getContextAttributes()};this.forceContextLoss=function(){S.get("WEBGL_lose_context").loseContext()};this.getMaxAnisotropy=function(){var a;return function(){if(void 0!==a)return a;var b=S.get("EXT_texture_filter_anisotropic");
return a=null!==b?r.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}();this.getPrecision=function(){return ha.precision};this.getPixelRatio=function(){return E};this.setPixelRatio=function(a){void 0!==a&&(E=a)};this.getSize=function(){return{width:M,height:K}};this.setSize=function(a,b,c){M=a;K=b;L.width=a*E;L.height=b*E;!1!==c&&(L.style.width=a+"px",L.style.height=b+"px");this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){na=a*E;oa=b*E;pa=c*E;qa=d*E;r.viewport(na,oa,pa,qa)};this.getViewport=
function(a){a.x=na/E;a.y=oa/E;a.z=pa/E;a.w=qa/E};this.setScissor=function(a,b,c,d){r.scissor(a*E,b*E,c*E,d*E)};this.enableScissorTest=function(a){I.setScissorTest(a)};this.getClearColor=function(){return U};this.setClearColor=function(a,c){U.set(a);X=void 0!==c?c:1;b(U.r,U.g,U.b,X)};this.getClearAlpha=function(){return X};this.setClearAlpha=function(a){X=a;b(U.r,U.g,U.b,X)};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=r.COLOR_BUFFER_BIT;if(void 0===b||b)d|=r.DEPTH_BUFFER_BIT;if(void 0===
c||c)d|=r.STENCIL_BUFFER_BIT;r.clear(d)};this.clearColor=function(){r.clear(r.COLOR_BUFFER_BIT)};this.clearDepth=function(){r.clear(r.DEPTH_BUFFER_BIT)};this.clearStencil=function(){r.clear(r.STENCIL_BUFFER_BIT)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.resetGLState=d;this.dispose=function(){L.removeEventListener("webglcontextlost",e,!1)};this.renderBufferImmediate=function(a,b,c){I.initAttributes();var d=W.get(a);a.hasPositions&&!d.position&&(d.position=
r.createBuffer());a.hasNormals&&!d.normal&&(d.normal=r.createBuffer());a.hasUvs&&!d.uv&&(d.uv=r.createBuffer());a.hasColors&&!d.color&&(d.color=r.createBuffer());b=b.getAttributes();a.hasPositions&&(r.bindBuffer(r.ARRAY_BUFFER,d.position),r.bufferData(r.ARRAY_BUFFER,a.positionArray,r.DYNAMIC_DRAW),I.enableAttribute(b.position),r.vertexAttribPointer(b.position,3,r.FLOAT,!1,0,0));if(a.hasNormals){r.bindBuffer(r.ARRAY_BUFFER,d.normal);if("MeshPhongMaterial"!==c.type&&c.shading===THREE.FlatShading)for(var e=
0,f=3*a.count;e<f;e+=9){var g=a.normalArray,h=(g[e+0]+g[e+3]+g[e+6])/3,k=(g[e+1]+g[e+4]+g[e+7])/3,l=(g[e+2]+g[e+5]+g[e+8])/3;g[e+0]=h;g[e+1]=k;g[e+2]=l;g[e+3]=h;g[e+4]=k;g[e+5]=l;g[e+6]=h;g[e+7]=k;g[e+8]=l}r.bufferData(r.ARRAY_BUFFER,a.normalArray,r.DYNAMIC_DRAW);I.enableAttribute(b.normal);r.vertexAttribPointer(b.normal,3,r.FLOAT,!1,0,0)}a.hasUvs&&c.map&&(r.bindBuffer(r.ARRAY_BUFFER,d.uv),r.bufferData(r.ARRAY_BUFFER,a.uvArray,r.DYNAMIC_DRAW),I.enableAttribute(b.uv),r.vertexAttribPointer(b.uv,2,r.FLOAT,
!1,0,0));a.hasColors&&c.vertexColors!==THREE.NoColors&&(r.bindBuffer(r.ARRAY_BUFFER,d.color),r.bufferData(r.ARRAY_BUFFER,a.colorArray,r.DYNAMIC_DRAW),I.enableAttribute(b.color),r.vertexAttribPointer(b.color,3,r.FLOAT,!1,0,0));I.disableUnusedAttributes();r.drawArrays(r.TRIANGLES,0,a.count);a.count=0};this.renderBufferDirect=function(a,b,c,d,e,f,g){t(e);var h=v(a,b,c,e,f),l=!1;a=d.id+"_"+h.id+"_"+e.wireframe;a!==sa&&(sa=a,l=!0);b=f.morphTargetInfluences;if(void 0!==b){a=[];c=0;for(l=b.length;c<l;c++){var n=
b[c];a.push([n,c])}a.sort(k);8<a.length&&(a.length=8);var m=d.morphAttributes;c=0;for(l=a.length;c<l;c++)n=a[c],ma[c]=n[0],0!==n[0]?(b=n[1],!0===e.morphTargets&&m.position&&d.addAttribute("morphTarget"+c,m.position[b]),!0===e.morphNormals&&m.normal&&d.addAttribute("morphNormal"+c,m.normal[b])):(!0===e.morphTargets&&d.removeAttribute("morphTarget"+c),!0===e.morphNormals&&d.removeAttribute("morphNormal"+c));a=h.getUniforms();null!==a.morphTargetInfluences&&r.uniform1fv(a.morphTargetInfluences,ma);l=
!0}b=d.index;c=d.attributes.position;!0===e.wireframe&&(b=va.getWireframeAttribute(d));null!==b?(a=Ha,a.setIndex(b)):a=Ga;if(l){a:{var l=void 0,q;if(d instanceof THREE.InstancedBufferGeometry&&(q=S.get("ANGLE_instanced_arrays"),null===q)){console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");break a}void 0===l&&(l=0);I.initAttributes();var n=d.attributes,h=h.getAttributes(),m=e.defaultAttributeValues,
p;for(p in h){var s=h[p];if(0<=s){var u=n[p];if(void 0!==u){var w=u.itemSize,x=va.getAttributeBuffer(u);if(u instanceof THREE.InterleavedBufferAttribute){var F=u.data,D=F.stride,u=u.offset;F instanceof THREE.InstancedInterleavedBuffer?(I.enableAttributeAndDivisor(s,F.meshPerAttribute,q),void 0===d.maxInstancedCount&&(d.maxInstancedCount=F.meshPerAttribute*F.count)):I.enableAttribute(s);r.bindBuffer(r.ARRAY_BUFFER,x);r.vertexAttribPointer(s,w,r.FLOAT,!1,D*F.array.BYTES_PER_ELEMENT,(l*D+u)*F.array.BYTES_PER_ELEMENT)}else u instanceof
THREE.InstancedBufferAttribute?(I.enableAttributeAndDivisor(s,u.meshPerAttribute,q),void 0===d.maxInstancedCount&&(d.maxInstancedCount=u.meshPerAttribute*u.count)):I.enableAttribute(s),r.bindBuffer(r.ARRAY_BUFFER,x),r.vertexAttribPointer(s,w,r.FLOAT,!1,0,l*w*4)}else if(void 0!==m&&(w=m[p],void 0!==w))switch(w.length){case 2:r.vertexAttrib2fv(s,w);break;case 3:r.vertexAttrib3fv(s,w);break;case 4:r.vertexAttrib4fv(s,w);break;default:r.vertexAttrib1fv(s,w)}}}I.disableUnusedAttributes()}null!==b&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,
va.getAttributeBuffer(b))}q=Infinity;null!==b?q=b.count:void 0!==c&&(q=c.count);p=d.drawRange.start;b=d.drawRange.count;c=null!==g?g.start:0;l=null!==g?g.count:Infinity;g=Math.max(0,p,c);q=Math.min(0+q,p+b,c+l)-1;q=Math.max(0,q-g+1);f instanceof THREE.Mesh?(!0===e.wireframe?(I.setLineWidth(e.wireframeLinewidth*E),a.setMode(r.LINES)):a.setMode(r.TRIANGLES),d instanceof THREE.InstancedBufferGeometry&&0<d.maxInstancedCount?a.renderInstances(d):a.render(g,q)):f instanceof THREE.Line?(d=e.linewidth,void 0===
d&&(d=1),I.setLineWidth(d*E),f instanceof THREE.LineSegments?a.setMode(r.LINES):a.setMode(r.LINE_STRIP),a.render(g,q)):f instanceof THREE.Points&&(a.setMode(r.POINTS),a.render(g,q))};this.render=function(a,b,c,d){if(!1===b instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var e=a.fog;sa="";ta=-1;ra=null;wa=!0;!0===a.autoUpdate&&a.updateMatrixWorld();null===b.parent&&b.updateMatrixWorld();b.matrixWorldInverse.getInverse(b.matrixWorld);
xa.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);Ba.setFromMatrix(xa);da.length=0;fa=ga=-1;ea.length=0;ja.length=0;q(a,b);ca.length=ga+1;Z.length=fa+1;!0===aa.sortObjects&&(ca.sort(m),Z.sort(p));$.render(a);ka.calls=0;ka.vertices=0;ka.faces=0;ka.points=0;this.setRenderTarget(c);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);a.overrideMaterial?(d=a.overrideMaterial,s(ca,b,da,e,d),s(Z,b,da,e,d)):(I.setBlending(THREE.NoBlending),s(ca,b,da,e),
s(Z,b,da,e));Ia.render(a,b);Ja.render(a,b,Da,Ea);c&&(a=c.texture,b=y(c),a.generateMipmaps&&b&&a.minFilter!==THREE.NearestFilter&&a.minFilter!==THREE.LinearFilter&&(a=c instanceof THREE.WebGLRenderTargetCube?r.TEXTURE_CUBE_MAP:r.TEXTURE_2D,c=W.get(c.texture).__webglTexture,I.bindTexture(a,c),r.generateMipmap(a),I.bindTexture(a,null)));I.setDepthTest(!0);I.setDepthWrite(!0);I.setColorWrite(!0)}};this.setFaceCulling=function(a,b){a===THREE.CullFaceNone?I.disable(r.CULL_FACE):(b===THREE.FrontFaceDirectionCW?
r.frontFace(r.CW):r.frontFace(r.CCW),a===THREE.CullFaceBack?r.cullFace(r.BACK):a===THREE.CullFaceFront?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK),I.enable(r.CULL_FACE))};this.setTexture=function(a,b){var c=W.get(a);if(0<a.version&&c.__version!==a.version){var d=a.image;if(void 0===d)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",a);else if(!1===d.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",a);else{void 0===
c.__webglInit&&(c.__webglInit=!0,a.addEventListener("dispose",g),c.__webglTexture=r.createTexture(),la.textures++);I.activeTexture(r.TEXTURE0+b);I.bindTexture(r.TEXTURE_2D,c.__webglTexture);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,a.flipY);r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);r.pixelStorei(r.UNPACK_ALIGNMENT,a.unpackAlignment);a.image=B(a.image,ha.maxTextureSize);if((a.wrapS!==THREE.ClampToEdgeWrapping||a.wrapT!==THREE.ClampToEdgeWrapping||a.minFilter!==THREE.NearestFilter&&
a.minFilter!==THREE.LinearFilter)&&!1===y(a.image)){d=a.image;if(d instanceof HTMLImageElement||d instanceof HTMLCanvasElement){var e=document.createElement("canvas");e.width=THREE.Math.nearestPowerOfTwo(d.width);e.height=THREE.Math.nearestPowerOfTwo(d.height);e.getContext("2d").drawImage(d,0,0,e.width,e.height);console.warn("THREE.WebGLRenderer: image is not power of two ("+d.width+"x"+d.height+"). Resized to "+e.width+"x"+e.height,d);d=e}a.image=d}var f=a.image,d=y(f),e=N(a.format),h=N(a.type);
x(r.TEXTURE_2D,a,d);var k=a.mipmaps;if(a instanceof THREE.DataTexture)if(0<k.length&&d){for(var l=0,n=k.length;l<n;l++)f=k[l],I.texImage2D(r.TEXTURE_2D,l,e,f.width,f.height,0,e,h,f.data);a.generateMipmaps=!1}else I.texImage2D(r.TEXTURE_2D,0,e,f.width,f.height,0,e,h,f.data);else if(a instanceof THREE.CompressedTexture)for(l=0,n=k.length;l<n;l++)f=k[l],a.format!==THREE.RGBAFormat&&a.format!==THREE.RGBFormat?-1<I.getCompressedTextureFormats().indexOf(e)?I.compressedTexImage2D(r.TEXTURE_2D,l,e,f.width,
f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):I.texImage2D(r.TEXTURE_2D,l,e,f.width,f.height,0,e,h,f.data);else if(0<k.length&&d){l=0;for(n=k.length;l<n;l++)f=k[l],I.texImage2D(r.TEXTURE_2D,l,e,e,h,f);a.generateMipmaps=!1}else I.texImage2D(r.TEXTURE_2D,0,e,e,h,a.image);a.generateMipmaps&&d&&r.generateMipmap(r.TEXTURE_2D);c.__version=a.version;if(a.onUpdate)a.onUpdate(a)}}else I.activeTexture(r.TEXTURE0+b),I.bindTexture(r.TEXTURE_2D,
c.__webglTexture)};this.setRenderTarget=function(a){var b=a instanceof THREE.WebGLRenderTargetCube;if(a&&void 0===W.get(a).__webglFramebuffer){var c=W.get(a),d=W.get(a.texture);void 0===a.depthBuffer&&(a.depthBuffer=!0);void 0===a.stencilBuffer&&(a.stencilBuffer=!0);a.addEventListener("dispose",f);d.__webglTexture=r.createTexture();la.textures++;var e=y(a),g=N(a.texture.format),h=N(a.texture.type);if(b){c.__webglFramebuffer=[];c.__webglRenderbuffer=[];I.bindTexture(r.TEXTURE_CUBE_MAP,d.__webglTexture);
x(r.TEXTURE_CUBE_MAP,a.texture,e);for(d=0;6>d;d++)c.__webglFramebuffer[d]=r.createFramebuffer(),c.__webglRenderbuffer[d]=r.createRenderbuffer(),I.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,g,a.width,a.height,0,g,h,null),J(c.__webglFramebuffer[d],a,r.TEXTURE_CUBE_MAP_POSITIVE_X+d),F(c.__webglRenderbuffer[d],a);a.texture.generateMipmaps&&e&&r.generateMipmap(r.TEXTURE_CUBE_MAP)}else c.__webglFramebuffer=r.createFramebuffer(),c.__webglRenderbuffer=a.shareDepthFrom?a.shareDepthFrom.__webglRenderbuffer:
r.createRenderbuffer(),I.bindTexture(r.TEXTURE_2D,d.__webglTexture),x(r.TEXTURE_2D,a.texture,e),I.texImage2D(r.TEXTURE_2D,0,g,a.width,a.height,0,g,h,null),J(c.__webglFramebuffer,a,r.TEXTURE_2D),a.shareDepthFrom?a.depthBuffer&&!a.stencilBuffer?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,c.__webglRenderbuffer):a.depthBuffer&&a.stencilBuffer&&r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,c.__webglRenderbuffer):F(c.__webglRenderbuffer,
a),a.texture.generateMipmaps&&e&&r.generateMipmap(r.TEXTURE_2D);b?I.bindTexture(r.TEXTURE_CUBE_MAP,null):I.bindTexture(r.TEXTURE_2D,null);r.bindRenderbuffer(r.RENDERBUFFER,null);r.bindFramebuffer(r.FRAMEBUFFER,null)}a?(c=W.get(a),d=b?c.__webglFramebuffer[a.activeCubeFace]:c.__webglFramebuffer,c=a.width,e=a.height,h=g=0):(d=null,c=pa,e=qa,g=na,h=oa);d!==za&&(r.bindFramebuffer(r.FRAMEBUFFER,d),r.viewport(g,h,c,e),za=d);b&&(d=W.get(a.texture),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,
r.TEXTURE_CUBE_MAP_POSITIVE_X+a.activeCubeFace,d.__webglTexture,0));Da=c;Ea=e};this.readRenderTargetPixels=function(a,b,c,d,e,f){if(!1===a instanceof THREE.WebGLRenderTarget)console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");else{var g=W.get(a).__webglFramebuffer;if(g){var h=!1;g!==za&&(r.bindFramebuffer(r.FRAMEBUFFER,g),h=!0);try{var k=a.texture;k.format!==THREE.RGBAFormat&&N(k.format)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_FORMAT)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):
k.type===THREE.UnsignedByteType||N(k.type)===r.getParameter(r.IMPLEMENTATION_COLOR_READ_TYPE)||k.type===THREE.FloatType&&S.get("WEBGL_color_buffer_float")||k.type===THREE.HalfFloatType&&S.get("EXT_color_buffer_half_float")?r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE?r.readPixels(b,c,d,e,N(k.format),N(k.type),f):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{h&&
r.bindFramebuffer(r.FRAMEBUFFER,za)}}}};this.supportsFloatTextures=function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");return S.get("OES_texture_float")};this.supportsHalfFloatTextures=function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return S.get("OES_texture_half_float")};this.supportsStandardDerivatives=function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");
return S.get("OES_standard_derivatives")};this.supportsCompressedTextureS3TC=function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");return S.get("WEBGL_compressed_texture_s3tc")};this.supportsCompressedTexturePVRTC=function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return S.get("WEBGL_compressed_texture_pvrtc")};this.supportsBlendMinMax=
function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return S.get("EXT_blend_minmax")};this.supportsVertexTextures=function(){return ha.vertexTextures};this.supportsInstancedArrays=function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return S.get("ANGLE_instanced_arrays")};this.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")};
this.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")};this.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")};this.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")};Object.defineProperties(this,{shadowMapEnabled:{get:function(){return $.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");$.enabled=a}},
shadowMapType:{get:function(){return $.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");$.type=a}},shadowMapCullFace:{get:function(){return $.cullFace},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.");$.cullFace=a}},shadowMapDebug:{get:function(){return $.debug},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapDebug is now .shadowMap.debug.");$.debug=a}}})};
THREE.WebGLRenderTarget=function(a,b,c){this.uuid=THREE.Math.generateUUID();this.width=a;this.height=b;c=c||{};void 0===c.minFilter&&(c.minFilter=THREE.LinearFilter);this.texture=new THREE.Texture(void 0,void 0,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy);this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.shareDepthFrom=void 0!==c.shareDepthFrom?c.shareDepthFrom:null};
THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,get wrapS(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");return this.texture.wrapS},set wrapS(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");this.texture.wrapS=a},get wrapT(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set wrapT(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");this.texture.wrapT=a},
get magFilter(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},set magFilter(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=a},get minFilter(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set minFilter(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");this.texture.minFilter=a},get anisotropy(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");
return this.texture.anisotropy},set anisotropy(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=a},get offset(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set offset(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");this.texture.offset=a},get repeat(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set repeat(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");
this.texture.repeat=a},get format(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");return this.texture.format},set format(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=a},get type(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set type(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=a},get generateMipmaps(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");
return this.texture.generateMipmaps},set generateMipmaps(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");this.texture.generateMipmaps=a},setSize:function(a,b){if(this.width!==a||this.height!==b)this.width=a,this.height=b,this.dispose()},clone:function(){return(new this.constructor).copy(this)},copy:function(a){this.width=a.width;this.height=a.height;this.texture=a.texture.clone();this.depthBuffer=a.depthBuffer;this.stencilBuffer=a.stencilBuffer;this.shareDepthFrom=
a.shareDepthFrom;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube=function(a,b,c){THREE.WebGLRenderTarget.call(this,a,b,c);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube;
THREE.WebGLBufferRenderer=function(a,b,c){var d;this.setMode=function(a){d=a};this.render=function(b,g){a.drawArrays(d,b,g);c.calls++;c.vertices+=g;d===a.TRIANGLES&&(c.faces+=g/3)};this.renderInstances=function(a){var c=b.get("ANGLE_instanced_arrays");if(null===c)console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{var f=a.attributes.position;f instanceof THREE.InterleavedBufferAttribute?c.drawArraysInstancedANGLE(d,
0,f.data.count,a.maxInstancedCount):c.drawArraysInstancedANGLE(d,0,f.count,a.maxInstancedCount)}}};
THREE.WebGLIndexedBufferRenderer=function(a,b,c){var d,e,g;this.setMode=function(a){d=a};this.setIndex=function(c){c.array instanceof Uint32Array&&b.get("OES_element_index_uint")?(e=a.UNSIGNED_INT,g=4):(e=a.UNSIGNED_SHORT,g=2)};this.render=function(b,h){a.drawElements(d,h,e,b*g);c.calls++;c.vertices+=h;d===a.TRIANGLES&&(c.faces+=h/3)};this.renderInstances=function(a){var c=b.get("ANGLE_instanced_arrays");null===c?console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):
c.drawElementsInstancedANGLE(d,a.index.array.length,e,0,a.maxInstancedCount)}};
THREE.WebGLExtensions=function(a){var b={};this.get=function(c){if(void 0!==b[c])return b[c];var d;switch(c){case "EXT_texture_filter_anisotropic":d=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":d=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
break;case "WEBGL_compressed_texture_pvrtc":d=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:d=a.getExtension(c)}null===d&&console.warn("THREE.WebGLRenderer: "+c+" extension not supported.");return b[c]=d}};
THREE.WebGLCapabilities=function(a,b,c){function d(b){if("highp"===b){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return"highp";b="mediump"}return"mediump"===b&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?"mediump":"lowp"}this.getMaxPrecision=d;this.precision=void 0!==c.precision?c.precision:"highp";
this.logarithmicDepthBuffer=void 0!==c.logarithmicDepthBuffer?c.logarithmicDepthBuffer:!1;this.maxTextures=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);this.maxVertexTextures=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE);this.maxCubemapSize=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE);this.maxAttributes=a.getParameter(a.MAX_VERTEX_ATTRIBS);this.maxVertexUniforms=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS);this.maxVaryings=a.getParameter(a.MAX_VARYING_VECTORS);
this.maxFragmentUniforms=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS);this.vertexTextures=0<this.maxVertexTextures;this.floatFragmentTextures=!!b.get("OES_texture_float");this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;c=d(this.precision);c!==this.precision&&(console.warn("THREE.WebGLRenderer:",this.precision,"not supported, using",c,"instead."),this.precision=c);this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!b.get("EXT_frag_depth"))};
THREE.WebGLGeometries=function(a,b,c){function d(a){a=a.target;var h=g[a.id].attributes,l;for(l in h)e(h[l]);a.removeEventListener("dispose",d);delete g[a.id];l=b.get(a);l.wireframe&&e(l.wireframe);c.memory.geometries--}function e(c){var d;d=c instanceof THREE.InterleavedBufferAttribute?b.get(c.data).__webglBuffer:b.get(c).__webglBuffer;void 0!==d&&(a.deleteBuffer(d),c instanceof THREE.InterleavedBufferAttribute?b.delete(c.data):b.delete(c))}var g={};this.get=function(a){var b=a.geometry;if(void 0!==
g[b.id])return g[b.id];b.addEventListener("dispose",d);var e;b instanceof THREE.BufferGeometry?e=b:b instanceof THREE.Geometry&&(void 0===b._bufferGeometry&&(b._bufferGeometry=(new THREE.BufferGeometry).setFromObject(a)),e=b._bufferGeometry);g[b.id]=e;c.memory.geometries++;return e}};
THREE.WebGLObjects=function(a,b,c){function d(c,d){var e=c instanceof THREE.InterleavedBufferAttribute?c.data:c,g=b.get(e);void 0===g.__webglBuffer?(g.__webglBuffer=a.createBuffer(),a.bindBuffer(d,g.__webglBuffer),a.bufferData(d,e.array,e.dynamic?a.DYNAMIC_DRAW:a.STATIC_DRAW),g.version=e.version):g.version!==e.version&&(a.bindBuffer(d,g.__webglBuffer),!1===e.dynamic||-1===e.updateRange.count?a.bufferSubData(d,0,e.array):0===e.updateRange.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):
(a.bufferSubData(d,e.updateRange.offset*e.array.BYTES_PER_ELEMENT,e.array.subarray(e.updateRange.offset,e.updateRange.offset+e.updateRange.count)),e.updateRange.count=0),g.version=e.version)}function e(a,b,c){if(b>c){var d=b;b=c;c=d}d=a[b];return void 0===d?(a[b]=[c],!0):-1===d.indexOf(c)?(d.push(c),!0):!1}var g=new THREE.WebGLGeometries(a,b,c);this.getAttributeBuffer=function(a){return a instanceof THREE.InterleavedBufferAttribute?b.get(a.data).__webglBuffer:b.get(a).__webglBuffer};this.getWireframeAttribute=
function(c){var g=b.get(c);if(void 0!==g.wireframe)return g.wireframe;var l=[],k=c.index,m=c.attributes;c=m.position;if(null!==k)for(var m={},k=k.array,p=0,n=k.length;p<n;p+=3){var q=k[p+0],s=k[p+1],t=k[p+2];e(m,q,s)&&l.push(q,s);e(m,s,t)&&l.push(s,t);e(m,t,q)&&l.push(t,q)}else for(k=m.position.array,p=0,n=k.length/3-1;p<n;p+=3)q=p+0,s=p+1,t=p+2,l.push(q,s,s,t,t,q);l=new THREE.BufferAttribute(new (65535<c.count?Uint32Array:Uint16Array)(l),1);d(l,a.ELEMENT_ARRAY_BUFFER);return g.wireframe=l};this.update=
function(b){var c=g.get(b);b.geometry instanceof THREE.Geometry&&c.updateFromObject(b);b=c.index;var e=c.attributes;null!==b&&d(b,a.ELEMENT_ARRAY_BUFFER);for(var k in e)d(e[k],a.ARRAY_BUFFER);b=c.morphAttributes;for(k in b)for(var e=b[k],m=0,p=e.length;m<p;m++)d(e[m],a.ARRAY_BUFFER);return c}};
THREE.WebGLProgram=function(){function a(a){var b=[],c;for(c in a){var f=a[c];!1!==f&&b.push("#define "+c+" "+f)}return b.join("\n")}function b(a){return""!==a}var c=0;return function(d,e,g,f){var h=d.context,l=g.defines,k=g.__webglShader.vertexShader,m=g.__webglShader.fragmentShader,p="SHADOWMAP_TYPE_BASIC";f.shadowMapType===THREE.PCFShadowMap?p="SHADOWMAP_TYPE_PCF":f.shadowMapType===THREE.PCFSoftShadowMap&&(p="SHADOWMAP_TYPE_PCF_SOFT");var n="ENVMAP_TYPE_CUBE",q="ENVMAP_MODE_REFLECTION",s="ENVMAP_BLENDING_MULTIPLY";
if(f.envMap){switch(g.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:n="ENVMAP_TYPE_CUBE";break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:n="ENVMAP_TYPE_EQUIREC";break;case THREE.SphericalReflectionMapping:n="ENVMAP_TYPE_SPHERE"}switch(g.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:q="ENVMAP_MODE_REFRACTION"}switch(g.combine){case THREE.MultiplyOperation:s="ENVMAP_BLENDING_MULTIPLY";
break;case THREE.MixOperation:s="ENVMAP_BLENDING_MIX";break;case THREE.AddOperation:s="ENVMAP_BLENDING_ADD"}}var t=0<d.gammaFactor?d.gammaFactor:1,v=a(l),u=h.createProgram();g instanceof THREE.RawShaderMaterial?d=l="":(l=["precision "+f.precision+" float;","precision "+f.precision+" int;","#define SHADER_NAME "+g.__webglShader.name,v,f.supportsVertexTextures?"#define VERTEX_TEXTURES":"",d.gammaInput?"#define GAMMA_INPUT":"",d.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+t,"#define MAX_DIR_LIGHTS "+
f.maxDirLights,"#define MAX_POINT_LIGHTS "+f.maxPointLights,"#define MAX_SPOT_LIGHTS "+f.maxSpotLights,"#define MAX_HEMI_LIGHTS "+f.maxHemiLights,"#define MAX_SHADOWS "+f.maxShadows,"#define MAX_BONES "+f.maxBones,f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+q:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.displacementMap&&
f.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.skinning?"#define USE_SKINNING":"",f.useVertexTexture?"#define BONE_TEXTURE":"",f.morphTargets?"#define USE_MORPHTARGETS":"",f.morphNormals&&!1===f.flatShading?"#define USE_MORPHNORMALS":"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?
"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+p:"",f.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",0<f.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",f.sizeAttenuation?"#define USE_SIZEATTENUATION":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&d.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;",
"uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;",
"\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(b).join("\n"),d=[f.bumpMap||f.normalMap||f.flatShading||g.derivatives?"#extension GL_OES_standard_derivatives : enable":"",f.logarithmicDepthBuffer&&d.extensions.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"","precision "+f.precision+" float;","precision "+
f.precision+" int;","#define SHADER_NAME "+g.__webglShader.name,v,"#define MAX_DIR_LIGHTS "+f.maxDirLights,"#define MAX_POINT_LIGHTS "+f.maxPointLights,"#define MAX_SPOT_LIGHTS "+f.maxSpotLights,"#define MAX_HEMI_LIGHTS "+f.maxHemiLights,"#define MAX_SHADOWS "+f.maxShadows,f.alphaTest?"#define ALPHATEST "+f.alphaTest:"",d.gammaInput?"#define GAMMA_INPUT":"",d.gammaOutput?"#define GAMMA_OUTPUT":"","#define GAMMA_FACTOR "+t,f.useFog&&f.fog?"#define USE_FOG":"",f.useFog&&f.fogExp?"#define FOG_EXP2":
"",f.map?"#define USE_MAP":"",f.envMap?"#define USE_ENVMAP":"",f.envMap?"#define "+n:"",f.envMap?"#define "+q:"",f.envMap?"#define "+s:"",f.lightMap?"#define USE_LIGHTMAP":"",f.aoMap?"#define USE_AOMAP":"",f.emissiveMap?"#define USE_EMISSIVEMAP":"",f.bumpMap?"#define USE_BUMPMAP":"",f.normalMap?"#define USE_NORMALMAP":"",f.specularMap?"#define USE_SPECULARMAP":"",f.alphaMap?"#define USE_ALPHAMAP":"",f.vertexColors?"#define USE_COLOR":"",f.flatShading?"#define FLAT_SHADED":"",f.metal?"#define METAL":
"",f.doubleSided?"#define DOUBLE_SIDED":"",f.flipSided?"#define FLIP_SIDED":"",f.shadowMapEnabled?"#define USE_SHADOWMAP":"",f.shadowMapEnabled?"#define "+p:"",f.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",0<f.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",f.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",f.logarithmicDepthBuffer&&d.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","\n"].filter(b).join("\n"));m=d+m;
k=THREE.WebGLShader(h,h.VERTEX_SHADER,l+k);m=THREE.WebGLShader(h,h.FRAGMENT_SHADER,m);h.attachShader(u,k);h.attachShader(u,m);void 0!==g.index0AttributeName?h.bindAttribLocation(u,0,g.index0AttributeName):!0===f.morphTargets&&h.bindAttribLocation(u,0,"position");h.linkProgram(u);f=h.getProgramInfoLog(u);p=h.getShaderInfoLog(k);n=h.getShaderInfoLog(m);s=q=!0;if(!1===h.getProgramParameter(u,h.LINK_STATUS))q=!1,console.error("THREE.WebGLProgram: shader error: ",h.getError(),"gl.VALIDATE_STATUS",h.getProgramParameter(u,
h.VALIDATE_STATUS),"gl.getProgramInfoLog",f,p,n);else if(""!==f)console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",f);else if(""===p||""===n)s=!1;s&&(this.diagnostics={runnable:q,material:g,programLog:f,vertexShader:{log:p,prefix:l},fragmentShader:{log:n,prefix:d}});h.deleteShader(k);h.deleteShader(m);var w;this.getUniforms=function(){if(void 0===w){for(var a={},b=h.getProgramParameter(u,h.ACTIVE_UNIFORMS),c=0;c<b;c++){var d=h.getActiveUniform(u,c).name,e=h.getUniformLocation(u,d),f=d.lastIndexOf("[0]");
-1!==f&&f===d.length-3&&(a[d.substr(0,f)]=e);a[d]=e}w=a}return w};var D;this.getAttributes=function(){if(void 0===D){for(var a={},b=h.getProgramParameter(u,h.ACTIVE_ATTRIBUTES),c=0;c<b;c++){var d=h.getActiveAttrib(u,c).name;a[d]=h.getAttribLocation(u,d)}D=a}return D};this.destroy=function(){h.deleteProgram(u);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");
return this.getAttributes()}}});this.id=c++;this.code=e;this.usedTimes=1;this.program=u;this.vertexShader=k;this.fragmentShader=m;return this}}();
THREE.WebGLPrograms=function(a,b){var c=[],d={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},e="precision supportsVertexTextures map envMap envMapMode lightMap aoMap emissiveMap bumpMap normalMap displacementMap specularMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals maxDirLights maxPointLights maxSpotLights maxHemiLights maxShadows shadowMapEnabled pointLightShadows shadowMapType shadowMapDebug alphaTest metal doubleSided flipSided".split(" ");this.getParameters=
function(c,e,h,l){var k,m,p,n,q,s=d[c.type];k=q=n=p=m=0;for(var t=e.length;k<t;k++){var v=e[k];!1!==v.visible&&(v instanceof THREE.DirectionalLight&&m++,v instanceof THREE.PointLight&&p++,v instanceof THREE.SpotLight&&n++,v instanceof THREE.HemisphereLight&&q++)}for(var v=k=t=0,u=e.length;v<u;v++){var w=e[v];w.castShadow&&((w instanceof THREE.SpotLight||w instanceof THREE.DirectionalLight)&&t++,w instanceof THREE.PointLight&&(t++,k++))}e=t;b.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture?
t=1024:(t=Math.floor((b.maxVertexUniforms-20)/4),void 0!==l&&l instanceof THREE.SkinnedMesh&&(t=Math.min(l.skeleton.bones.length,t),t<l.skeleton.bones.length&&console.warn("WebGLRenderer: too many bones - "+l.skeleton.bones.length+", this GPU supports just "+t+" (try OpenGL instead of ANGLE)")));v=a.getPrecision();null!==c.precision&&(v=b.getMaxPrecision(c.precision),v!==c.precision&&console.warn("THREE.WebGLRenderer.initMaterial:",c.precision,"not supported, using",v,"instead."));return{shaderID:s,
precision:v,supportsVertexTextures:b.vertexTextures,map:!!c.map,envMap:!!c.envMap,envMapMode:c.envMap&&c.envMap.mapping,lightMap:!!c.lightMap,aoMap:!!c.aoMap,emissiveMap:!!c.emissiveMap,bumpMap:!!c.bumpMap,normalMap:!!c.normalMap,displacementMap:!!c.displacementMap,specularMap:!!c.specularMap,alphaMap:!!c.alphaMap,combine:c.combine,vertexColors:c.vertexColors,fog:h,useFog:c.fog,fogExp:h instanceof THREE.FogExp2,flatShading:c.shading===THREE.FlatShading,sizeAttenuation:c.sizeAttenuation,logarithmicDepthBuffer:b.logarithmicDepthBuffer,
skinning:c.skinning,maxBones:t,useVertexTexture:b.floatVertexTextures&&l&&l.skeleton&&l.skeleton.useVertexTexture,morphTargets:c.morphTargets,morphNormals:c.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,maxDirLights:m,maxPointLights:p,maxSpotLights:n,maxHemiLights:q,maxShadows:e,pointLightShadows:k,shadowMapEnabled:a.shadowMap.enabled&&l.receiveShadow&&0<e,shadowMapType:a.shadowMap.type,shadowMapDebug:a.shadowMap.debug,alphaTest:c.alphaTest,metal:c.metal,doubleSided:c.side===
THREE.DoubleSide,flipSided:c.side===THREE.BackSide}};this.getProgramCode=function(a,b){var c=[];b.shaderID?c.push(b.shaderID):(c.push(a.fragmentShader),c.push(a.vertexShader));if(void 0!==a.defines)for(var d in a.defines)c.push(d),c.push(a.defines[d]);for(d=0;d<e.length;d++){var k=e[d];c.push(k);c.push(b[k])}return c.join()};this.acquireProgram=function(b,d,e){for(var l,k=0,m=c.length;k<m;k++){var p=c[k];if(p.code===e){l=p;++l.usedTimes;break}}void 0===l&&(l=new THREE.WebGLProgram(a,e,b,d),c.push(l));
return l};this.releaseProgram=function(a){if(0===--a.usedTimes){var b=c.indexOf(a);c[b]=c[c.length-1];c.pop();a.destroy()}};this.programs=c};THREE.WebGLProperties=function(){var a={};this.get=function(b){b=b.uuid;var c=a[b];void 0===c&&(c={},a[b]=c);return c};this.delete=function(b){delete a[b.uuid]};this.clear=function(){a={}}};
THREE.WebGLShader=function(){function a(a){a=a.split("\n");for(var c=0;c<a.length;c++)a[c]=c+1+": "+a[c];return a.join("\n")}return function(b,c,d){var e=b.createShader(c);b.shaderSource(e,d);b.compileShader(e);!1===b.getShaderParameter(e,b.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile.");""!==b.getShaderInfoLog(e)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",c===b.VERTEX_SHADER?"vertex":"fragment",b.getShaderInfoLog(e),a(d));return e}}();
THREE.WebGLShadowMap=function(a,b,c){function d(a,b,c,d){var e=a.geometry,f=null,f=n,g=a.customDepthMaterial;c&&(f=q,g=a.customDistanceMaterial);g?f=g:(a=a instanceof THREE.SkinnedMesh&&b.skinning,g=0,void 0!==e.morphTargets&&0<e.morphTargets.length&&b.morphTargets&&(g|=1),a&&(g|=2),f=f[g]);f.visible=b.visible;f.wireframe=b.wireframe;f.wireframeLinewidth=b.wireframeLinewidth;c&&void 0!==f.uniforms.lightPos&&f.uniforms.lightPos.value.copy(d);return f}function e(a,b){if(!1!==a.visible){(a instanceof
THREE.Mesh||a instanceof THREE.Line||a instanceof THREE.Points)&&a.castShadow&&(!1===a.frustumCulled||!0===h.intersectsObject(a))&&!0===a.material.visible&&(a.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,a.matrixWorld),p.push(a));for(var c=a.children,d=0,f=c.length;d<f;d++)e(c[d],b)}}var g=a.context,f=a.state,h=new THREE.Frustum,l=new THREE.Matrix4;new THREE.Vector3;new THREE.Vector3;for(var k=new THREE.Vector3,m=new THREE.Vector3,p=[],n=Array(4),q=Array(4),s=[new THREE.Vector3(1,0,0),new THREE.Vector3(-1,
0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,-1),new THREE.Vector3(0,1,0),new THREE.Vector3(0,-1,0)],t=[new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,-1)],v=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4],u=new THREE.Vector4,w=THREE.ShaderLib.depthRGBA,D=THREE.UniformsUtils.clone(w.uniforms),x=THREE.ShaderLib.distanceRGBA,B=THREE.UniformsUtils.clone(x.uniforms),
y=0;4!==y;++y){var z=0!==(y&1),A=0!==(y&2),J=new THREE.ShaderMaterial({uniforms:D,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,morphTargets:z,skinning:A});J._shadowPass=!0;n[y]=J;z=new THREE.ShaderMaterial({uniforms:B,vertexShader:x.vertexShader,fragmentShader:x.fragmentShader,morphTargets:z,skinning:A});z._shadowPass=!0;q[y]=z}var F=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=THREE.PCFShadowMap;this.cullFace=THREE.CullFaceFront;this.render=function(n){var q,
w;if(!1!==F.enabled&&(!1!==F.autoUpdate||!1!==F.needsUpdate)){g.clearColor(1,1,1,1);f.disable(g.BLEND);f.enable(g.CULL_FACE);g.frontFace(g.CCW);g.cullFace(F.cullFace===THREE.CullFaceFront?g.FRONT:g.BACK);f.setDepthTest(!0);a.getViewport(u);for(var x=0,D=b.length;x<D;x++){var y=b[x];if(!0===y.castShadow){var z=y.shadow,B=z.camera,A=z.mapSize;if(y instanceof THREE.PointLight){q=6;w=!0;var H=A.x/4,J=A.y/2;v[0].set(2*H,J,H,J);v[1].set(0,J,H,J);v[2].set(3*H,J,H,J);v[3].set(H,J,H,J);v[4].set(3*H,0,H,J);
v[5].set(H,0,H,J)}else q=1,w=!1;null===z.map&&(H=THREE.LinearFilter,F.type===THREE.PCFSoftShadowMap&&(H=THREE.NearestFilter),z.map=new THREE.WebGLRenderTarget(A.x,A.y,{minFilter:H,magFilter:H,format:THREE.RGBAFormat}),z.matrix=new THREE.Matrix4,y instanceof THREE.SpotLight&&(B.aspect=A.x/A.y),B.updateProjectionMatrix());A=z.map;z=z.matrix;m.setFromMatrixPosition(y.matrixWorld);B.position.copy(m);a.setRenderTarget(A);a.clear();for(A=0;A<q;A++)for(w?(k.copy(B.position),k.add(s[A]),B.up.copy(t[A]),B.lookAt(k),
H=v[A],a.setViewport(H.x,H.y,H.z,H.w)):(k.setFromMatrixPosition(y.target.matrixWorld),B.lookAt(k)),B.updateMatrixWorld(),B.matrixWorldInverse.getInverse(B.matrixWorld),z.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),z.multiply(B.projectionMatrix),z.multiply(B.matrixWorldInverse),l.multiplyMatrices(B.projectionMatrix,B.matrixWorldInverse),h.setFromMatrix(l),p.length=0,e(n,B),H=0,J=p.length;H<J;H++){var G=p[H],ia=c.update(G),U=G.material;if(U instanceof THREE.MeshFaceMaterial)for(var X=ia.groups,U=U.materials,
da=0,ca=X.length;da<ca;da++){var ga=X[da],Z=U[ga.materialIndex];!0===Z.visible&&(Z=d(G,Z,w,m),a.renderBufferDirect(B,b,null,ia,Z,G,ga))}else Z=d(G,U,w,m),a.renderBufferDirect(B,b,null,ia,Z,G,null)}a.resetGLState()}}a.setViewport(u.x,u.y,u.z,u.w);n=a.getClearColor();q=a.getClearAlpha();a.setClearColor(n,q);f.enable(g.BLEND);F.cullFace===THREE.CullFaceFront&&g.cullFace(g.BACK);a.resetGLState();F.needsUpdate=!1}}};
THREE.WebGLState=function(a,b,c){var d=this,e=new Uint8Array(16),g=new Uint8Array(16),f=new Uint8Array(16),h={},l=null,k=null,m=null,p=null,n=null,q=null,s=null,t=null,v=null,u=null,w=null,D=null,x=null,B=null,y=null,z=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),A=void 0,J={};this.init=function(){a.clearColor(0,0,0,1);a.clearDepth(1);a.clearStencil(0);this.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.frontFace(a.CCW);a.cullFace(a.BACK);this.enable(a.CULL_FACE);this.enable(a.BLEND);a.blendEquation(a.FUNC_ADD);
a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA)};this.initAttributes=function(){for(var a=0,b=e.length;a<b;a++)e[a]=0};this.enableAttribute=function(c){e[c]=1;0===g[c]&&(a.enableVertexAttribArray(c),g[c]=1);0!==f[c]&&(b.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(c,0),f[c]=0)};this.enableAttributeAndDivisor=function(b,c,d){e[b]=1;0===g[b]&&(a.enableVertexAttribArray(b),g[b]=1);f[b]!==c&&(d.vertexAttribDivisorANGLE(b,c),f[b]=c)};this.disableUnusedAttributes=function(){for(var b=0,c=g.length;b<
c;b++)g[b]!==e[b]&&(a.disableVertexAttribArray(b),g[b]=0)};this.enable=function(b){!0!==h[b]&&(a.enable(b),h[b]=!0)};this.disable=function(b){!1!==h[b]&&(a.disable(b),h[b]=!1)};this.getCompressedTextureFormats=function(){if(null===l&&(l=[],b.get("WEBGL_compressed_texture_pvrtc")||b.get("WEBGL_compressed_texture_s3tc")))for(var c=a.getParameter(a.COMPRESSED_TEXTURE_FORMATS),d=0;d<c.length;d++)l.push(c[d]);return l};this.setBlending=function(b,d,e,f,g,h,l){b!==k&&(b===THREE.NoBlending?this.disable(a.BLEND):
b===THREE.AdditiveBlending?(this.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE)):b===THREE.SubtractiveBlending?(this.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.ONE_MINUS_SRC_COLOR)):b===THREE.MultiplyBlending?(this.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.SRC_COLOR)):b===THREE.CustomBlending?this.enable(a.BLEND):(this.enable(a.BLEND),a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,
a.ONE,a.ONE_MINUS_SRC_ALPHA)),k=b);if(b===THREE.CustomBlending){g=g||d;h=h||e;l=l||f;if(d!==m||g!==q)a.blendEquationSeparate(c(d),c(g)),m=d,q=g;if(e!==p||f!==n||h!==s||l!==t)a.blendFuncSeparate(c(e),c(f),c(h),c(l)),p=e,n=f,s=h,t=l}else t=s=q=n=p=m=null};this.setDepthFunc=function(b){if(v!==b){if(b)switch(b){case THREE.NeverDepth:a.depthFunc(a.NEVER);break;case THREE.AlwaysDepth:a.depthFunc(a.ALWAYS);break;case THREE.LessDepth:a.depthFunc(a.LESS);break;case THREE.LessEqualDepth:a.depthFunc(a.LEQUAL);
break;case THREE.EqualDepth:a.depthFunc(a.EQUAL);break;case THREE.GreaterEqualDepth:a.depthFunc(a.GEQUAL);break;case THREE.GreaterDepth:a.depthFunc(a.GREATER);break;case THREE.NotEqualDepth:a.depthFunc(a.NOTEQUAL);break;default:a.depthFunc(a.LEQUAL)}else a.depthFunc(a.LEQUAL);v=b}};this.setDepthTest=function(b){b?this.enable(a.DEPTH_TEST):this.disable(a.DEPTH_TEST)};this.setDepthWrite=function(b){u!==b&&(a.depthMask(b),u=b)};this.setColorWrite=function(b){w!==b&&(a.colorMask(b,b,b,b),w=b)};this.setFlipSided=
function(b){D!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),D=b)};this.setLineWidth=function(b){b!==x&&(a.lineWidth(b),x=b)};this.setPolygonOffset=function(b,c,d){b?this.enable(a.POLYGON_OFFSET_FILL):this.disable(a.POLYGON_OFFSET_FILL);!b||B===c&&y===d||(a.polygonOffset(c,d),B=c,y=d)};this.setScissorTest=function(b){b?this.enable(a.SCISSOR_TEST):this.disable(a.SCISSOR_TEST)};this.activeTexture=function(b){void 0===b&&(b=a.TEXTURE0+z-1);A!==b&&(a.activeTexture(b),A=b)};this.bindTexture=function(b,c){void 0===
A&&d.activeTexture();var e=J[A];void 0===e&&(e={type:void 0,texture:void 0},J[A]=e);if(e.type!==b||e.texture!==c)a.bindTexture(b,c),e.type=b,e.texture=c};this.compressedTexImage2D=function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(b){console.error(b)}};this.texImage2D=function(){try{a.texImage2D.apply(a,arguments)}catch(b){console.error(b)}};this.reset=function(){for(var b=0;b<g.length;b++)1===g[b]&&(a.disableVertexAttribArray(b),g[b]=0);h={};D=w=u=k=l=null}};
THREE.LensFlarePlugin=function(a,b){var c,d,e,g,f,h,l,k,m,p,n=a.context,q=a.state,s,t,v,u,w,D;this.render=function(x,B,y,z){if(0!==b.length){x=new THREE.Vector3;var A=z/y,J=.5*y,F=.5*z,C=16/z,N=new THREE.Vector2(C*A,C),L=new THREE.Vector3(1,1,0),Q=new THREE.Vector2(1,1);if(void 0===v){var C=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),M=new Uint16Array([0,1,2,0,2,3]);s=n.createBuffer();t=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,s);n.bufferData(n.ARRAY_BUFFER,C,n.STATIC_DRAW);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,
t);n.bufferData(n.ELEMENT_ARRAY_BUFFER,M,n.STATIC_DRAW);w=n.createTexture();D=n.createTexture();q.bindTexture(n.TEXTURE_2D,w);n.texImage2D(n.TEXTURE_2D,0,n.RGB,16,16,0,n.RGB,n.UNSIGNED_BYTE,null);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST);q.bindTexture(n.TEXTURE_2D,D);n.texImage2D(n.TEXTURE_2D,0,
n.RGBA,16,16,0,n.RGBA,n.UNSIGNED_BYTE,null);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST);n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST);var C=(u=0<n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif ( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif ( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if ( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
M=n.createProgram(),K=n.createShader(n.FRAGMENT_SHADER),E=n.createShader(n.VERTEX_SHADER),O="precision "+a.getPrecision()+" float;\n";n.shaderSource(K,O+C.fragmentShader);n.shaderSource(E,O+C.vertexShader);n.compileShader(K);n.compileShader(E);n.attachShader(M,K);n.attachShader(M,E);n.linkProgram(M);v=M;m=n.getAttribLocation(v,"position");p=n.getAttribLocation(v,"uv");c=n.getUniformLocation(v,"renderType");d=n.getUniformLocation(v,"map");e=n.getUniformLocation(v,"occlusionMap");g=n.getUniformLocation(v,
"opacity");f=n.getUniformLocation(v,"color");h=n.getUniformLocation(v,"scale");l=n.getUniformLocation(v,"rotation");k=n.getUniformLocation(v,"screenPosition")}n.useProgram(v);q.initAttributes();q.enableAttribute(m);q.enableAttribute(p);q.disableUnusedAttributes();n.uniform1i(e,0);n.uniform1i(d,1);n.bindBuffer(n.ARRAY_BUFFER,s);n.vertexAttribPointer(m,2,n.FLOAT,!1,16,0);n.vertexAttribPointer(p,2,n.FLOAT,!1,16,8);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t);q.disable(n.CULL_FACE);n.depthMask(!1);M=0;for(K=
b.length;M<K;M++)if(C=16/z,N.set(C*A,C),E=b[M],x.set(E.matrixWorld.elements[12],E.matrixWorld.elements[13],E.matrixWorld.elements[14]),x.applyMatrix4(B.matrixWorldInverse),x.applyProjection(B.projectionMatrix),L.copy(x),Q.x=L.x*J+J,Q.y=L.y*F+F,u||0<Q.x&&Q.x<y&&0<Q.y&&Q.y<z){q.activeTexture(n.TEXTURE0);q.bindTexture(n.TEXTURE_2D,null);q.activeTexture(n.TEXTURE1);q.bindTexture(n.TEXTURE_2D,w);n.copyTexImage2D(n.TEXTURE_2D,0,n.RGB,Q.x-8,Q.y-8,16,16,0);n.uniform1i(c,0);n.uniform2f(h,N.x,N.y);n.uniform3f(k,
L.x,L.y,L.z);q.disable(n.BLEND);q.enable(n.DEPTH_TEST);n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0);q.activeTexture(n.TEXTURE0);q.bindTexture(n.TEXTURE_2D,D);n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,Q.x-8,Q.y-8,16,16,0);n.uniform1i(c,1);q.disable(n.DEPTH_TEST);q.activeTexture(n.TEXTURE1);q.bindTexture(n.TEXTURE_2D,w);n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0);E.positionScreen.copy(L);E.customUpdateCallback?E.customUpdateCallback(E):E.updateLensFlares();n.uniform1i(c,2);q.enable(n.BLEND);for(var O=
0,T=E.lensFlares.length;O<T;O++){var H=E.lensFlares[O];.001<H.opacity&&.001<H.scale&&(L.x=H.x,L.y=H.y,L.z=H.z,C=H.size*H.scale/z,N.x=C*A,N.y=C,n.uniform3f(k,L.x,L.y,L.z),n.uniform2f(h,N.x,N.y),n.uniform1f(l,H.rotation),n.uniform1f(g,H.opacity),n.uniform3f(f,H.color.r,H.color.g,H.color.b),q.setBlending(H.blending,H.blendEquation,H.blendSrc,H.blendDst),a.setTexture(H.texture,1),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0))}}q.enable(n.CULL_FACE);q.enable(n.DEPTH_TEST);n.depthMask(!0);a.resetGLState()}}};
THREE.SpritePlugin=function(a,b){var c,d,e,g,f,h,l,k,m,p,n,q,s,t,v,u,w;function D(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var x=a.context,B=a.state,y,z,A,J,F=new THREE.Vector3,C=new THREE.Quaternion,N=new THREE.Vector3;this.render=function(L,Q){if(0!==b.length){if(void 0===A){var M=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),K=new Uint16Array([0,1,2,0,2,3]);y=x.createBuffer();z=x.createBuffer();x.bindBuffer(x.ARRAY_BUFFER,y);x.bufferData(x.ARRAY_BUFFER,M,x.STATIC_DRAW);x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,
z);x.bufferData(x.ELEMENT_ARRAY_BUFFER,K,x.STATIC_DRAW);var M=x.createProgram(),K=x.createShader(x.VERTEX_SHADER),E=x.createShader(x.FRAGMENT_SHADER);x.shaderSource(K,["precision "+a.getPrecision()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n"));
x.shaderSource(E,["precision "+a.getPrecision()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n"));
x.compileShader(K);x.compileShader(E);x.attachShader(M,K);x.attachShader(M,E);x.linkProgram(M);A=M;u=x.getAttribLocation(A,"position");w=x.getAttribLocation(A,"uv");c=x.getUniformLocation(A,"uvOffset");d=x.getUniformLocation(A,"uvScale");e=x.getUniformLocation(A,"rotation");g=x.getUniformLocation(A,"scale");f=x.getUniformLocation(A,"color");h=x.getUniformLocation(A,"map");l=x.getUniformLocation(A,"opacity");k=x.getUniformLocation(A,"modelViewMatrix");m=x.getUniformLocation(A,"projectionMatrix");p=
x.getUniformLocation(A,"fogType");n=x.getUniformLocation(A,"fogDensity");q=x.getUniformLocation(A,"fogNear");s=x.getUniformLocation(A,"fogFar");t=x.getUniformLocation(A,"fogColor");v=x.getUniformLocation(A,"alphaTest");M=document.createElement("canvas");M.width=8;M.height=8;K=M.getContext("2d");K.fillStyle="white";K.fillRect(0,0,8,8);J=new THREE.Texture(M);J.needsUpdate=!0}x.useProgram(A);B.initAttributes();B.enableAttribute(u);B.enableAttribute(w);B.disableUnusedAttributes();B.disable(x.CULL_FACE);
B.enable(x.BLEND);x.bindBuffer(x.ARRAY_BUFFER,y);x.vertexAttribPointer(u,2,x.FLOAT,!1,16,0);x.vertexAttribPointer(w,2,x.FLOAT,!1,16,8);x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,z);x.uniformMatrix4fv(m,!1,Q.projectionMatrix.elements);B.activeTexture(x.TEXTURE0);x.uniform1i(h,0);K=M=0;(E=L.fog)?(x.uniform3f(t,E.color.r,E.color.g,E.color.b),E instanceof THREE.Fog?(x.uniform1f(q,E.near),x.uniform1f(s,E.far),x.uniform1i(p,1),K=M=1):E instanceof THREE.FogExp2&&(x.uniform1f(n,E.density),x.uniform1i(p,2),K=M=2)):
(x.uniform1i(p,0),K=M=0);for(var E=0,O=b.length;E<O;E++){var T=b[E];T.modelViewMatrix.multiplyMatrices(Q.matrixWorldInverse,T.matrixWorld);T.z=-T.modelViewMatrix.elements[14]}b.sort(D);for(var H=[],E=0,O=b.length;E<O;E++){var T=b[E],R=T.material;x.uniform1f(v,R.alphaTest);x.uniformMatrix4fv(k,!1,T.modelViewMatrix.elements);T.matrixWorld.decompose(F,C,N);H[0]=N.x;H[1]=N.y;T=0;L.fog&&R.fog&&(T=K);M!==T&&(x.uniform1i(p,T),M=T);null!==R.map?(x.uniform2f(c,R.map.offset.x,R.map.offset.y),x.uniform2f(d,
R.map.repeat.x,R.map.repeat.y)):(x.uniform2f(c,0,0),x.uniform2f(d,1,1));x.uniform1f(l,R.opacity);x.uniform3f(f,R.color.r,R.color.g,R.color.b);x.uniform1f(e,R.rotation);x.uniform2fv(g,H);B.setBlending(R.blending,R.blendEquation,R.blendSrc,R.blendDst);B.setDepthTest(R.depthTest);B.setDepthWrite(R.depthWrite);R.map&&R.map.image&&R.map.image.width?a.setTexture(R.map,0):a.setTexture(J,0);x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0)}B.enable(x.CULL_FACE);a.resetGLState()}}};
THREE.CurveUtils={tangentQuadraticBezier:function(a,b,c,d){return 2*(1-a)*(c-b)+2*a*(d-c)},tangentCubicBezier:function(a,b,c,d,e){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*d*(1-a)-3*a*a*d+3*a*a*e},tangentSpline:function(a,b,c,d,e){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},interpolate:function(a,b,c,d,e){a=.5*(c-a);d=.5*(d-b);var g=e*e;return(2*b-2*c+a+d)*e*g+(-3*b+3*c-2*a-d)*g+a*e+b}};
THREE.GeometryUtils={merge:function(a,b,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var d;b instanceof THREE.Mesh&&(b.matrixAutoUpdate&&b.updateMatrix(),d=b.matrix,b=b.geometry);a.merge(b,d,c)},center:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return a.center()}};
THREE.ImageUtils={crossOrigin:void 0,loadTexture:function(a,b,c,d){console.warn("THREE.ImageUtils.loadTexture is being deprecated. Use THREE.TextureLoader() instead.");var e=new THREE.TextureLoader;e.setCrossOrigin(this.crossOrigin);a=e.load(a,c,void 0,d);b&&(a.mapping=b);return a},loadTextureCube:function(a,b,c,d){console.warn("THREE.ImageUtils.loadTextureCube is being deprecated. Use THREE.CubeTextureLoader() instead.");var e=new THREE.CubeTextureLoader;e.setCrossOrigin(this.crossOrigin);a=e.load(a,
c,void 0,d);b&&(a.mapping=b);return a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};
THREE.SceneUtils={createMultiMaterialObject:function(a,b){for(var c=new THREE.Group,d=0,e=b.length;d<e;d++)c.add(new THREE.Mesh(a,b[d]));return c},detach:function(a,b,c){a.applyMatrix(b.matrixWorld);b.remove(a);c.add(a)},attach:function(a,b,c){var d=new THREE.Matrix4;d.getInverse(c.matrixWorld);a.applyMatrix(d);b.remove(a);c.add(a)}};
THREE.ShapeUtils={area:function(a){for(var b=a.length,c=0,d=b-1,e=0;e<b;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c},triangulate:function(){return function(a,b){var c=a.length;if(3>c)return null;var d=[],e=[],g=[],f,h,l;if(0<THREE.ShapeUtils.area(a))for(h=0;h<c;h++)e[h]=h;else for(h=0;h<c;h++)e[h]=c-1-h;var k=2*c;for(h=c-1;2<c;){if(0>=k--){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");break}f=h;c<=f&&(f=0);h=f+1;c<=h&&(h=0);l=h+1;c<=l&&(l=0);var m;a:{var p=
m=void 0,n=void 0,q=void 0,s=void 0,t=void 0,v=void 0,u=void 0,w=void 0,p=a[e[f]].x,n=a[e[f]].y,q=a[e[h]].x,s=a[e[h]].y,t=a[e[l]].x,v=a[e[l]].y;if(Number.EPSILON>(q-p)*(v-n)-(s-n)*(t-p))m=!1;else{var D=void 0,x=void 0,B=void 0,y=void 0,z=void 0,A=void 0,J=void 0,F=void 0,C=void 0,N=void 0,C=F=J=w=u=void 0,D=t-q,x=v-s,B=p-t,y=n-v,z=q-p,A=s-n;for(m=0;m<c;m++)if(u=a[e[m]].x,w=a[e[m]].y,!(u===p&&w===n||u===q&&w===s||u===t&&w===v)&&(J=u-p,F=w-n,C=u-q,N=w-s,u-=t,w-=v,C=D*N-x*C,J=z*F-A*J,F=B*w-y*u,C>=-Number.EPSILON&&
F>=-Number.EPSILON&&J>=-Number.EPSILON)){m=!1;break a}m=!0}}if(m){d.push([a[e[f]],a[e[h]],a[e[l]]]);g.push([e[f],e[h],e[l]]);f=h;for(l=h+1;l<c;f++,l++)e[f]=e[l];c--;k=2*c}}return b?g:d}}(),triangulateShape:function(a,b){function c(a,b,c){return a.x!==b.x?a.x<b.x?a.x<=c.x&&c.x<=b.x:b.x<=c.x&&c.x<=a.x:a.y<b.y?a.y<=c.y&&c.y<=b.y:b.y<=c.y&&c.y<=a.y}function d(a,b,d,e,f){var g=b.x-a.x,h=b.y-a.y,k=e.x-d.x,l=e.y-d.y,m=a.x-d.x,p=a.y-d.y,z=h*k-g*l,A=h*m-g*p;if(Math.abs(z)>Number.EPSILON){if(0<z){if(0>A||A>
z)return[];k=l*m-k*p;if(0>k||k>z)return[]}else{if(0<A||A<z)return[];k=l*m-k*p;if(0<k||k<z)return[]}if(0===k)return!f||0!==A&&A!==z?[a]:[];if(k===z)return!f||0!==A&&A!==z?[b]:[];if(0===A)return[d];if(A===z)return[e];f=k/z;return[{x:a.x+f*g,y:a.y+f*h}]}if(0!==A||l*m!==k*p)return[];h=0===g&&0===h;k=0===k&&0===l;if(h&&k)return a.x!==d.x||a.y!==d.y?[]:[a];if(h)return c(d,e,a)?[a]:[];if(k)return c(a,b,d)?[d]:[];0!==g?(a.x<b.x?(g=a,k=a.x,h=b,a=b.x):(g=b,k=b.x,h=a,a=a.x),d.x<e.x?(b=d,z=d.x,l=e,d=e.x):(b=
e,z=e.x,l=d,d=d.x)):(a.y<b.y?(g=a,k=a.y,h=b,a=b.y):(g=b,k=b.y,h=a,a=a.y),d.y<e.y?(b=d,z=d.y,l=e,d=e.y):(b=e,z=e.y,l=d,d=d.y));return k<=z?a<z?[]:a===z?f?[]:[b]:a<=d?[b,h]:[b,l]:k>d?[]:k===d?f?[]:[g]:a<=d?[g,h]:[g,l]}function e(a,b,c,d){var e=b.x-a.x,f=b.y-a.y;b=c.x-a.x;c=c.y-a.y;var g=d.x-a.x;d=d.y-a.y;a=e*c-f*b;e=e*d-f*g;return Math.abs(a)>Number.EPSILON?(b=g*c-d*b,0<a?0<=e&&0<=b:0<=e||0<=b):0<e}var g,f,h,l,k,m={};h=a.concat();g=0;for(f=b.length;g<f;g++)Array.prototype.push.apply(h,b[g]);g=0;for(f=
h.length;g<f;g++)k=h[g].x+":"+h[g].y,void 0!==m[k]&&console.warn("THREE.Shape: Duplicate point",k),m[k]=g;g=function(a,b){function c(a,b){var d=h.length-1,f=a-1;0>f&&(f=d);var g=a+1;g>d&&(g=0);d=e(h[a],h[f],h[g],k[b]);if(!d)return!1;d=k.length-1;f=b-1;0>f&&(f=d);g=b+1;g>d&&(g=0);return(d=e(k[b],k[f],k[g],h[a]))?!0:!1}function f(a,b){var c,e;for(c=0;c<h.length;c++)if(e=c+1,e%=h.length,e=d(a,b,h[c],h[e],!0),0<e.length)return!0;return!1}function g(a,c){var e,f,h,k;for(e=0;e<l.length;e++)for(f=b[l[e]],
h=0;h<f.length;h++)if(k=h+1,k%=f.length,k=d(a,c,f[h],f[k],!0),0<k.length)return!0;return!1}var h=a.concat(),k,l=[],m,p,y,z,A,J=[],F,C,N,L=0;for(m=b.length;L<m;L++)l.push(L);F=0;for(var Q=2*l.length;0<l.length;){Q--;if(0>Q){console.log("Infinite Loop! Holes left:"+l.length+", Probably Hole outside Shape!");break}for(p=F;p<h.length;p++){y=h[p];m=-1;for(L=0;L<l.length;L++)if(z=l[L],A=y.x+":"+y.y+":"+z,void 0===J[A]){k=b[z];for(C=0;C<k.length;C++)if(z=k[C],c(p,C)&&!f(y,z)&&!g(y,z)){m=C;l.splice(L,1);
F=h.slice(0,p+1);z=h.slice(p);C=k.slice(m);N=k.slice(0,m+1);h=F.concat(C).concat(N).concat(z);F=p;break}if(0<=m)break;J[A]=!0}if(0<=m)break}}return h}(a,b);var p=THREE.ShapeUtils.triangulate(g,!1);g=0;for(f=p.length;g<f;g++)for(l=p[g],h=0;3>h;h++)k=l[h].x+":"+l[h].y,k=m[k],void 0!==k&&(l[h]=k);return p.concat()},isClockWise:function(a){return 0>THREE.ShapeUtils.area(a)},b2:function(){return function(a,b,c,d){var e=1-a;return e*e*b+2*(1-a)*a*c+a*a*d}}(),b3:function(){return function(a,b,c,d,e){var g=
1-a,f=1-a;return g*g*g*b+3*f*f*a*c+3*(1-a)*a*a*d+a*a*a*e}}()};THREE.Audio=function(a){THREE.Object3D.call(this);this.type="Audio";this.context=a.context;this.source=this.context.createBufferSource();this.source.onended=this.onEnded.bind(this);this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.panner=this.context.createPanner();this.panner.connect(this.gain);this.autoplay=!1;this.startTime=0;this.playbackRate=1;this.isPlaying=!1};THREE.Audio.prototype=Object.create(THREE.Object3D.prototype);
THREE.Audio.prototype.constructor=THREE.Audio;THREE.Audio.prototype.load=function(a){var b=this,c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="arraybuffer";c.onload=function(a){b.context.decodeAudioData(this.response,function(a){b.source.buffer=a;b.autoplay&&b.play()})};c.send();return this};
THREE.Audio.prototype.play=function(){if(!0===this.isPlaying)console.warn("THREE.Audio: Audio is already playing.");else{var a=this.context.createBufferSource();a.buffer=this.source.buffer;a.loop=this.source.loop;a.onended=this.source.onended;a.start(0,this.startTime);a.playbackRate.value=this.playbackRate;this.isPlaying=!0;this.source=a;this.connect()}};THREE.Audio.prototype.pause=function(){this.source.stop();this.startTime=this.context.currentTime};
THREE.Audio.prototype.stop=function(){this.source.stop();this.startTime=0};THREE.Audio.prototype.connect=function(){void 0!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.panner)):this.source.connect(this.panner)};THREE.Audio.prototype.disconnect=function(){void 0!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.panner)):this.source.disconnect(this.panner)};
THREE.Audio.prototype.setFilter=function(a){!0===this.isPlaying?(this.disconnect(),this.filter=a,this.connect()):this.filter=a};THREE.Audio.prototype.getFilter=function(){return this.filter};THREE.Audio.prototype.setPlaybackRate=function(a){this.playbackRate=a;!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate)};THREE.Audio.prototype.getPlaybackRate=function(){return this.playbackRate};THREE.Audio.prototype.onEnded=function(){this.isPlaying=!1};
THREE.Audio.prototype.setLoop=function(a){this.source.loop=a};THREE.Audio.prototype.getLoop=function(){return this.source.loop};THREE.Audio.prototype.setRefDistance=function(a){this.panner.refDistance=a};THREE.Audio.prototype.getRefDistance=function(){return this.panner.refDistance};THREE.Audio.prototype.setRolloffFactor=function(a){this.panner.rolloffFactor=a};THREE.Audio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor};
THREE.Audio.prototype.setVolume=function(a){this.gain.gain.value=a};THREE.Audio.prototype.getVolume=function(){return this.gain.gain.value};THREE.Audio.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3;return function(b){THREE.Object3D.prototype.updateMatrixWorld.call(this,b);a.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(a.x,a.y,a.z)}}();THREE.AudioListener=function(){THREE.Object3D.call(this);this.type="AudioListener";this.context=new (window.AudioContext||window.webkitAudioContext)};
THREE.AudioListener.prototype=Object.create(THREE.Object3D.prototype);THREE.AudioListener.prototype.constructor=THREE.AudioListener;
THREE.AudioListener.prototype.updateMatrixWorld=function(){var a=new THREE.Vector3,b=new THREE.Quaternion,c=new THREE.Vector3,d=new THREE.Vector3;return function(e){THREE.Object3D.prototype.updateMatrixWorld.call(this,e);e=this.context.listener;var g=this.up;this.matrixWorld.decompose(a,b,c);d.set(0,0,-1).applyQuaternion(b);e.setPosition(a.x,a.y,a.z);e.setOrientation(d.x,d.y,d.z,g.x,g.y,g.z)}}();THREE.Curve=function(){};
THREE.Curve.prototype={constructor:THREE.Curve,getPoint:function(a){console.warn("THREE.Curve: Warning, getPoint() not implemented!");return null},getPointAt:function(a){a=this.getUtoTmapping(a);return this.getPoint(a)},getPoints:function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPoint(b/a));return c},getSpacedPoints:function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.getPointAt(b/a));return c},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){a||
(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b=[],c,d=this.getPoint(0),e,g=0;b.push(0);for(e=1;e<=a;e++)c=this.getPoint(e/a),g+=c.distanceTo(d),b.push(g),d=c;return this.cacheArcLengths=b},updateArcLengths:function(){this.needsUpdate=!0;this.getLengths()},getUtoTmapping:function(a,b){var c=this.getLengths(),d=0,e=c.length,g;g=b?b:a*c[e-1];for(var f=0,h=e-
1,l;f<=h;)if(d=Math.floor(f+(h-f)/2),l=c[d]-g,0>l)f=d+1;else if(0<l)h=d-1;else{h=d;break}d=h;if(c[d]===g)return d/(e-1);f=c[d];return c=(d+(g-f)/(c[d+1]-f))/(e-1)},getTangent:function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.getPoint(b);return this.getPoint(a).clone().sub(b).normalize()},getTangentAt:function(a){a=this.getUtoTmapping(a);return this.getTangent(a)}};THREE.Curve.Utils=THREE.CurveUtils;
THREE.Curve.create=function(a,b){a.prototype=Object.create(THREE.Curve.prototype);a.prototype.constructor=a;a.prototype.getPoint=b;return a};THREE.CurvePath=function(){this.curves=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.constructor=THREE.CurvePath;THREE.CurvePath.prototype.add=function(a){this.curves.push(a)};
THREE.CurvePath.prototype.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new THREE.LineCurve(b,a))};THREE.CurvePath.prototype.getPoint=function(a){for(var b=a*this.getLength(),c=this.getCurveLengths(),d=0;d<c.length;){if(c[d]>=b)return a=this.curves[d],b=1-(c[d]-b)/a.getLength(),a.getPointAt(b);d++}return null};THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};
THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var a=[],b=0,c=0,d=this.curves.length;c<d;c++)b+=this.curves[c].getLength(),a.push(b);return this.cacheLengths=a};THREE.CurvePath.prototype.createPointsGeometry=function(a){a=this.getPoints(a,!0);return this.createGeometry(a)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){a=this.getSpacedPoints(a,!0);return this.createGeometry(a)};
THREE.CurvePath.prototype.createGeometry=function(a){for(var b=new THREE.Geometry,c=0,d=a.length;c<d;c++){var e=a[c];b.vertices.push(new THREE.Vector3(e.x,e.y,e.z||0))}return b};THREE.Path=function(a){THREE.CurvePath.call(this);this.actions=[];a&&this.fromPoints(a)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.Path.prototype.constructor=THREE.Path;THREE.Path.prototype.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)};
THREE.Path.prototype.moveTo=function(a,b){this.actions.push({action:"moveTo",args:[a,b]})};THREE.Path.prototype.lineTo=function(a,b){var c=this.actions[this.actions.length-1].args,c=new THREE.LineCurve(new THREE.Vector2(c[c.length-2],c[c.length-1]),new THREE.Vector2(a,b));this.curves.push(c);this.actions.push({action:"lineTo",args:[a,b]})};
THREE.Path.prototype.quadraticCurveTo=function(a,b,c,d){var e=this.actions[this.actions.length-1].args,e=new THREE.QuadraticBezierCurve(new THREE.Vector2(e[e.length-2],e[e.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d));this.curves.push(e);this.actions.push({action:"quadraticCurveTo",args:[a,b,c,d]})};
THREE.Path.prototype.bezierCurveTo=function(a,b,c,d,e,g){var f=this.actions[this.actions.length-1].args,f=new THREE.CubicBezierCurve(new THREE.Vector2(f[f.length-2],f[f.length-1]),new THREE.Vector2(a,b),new THREE.Vector2(c,d),new THREE.Vector2(e,g));this.curves.push(f);this.actions.push({action:"bezierCurveTo",args:[a,b,c,d,e,g]})};
THREE.Path.prototype.splineThru=function(a){var b=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,c=[new THREE.Vector2(c[c.length-2],c[c.length-1])];Array.prototype.push.apply(c,a);c=new THREE.SplineCurve(c);this.curves.push(c);this.actions.push({action:"splineThru",args:b})};THREE.Path.prototype.arc=function(a,b,c,d,e,g){var f=this.actions[this.actions.length-1].args;this.absarc(a+f[f.length-2],b+f[f.length-1],c,d,e,g)};
THREE.Path.prototype.absarc=function(a,b,c,d,e,g){this.absellipse(a,b,c,c,d,e,g)};THREE.Path.prototype.ellipse=function(a,b,c,d,e,g,f,h){var l=this.actions[this.actions.length-1].args;this.absellipse(a+l[l.length-2],b+l[l.length-1],c,d,e,g,f,h)};THREE.Path.prototype.absellipse=function(a,b,c,d,e,g,f,h){var l=[a,b,c,d,e,g,f,h||0];a=new THREE.EllipseCurve(a,b,c,d,e,g,f,h);this.curves.push(a);a=a.getPoint(1);l.push(a.x);l.push(a.y);this.actions.push({action:"ellipse",args:l})};
THREE.Path.prototype.getSpacedPoints=function(a,b){a||(a=40);for(var c=[],d=0;d<a;d++)c.push(this.getPoint(d/a));return c};
THREE.Path.prototype.getPoints=function(a,b){a=a||12;for(var c=THREE.ShapeUtils.b2,d=THREE.ShapeUtils.b3,e=[],g,f,h,l,k,m,p,n,q,s,t=0,v=this.actions.length;t<v;t++){q=this.actions[t];var u=q.args;switch(q.action){case "moveTo":e.push(new THREE.Vector2(u[0],u[1]));break;case "lineTo":e.push(new THREE.Vector2(u[0],u[1]));break;case "quadraticCurveTo":g=u[2];f=u[3];k=u[0];m=u[1];0<e.length?(q=e[e.length-1],p=q.x,n=q.y):(q=this.actions[t-1].args,p=q[q.length-2],n=q[q.length-1]);for(u=1;u<=a;u++)s=u/a,
q=c(s,p,k,g),s=c(s,n,m,f),e.push(new THREE.Vector2(q,s));break;case "bezierCurveTo":g=u[4];f=u[5];k=u[0];m=u[1];h=u[2];l=u[3];0<e.length?(q=e[e.length-1],p=q.x,n=q.y):(q=this.actions[t-1].args,p=q[q.length-2],n=q[q.length-1]);for(u=1;u<=a;u++)s=u/a,q=d(s,p,k,h,g),s=d(s,n,m,l,f),e.push(new THREE.Vector2(q,s));break;case "splineThru":q=this.actions[t-1].args;s=[new THREE.Vector2(q[q.length-2],q[q.length-1])];q=a*u[0].length;s=s.concat(u[0]);s=new THREE.SplineCurve(s);for(u=1;u<=q;u++)e.push(s.getPointAt(u/
q));break;case "arc":g=u[0];f=u[1];m=u[2];h=u[3];q=u[4];k=!!u[5];p=q-h;n=2*a;for(u=1;u<=n;u++)s=u/n,k||(s=1-s),s=h+s*p,q=g+m*Math.cos(s),s=f+m*Math.sin(s),e.push(new THREE.Vector2(q,s));break;case "ellipse":g=u[0];f=u[1];m=u[2];l=u[3];h=u[4];q=u[5];k=!!u[6];var w=u[7];p=q-h;n=2*a;var D,x;0!==w&&(D=Math.cos(w),x=Math.sin(w));for(u=1;u<=n;u++){s=u/n;k||(s=1-s);s=h+s*p;q=g+m*Math.cos(s);s=f+l*Math.sin(s);if(0!==w){var B=q;q=(B-g)*D-(s-f)*x+g;s=(B-g)*x+(s-f)*D+f}e.push(new THREE.Vector2(q,s))}}}c=e[e.length-
1];Math.abs(c.x-e[0].x)<Number.EPSILON&&Math.abs(c.y-e[0].y)<Number.EPSILON&&e.splice(e.length-1,1);b&&e.push(e[0]);return e};
THREE.Path.prototype.toShapes=function(a,b){function c(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=a[c],f=new THREE.Shape;f.actions=e.actions;f.curves=e.curves;b.push(f)}return b}function d(a,b){for(var c=b.length,d=!1,e=c-1,f=0;f<c;e=f++){var g=b[e],h=b[f],k=h.x-g.x,l=h.y-g.y;if(Math.abs(l)>Number.EPSILON){if(0>l&&(g=b[f],k=-k,h=b[e],l=-l),!(a.y<g.y||a.y>h.y))if(a.y===g.y){if(a.x===g.x)return!0}else{e=l*(a.x-g.x)-k*(a.y-g.y);if(0===e)return!0;0>e||(d=!d)}}else if(a.y===g.y&&(h.x<=a.x&&a.x<=g.x||
g.x<=a.x&&a.x<=h.x))return!0}return d}var e=THREE.ShapeUtils.isClockWise,g=function(a){for(var b=[],c=new THREE.Path,d=0,e=a.length;d<e;d++){var f=a[d],g=f.args,f=f.action;"moveTo"===f&&0!==c.actions.length&&(b.push(c),c=new THREE.Path);c[f].apply(c,g)}0!==c.actions.length&&b.push(c);return b}(this.actions);if(0===g.length)return[];if(!0===b)return c(g);var f,h,l,k=[];if(1===g.length)return h=g[0],l=new THREE.Shape,l.actions=h.actions,l.curves=h.curves,k.push(l),k;var m=!e(g[0].getPoints()),m=a?!m:
m;l=[];var p=[],n=[],q=0,s;p[q]=void 0;n[q]=[];for(var t=0,v=g.length;t<v;t++)h=g[t],s=h.getPoints(),f=e(s),(f=a?!f:f)?(!m&&p[q]&&q++,p[q]={s:new THREE.Shape,p:s},p[q].s.actions=h.actions,p[q].s.curves=h.curves,m&&q++,n[q]=[]):n[q].push({h:h,p:s[0]});if(!p[0])return c(g);if(1<p.length){t=!1;h=[];e=0;for(g=p.length;e<g;e++)l[e]=[];e=0;for(g=p.length;e<g;e++)for(f=n[e],m=0;m<f.length;m++){q=f[m];s=!0;for(v=0;v<p.length;v++)d(q.p,p[v].p)&&(e!==v&&h.push({froms:e,tos:v,hole:m}),s?(s=!1,l[v].push(q)):
t=!0);s&&l[e].push(q)}0<h.length&&(t||(n=l))}t=0;for(e=p.length;t<e;t++)for(l=p[t].s,k.push(l),h=n[t],g=0,f=h.length;g<f;g++)l.holes.push(h[g].h);return k};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.constructor=THREE.Shape;THREE.Shape.prototype.extrude=function(a){return new THREE.ExtrudeGeometry(this,a)};THREE.Shape.prototype.makeGeometry=function(a){return new THREE.ShapeGeometry(this,a)};
THREE.Shape.prototype.getPointsHoles=function(a){for(var b=[],c=0,d=this.holes.length;c<d;c++)b[c]=this.holes[c].getPoints(a);return b};THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}};THREE.Shape.prototype.extractPoints=function(a){return this.extractAllPoints(a)};THREE.Shape.Utils=THREE.ShapeUtils;THREE.LineCurve=function(a,b){this.v1=a;this.v2=b};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.LineCurve.prototype.constructor=THREE.LineCurve;THREE.LineCurve.prototype.getPoint=function(a){var b=this.v2.clone().sub(this.v1);b.multiplyScalar(a).add(this.v1);return b};THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)};THREE.LineCurve.prototype.getTangent=function(a){return this.v2.clone().sub(this.v1).normalize()};THREE.QuadraticBezierCurve=function(a,b,c){this.v0=a;this.v1=b;this.v2=c};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve;THREE.QuadraticBezierCurve.prototype.getPoint=function(a){var b=THREE.ShapeUtils.b2;return new THREE.Vector2(b(a,this.v0.x,this.v1.x,this.v2.x),b(a,this.v0.y,this.v1.y,this.v2.y))};THREE.QuadraticBezierCurve.prototype.getTangent=function(a){var b=THREE.CurveUtils.tangentQuadraticBezier;return(new THREE.Vector2(b(a,this.v0.x,this.v1.x,this.v2.x),b(a,this.v0.y,this.v1.y,this.v2.y))).normalize()};
THREE.CubicBezierCurve=function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve;THREE.CubicBezierCurve.prototype.getPoint=function(a){var b=THREE.ShapeUtils.b3;return new THREE.Vector2(b(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),b(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y))};
THREE.CubicBezierCurve.prototype.getTangent=function(a){var b=THREE.CurveUtils.tangentCubicBezier;return(new THREE.Vector2(b(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),b(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y))).normalize()};THREE.SplineCurve=function(a){this.points=void 0==a?[]:a};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.constructor=THREE.SplineCurve;
THREE.SplineCurve.prototype.getPoint=function(a){var b=this.points;a*=b.length-1;var c=Math.floor(a);a-=c;var d=b[0===c?c:c-1],e=b[c],g=b[c>b.length-2?b.length-1:c+1],b=b[c>b.length-3?b.length-1:c+2],c=THREE.CurveUtils.interpolate;return new THREE.Vector2(c(d.x,e.x,g.x,b.x,a),c(d.y,e.y,g.y,b.y,a))};THREE.EllipseCurve=function(a,b,c,d,e,g,f,h){this.aX=a;this.aY=b;this.xRadius=c;this.yRadius=d;this.aStartAngle=e;this.aEndAngle=g;this.aClockwise=f;this.aRotation=h||0};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.EllipseCurve.prototype.constructor=THREE.EllipseCurve;
THREE.EllipseCurve.prototype.getPoint=function(a){var b=this.aEndAngle-this.aStartAngle;0>b&&(b+=2*Math.PI);b>2*Math.PI&&(b-=2*Math.PI);b=!0===this.aClockwise?this.aEndAngle+(1-a)*(2*Math.PI-b):this.aStartAngle+a*b;a=this.aX+this.xRadius*Math.cos(b);var c=this.aY+this.yRadius*Math.sin(b);if(0!==this.aRotation){var b=Math.cos(this.aRotation),d=Math.sin(this.aRotation),e=a;a=(e-this.aX)*b-(c-this.aY)*d+this.aX;c=(e-this.aX)*d+(c-this.aY)*b+this.aY}return new THREE.Vector2(a,c)};
THREE.ArcCurve=function(a,b,c,d,e,g){THREE.EllipseCurve.call(this,a,b,c,c,d,e,g)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);THREE.ArcCurve.prototype.constructor=THREE.ArcCurve;THREE.LineCurve3=THREE.Curve.create(function(a,b){this.v1=a;this.v2=b},function(a){var b=new THREE.Vector3;b.subVectors(this.v2,this.v1);b.multiplyScalar(a);b.add(this.v1);return b});
THREE.QuadraticBezierCurve3=THREE.Curve.create(function(a,b,c){this.v0=a;this.v1=b;this.v2=c},function(a){var b=THREE.ShapeUtils.b2;return new THREE.Vector3(b(a,this.v0.x,this.v1.x,this.v2.x),b(a,this.v0.y,this.v1.y,this.v2.y),b(a,this.v0.z,this.v1.z,this.v2.z))});
THREE.CubicBezierCurve3=THREE.Curve.create(function(a,b,c,d){this.v0=a;this.v1=b;this.v2=c;this.v3=d},function(a){var b=THREE.ShapeUtils.b3;return new THREE.Vector3(b(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),b(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y),b(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z))});
THREE.SplineCurve3=THREE.Curve.create(function(a){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3");this.points=void 0==a?[]:a},function(a){var b=this.points;a*=b.length-1;var c=Math.floor(a);a-=c;var d=b[0==c?c:c-1],e=b[c],g=b[c>b.length-2?b.length-1:c+1],b=b[c>b.length-3?b.length-1:c+2],c=THREE.CurveUtils.interpolate;return new THREE.Vector3(c(d.x,e.x,g.x,b.x,a),c(d.y,e.y,g.y,b.y,a),c(d.z,e.z,g.z,b.z,a))});
THREE.CatmullRomCurve3=function(){function a(){}var b=new THREE.Vector3,c=new a,d=new a,e=new a;a.prototype.init=function(a,b,c,d){this.c0=a;this.c1=c;this.c2=-3*a+3*b-2*c-d;this.c3=2*a-2*b+c+d};a.prototype.initNonuniformCatmullRom=function(a,b,c,d,e,m,p){a=((b-a)/e-(c-a)/(e+m)+(c-b)/m)*m;d=((c-b)/m-(d-b)/(m+p)+(d-c)/p)*m;this.init(b,c,a,d)};a.prototype.initCatmullRom=function(a,b,c,d,e){this.init(b,c,e*(c-a),e*(d-b))};a.prototype.calc=function(a){var b=a*a;return this.c0+this.c1*a+this.c2*b+this.c3*
b*a};return THREE.Curve.create(function(a){this.points=a||[]},function(a){var f=this.points,h,l;l=f.length;2>l&&console.log("duh, you need at least 2 points");a*=l-1;h=Math.floor(a);a-=h;0===a&&h===l-1&&(h=l-2,a=1);var k,m,p;0===h?(b.subVectors(f[0],f[1]).add(f[0]),k=b):k=f[h-1];m=f[h];p=f[h+1];h+2<l?f=f[h+2]:(b.subVectors(f[l-1],f[l-2]).add(f[l-2]),f=b);if(void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var n="chordal"===this.type?.5:.25;l=Math.pow(k.distanceToSquared(m),n);
h=Math.pow(m.distanceToSquared(p),n);n=Math.pow(p.distanceToSquared(f),n);1E-4>h&&(h=1);1E-4>l&&(l=h);1E-4>n&&(n=h);c.initNonuniformCatmullRom(k.x,m.x,p.x,f.x,l,h,n);d.initNonuniformCatmullRom(k.y,m.y,p.y,f.y,l,h,n);e.initNonuniformCatmullRom(k.z,m.z,p.z,f.z,l,h,n)}else"catmullrom"===this.type&&(l=void 0!==this.tension?this.tension:.5,c.initCatmullRom(k.x,m.x,p.x,f.x,l),d.initCatmullRom(k.y,m.y,p.y,f.y,l),e.initCatmullRom(k.z,m.z,p.z,f.z,l));return new THREE.Vector3(c.calc(a),d.calc(a),e.calc(a))})}();
THREE.ClosedSplineCurve3=THREE.Curve.create(function(a){this.points=void 0==a?[]:a},function(a){var b=this.points;a*=b.length-0;var c=Math.floor(a);a-=c;var c=c+(0<c?0:(Math.floor(Math.abs(c)/b.length)+1)*b.length),d=b[(c-1)%b.length],e=b[c%b.length],g=b[(c+1)%b.length],b=b[(c+2)%b.length],c=THREE.CurveUtils.interpolate;return new THREE.Vector3(c(d.x,e.x,g.x,b.x,a),c(d.y,e.y,g.y,b.y,a),c(d.z,e.z,g.z,b.z,a))});
THREE.BoxGeometry=function(a,b,c,d,e,g){function f(a,b,c,d,e,f,g,t){var v,u=h.widthSegments,w=h.heightSegments,D=e/2,x=f/2,B=h.vertices.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)v="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)v="y",w=h.depthSegments;else if("z"===a&&"y"===b||"y"===a&&"z"===b)v="x",u=h.depthSegments;var y=u+1,z=w+1,A=e/u,J=f/w,F=new THREE.Vector3;F[v]=0<g?1:-1;for(e=0;e<z;e++)for(f=0;f<y;f++){var C=new THREE.Vector3;C[a]=(f*A-D)*c;C[b]=(e*J-x)*d;C[v]=g;h.vertices.push(C)}for(e=
0;e<w;e++)for(f=0;f<u;f++)x=f+y*e,a=f+y*(e+1),b=f+1+y*(e+1),c=f+1+y*e,d=new THREE.Vector2(f/u,1-e/w),g=new THREE.Vector2(f/u,1-(e+1)/w),v=new THREE.Vector2((f+1)/u,1-(e+1)/w),D=new THREE.Vector2((f+1)/u,1-e/w),x=new THREE.Face3(x+B,a+B,c+B),x.normal.copy(F),x.vertexNormals.push(F.clone(),F.clone(),F.clone()),x.materialIndex=t,h.faces.push(x),h.faceVertexUvs[0].push([d,g,D]),x=new THREE.Face3(a+B,b+B,c+B),x.normal.copy(F),x.vertexNormals.push(F.clone(),F.clone(),F.clone()),x.materialIndex=t,h.faces.push(x),
h.faceVertexUvs[0].push([g.clone(),v,D.clone()])}THREE.Geometry.call(this);this.type="BoxGeometry";this.parameters={width:a,height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:g};this.widthSegments=d||1;this.heightSegments=e||1;this.depthSegments=g||1;var h=this;d=a/2;e=b/2;g=c/2;f("z","y",-1,-1,c,b,d,0);f("z","y",1,-1,c,b,-d,1);f("x","z",1,1,a,c,e,2);f("x","z",1,-1,a,c,-e,3);f("x","y",1,-1,a,b,g,4);f("x","y",-1,-1,a,b,-g,5);this.mergeVertices()};THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.BoxGeometry.prototype.constructor=THREE.BoxGeometry;THREE.BoxGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.BoxGeometry(a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments)};THREE.CubeGeometry=THREE.BoxGeometry;THREE.CircleGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.type="CircleGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};this.fromBufferGeometry(new THREE.CircleBufferGeometry(a,b,c,d))};
THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CircleGeometry.prototype.constructor=THREE.CircleGeometry;THREE.CircleGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.CircleGeometry(a.radius,a.segments,a.thetaStart,a.thetaLength)};
THREE.CircleBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this);this.type="CircleBufferGeometry";this.parameters={radius:a,segments:b,thetaStart:c,thetaLength:d};a=a||50;b=void 0!==b?Math.max(3,b):8;c=void 0!==c?c:0;d=void 0!==d?d:2*Math.PI;var e=b+2,g=new Float32Array(3*e),f=new Float32Array(3*e),e=new Float32Array(2*e);f[2]=1;e[0]=.5;e[1]=.5;for(var h=0,l=3,k=2;h<=b;h++,l+=3,k+=2){var m=c+h/b*d;g[l]=a*Math.cos(m);g[l+1]=a*Math.sin(m);f[l+2]=1;e[k]=(g[l]/a+1)/2;e[k+1]=(g[l+1]/a+1)/2}c=
[];for(l=1;l<=b;l++)c.push(l,l+1,0);this.setIndex(new THREE.BufferAttribute(new Uint16Array(c),1));this.addAttribute("position",new THREE.BufferAttribute(g,3));this.addAttribute("normal",new THREE.BufferAttribute(f,3));this.addAttribute("uv",new THREE.BufferAttribute(e,2));this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.CircleBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.CircleBufferGeometry.prototype.constructor=THREE.CircleBufferGeometry;
THREE.CircleBufferGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.CircleBufferGeometry(a.radius,a.segments,a.thetaStart,a.thetaLength)};
THREE.CylinderGeometry=function(a,b,c,d,e,g,f,h){THREE.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:a,radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:g,thetaStart:f,thetaLength:h};a=void 0!==a?a:20;b=void 0!==b?b:20;c=void 0!==c?c:100;d=d||8;e=e||1;g=void 0!==g?g:!1;f=void 0!==f?f:0;h=void 0!==h?h:2*Math.PI;var l=c/2,k,m,p=[],n=[];for(m=0;m<=e;m++){var q=[],s=[],t=m/e,v=t*(b-a)+a;for(k=0;k<=d;k++){var u=k/d,w=new THREE.Vector3;w.x=v*Math.sin(u*h+
f);w.y=-t*c+l;w.z=v*Math.cos(u*h+f);this.vertices.push(w);q.push(this.vertices.length-1);s.push(new THREE.Vector2(u,1-t))}p.push(q);n.push(s)}c=(b-a)/c;for(k=0;k<d;k++)for(0!==a?(f=this.vertices[p[0][k]].clone(),h=this.vertices[p[0][k+1]].clone()):(f=this.vertices[p[1][k]].clone(),h=this.vertices[p[1][k+1]].clone()),f.setY(Math.sqrt(f.x*f.x+f.z*f.z)*c).normalize(),h.setY(Math.sqrt(h.x*h.x+h.z*h.z)*c).normalize(),m=0;m<e;m++){var q=p[m][k],s=p[m+1][k],t=p[m+1][k+1],v=p[m][k+1],u=f.clone(),w=f.clone(),
D=h.clone(),x=h.clone(),B=n[m][k].clone(),y=n[m+1][k].clone(),z=n[m+1][k+1].clone(),A=n[m][k+1].clone();this.faces.push(new THREE.Face3(q,s,v,[u,w,x]));this.faceVertexUvs[0].push([B,y,A]);this.faces.push(new THREE.Face3(s,t,v,[w.clone(),D,x.clone()]));this.faceVertexUvs[0].push([y.clone(),z,A.clone()])}if(!1===g&&0<a)for(this.vertices.push(new THREE.Vector3(0,l,0)),k=0;k<d;k++)q=p[0][k],s=p[0][k+1],t=this.vertices.length-1,u=new THREE.Vector3(0,1,0),w=new THREE.Vector3(0,1,0),D=new THREE.Vector3(0,
1,0),B=n[0][k].clone(),y=n[0][k+1].clone(),z=new THREE.Vector2(y.x,0),this.faces.push(new THREE.Face3(q,s,t,[u,w,D],void 0,1)),this.faceVertexUvs[0].push([B,y,z]);if(!1===g&&0<b)for(this.vertices.push(new THREE.Vector3(0,-l,0)),k=0;k<d;k++)q=p[e][k+1],s=p[e][k],t=this.vertices.length-1,u=new THREE.Vector3(0,-1,0),w=new THREE.Vector3(0,-1,0),D=new THREE.Vector3(0,-1,0),B=n[e][k+1].clone(),y=n[e][k].clone(),z=new THREE.Vector2(y.x,1),this.faces.push(new THREE.Face3(q,s,t,[u,w,D],void 0,2)),this.faceVertexUvs[0].push([B,
y,z]);this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry;THREE.CylinderGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.CylinderGeometry(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength)};
THREE.EdgesGeometry=function(a,b){function c(a,b){return a-b}THREE.BufferGeometry.call(this);var d=Math.cos(THREE.Math.degToRad(void 0!==b?b:1)),e=[0,0],g={},f=["a","b","c"],h;a instanceof THREE.BufferGeometry?(h=new THREE.Geometry,h.fromBufferGeometry(a)):h=a.clone();h.mergeVertices();h.computeFaceNormals();var l=h.vertices;h=h.faces;for(var k=0,m=h.length;k<m;k++)for(var p=h[k],n=0;3>n;n++){e[0]=p[f[n]];e[1]=p[f[(n+1)%3]];e.sort(c);var q=e.toString();void 0===g[q]?g[q]={vert1:e[0],vert2:e[1],face1:k,
face2:void 0}:g[q].face2=k}e=[];for(q in g)if(f=g[q],void 0===f.face2||h[f.face1].normal.dot(h[f.face2].normal)<=d)k=l[f.vert1],e.push(k.x),e.push(k.y),e.push(k.z),k=l[f.vert2],e.push(k.x),e.push(k.y),e.push(k.z);this.addAttribute("position",new THREE.BufferAttribute(new Float32Array(e),3))};THREE.EdgesGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.EdgesGeometry.prototype.constructor=THREE.EdgesGeometry;
THREE.ExtrudeGeometry=function(a,b){"undefined"!==typeof a&&(THREE.Geometry.call(this),this.type="ExtrudeGeometry",a=Array.isArray(a)?a:[a],this.addShapeList(a,b),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry;THREE.ExtrudeGeometry.prototype.addShapeList=function(a,b){for(var c=a.length,d=0;d<c;d++)this.addShape(a[d],b)};
THREE.ExtrudeGeometry.prototype.addShape=function(a,b){function c(a,b,c){b||console.error("THREE.ExtrudeGeometry: vec does not exist");return b.clone().multiplyScalar(c).add(a)}function d(a,b,c){var d=1,d=a.x-b.x,e=a.y-b.y,f=c.x-a.x,g=c.y-a.y,h=d*d+e*e;if(Math.abs(d*g-e*f)>Number.EPSILON){var k=Math.sqrt(h),l=Math.sqrt(f*f+g*g),h=b.x-e/k;b=b.y+d/k;f=((c.x-g/l-h)*g-(c.y+f/l-b)*f)/(d*g-e*f);c=h+d*f-a.x;a=b+e*f-a.y;d=c*c+a*a;if(2>=d)return new THREE.Vector2(c,a);d=Math.sqrt(d/2)}else a=!1,d>Number.EPSILON?
f>Number.EPSILON&&(a=!0):d<-Number.EPSILON?f<-Number.EPSILON&&(a=!0):Math.sign(e)===Math.sign(g)&&(a=!0),a?(c=-e,a=d,d=Math.sqrt(h)):(c=d,a=e,d=Math.sqrt(h/2));return new THREE.Vector2(c/d,a/d)}function e(a,b){var c,d;for(G=a.length;0<=--G;){c=G;d=G-1;0>d&&(d=a.length-1);for(var e=0,f=q+2*m,e=0;e<f;e++){var g=T*e,h=T*(e+1),k=b+c+g,g=b+d+g,l=b+d+h,h=b+c+h,k=k+F,g=g+F,l=l+F,h=h+F;J.faces.push(new THREE.Face3(k,g,h,null,null,1));J.faces.push(new THREE.Face3(g,l,h,null,null,1));k=u.generateSideWallUV(J,
k,g,l,h);J.faceVertexUvs[0].push([k[0],k[1],k[3]]);J.faceVertexUvs[0].push([k[1],k[2],k[3]])}}}function g(a,b,c){J.vertices.push(new THREE.Vector3(a,b,c))}function f(a,b,c){a+=F;b+=F;c+=F;J.faces.push(new THREE.Face3(a,b,c,null,null,0));a=u.generateTopUV(J,a,b,c);J.faceVertexUvs[0].push(a)}var h=void 0!==b.amount?b.amount:100,l=void 0!==b.bevelThickness?b.bevelThickness:6,k=void 0!==b.bevelSize?b.bevelSize:l-2,m=void 0!==b.bevelSegments?b.bevelSegments:3,p=void 0!==b.bevelEnabled?b.bevelEnabled:!0,
n=void 0!==b.curveSegments?b.curveSegments:12,q=void 0!==b.steps?b.steps:1,s=b.extrudePath,t,v=!1,u=void 0!==b.UVGenerator?b.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,w,D,x,B;s&&(t=s.getSpacedPoints(q),v=!0,p=!1,w=void 0!==b.frames?b.frames:new THREE.TubeGeometry.FrenetFrames(s,q,!1),D=new THREE.Vector3,x=new THREE.Vector3,B=new THREE.Vector3);p||(k=l=m=0);var y,z,A,J=this,F=this.vertices.length,s=a.extractPoints(n),n=s.shape,C=s.holes;if(s=!THREE.ShapeUtils.isClockWise(n)){n=n.reverse();
z=0;for(A=C.length;z<A;z++)y=C[z],THREE.ShapeUtils.isClockWise(y)&&(C[z]=y.reverse());s=!1}var N=THREE.ShapeUtils.triangulateShape(n,C),L=n;z=0;for(A=C.length;z<A;z++)y=C[z],n=n.concat(y);var Q,M,K,E,O,T=n.length,H,R=N.length,s=[],G=0;K=L.length;Q=K-1;for(M=G+1;G<K;G++,Q++,M++)Q===K&&(Q=0),M===K&&(M=0),s[G]=d(L[G],L[Q],L[M]);var ia=[],U,X=s.concat();z=0;for(A=C.length;z<A;z++){y=C[z];U=[];G=0;K=y.length;Q=K-1;for(M=G+1;G<K;G++,Q++,M++)Q===K&&(Q=0),M===K&&(M=0),U[G]=d(y[G],y[Q],y[M]);ia.push(U);X=
X.concat(U)}for(Q=0;Q<m;Q++){K=Q/m;E=l*(1-K);M=k*Math.sin(K*Math.PI/2);G=0;for(K=L.length;G<K;G++)O=c(L[G],s[G],M),g(O.x,O.y,-E);z=0;for(A=C.length;z<A;z++)for(y=C[z],U=ia[z],G=0,K=y.length;G<K;G++)O=c(y[G],U[G],M),g(O.x,O.y,-E)}M=k;for(G=0;G<T;G++)O=p?c(n[G],X[G],M):n[G],v?(x.copy(w.normals[0]).multiplyScalar(O.x),D.copy(w.binormals[0]).multiplyScalar(O.y),B.copy(t[0]).add(x).add(D),g(B.x,B.y,B.z)):g(O.x,O.y,0);for(K=1;K<=q;K++)for(G=0;G<T;G++)O=p?c(n[G],X[G],M):n[G],v?(x.copy(w.normals[K]).multiplyScalar(O.x),
D.copy(w.binormals[K]).multiplyScalar(O.y),B.copy(t[K]).add(x).add(D),g(B.x,B.y,B.z)):g(O.x,O.y,h/q*K);for(Q=m-1;0<=Q;Q--){K=Q/m;E=l*(1-K);M=k*Math.sin(K*Math.PI/2);G=0;for(K=L.length;G<K;G++)O=c(L[G],s[G],M),g(O.x,O.y,h+E);z=0;for(A=C.length;z<A;z++)for(y=C[z],U=ia[z],G=0,K=y.length;G<K;G++)O=c(y[G],U[G],M),v?g(O.x,O.y+t[q-1].y,t[q-1].x+E):g(O.x,O.y,h+E)}(function(){if(p){var a;a=0*T;for(G=0;G<R;G++)H=N[G],f(H[2]+a,H[1]+a,H[0]+a);a=q+2*m;a*=T;for(G=0;G<R;G++)H=N[G],f(H[0]+a,H[1]+a,H[2]+a)}else{for(G=
0;G<R;G++)H=N[G],f(H[2],H[1],H[0]);for(G=0;G<R;G++)H=N[G],f(H[0]+T*q,H[1]+T*q,H[2]+T*q)}})();(function(){var a=0;e(L,a);a+=L.length;z=0;for(A=C.length;z<A;z++)y=C[z],e(y,a),a+=y.length})()};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(a,b,c,d){a=a.vertices;b=a[b];c=a[c];d=a[d];return[new THREE.Vector2(b.x,b.y),new THREE.Vector2(c.x,c.y),new THREE.Vector2(d.x,d.y)]},generateSideWallUV:function(a,b,c,d,e){a=a.vertices;b=a[b];c=a[c];d=a[d];e=a[e];return.01>Math.abs(b.y-c.y)?[new THREE.Vector2(b.x,1-b.z),new THREE.Vector2(c.x,1-c.z),new THREE.Vector2(d.x,1-d.z),new THREE.Vector2(e.x,1-e.z)]:[new THREE.Vector2(b.y,1-b.z),new THREE.Vector2(c.y,1-c.z),new THREE.Vector2(d.y,
1-d.z),new THREE.Vector2(e.y,1-e.z)]}};THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this);this.type="ShapeGeometry";!1===Array.isArray(a)&&(a=[a]);this.addShapeList(a,b);this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.constructor=THREE.ShapeGeometry;THREE.ShapeGeometry.prototype.addShapeList=function(a,b){for(var c=0,d=a.length;c<d;c++)this.addShape(a[c],b);return this};
THREE.ShapeGeometry.prototype.addShape=function(a,b){void 0===b&&(b={});var c=b.material,d=void 0===b.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:b.UVGenerator,e,g,f,h=this.vertices.length;e=a.extractPoints(void 0!==b.curveSegments?b.curveSegments:12);var l=e.shape,k=e.holes;if(!THREE.ShapeUtils.isClockWise(l))for(l=l.reverse(),e=0,g=k.length;e<g;e++)f=k[e],THREE.ShapeUtils.isClockWise(f)&&(k[e]=f.reverse());var m=THREE.ShapeUtils.triangulateShape(l,k);e=0;for(g=k.length;e<g;e++)f=k[e],l=l.concat(f);
k=l.length;g=m.length;for(e=0;e<k;e++)f=l[e],this.vertices.push(new THREE.Vector3(f.x,f.y,0));for(e=0;e<g;e++)k=m[e],l=k[0]+h,f=k[1]+h,k=k[2]+h,this.faces.push(new THREE.Face3(l,f,k,null,null,c)),this.faceVertexUvs[0].push(d.generateTopUV(this,l,f,k))};
THREE.LatheGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.type="LatheGeometry";this.parameters={points:a,segments:b,phiStart:c,phiLength:d};b=b||12;c=c||0;d=d||2*Math.PI;for(var e=1/(a.length-1),g=1/b,f=0,h=b;f<=h;f++)for(var l=c+f*g*d,k=Math.cos(l),m=Math.sin(l),l=0,p=a.length;l<p;l++){var n=a[l],q=new THREE.Vector3;q.x=k*n.x-m*n.y;q.y=m*n.x+k*n.y;q.z=n.z;this.vertices.push(q)}c=a.length;f=0;for(h=b;f<h;f++)for(l=0,p=a.length-1;l<p;l++){b=m=l+c*f;d=m+c;var k=m+1+c,m=m+1,n=f*g,q=l*e,s=
n+g,t=q+e;this.faces.push(new THREE.Face3(b,d,m));this.faceVertexUvs[0].push([new THREE.Vector2(n,q),new THREE.Vector2(s,q),new THREE.Vector2(n,t)]);this.faces.push(new THREE.Face3(d,k,m));this.faceVertexUvs[0].push([new THREE.Vector2(s,q),new THREE.Vector2(s,t),new THREE.Vector2(n,t)])}this.mergeVertices();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry;
THREE.PlaneGeometry=function(a,b,c,d){THREE.Geometry.call(this);this.type="PlaneGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};this.fromBufferGeometry(new THREE.PlaneBufferGeometry(a,b,c,d))};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry;THREE.PlaneGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.PlaneGeometry(a.width,a.height,a.widthSegments,a.heightSegments)};
THREE.PlaneBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this);this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};var e=a/2,g=b/2;c=Math.floor(c)||1;d=Math.floor(d)||1;var f=c+1,h=d+1,l=a/c,k=b/d;b=new Float32Array(f*h*3);a=new Float32Array(f*h*3);for(var m=new Float32Array(f*h*2),p=0,n=0,q=0;q<h;q++)for(var s=q*k-g,t=0;t<f;t++)b[p]=t*l-e,b[p+1]=-s,a[p+2]=1,m[n]=t/c,m[n+1]=1-q/d,p+=3,n+=2;p=0;e=new (65535<b.length/3?Uint32Array:Uint16Array)(c*
d*6);for(q=0;q<d;q++)for(t=0;t<c;t++)g=t+f*(q+1),h=t+1+f*(q+1),l=t+1+f*q,e[p]=t+f*q,e[p+1]=g,e[p+2]=l,e[p+3]=g,e[p+4]=h,e[p+5]=l,p+=6;this.setIndex(new THREE.BufferAttribute(e,1));this.addAttribute("position",new THREE.BufferAttribute(b,3));this.addAttribute("normal",new THREE.BufferAttribute(a,3));this.addAttribute("uv",new THREE.BufferAttribute(m,2))};THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry;
THREE.PlaneBufferGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.PlaneBufferGeometry(a.width,a.height,a.widthSegments,a.heightSegments)};
THREE.RingGeometry=function(a,b,c,d,e,g){THREE.Geometry.call(this);this.type="RingGeometry";this.parameters={innerRadius:a,outerRadius:b,thetaSegments:c,phiSegments:d,thetaStart:e,thetaLength:g};a=a||0;b=b||50;e=void 0!==e?e:0;g=void 0!==g?g:2*Math.PI;c=void 0!==c?Math.max(3,c):8;d=void 0!==d?Math.max(1,d):8;var f,h=[],l=a,k=(b-a)/d;for(a=0;a<d+1;a++){for(f=0;f<c+1;f++){var m=new THREE.Vector3,p=e+f/c*g;m.x=l*Math.cos(p);m.y=l*Math.sin(p);this.vertices.push(m);h.push(new THREE.Vector2((m.x/b+1)/2,
(m.y/b+1)/2))}l+=k}b=new THREE.Vector3(0,0,1);for(a=0;a<d;a++)for(e=a*(c+1),f=0;f<c;f++)g=p=f+e,k=p+c+1,m=p+c+2,this.faces.push(new THREE.Face3(g,k,m,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([h[g].clone(),h[k].clone(),h[m].clone()]),g=p,k=p+c+2,m=p+1,this.faces.push(new THREE.Face3(g,k,m,[b.clone(),b.clone(),b.clone()])),this.faceVertexUvs[0].push([h[g].clone(),h[k].clone(),h[m].clone()]);this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,l)};
THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.RingGeometry.prototype.constructor=THREE.RingGeometry;THREE.RingGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.RingGeometry(a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength)};
THREE.SphereGeometry=function(a,b,c,d,e,g,f){THREE.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:g,thetaLength:f};this.fromBufferGeometry(new THREE.SphereBufferGeometry(a,b,c,d,e,g,f))};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry;
THREE.SphereGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.SphereGeometry(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)};
THREE.SphereBufferGeometry=function(a,b,c,d,e,g,f){THREE.BufferGeometry.call(this);this.type="SphereBufferGeometry";this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:g,thetaLength:f};a=a||50;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;g=void 0!==g?g:0;f=void 0!==f?f:Math.PI;for(var h=g+f,l=(b+1)*(c+1),k=new THREE.BufferAttribute(new Float32Array(3*l),3),m=new THREE.BufferAttribute(new Float32Array(3*
l),3),l=new THREE.BufferAttribute(new Float32Array(2*l),2),p=0,n=[],q=new THREE.Vector3,s=0;s<=c;s++){for(var t=[],v=s/c,u=0;u<=b;u++){var w=u/b,D=-a*Math.cos(d+w*e)*Math.sin(g+v*f),x=a*Math.cos(g+v*f),B=a*Math.sin(d+w*e)*Math.sin(g+v*f);q.set(D,x,B).normalize();k.setXYZ(p,D,x,B);m.setXYZ(p,q.x,q.y,q.z);l.setXY(p,w,1-v);t.push(p);p++}n.push(t)}d=[];for(s=0;s<c;s++)for(u=0;u<b;u++)e=n[s][u+1],f=n[s][u],p=n[s+1][u],q=n[s+1][u+1],(0!==s||0<g)&&d.push(e,f,q),(s!==c-1||h<Math.PI)&&d.push(f,p,q);this.setIndex(new (65535<
k.count?THREE.Uint32Attribute:THREE.Uint16Attribute)(d,1));this.addAttribute("position",k);this.addAttribute("normal",m);this.addAttribute("uv",l);this.boundingSphere=new THREE.Sphere(new THREE.Vector3,a)};THREE.SphereBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.SphereBufferGeometry.prototype.constructor=THREE.SphereBufferGeometry;
THREE.SphereBufferGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.SphereBufferGeometry(a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength)};
THREE.TorusGeometry=function(a,b,c,d,e){THREE.Geometry.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:e};a=a||100;b=b||40;c=c||8;d=d||6;e=e||2*Math.PI;for(var g=new THREE.Vector3,f=[],h=[],l=0;l<=c;l++)for(var k=0;k<=d;k++){var m=k/d*e,p=l/c*Math.PI*2;g.x=a*Math.cos(m);g.y=a*Math.sin(m);var n=new THREE.Vector3;n.x=(a+b*Math.cos(p))*Math.cos(m);n.y=(a+b*Math.cos(p))*Math.sin(m);n.z=b*Math.sin(p);this.vertices.push(n);f.push(new THREE.Vector2(k/
d,l/c));h.push(n.clone().sub(g).normalize())}for(l=1;l<=c;l++)for(k=1;k<=d;k++)a=(d+1)*l+k-1,b=(d+1)*(l-1)+k-1,e=(d+1)*(l-1)+k,g=(d+1)*l+k,m=new THREE.Face3(a,b,g,[h[a].clone(),h[b].clone(),h[g].clone()]),this.faces.push(m),this.faceVertexUvs[0].push([f[a].clone(),f[b].clone(),f[g].clone()]),m=new THREE.Face3(b,e,g,[h[b].clone(),h[e].clone(),h[g].clone()]),this.faces.push(m),this.faceVertexUvs[0].push([f[b].clone(),f[e].clone(),f[g].clone()]);this.computeFaceNormals()};
THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry;THREE.TorusGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.TorusGeometry(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc)};
THREE.TorusKnotGeometry=function(a,b,c,d,e,g,f){function h(a,b,c,d,e){var f=Math.cos(a),g=Math.sin(a);a*=b/c;b=Math.cos(a);f*=d*(2+b)*.5;g=d*(2+b)*g*.5;d=e*d*Math.sin(a)*.5;return new THREE.Vector3(f,g,d)}THREE.Geometry.call(this);this.type="TorusKnotGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,p:e,q:g,heightScale:f};a=a||100;b=b||40;c=c||64;d=d||8;e=e||2;g=g||3;f=f||1;for(var l=Array(c),k=new THREE.Vector3,m=new THREE.Vector3,p=new THREE.Vector3,n=0;n<c;++n){l[n]=
Array(d);var q=n/c*2*e*Math.PI,s=h(q,g,e,a,f),q=h(q+.01,g,e,a,f);k.subVectors(q,s);m.addVectors(q,s);p.crossVectors(k,m);m.crossVectors(p,k);p.normalize();m.normalize();for(q=0;q<d;++q){var t=q/d*2*Math.PI,v=-b*Math.cos(t),t=b*Math.sin(t),u=new THREE.Vector3;u.x=s.x+v*m.x+t*p.x;u.y=s.y+v*m.y+t*p.y;u.z=s.z+v*m.z+t*p.z;l[n][q]=this.vertices.push(u)-1}}for(n=0;n<c;++n)for(q=0;q<d;++q)e=(n+1)%c,g=(q+1)%d,a=l[n][q],b=l[e][q],e=l[e][g],g=l[n][g],f=new THREE.Vector2(n/c,q/d),k=new THREE.Vector2((n+1)/c,
q/d),m=new THREE.Vector2((n+1)/c,(q+1)/d),p=new THREE.Vector2(n/c,(q+1)/d),this.faces.push(new THREE.Face3(a,b,g)),this.faceVertexUvs[0].push([f,k,p]),this.faces.push(new THREE.Face3(b,e,g)),this.faceVertexUvs[0].push([k.clone(),m,p.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry;
THREE.TorusKnotGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.TorusKnotGeometry(a.radius,a.tube,a.radialSegments,a.tubularSegments,a.p,a.q,a.heightScale)};
THREE.TubeGeometry=function(a,b,c,d,e,g){THREE.Geometry.call(this);this.type="TubeGeometry";this.parameters={path:a,segments:b,radius:c,radialSegments:d,closed:e,taper:g};b=b||64;c=c||1;d=d||8;e=e||!1;g=g||THREE.TubeGeometry.NoTaper;var f=[],h,l,k=b+1,m,p,n,q,s,t=new THREE.Vector3,v,u,w;v=new THREE.TubeGeometry.FrenetFrames(a,b,e);u=v.normals;w=v.binormals;this.tangents=v.tangents;this.normals=u;this.binormals=w;for(v=0;v<k;v++)for(f[v]=[],m=v/(k-1),s=a.getPointAt(m),h=u[v],l=w[v],n=c*g(m),m=0;m<
d;m++)p=m/d*2*Math.PI,q=-n*Math.cos(p),p=n*Math.sin(p),t.copy(s),t.x+=q*h.x+p*l.x,t.y+=q*h.y+p*l.y,t.z+=q*h.z+p*l.z,f[v][m]=this.vertices.push(new THREE.Vector3(t.x,t.y,t.z))-1;for(v=0;v<b;v++)for(m=0;m<d;m++)g=e?(v+1)%b:v+1,k=(m+1)%d,a=f[v][m],c=f[g][m],g=f[g][k],k=f[v][k],t=new THREE.Vector2(v/b,m/d),u=new THREE.Vector2((v+1)/b,m/d),w=new THREE.Vector2((v+1)/b,(m+1)/d),h=new THREE.Vector2(v/b,(m+1)/d),this.faces.push(new THREE.Face3(a,c,k)),this.faceVertexUvs[0].push([t,u,h]),this.faces.push(new THREE.Face3(c,
g,k)),this.faceVertexUvs[0].push([u.clone(),w,h.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry;THREE.TubeGeometry.prototype.clone=function(){return new this.constructor(this.parameters.path,this.parameters.segments,this.parameters.radius,this.parameters.radialSegments,this.parameters.closed,this.parameters.taper)};THREE.TubeGeometry.NoTaper=function(a){return 1};
THREE.TubeGeometry.SinusoidalTaper=function(a){return Math.sin(Math.PI*a)};
THREE.TubeGeometry.FrenetFrames=function(a,b,c){var d=new THREE.Vector3,e=[],g=[],f=[],h=new THREE.Vector3,l=new THREE.Matrix4;b+=1;var k,m,p;this.tangents=e;this.normals=g;this.binormals=f;for(k=0;k<b;k++)m=k/(b-1),e[k]=a.getTangentAt(m),e[k].normalize();g[0]=new THREE.Vector3;f[0]=new THREE.Vector3;a=Number.MAX_VALUE;k=Math.abs(e[0].x);m=Math.abs(e[0].y);p=Math.abs(e[0].z);k<=a&&(a=k,d.set(1,0,0));m<=a&&(a=m,d.set(0,1,0));p<=a&&d.set(0,0,1);h.crossVectors(e[0],d).normalize();g[0].crossVectors(e[0],
h);f[0].crossVectors(e[0],g[0]);for(k=1;k<b;k++)g[k]=g[k-1].clone(),f[k]=f[k-1].clone(),h.crossVectors(e[k-1],e[k]),h.length()>Number.EPSILON&&(h.normalize(),d=Math.acos(THREE.Math.clamp(e[k-1].dot(e[k]),-1,1)),g[k].applyMatrix4(l.makeRotationAxis(h,d))),f[k].crossVectors(e[k],g[k]);if(c)for(d=Math.acos(THREE.Math.clamp(g[0].dot(g[b-1]),-1,1)),d/=b-1,0<e[0].dot(h.crossVectors(g[0],g[b-1]))&&(d=-d),k=1;k<b;k++)g[k].applyMatrix4(l.makeRotationAxis(e[k],d*k)),f[k].crossVectors(e[k],g[k])};
THREE.PolyhedronGeometry=function(a,b,c,d){function e(a){var b=a.normalize().clone();b.index=l.vertices.push(b)-1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+.5;a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5;b.uv=new THREE.Vector2(c,1-a);return b}function g(a,b,c,d){d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()],void 0,d);l.faces.push(d);v.copy(a).add(b).add(c).divideScalar(3);d=Math.atan2(v.z,-v.x);l.faceVertexUvs[0].push([h(a.uv,a,d),h(b.uv,b,d),h(c.uv,c,d)])}function f(a,
b){for(var c=Math.pow(2,b),d=e(l.vertices[a.a]),f=e(l.vertices[a.b]),h=e(l.vertices[a.c]),k=[],n=a.materialIndex,m=0;m<=c;m++){k[m]=[];for(var p=e(d.clone().lerp(h,m/c)),q=e(f.clone().lerp(h,m/c)),s=c-m,t=0;t<=s;t++)k[m][t]=0===t&&m===c?p:e(p.clone().lerp(q,t/s))}for(m=0;m<c;m++)for(t=0;t<2*(c-m)-1;t++)d=Math.floor(t/2),0===t%2?g(k[m][d+1],k[m+1][d],k[m][d],n):g(k[m][d+1],k[m+1][d+1],k[m+1][d],n)}function h(a,b,c){0>c&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y));0===b.x&&0===b.z&&(a=new THREE.Vector2(c/
2/Math.PI+.5,a.y));return a.clone()}THREE.Geometry.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,indices:b,radius:c,detail:d};c=c||1;d=d||0;for(var l=this,k=0,m=a.length;k<m;k+=3)e(new THREE.Vector3(a[k],a[k+1],a[k+2]));a=this.vertices;for(var p=[],n=k=0,m=b.length;k<m;k+=3,n++){var q=a[b[k]],s=a[b[k+1]],t=a[b[k+2]];p[n]=new THREE.Face3(q.index,s.index,t.index,[q.clone(),s.clone(),t.clone()],void 0,n)}for(var v=new THREE.Vector3,k=0,m=p.length;k<m;k++)f(p[k],d);k=0;for(m=this.faceVertexUvs[0].length;k<
m;k++)b=this.faceVertexUvs[0][k],d=b[0].x,a=b[1].x,p=b[2].x,n=Math.max(d,a,p),q=Math.min(d,a,p),.9<n&&.1>q&&(.2>d&&(b[0].x+=1),.2>a&&(b[1].x+=1),.2>p&&(b[2].x+=1));k=0;for(m=this.vertices.length;k<m;k++)this.vertices[k].multiplyScalar(c);this.mergeVertices();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry;
THREE.PolyhedronGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.PolyhedronGeometry(a.vertices,a.indices,a.radius,a.detail)};
THREE.DodecahedronGeometry=function(a,b){var c=(1+Math.sqrt(5))/2,d=1/c;THREE.PolyhedronGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-c,0,-d,c,0,d,-c,0,d,c,-d,-c,0,-d,c,0,d,-c,0,d,c,0,-c,0,-d,c,0,-d,-c,0,d,c,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,
12,14,1,14,5,1,5,9],a,b);this.type="DodecahedronGeometry";this.parameters={radius:a,detail:b}};THREE.DodecahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);THREE.DodecahedronGeometry.prototype.constructor=THREE.DodecahedronGeometry;THREE.DodecahedronGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.DodecahedronGeometry(a.radius,a.detail)};
THREE.IcosahedronGeometry=function(a,b){var c=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b);this.type="IcosahedronGeometry";this.parameters={radius:a,detail:b}};THREE.IcosahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);
THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry;THREE.IcosahedronGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.IcosahedronGeometry(a.radius,a.detail)};THREE.OctahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b}};THREE.OctahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);
THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry;THREE.OctahedronGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.OctahedronGeometry(a.radius,a.detail)};THREE.TetrahedronGeometry=function(a,b){THREE.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b);this.type="TetrahedronGeometry";this.parameters={radius:a,detail:b}};THREE.TetrahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);
THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry;THREE.TetrahedronGeometry.prototype.clone=function(){var a=this.parameters;return new THREE.TetrahedronGeometry(a.radius,a.detail)};
THREE.ParametricGeometry=function(a,b,c){THREE.Geometry.call(this);this.type="ParametricGeometry";this.parameters={func:a,slices:b,stacks:c};var d=this.vertices,e=this.faces,g=this.faceVertexUvs[0],f,h,l,k,m=b+1;for(f=0;f<=c;f++)for(k=f/c,h=0;h<=b;h++)l=h/b,l=a(l,k),d.push(l);var p,n,q,s;for(f=0;f<c;f++)for(h=0;h<b;h++)a=f*m+h,d=f*m+h+1,k=(f+1)*m+h+1,l=(f+1)*m+h,p=new THREE.Vector2(h/b,f/c),n=new THREE.Vector2((h+1)/b,f/c),q=new THREE.Vector2((h+1)/b,(f+1)/c),s=new THREE.Vector2(h/b,(f+1)/c),e.push(new THREE.Face3(a,
d,l)),g.push([p,n,s]),e.push(new THREE.Face3(d,k,l)),g.push([n.clone(),q,s.clone()]);this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry;
THREE.WireframeGeometry=function(a){function b(a,b){return a-b}THREE.BufferGeometry.call(this);var c=[0,0],d={},e=["a","b","c"];if(a instanceof THREE.Geometry){var g=a.vertices,f=a.faces,h=0,l=new Uint32Array(6*f.length);a=0;for(var k=f.length;a<k;a++)for(var m=f[a],p=0;3>p;p++){c[0]=m[e[p]];c[1]=m[e[(p+1)%3]];c.sort(b);var n=c.toString();void 0===d[n]&&(l[2*h]=c[0],l[2*h+1]=c[1],d[n]=!0,h++)}c=new Float32Array(6*h);a=0;for(k=h;a<k;a++)for(p=0;2>p;p++)d=g[l[2*a+p]],h=6*a+3*p,c[h+0]=d.x,c[h+1]=d.y,
c[h+2]=d.z;this.addAttribute("position",new THREE.BufferAttribute(c,3))}else if(a instanceof THREE.BufferGeometry){if(null!==a.index){k=a.index.array;g=a.attributes.position;e=a.drawcalls;h=0;0===e.length&&a.addGroup(0,k.length);l=new Uint32Array(2*k.length);f=0;for(m=e.length;f<m;++f){a=e[f];p=a.start;n=a.count;a=p;for(var q=p+n;a<q;a+=3)for(p=0;3>p;p++)c[0]=k[a+p],c[1]=k[a+(p+1)%3],c.sort(b),n=c.toString(),void 0===d[n]&&(l[2*h]=c[0],l[2*h+1]=c[1],d[n]=!0,h++)}c=new Float32Array(6*h);a=0;for(k=
h;a<k;a++)for(p=0;2>p;p++)h=6*a+3*p,d=l[2*a+p],c[h+0]=g.getX(d),c[h+1]=g.getY(d),c[h+2]=g.getZ(d)}else for(g=a.attributes.position.array,h=g.length/3,l=h/3,c=new Float32Array(6*h),a=0,k=l;a<k;a++)for(p=0;3>p;p++)h=18*a+6*p,l=9*a+3*p,c[h+0]=g[l],c[h+1]=g[l+1],c[h+2]=g[l+2],d=9*a+(p+1)%3*3,c[h+3]=g[d],c[h+4]=g[d+1],c[h+5]=g[d+2];this.addAttribute("position",new THREE.BufferAttribute(c,3))}};THREE.WireframeGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);
THREE.WireframeGeometry.prototype.constructor=THREE.WireframeGeometry;THREE.AxisHelper=function(a){a=a||1;var b=new Float32Array([0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a]),c=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);a=new THREE.BufferGeometry;a.addAttribute("position",new THREE.BufferAttribute(b,3));a.addAttribute("color",new THREE.BufferAttribute(c,3));b=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.LineSegments.call(this,a,b)};THREE.AxisHelper.prototype=Object.create(THREE.LineSegments.prototype);
THREE.AxisHelper.prototype.constructor=THREE.AxisHelper;
THREE.ArrowHelper=function(){var a=new THREE.Geometry;a.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,1,0));var b=new THREE.CylinderGeometry(0,.5,1,5,1);b.translate(0,-.5,0);return function(c,d,e,g,f,h){THREE.Object3D.call(this);void 0===g&&(g=16776960);void 0===e&&(e=1);void 0===f&&(f=.2*e);void 0===h&&(h=.2*f);this.position.copy(d);f<e&&(this.line=new THREE.Line(a,new THREE.LineBasicMaterial({color:g})),this.line.matrixAutoUpdate=!1,this.add(this.line));this.cone=new THREE.Mesh(b,new THREE.MeshBasicMaterial({color:g}));
this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(c);this.setLength(e,f,h)}}();THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper;THREE.ArrowHelper.prototype.setDirection=function(){var a=new THREE.Vector3,b;return function(c){.99999<c.y?this.quaternion.set(0,0,0,1):-.99999>c.y?this.quaternion.set(1,0,0,0):(a.set(c.z,0,-c.x).normalize(),b=Math.acos(c.y),this.quaternion.setFromAxisAngle(a,b))}}();
THREE.ArrowHelper.prototype.setLength=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);b<a&&(this.line.scale.set(1,a-b,1),this.line.updateMatrix());this.cone.scale.set(c,b,c);this.cone.position.y=a;this.cone.updateMatrix()};THREE.ArrowHelper.prototype.setColor=function(a){void 0!==this.line&&this.line.material.color.set(a);this.cone.material.color.set(a)};
THREE.BoxHelper=function(a){var b=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),c=new Float32Array(24),d=new THREE.BufferGeometry;d.setIndex(new THREE.BufferAttribute(b,1));d.addAttribute("position",new THREE.BufferAttribute(c,3));THREE.LineSegments.call(this,d,new THREE.LineBasicMaterial({color:16776960}));void 0!==a&&this.update(a)};THREE.BoxHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.BoxHelper.prototype.constructor=THREE.BoxHelper;
THREE.BoxHelper.prototype.update=function(){var a=new THREE.Box3;return function(b){a.setFromObject(b);if(!a.empty()){b=a.min;var c=a.max,d=this.geometry.attributes.position,e=d.array;e[0]=c.x;e[1]=c.y;e[2]=c.z;e[3]=b.x;e[4]=c.y;e[5]=c.z;e[6]=b.x;e[7]=b.y;e[8]=c.z;e[9]=c.x;e[10]=b.y;e[11]=c.z;e[12]=c.x;e[13]=c.y;e[14]=b.z;e[15]=b.x;e[16]=c.y;e[17]=b.z;e[18]=b.x;e[19]=b.y;e[20]=b.z;e[21]=c.x;e[22]=b.y;e[23]=b.z;d.needsUpdate=!0;this.geometry.computeBoundingSphere()}}}();
THREE.BoundingBoxHelper=function(a,b){var c=void 0!==b?b:8947848;this.object=a;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:c,wireframe:!0}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.constructor=THREE.BoundingBoxHelper;THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};
THREE.CameraHelper=function(a){function b(a,b,d){c(a,d);c(b,d)}function c(a,b){d.vertices.push(new THREE.Vector3);d.colors.push(new THREE.Color(b));void 0===g[a]&&(g[a]=[]);g[a].push(d.vertices.length-1)}var d=new THREE.Geometry,e=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),g={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);
b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);THREE.LineSegments.call(this,d,e);this.camera=a;this.camera.updateProjectionMatrix();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=g;this.update()};
THREE.CameraHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.CameraHelper.prototype.constructor=THREE.CameraHelper;
THREE.CameraHelper.prototype.update=function(){function a(a,f,h,l){d.set(f,h,l).unproject(e);a=c[a];if(void 0!==a)for(f=0,h=a.length;f<h;f++)b.vertices[a[f]].copy(d)}var b,c,d=new THREE.Vector3,e=new THREE.Camera;return function(){b=this.geometry;c=this.pointMap;e.projectionMatrix.copy(this.camera.projectionMatrix);a("c",0,0,-1);a("t",0,0,1);a("n1",-1,-1,-1);a("n2",1,-1,-1);a("n3",-1,1,-1);a("n4",1,1,-1);a("f1",-1,-1,1);a("f2",1,-1,1);a("f3",-1,1,1);a("f4",1,1,1);a("u1",.7,1.1,-1);a("u2",-.7,1.1,
-1);a("u3",0,2,-1);a("cf1",-1,0,1);a("cf2",1,0,1);a("cf3",0,-1,1);a("cf4",0,1,1);a("cn1",-1,0,-1);a("cn2",1,0,-1);a("cn3",0,-1,-1);a("cn4",0,1,-1);b.verticesNeedUpdate=!0}}();
THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;b=b||1;var c=new THREE.Geometry;c.vertices.push(new THREE.Vector3(-b,b,0),new THREE.Vector3(b,b,0),new THREE.Vector3(b,-b,0),new THREE.Vector3(-b,-b,0),new THREE.Vector3(-b,b,0));var d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Line(c,d);this.add(this.lightPlane);
c=new THREE.Geometry;c.vertices.push(new THREE.Vector3,new THREE.Vector3);d=new THREE.LineBasicMaterial({fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(c,d);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.constructor=THREE.DirectionalLightHelper;
THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};
THREE.DirectionalLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);c.subVectors(b,a);this.lightPlane.lookAt(c);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(c);this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();
THREE.EdgesHelper=function(a,b,c){b=void 0!==b?b:16777215;THREE.LineSegments.call(this,new THREE.EdgesGeometry(a.geometry,c),new THREE.LineBasicMaterial({color:b}));this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1};THREE.EdgesHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.EdgesHelper.prototype.constructor=THREE.EdgesHelper;
THREE.FaceNormalsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;d=void 0!==d?d:1;b=0;c=this.object.geometry;c instanceof THREE.Geometry?b=c.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");c=new THREE.BufferGeometry;b=new THREE.Float32Attribute(6*b,3);c.addAttribute("position",b);THREE.LineSegments.call(this,c,new THREE.LineBasicMaterial({color:a,linewidth:d}));this.matrixAutoUpdate=
!1;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.FaceNormalsHelper.prototype.constructor=THREE.FaceNormalsHelper;
THREE.FaceNormalsHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(){this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);for(var d=this.object.matrixWorld,e=this.geometry.attributes.position,g=this.object.geometry,f=g.vertices,g=g.faces,h=0,l=0,k=g.length;l<k;l++){var m=g[l],p=m.normal;a.copy(f[m.a]).add(f[m.b]).add(f[m.c]).divideScalar(3).applyMatrix4(d);b.copy(p).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);
e.setXYZ(h,a.x,a.y,a.z);h+=1;e.setXYZ(h,b.x,b.y,b.z);h+=1}e.needsUpdate=!0;return this}}();
THREE.GridHelper=function(a,b){var c=new THREE.Geometry,d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var e=-a;e<=a;e+=b){c.vertices.push(new THREE.Vector3(-a,0,e),new THREE.Vector3(a,0,e),new THREE.Vector3(e,0,-a),new THREE.Vector3(e,0,a));var g=0===e?this.color1:this.color2;c.colors.push(g,g,g,g)}THREE.LineSegments.call(this,c,d)};THREE.GridHelper.prototype=Object.create(THREE.LineSegments.prototype);
THREE.GridHelper.prototype.constructor=THREE.GridHelper;THREE.GridHelper.prototype.setColors=function(a,b){this.color1.set(a);this.color2.set(b);this.geometry.colorsNeedUpdate=!0};
THREE.HemisphereLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;this.colors=[new THREE.Color,new THREE.Color];var c=new THREE.SphereGeometry(b,4,2);c.rotateX(-Math.PI/2);for(var d=0;8>d;d++)c.faces[d].color=this.colors[4>d?0:1];d=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:!0});this.lightSphere=new THREE.Mesh(c,d);this.add(this.lightSphere);this.update()};
THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.constructor=THREE.HemisphereLightHelper;THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};
THREE.HemisphereLightHelper.prototype.update=function(){var a=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=!0}}();
THREE.PointLightHelper=function(a,b){this.light=a;this.light.updateMatrixWorld();var c=new THREE.SphereGeometry(b,4,2),d=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});d.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,c,d);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=!1};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.constructor=THREE.PointLightHelper;
THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SkeletonHelper=function(a){this.bones=this.getBoneList(a);for(var b=new THREE.Geometry,c=0;c<this.bones.length;c++)this.bones[c].parent instanceof THREE.Bone&&(b.vertices.push(new THREE.Vector3),b.vertices.push(new THREE.Vector3),b.colors.push(new THREE.Color(0,0,1)),b.colors.push(new THREE.Color(0,1,0)));b.dynamic=!0;c=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});THREE.LineSegments.call(this,b,c);this.root=a;this.matrix=a.matrixWorld;
this.matrixAutoUpdate=!1;this.update()};THREE.SkeletonHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.SkeletonHelper.prototype.constructor=THREE.SkeletonHelper;THREE.SkeletonHelper.prototype.getBoneList=function(a){var b=[];a instanceof THREE.Bone&&b.push(a);for(var c=0;c<a.children.length;c++)b.push.apply(b,this.getBoneList(a.children[c]));return b};
THREE.SkeletonHelper.prototype.update=function(){for(var a=this.geometry,b=(new THREE.Matrix4).getInverse(this.root.matrixWorld),c=new THREE.Matrix4,d=0,e=0;e<this.bones.length;e++){var g=this.bones[e];g.parent instanceof THREE.Bone&&(c.multiplyMatrices(b,g.matrixWorld),a.vertices[d].setFromMatrixPosition(c),c.multiplyMatrices(b,g.parent.matrixWorld),a.vertices[d+1].setFromMatrixPosition(c),d+=2)}a.verticesNeedUpdate=!0;a.computeBoundingSphere()};
THREE.SpotLightHelper=function(a){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1;a=new THREE.CylinderGeometry(0,1,1,8,1,!0);a.translate(0,-.5,0);a.rotateX(-Math.PI/2);var b=new THREE.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new THREE.Mesh(a,b);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.SpotLightHelper.prototype.constructor=THREE.SpotLightHelper;
THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};THREE.SpotLightHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){var c=this.light.distance?this.light.distance:1E4,d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(b.sub(a));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();
THREE.VertexNormalsHelper=function(a,b,c,d){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16711680;d=void 0!==d?d:1;b=0;c=this.object.geometry;c instanceof THREE.Geometry?b=3*c.faces.length:c instanceof THREE.BufferGeometry&&(b=c.attributes.normal.count);c=new THREE.BufferGeometry;b=new THREE.Float32Attribute(6*b,3);c.addAttribute("position",b);THREE.LineSegments.call(this,c,new THREE.LineBasicMaterial({color:a,linewidth:d}));this.matrixAutoUpdate=!1;this.update()};
THREE.VertexNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.VertexNormalsHelper.prototype.constructor=THREE.VertexNormalsHelper;
THREE.VertexNormalsHelper.prototype.update=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(){var d=["a","b","c"];this.object.updateMatrixWorld(!0);c.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,g=this.geometry.attributes.position,f=this.object.geometry;if(f instanceof THREE.Geometry)for(var h=f.vertices,l=f.faces,k=f=0,m=l.length;k<m;k++)for(var p=l[k],n=0,q=p.vertexNormals.length;n<q;n++){var s=p.vertexNormals[n];a.copy(h[p[d[n]]]).applyMatrix4(e);
b.copy(s).applyMatrix3(c).normalize().multiplyScalar(this.size).add(a);g.setXYZ(f,a.x,a.y,a.z);f+=1;g.setXYZ(f,b.x,b.y,b.z);f+=1}else if(f instanceof THREE.BufferGeometry)for(d=f.attributes.position,h=f.attributes.normal,n=f=0,q=d.count;n<q;n++)a.set(d.getX(n),d.getY(n),d.getZ(n)).applyMatrix4(e),b.set(h.getX(n),h.getY(n),h.getZ(n)),b.applyMatrix3(c).normalize().multiplyScalar(this.size).add(a),g.setXYZ(f,a.x,a.y,a.z),f+=1,g.setXYZ(f,b.x,b.y,b.z),f+=1;g.needsUpdate=!0;return this}}();
THREE.WireframeHelper=function(a,b){var c=void 0!==b?b:16777215;THREE.LineSegments.call(this,new THREE.WireframeGeometry(a.geometry),new THREE.LineBasicMaterial({color:c}));this.matrix=a.matrixWorld;this.matrixAutoUpdate=!1};THREE.WireframeHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.WireframeHelper.prototype.constructor=THREE.WireframeHelper;THREE.ImmediateRenderObject=function(a){THREE.Object3D.call(this);this.material=a;this.render=function(a){}};
THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject;THREE.MorphBlendMesh=function(a,b){THREE.Mesh.call(this,a,b);this.animationsMap={};this.animationsList=[];var c=this.geometry.morphTargets.length;this.createAnimation("__default",0,c-1,c/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh;
THREE.MorphBlendMesh.prototype.createAnimation=function(a,b,c,d){b={start:b,end:c,length:c-b+1,fps:d,duration:(c-b)/d,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[a]=b;this.animationsList.push(b)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(a){for(var b=/([a-z]+)_?(\d+)/,c,d={},e=this.geometry,g=0,f=e.morphTargets.length;g<f;g++){var h=e.morphTargets[g].name.match(b);if(h&&1<h.length){var l=h[1];d[l]||(d[l]={start:Infinity,end:-Infinity});h=d[l];g<h.start&&(h.start=g);g>h.end&&(h.end=g);c||(c=l)}}for(l in d)h=d[l],this.createAnimation(l,h.start,h.end,a);this.firstAnimation=c};
THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){if(a=this.animationsMap[a])a.direction=1,a.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){if(a=this.animationsMap[a])a.direction=-1,a.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,b){var c=this.animationsMap[a];c&&(c.fps=b,c.duration=(c.end-c.start)/c.fps)};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,b){var c=this.animationsMap[a];c&&(c.duration=b,c.fps=(c.end-c.start)/c.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,b){var c=this.animationsMap[a];c&&(c.weight=b)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,b){var c=this.animationsMap[a];c&&(c.time=b)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var b=0;if(a=this.animationsMap[a])b=a.time;return b};
THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var b=-1;if(a=this.animationsMap[a])b=a.duration;return b};THREE.MorphBlendMesh.prototype.playAnimation=function(a){var b=this.animationsMap[a];b?(b.time=0,b.active=!0):console.warn("THREE.MorphBlendMesh: animation["+a+"] undefined in .playAnimation()")};THREE.MorphBlendMesh.prototype.stopAnimation=function(a){if(a=this.animationsMap[a])a.active=!1};
THREE.MorphBlendMesh.prototype.update=function(a){for(var b=0,c=this.animationsList.length;b<c;b++){var d=this.animationsList[b];if(d.active){var e=d.duration/d.length;d.time+=d.direction*a;if(d.mirroredLoop){if(d.time>d.duration||0>d.time)d.direction*=-1,d.time>d.duration&&(d.time=d.duration,d.directionBackwards=!0),0>d.time&&(d.time=0,d.directionBackwards=!1)}else d.time%=d.duration,0>d.time&&(d.time+=d.duration);var g=d.start+THREE.Math.clamp(Math.floor(d.time/e),0,d.length-1),f=d.weight;g!==d.currentFrame&&
(this.morphTargetInfluences[d.lastFrame]=0,this.morphTargetInfluences[d.currentFrame]=1*f,this.morphTargetInfluences[g]=0,d.lastFrame=d.currentFrame,d.currentFrame=g);e=d.time%e/e;d.directionBackwards&&(e=1-e);d.currentFrame!==d.lastFrame?(this.morphTargetInfluences[d.currentFrame]=e*f,this.morphTargetInfluences[d.lastFrame]=(1-e)*f):this.morphTargetInfluences[d.currentFrame]=f}}};

eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('M dT(ap){C.ap=ap;C.6A=1f;C.5s=1f;C.6J=1f;C.7o=1f;C.2o=1f}dT.Z.hY=M(aE){C.6A=C.2o;if(1f!==C.6A&&1f!==aE){C.5s=C.ap(aE,C.6A);C.6J=(1f!==C.6J)?12.d4(C.5s,C.6J):C.5s;C.7o=(1f!==C.7o)?12.aI(C.5s,C.7o):C.5s}C.2o=aE;11 C};dT.Z.3N=M(6M,d9){11[6M+"5s: "+C.5s,6M+"7o: "+C.7o,6M+"6J: "+C.6J,6M+"2o: "+C.2o,6M+"6A: "+C.6A,].fF(d9)};M hk(a,b){11(a>=b)?(a-b):(iD+a-b)}M ig(a,b){11(a>=b)?(a-b):(it+a-b)};M 2E(x){11(x>0)?1.0/12.1o(x):0}M ip(x,dH,eD,dP,eF){11(x-dH)*(eF-dP)/(eD-dH)+dP}M 14(1i,1h,1b,1a){C.q=W 2G(4);C.q[0]=1i;C.q[1]=1h;C.q[2]=1b;C.q[3]=1a}14.Z.3G=M(){J q=C.q;q[0]=q[1]=q[2]=q[3]=0};14.Z.1I=M(S){J q=C.q;S.q[0]=q[0];S.q[1]=q[1];S.q[2]=q[2];S.q[3]=q[3]};14.Z.1y=M(1i,1h,1b,1a){J q=C.q;q[0]=1i;q[1]=1h;q[2]=1b;q[3]=1a};14.Z.gN=M(b){J p=C.q;J q=b.q;11(p[0]==q[0])&&(p[1]==q[1])&&(p[2]==q[2])&&(p[3]==q[3])};14.Z.iT=M(29,f7,eR,hz){J q=C.q;29*=0.5;J f5=12.8j(29);J 9z=12.4U(29);q[0]=f5;q[1]=9z*f7;q[2]=9z*eR;q[3]=9z*hz};14.Z.hX=M(S){J q=C.q;J s=12.1o(1-(q[0]*q[0]));if(s!==0){S.q[0]=0;S.q[1]=q[1]/s;S.q[2]=q[2]/s;S.q[3]=q[3]/s}1k S.1y(0,0,0,0);11 2*12.ch(q[0])};14.Z.5c=M(b,S){J q=C.q;S.q[0]=q[0]*b.q[0]-q[1]*b.q[1]-q[2]*b.q[2]-q[3]*b.q[3];S.q[1]=q[0]*b.q[1]+q[1]*b.q[0]+q[2]*b.q[3]-q[3]*b.q[2];S.q[2]=q[0]*b.q[2]-q[1]*b.q[3]+q[2]*b.q[0]+q[3]*b.q[1];S.q[3]=q[0]*b.q[3]+q[1]*b.q[2]-q[2]*b.q[1]+q[3]*b.q[0]};14.Z.9c=M(b,S){J q=C.q;S.q[0]=0;S.q[1]=(q[2]*b.q[3])-(b.q[2]*q[3]);S.q[2]=-(q[1]*b.q[3])+(b.q[1]*q[3]);S.q[3]=(q[1]*b.q[2])-(b.q[1]*q[2])};14.Z.cp=M(b){J q=C.q;11(q[1]*b.q[1])+(q[2]*b.q[2])+(q[3]*b.q[3])};14.Z.hJ=M(b){J q=C.q;11(q[0]*b.q[0])+(q[1]*b.q[1])+(q[2]*b.q[2])+(q[3]*b.q[3])};14.Z.1V=M(b,S){J q=C.q;S.q[0]=q[0]*b;S.q[1]=q[1]*b;S.q[2]=q[2]*b;S.q[3]=q[3]*b};14.Z.8h=M(b,S){J q=C.q;S.q[0]=q[0]*b.q[0];S.q[1]=q[1]*b.q[1];S.q[2]=q[2]*b.q[2];S.q[3]=q[3]*b.q[3]};14.Z.2L=M(b,S){J q=C.q;S.q[0]=q[0]+b.q[0];S.q[1]=q[1]+b.q[1];S.q[2]=q[2]+b.q[2];S.q[3]=q[3]+b.q[3]};14.Z.7c=M(b,S){J q=C.q;S.q[0]=q[0]-b.q[0];S.q[1]=q[1]-b.q[1];S.q[2]=q[2]-b.q[2];S.q[3]=q[3]-b.q[3]};14.Z.hL=M(S){J 47=C.hJ(C);if(47!==0)47=1.0/47;C.62(S);S.1V(47,S)};14.Z.62=M(S){J q=C.q;S.q[0]=q[0];S.q[1]=-q[1];S.q[2]=-q[2];S.q[3]=-q[3]};14.Z.1X=M(){J q=C.q;11 12.1o(q[0]*q[0]+q[1]*q[1]+q[2]*q[2]+q[3]*q[3])};14.Z.hI=M(){J q=C.q;11 2E(q[0]*q[0]+q[1]*q[1]+q[2]*q[2]+q[3]*q[3])};14.Z.3n=M(S){J q=C.q;J 47=C.hI();S.q[0]=q[0]*47;S.q[1]=q[1]*47;S.q[2]=q[2]*47;S.q[3]=q[3]*47};14.Z.5b=M(b,S){J ba=W 14(0,0,0,0);J c6=W 14(0,0,0,0);J a9=W 14(0,0,0,0);b.3n(a9);a9.hL(c6);a9.5c(C,ba);ba.5c(c6,S)};14.Z.i9=M(S){1i=C.q[0];1h=C.q[1];1b=C.q[2];1a=C.q[3];J gW=12.1o((1i*1i)+(1h*1h)+(1b*1b)+(1a*1a));J gR=12.9Y(2*(1i*1h+1b*1a),1-2*(1h*1h+1b*1b));J 29=12.i1(2*(1i*1b-1a*1h));J gQ=12.9Y(2*(1i*1a+1h*1b),1-2*(1b*1b+1a*1a));S.q[0]=gW;S.q[1]=29;S.q[2]=gR;S.q[3]=gQ};M 51(){C.1r()}51.Z.1r=M(){C.2A=W 14(0,0,0,0)};51.Z.6m=M(5u,4x,79){4x.2L(C.2A,C.2A);C.2A.1V(0.5*5u,C.2A);79.2L(C.2A,79);4x.1I(C.2A)};M cB(){C.1r()}cB.Z.1r=M(){C.2A=W 14(0,0,0,0);C.cC=W 14(0,0,0,0);C.4z=W 14(0,0,0,0)};cB.Z.6m=M(5u,4x,79){C.2A.1V(4,C.4z);C.4z.2L(4x,C.4z);C.4z.2L(C.cC,C.4z);C.4z.1V(5u/3.0,C.4z);C.2A.1I(C.cC);4x.1I(C.2A);79.2L(C.4z,79)};M 9f(1A){C.1r();C.1A=1A}9f.Z.1r=M(){J i;C.2A=[];C.8Z=[];C.8X=0;C.2j=0;17(i=0;i<C.1A;i++){C.2A[i]=W 14(0,0,0,0);C.8Z[i]=0}};9f.Z.hA=M(5u,4x,S){if(5u===0)S.1y(0,0,0,0);1k{C.8X-=C.8Z[C.2j];C.8X+=5u;4x.7c(C.2A[C.2j],S);S.1V(1.0/C.8X,S);4x.1I(C.2A[C.2j]);C.8Z[C.2j]=5u;++C.2j;C.2j%=C.1A}};14.Z.i4=M(b,S){J q=C.q;J 2P=[q[0]*q[0],q[1]*q[1],q[2]*q[2],q[3]*q[3]];J m=[2P[0]+2P[1]-2P[2]-2P[3],2*(q[1]*q[2]-q[0]*q[3]),2*(q[1]*q[3]+q[0]*q[2]),2*(q[1]*q[2]+q[0]*q[3]),2P[0]-2P[1]+2P[2]-2P[3],2*(q[2]*q[3]-q[0]*q[1]),2*(q[1]*q[3]-q[0]*q[2]),2*(q[2]*q[3]+q[0]*q[1]),2P[0]-2P[1]-2P[2]+2P[3]];bw(S,m)};14.Z.iQ=M(){J q=C.q;cX.9b(q[0]+" "+q[1]+" "+q[2]+" "+q[3])};M 1l(hM,hH){J i,j,S=[];17(i=0;i<hM;i++){S[i]=[];17(j=0;j<hH;j++)S[i][j]=0}11 S}M bq(n){J S=1l(n,n);J i;17(i=0;i<n;i++)S[i][i]=1.0;11 S}M 1O(a,b,S){J i,j,k,ii,iA;if(a[0].19!=b.19)11 4p;17(i=0;i<a.19;i++){17(k=0;k<b[0].19;k++){S[i][k]=0;17(j=0;j<b.19;j++)S[i][k]+=a[i][j]*b[j][k]}}}M 3D(a,b,S){J i,j;17(i=0;i<a.19;i++)17(j=0;j<a[0].19;j++)S[i][j]=a[i][j]*b}M 3J(a,b,S){J i,j;17(i=0;i<a.19;i++)17(j=0;j<a[0].19;j++)S[i][j]=a[i][j]+b[i][j]}M dg(a,S){J i,j;if(a.19!=a[0].19)11 4p;17(i=0;i<a.19;i++)++a[i][i]}M e3(a,b,S){J i,j;17(i=0;i<a.19;i++)17(j=0;j<a[0].19;j++)S[i][j]=a[i][j]-b[i][j]}M iq(a,S){J i,j;if(a.19!=a[0].19)11 4p;17(i=0;i<a.19;i++)--a[i][i]}M bw(7Q,S){J i,j,k=0;17(i=0;i<S.19;i++)17(j=0;j<S[0].19;j++)S[i][j]=7Q[k++]}M iR(a,fo){J i,j,k=0;17(i=0;i<a.19;i++)17(j=0;j<a[0].19;j++)fo[k++]=a[i][j]}M iS(a){11 a.19*a[0].19}M iV(a){11 a.19}M ie(a){11 a[0].19}M 6z(a,S){J i,j;17(i=0;i<a.19;i++)17(j=0;j<a[0].19;j++)S[i][j]=a[i][j]}M 6q(a,S){J i,j;17(i=0;i<a.19;i++)17(j=0;j<a[0].19;j++)S[j][i]=a[i][j]}M dc(a,i,k){J j,1c;17(j=0;j<a[0].19;j++){1c=a[i][j];a[i][j]=a[k][j];a[k][j]=a[i][j]}}M fT(a){J i,j;17(i=0;i<a.19;i++)17(j=0;j<a[0].19;j++)a[i][j]=0}M c2(a){fT(a);17(J i=0;i<a.19;i++)a[i][i]=1}M 6t(a,1c,S){6z(a,S);J P=W 2G(S.19);J b6=(gn(S,P)==1);if(b6)gk(S,P,1c);1k b6=gs(a,S);11 b6}M gn(a,P){J i,j,k,kd=0,T;J p,t;J 27=a.19;17(i=0;i<27;i++)P[i]=i;17(k=0;k<27-1;k++){p=0;17(i=k;i<27;i++){t=a[i][k];if(t<0)t*=-1;if(t>p){p=t;kd=i}}if(p===0)11 0;T=P[kd];P[kd]=P[k];P[k]=T;17(i=0;i<27;i++){t=a[kd][i];a[kd][i]=a[k][i];a[k][i]=t}17(i=k+1;i<27;i++){a[i][k]=a[i][k]/a[k][k];17(j=k+1;j<27;j++)a[i][j]-=a[i][k]*a[k][j]}}11 1}M gk(a,P,1c){J i,j,n,m;J t;J 27=a.19;J X=W 2G(27);J Y=W 2G(27);17(n=0;n<27;n++)X[n]=Y[n]=0;17(i=0;i<27;i++){17(j=0;j<27;j++)1c[i][j]=0;1c[i][i]=1;17(n=0;n<27;n++){t=0;17(m=0;m<=n-1;m++)t+=a[n][m]*Y[m];Y[n]=1c[i][P[n]]-t}17(n=27-1;n>=0;n--){t=0;17(m=n+1;m<27;m++)t+=a[n][m]*X[m];X[n]=(Y[n]-t)/a[n][n]}17(j=0;j<27;j++)1c[i][j]=X[j]}17(i=0;i<27;i++)17(j=0;j<27;j++)a[i][j]=1c[j][i];11 0}M iF(a,S){6z(a,S);J n=S.19;J 5X;J k,i,j;J 3l;J 8I=[];17(k=0;k<n;k++){3l=0;17(i=k;i<n;i++)if(12.1C(S[i][k])>=3l){3l=12.1C(S[i][k]);5X=i}if(S[5X][k]===0)11 0;if(5X!=k){17(j=0;j<n;j++){3l=S[k][j];S[k][j]=S[5X][j];S[5X][j]=3l}}8I[k]=5X;3l=1/S[k][k]; S[k][k]=1;17(j=0;j<n;j++)S[k][j]=S[k][j]*3l;17(i=0;i<n;i++)if(i!=k){3l=S[i][k];S[i][k]=0;17(j=0;j<n;j++)S[i][j]=S[i][j]-S[k][j]*3l}}17(k=n-1;k>=0;k--)if(8I[k]!=k)17(i=0;i<n;i++){3l=S[i][k];S[i][k]=S[i][8I[k]];S[i][8I[k]]=3l}11 1}M gs(a,S){c2(S);gC(a,S)}M gC(a,S){if(a.19!=a[0].19)11 4p;if(S.19!=a.19)11 4p;J i,j,k,n=a.19;J 2i;17(i=0;i<n;i++){17(k=i;k<n;k++)if(a[k][i]!==0){if(k!=i){dc(a,i,k);dc(S,i,k)}1x}if(k==n)11 0;if(a[i][i]!=1){2i=1.0/a[i][i];17(j=0;j<a[0].19;j++)a[i][j]*=2i;17(j=0;j<S[0].19;j++)S[i][j]*=2i}17(k=0;k<n;k++){if((k!=i)&&(a[k][i])!==0){2i=a[k][i];17(j=0;j<a[0].19;j++)a[k][j]-=2i*a[i][j];17(j=0;j<S[0].19;j++)S[k][j]-=2i*S[i][j]}}}11 1}M i2(a,S){if(a.19!=a[0].19)11 4p;if(S.19!=S[0].19)11 4p;if(S.19!=a.19)11 4p;J i,j,k;17(i=0;i<a.19;i++)17(j=0;j<(i+1);j++){J s=0;17(k=0;k<j;k++)s+=S[i][k]*S[j][k];S[i][j]=(i==j)?12.1o(a[i][i]-s):(1.0/S[j][j]*(a[i][j]-s))}}M eC(A,1z,Q,D){J gu=24;J k0,k1,k2;J o=[0.0,0.0,0.0];J m=[0.0,0.0,0.0];J q=[0.0,0.0,0.0,1.0];J jr=[0.0,0.0,0.0,0.0];J 8d,8T,7y,7I;J 4d,4g,mq;J 4m,8e,t,c;17(J i=0;i<gu;++i){8T=q[0]*q[0];7y=q[1]*q[1];7I=q[2]*q[2];8d=q[3]*q[3];Q[0][0]=(8T-7y-7I+8d);Q[1][1]=(-8T+7y-7I+8d);Q[2][2]=(-8T-7y+7I+8d);4d=q[0]*q[1];4g=q[2]*q[3];Q[1][0]=2.0*(4d+4g);Q[0][1]=2.0*(4d-4g);4d=q[0]*q[2];4g=q[1]*q[3];Q[2][0]=2.0*(4d-4g);Q[0][2]=2.0*(4d+4g);4d=q[1]*q[2];4g=q[0]*q[3];Q[2][1]=2.0*(4d+4g);Q[1][2]=2.0*(4d-4g);1z[0][0]=Q[0][0]*A[0][0]+Q[1][0]*A[0][1]+Q[2][0]*A[0][2];1z[0][1]=Q[0][1]*A[0][0]+Q[1][1]*A[0][1]+Q[2][1]*A[0][2];1z[0][2]=Q[0][2]*A[0][0]+Q[1][2]*A[0][1]+Q[2][2]*A[0][2];1z[1][0]=Q[0][0]*A[0][1]+Q[1][0]*A[1][1]+Q[2][0]*A[1][2];1z[1][1]=Q[0][1]*A[0][1]+Q[1][1]*A[1][1]+Q[2][1]*A[1][2];1z[1][2]=Q[0][2]*A[0][1]+Q[1][2]*A[1][1]+Q[2][2]*A[1][2];1z[2][0]=Q[0][0]*A[0][2]+Q[1][0]*A[1][2]+Q[2][0]*A[2][2];1z[2][1]=Q[0][1]*A[0][2]+Q[1][1]*A[1][2]+Q[2][1]*A[2][2];1z[2][2]=Q[0][2]*A[0][2]+Q[1][2]*A[1][2]+Q[2][2]*A[2][2];D[0][0]=1z[0][0]*Q[0][0]+1z[1][0]*Q[1][0]+1z[2][0]*Q[2][0];D[0][1]=1z[0][0]*Q[0][1]+1z[1][0]*Q[1][1]+1z[2][0]*Q[2][1];D[0][2]=1z[0][0]*Q[0][2]+1z[1][0]*Q[1][2]+1z[2][0]*Q[2][2];D[1][0]=1z[0][1]*Q[0][0]+1z[1][1]*Q[1][0]+1z[2][1]*Q[2][0];D[1][1]=1z[0][1]*Q[0][1]+1z[1][1]*Q[1][1]+1z[2][1]*Q[2][1];D[1][2]=1z[0][1]*Q[0][2]+1z[1][1]*Q[1][2]+1z[2][1]*Q[2][2];D[2][0]=1z[0][2]*Q[0][0]+1z[1][2]*Q[1][0]+1z[2][2]*Q[2][0];D[2][1]=1z[0][2]*Q[0][1]+1z[1][2]*Q[1][1]+1z[2][2]*Q[2][1];D[2][2]=1z[0][2]*Q[0][2]+1z[1][2]*Q[1][2]+1z[2][2]*Q[2][2];o[0]=D[1][2];o[1]=D[0][2];o[2]=D[0][1];m[0]=12.1C(o[0]);m[1]=12.1C(o[1]);m[2]=12.1C(o[2]);k0=(m[0]>m[1]&&m[0]>m[2])?0:(m[1]>m[2])?1:2;k1=(k0+1)%3;k2=(k0+2)%3;if(o[k0]===0.0)1x;4m=(D[k2][k2]-D[k1][k1])/(2.0*o[k0]);8e=(4m>0.0)?1.0:-1.0;4m*=8e;t=8e/(4m+((4m<1.i5)?12.1o(4m*4m+1.0):4m)); c=1.0/12.1o(t*t+1.0);if(c==1.0)1x;jr[0]=jr[1]=jr[2]=jr[3]=0.0;jr[k0]=8e*12.1o((1.0-c)/2.0);jr[k0]*=-1.0;jr[3]=12.1o(1.0-jr[k0]*jr[k0]);if(jr[3]==1.0)1x;q[0]=(q[3]*jr[0]+q[0]*jr[3]+q[1]*jr[2]-q[2]*jr[1]);q[1]=(q[3]*jr[1]-q[0]*jr[2]+q[1]*jr[3]+q[2]*jr[0]);q[2]=(q[3]*jr[2]+q[0]*jr[1]-q[1]*jr[0]+q[2]*jr[3]);q[3]=(q[3]*jr[3]-q[0]*jr[0]-q[1]*jr[1]-q[2]*jr[2]);mq=12.1o(q[0]*q[0]+q[1]*q[1]+q[2]*q[2]+q[3]*q[3]);q[0]/=mq;q[1]/=mq;q[2]/=mq;q[3]/=mq}}M hZ(m,9y){J 6b,s,q=9y.q;J i,j,k;J cY=[1,2,0];6b=m[0][0]+m[1][1]+m[2][2];if(6b>0.0){s=12.1o(6b+1.0);q[0]=s*0.5;s=0.5/s;q[1]=(m[1][2]-m[2][1])*s;q[2]=(m[2][0]-m[0][2])*s;q[3]=(m[0][1]-m[1][0])*s}1k{i=0;if(m[1][1]>m[0][0])i=1;if(m[2][2]>m[i][i])i=2;j=cY[i];k=cY[j];s=12.1o((m[i][i]-(m[j][j]+m[k][k]))+1.0);q[i]=s*0.5;if(s!==0.0)s=0.5/s;q[3]=(m[j][k]-m[k][j])*s;q[j]=(m[i][j]+m[j][i])*s;q[k]=(m[i][k]+m[k][i])*s}}M h8(m,9y){J 6b=m[0][0]+m[1][1]+m[2][2];J s;J q=9y.q;if(6b>0){s=12.1o(6b+1.0)*2;q[0]=0.25*s;q[1]=(m[2][1]-m[1][2])/s;q[2]=(m[0][2]-m[2][0])/s;q[3]=(m[1][0]-m[0][1])/s}1k if((m[0][0]>m[1][1])&(m[0][0]>m[2][2])){s=12.1o(1.0+m[0][0]-m[1][1]-m[2][2])*2;q[0]=(m[2][1]-m[1][2])/s;q[1]=0.25*s;q[2]=(m[0][1]+m[1][0])/s;q[3]=(m[0][2]+m[2][0])/s}1k if(m[1][1]>m[2][2]){s=12.1o(1.0+m[1][1]-m[0][0]-m[2][2])*2;q[0]=(m[0][2]-m[2][0])/s;q[1]=(m[0][1]+m[1][0])/s;q[2]=0.25*s;q[3]=(m[1][2]+m[2][1])/s}1k{s=12.1o(1.0+m[2][2]-m[0][0]-m[1][1])*2;q[0]=(m[1][0]-m[0][1])/s;q[1]=(m[0][2]+m[2][0])/s;q[2]=(m[1][2]+m[2][1])/s;q[3]=0.25*s}};M 3K(){C.1r()}3K.Z.1r=M(){C.n=0;C.2a=0;C.3c=0;C.7j=0;C.s=0;C.a5=0};3K.Z.1S=M(x){++C.n;if(C.n==1){C.7j=C.2a=x;C.a5=0.0}1k{C.2a=C.7j+(x-C.7j)/C.n;C.s=C.a5+((x-C.7j)*(x-C.2a));C.7j=C.2a;C.a5=C.s;C.3c=C.s/(C.n-1)}};3K.Z.8c=M(){11 12.1o(C.3c)};M 7A(N,a4,ai){C.7n=W 3K();C.1r(N,a4,ai)}7A.Z.1r=M(N,a4,ai){C.N=N;C.2a=a4;C.3c=ai;C.ac=[];C.s=0;C.7n.1r()};7A.Z.1S=M(x){J ah;J 8S=0;C.ac.3o(x);2v(C.ac.19>C.N)8S=C.ac.3F();J n=C.7n.n;if(n<C.N){C.7n.1S(x);C.3c=C.7n.3c;C.2a=C.7n.2a;C.s=C.3c*C.N}1k{ah=C.2a+(x-8S)/C.N;C.s+=(x+8S-C.2a-ah)*(x-8S);C.3c=C.s/C.N;C.2a=ah}};7A.Z.8c=M(){11 12.1o(C.3c)};M bN(){C.1r()}bN.Z.1r=M(){C.n=0;C.40=0;C.41=0;C.2Q=0;C.9R=0;C.2J=0;C.m=1;C.b=0;C.hW=0};bN.Z.1S=M(bm,aW){++C.n;J 2S=1/C.n;J 5Z=(C.n-1)*2S;J 44=bm-C.40;J 4N=aW-C.41;J 4P,6E;C.2Q+=(5Z*44*44-C.2Q)*2S;C.9R+=(5Z*4N*4N-C.9R)*2S;C.2J+=(5Z*44*4N-C.2J)*2S;C.40+=44*2S;C.41+=4N*2S;if((C.2Q===0)||(C.2J===0))11 1e;4P=C.2J/C.2Q;6E=C.41-(4P*C.40);C.m=1/4P;C.b=6E;C.r=(C.2J*C.2J)/(C.2Q*C.9R)};M dV(N){C.1r(N)}dV.Z.1r=M(N){C.dG=0.5;C.g9=3.5;C.4o=0;C.8f=W 7A(N,0,i3);C.a8=0};dV.Z.1S=M(x){J 7s=0;J ia=x;J S=0;if((12.1C(x)-C.8f.2a)>(C.8f.8c()*C.g9))7s=(x>C.8f.2a)?1:-1;C.a8=(x*(1-C.dG))+(C.a8*C.dG);C.8f.1S(C.a8);if((7s!==0)&&(C.4o!=7s))S=7s;C.4o=7s;11 S};M i6(2a,8c){J u,v,r;do{u=2*12.g7()-1;v=2*12.g7()-1;r=u*u+v*v}2v(r===0||r>1);J c=12.1o(-2*12.9b(r)/r);11 2a+u*c*8c};1p.i7=fv;1p.gv=ib;1p.fZ=4;1p.gb=3;1p.fY=4;1p.fV=1p.gb*1p.fY;1p.7k=1p.fV*1p.fZ;1p.8s=i8;1p.g0=1p.8s+0;1p.g4=1p.g0+2;1p.g3=1p.g4+2;1p.g2=1p.g3+2;1p.g1=1p.g2+1p.7k;1p.gg=1p.g1+1p.7k;1p.gh=1p.gg+1p.7k;1p.gw=1p.gh+1p.7k;1p.ic=1p.gw+1p.7k;1p.cl=1p.8s+1p.gv;M 1p(52){C.1r(52)}1p.Z.1r=M(52){C.52=52};1p.Z.bs=M(1R,1B){J i;J n=1B.19;if((1R<1p.8s)||((n+1R)>1p.cl))11 1e;J 4b=1R.3N(16);4b=(\'7z\'+4b).3X(4b.19);J 4c=n.3N(16);4c=(\'7z\'+4c).3X(4c.19);J 6T="$e$F"+4b+4c;17(i=0;i<1B.19;i++){if((1B[i]<0)||(1B[i]>4y))11 1e;J dd=1B[i].3N(16);dd=(\'fN\'+dd).3X(dd.19);6T+=dd}6T+="$E";$1N.5z(6T);11 1t};1p.Z.gA=M(S){C(S.84)};1p.Z.cZ=M(S){J i,j=0,n=S.84.19;if(n%4)11;J r=S.84;J a=W 2G(n/4);17(i=0;i<n;i+=4){if(C.cr.52)a[j]=(r[i+3]<<24)|(r[i+2]<<16)|(r[i+1]<<8)|r[i+0];1k a[j]=(r[i+0]<<24)|(r[i+1]<<16)|(r[i+2]<<8)|r[i+3];a[j]=C.cr.gj(a[j]>>>0);++j}C(a)};1p.Z.bd=M(1R,2M,2C){if((1R<1p.8s)||((2M+1R)>1p.cl))11 1e;J 4b=1R.3N(16);4b=(\'7z\'+4b).3X(4b.19);J 4c=2M.3N(16);4c=(\'7z\'+4c).3X(4c.19);2C.cr=C;11"$e$f"+4b+4c};1p.Z.i0=M(1R,2M,2C){J 4q=C.bd(1R,2M,2C);if(4q)$1N.5v(4q,C.gA.2l(2C))};1p.Z.iW=M(1R,2C){J 4q=C.bd(1R,4,2C);if(4q)$1N.5v(4q,C.cZ.2l(2C))};1p.Z.iJ=M(1R,f){f=C.co(f);J 1B=W 2G(4);J i;17(i=0;i<4;i++){J 2j=C.52?i:3-i;1B[i]=(f>>(i*8))&4y}11 C.bs(1R,1B)};1p.Z.iK=M(1R,b0,2C){J 4q=C.bd(1R,4*b0,2C);if(4q)$1N.5v(4q,C.cZ.2l(2C))};1p.Z.iH=M(1R,b5){J i,j,f,2s=0;J b0=b5.19;J 1B=W 2G(b0*4);17(i=0;i<b5.19;i++){f=C.co(b5[i]);17(j=0;j<4;j++){J 2j=C.52?j:3-j;1B[2s+2j]=(f>>(j*8))&4y}2s+=4}11 C.bs(1R,1B)};1p.Z.gj=M(aN){J 4Z=aN.3N(2);if(4Z.19<32)4Z=(\'iG\'+4Z).3X(4Z.19);J 5T=(4Z.5W(0)==\'1\')?-1:1;J 5p=2K(4Z.3X(1,8),2)-5N;J b4=4Z.3X(9);J bh=\'1\'+b4;J i=0;J an=1;J cE=0;if(5p==-5N){if(b4.iN(\'1\')==-1)11 0;1k{5p=-bp;bh=\'0\'+b4}}2v(i<bh.19){cE+=an*2K(bh.5W(i));an=an/2;i++}11 5T*cE*12.iC(2,5p)};1p.Z.co=M(aN){J n=+aN;J 2m=(n!==n)||n==-8n||n==+8n?n:0;J 48=0;J 4s=im;J 33=W 2G(4s);J dm=(n=2m!==0?0:n)<0;n=12.1C(n);J 67=12.bK(n);J 7U=n-67;J i,7J,7h,j,5p;if(2m!==0){if(n!==n)11 io;if(n===8n)11 il;if(n===-8n)11 ik}i=4s;2v(i)33[--i]=0;i=gG;2v(67&&i){33[--i]=67%2;67=12.bK(67/2)}i=8l;2v(7U>0&&i){7U*=2;33[++i]=(7U>=1)?1:0;--7U}i=-1;2v(++i<4s&&!33[i]);if(33[(7J=22+(i=(48=8l-i)>=-bp&&48<=5N?i+1:8l-(48=-5N)))+1]){if(!(7h=33[7J])){j=7J+2;2v(!7h&&j<4s)7h=33[j++]}j=7J+1;2v(7h&&--j>=0){33[j]=1-33[j];7h=0}}i=i-2<0?-1:i-3;2v(++i<4s&&!33[i]);J x=(48=8l-i)>=-bp&&48<=5N?++i:48<-bp&&(i=d5,48=-5N);J y=(67||2m!==0)&&(48=8l,i=gG,2m==-8n?dm=1:(2m!==2m)&&(33[i]=1));n=12.1C(48+5N);5p=0;j=0;2v(j<8){5p+=(n%2)<<j;n>>=1;j++}J bc=0;n=i+23;17(;i<n;i++)bc=(bc<<1)+33[i];11(((dm?iz:0)+(5p<<23)+bc)|0)>>>0};1q.fG=0;1q.9a=1;1q.96=2;1q.e2=3;1q.cR=4;1q.fH=5;1q.fC=0;1q.gF=1;1q.hB=2;1q.hC=3;1q.hD=4;1q.hE=5;M 1q(b9,3z,2N,3e,3B,1A,3g){C.1r(b9,3z,2N,3e,3B,1A,3g)}1q.Z.1r=M(b9,3z,2N,3e,3B,1A,3g){C.1F=b9;C.3B=3B;C.1A=C.dC(1A);C.4E=C.1A+1;C.2N=2N;C.3e=3e;C.3g=3g;C.6X=0;C.8Y=W 2G(C.3B+1);C.4X=W 2G(C.3B+1);C.71=W 2G(C.3B+1);C.3z=1q.fC;C.aR();C.ds(3z)};1q.Z.aR=M(){J i;17(i=0;i<C.3B+1;i++)C.8Y[i]=0;C.6X=0};1q.Z.iB=M(1F){if((C.1F==1F)||(1F<0)||(1F>=1q.fH))11;C.1F=1F;if(C.1F==1q.cR)C.ei();1k C.9s(C.2N,C.3e)};1q.Z.iy=M(){11 C.1F};1q.Z.ix=M(3g){C.3g=3g;C.9s(C.2N,C.3e)};1q.Z.iu=M(){11 C.3g};1q.Z.9s=M(2N,3e){C.2N=2N;C.3e=3e;J 8b=1f;6k(C.1F){1E 1q.fG:1E 1q.9a:8b=C.hU.2l(C);1x;1E 1q.96:1E 1q.e2:8b=C.hP.2l(C);1x;7l:1x}if(8b!==1f)8b()};1q.Z.iv=M(){11 C.2N};1q.Z.iw=M(1A){C.1A=C.dC(1A);C.4E=C.1A+1;C.ds(C.3z)};1q.Z.iU=M(){11 C.1A};1q.Z.ds=M(3z){C.3z=3z;J 4Y=1f;6k(C.3z){1E 1q.gF:4Y=C.gU.2l(C);1x;1E 1q.hB:4Y=C.ho.2l(C);1x;1E 1q.hC:4Y=C.f9.2l(C);1x;1E 1q.hD:4Y=C.h2.2l(C);1x;1E 1q.hE:4Y=C.h1.2l(C);1x;7l:1x}if(4Y!==1f)4Y();if(C.1F==1q.cR)C.ei();1k C.9s(C.2N,C.3e)};1q.Z.ij=M(){11 C.3z};1q.Z.1S=M(4G){J i;J 1Y=0;C.8Y[C.6X]=4G;17(i=0;i<C.4E;i++)1Y+=C.8Y[(i+C.6X)%C.4E]*C.71[i];++C.6X;C.6X%=C.4E;11 1Y};1q.Z.ih=M(1L){J hS=1L.19;J 4G,i;17(4G=0;4G<hS;4G++)1L[4G]=C.1S(1L[4G])};1q.Z.dC=M(1A){if(1A%2)--1A;if(1A>C.3B)1A=C.3B;if(1A<0)1A=0;11 1A};1q.Z.ei=M(){J i;17(i=0;i<C.4E;i++)C.71[i]=0;C.71[C.1A/2]=1};1q.Z.hU=M(){J i,n=C.4E;J 4K=C.1A/2;J eb=C.2N/C.3g;J hV=(2*12.4f)*eb;J 4J;J 1c;17(i=0;i<n;i++){if(i!=4K){4J=i-4K;1c=12.4U(hV*4J);1c/=12.4f*4J;if(C.1F==1q.9a)1c*=-1}1k{1c=2.0*eb;if(C.1F==1q.9a)1c=1-1c}1c*=C.4X[i];C.71[i]=1c}};1q.Z.hP=M(){J en=C.3e*0.5/C.3g;J i,n=C.4E;J 4K=C.1A/2;J 6p=(C.2N/C.3g);J 8p=6p+en;6p-=en;if(6p<0.0)6p=0.0;if(8p>0.5)8p=0.5;J eq=(2*12.4f)*6p;J es=(2*12.4f)*8p;J hO=(C.1F==1q.96)?es:eq;J hn=(C.1F==1q.96)?eq:es;J 1c;17(i=0;i<n;i++){if(i!=4K){4J=i-4K;1c=12.4U(hO*4J);1c-=12.4U(hn*4J);1c/=12.4f*4J}1k{1c=2*(8p-6p);if(C.1F==1q.e2)1c=1-1c}1c*=C.4X[i];C.71[i]=1c}};1q.Z.gU=M(){J i,n=C.1A+1;17(i=0;i<n;i++)C.4X[i]=1};1q.Z.ho=M(){J i,n=C.1A+1;J 4K=C.1A/2;J gS=2.0/C.1A;17(i=0;i<n;i++){C.4X[i]=1-(gS*12.1C(i-4K))}};1q.Z.f9=M(){J i,n=C.1A+1;J 4a=0;J 6Y=(2*12.4f)/C.1A;17(i=0;i<n;i++){C.4X[i]=0.5*(1-12.8j(4a));4a+=6Y}};1q.Z.h2=M(){J i,n=C.1A+1;J 4a=0;J 6Y=(2*12.4f)/C.1A;17(i=0;i<n;i++){C.4X[i]=0.54-0.46*12.8j(4a);4a+=6Y}};1q.Z.h1=M(){J i,n=C.1A+1;J 4a=0;J 6Y=(2*12.4f)/C.1A;J a=0;J a0=(1-a)/2.0;J a1=1/2.0;J a2=a/2.0;17(i=0;i<n;i++){C.4X[i]=a0-a1*12.8j(4a)+a2*12.8j(2*4a);4a+=6Y}};1d.7m=0;1d.7M=1;1d.4Q=2;1d.7t=3;1d.5B=5;1d.ag=6;1d.gK=0;1d.cj=1;1d.h3=1.0;1d.hg=5;1d.gP=1.5;1d.hf=2;1d.8z=0.iP;1d.7b=1.0;1d.7K=1.0;1d.iO=5;1d.hh=3;M 1d(){C.1r();C.e1=1d.gK}1d.Z.1r=M(){C.3r=W 14(0,0,0,0);C.7C=W 14(0,0,0,0);C.dS=W 14(0,0,0,0);C.39=W 14(0,0,0,0);C.by=0;C.gL=W 51();C.gM=W 51();C.3f=0;C.7w=0;C.a6=0;C.8m=0;C.9d=0;C.4e=W 14(0,0,0,0);C.9E=W 3K();C.9S=W 3K();C.9T=W 3K();C.6r=0;C.5x=0;C.7p=0;C.2Z=0;C.5y=9.bE;C.2F=1e;C.bL=0;C.1D=1d.7t;C.br=1e;C.9o=1e;C.1G=0;C.4u=0.9;C.6o=W 14(0,0,0,0);C.6e=W 14(0,0,0,0);C.6d=W 14(0,0,0,0);C.3m=W 14(0,0,0,0)};1d.Z.1S=M(1j,1n,g,a){a.1I(C.dS);a.5b(1n,C.39);C.39.q[3]-=C.5y;C.by=g.1X();g.5b(1n,C.4e);C.9o=C.9w(1j);C.gJ(1j,g,a);C.bL++;11 C.br};1d.Z.gJ=M(1j,g,a){J 1c=W 14(0,0,0,0);C.39.1I(1c);1c.1V(1.0-C.4u,1c);C.6o.1V(C.4u,C.6o);C.6o.2L(1c,C.6o);C.6o.1I(1c);1c.1V(1.0-C.4u,1c);C.6e.1V(C.4u,C.6e);C.6e.2L(1c,C.6e);C.6e.1I(1c);1c.1V(1.0-C.4u,1c);C.6d.1V(C.4u,C.6d);C.6d.2L(1c,C.6d);C.6d.1I(1c);1c.1V(1.0-C.4u,1c);C.3m.1V(C.4u,C.3m);C.3m.2L(1c,C.3m);if(C.1D==1d.4Q){J dX=C.39.1X();if(dX>C.3f)C.3f=dX}if((C.1D==1d.4Q)||(C.1D==1d.5B)||(C.1D==1d.7M))C.gL.6m(1j,C.39,C.7C);1k C.7C.3G();J cH=C.7C.1X();if((C.1D==1d.4Q)||(C.1D==1d.5B))C.2Z+=0.5*(C.7O+cH)*1j;C.7O=cH;if(C.7O>C.7w)C.7w=C.7O;if(C.1D==1d.5B){C.9E.1S(C.4e.q[1]);C.9S.1S(C.4e.q[2]);C.9T.1S(C.4e.q[3])}C.gM.6m(1j,C.7C,C.3r);if(C.3r.q[3]>C.7p)C.7p=C.3r.q[3]};1d.Z.9w=M(1j){J S=1e;J hj=C.1D;C.1G+=1j;6k(C.1D){1E 1d.7m:if(C.e1==1d.cj){if(C.bF(0,0,-C.5y,1d.7K)){C.1D=1d.7M;C.1G=0;C.bk()}}1k{if(!C.6I(0,0,0,1d.7b)){C.1D=1d.4Q;C.1G=0;C.bk()}}1x;1E 1d.7M:if(!C.6I(0,0,-C.5y,1d.7b)){C.1D=1d.4Q;C.1G=C.5x=0;C.6o.3G();C.6e.3G();C.6d.3G();C.3m.3G()}1k if(C.1G>=1d.gP){C.1D=1d.7m;C.1G=0}1x;1E 1d.4Q:if((C.bF(0,0,-C.5y,1d.7K))){C.1D=1d.5B;C.5x=C.1G;C.1G=0}1k if(C.1G>=1d.h3){C.1D=1d.7t;C.1G=0;C.2F=1e}1k if(C.6I(0,0,0,1d.7b)){C.1D=1d.7m;C.1G=0;C.2F=1e}1x;1E 1d.5B:if(C.dS.1X()>1d.hh){C.1D=1d.ag;C.2F=1e;C.hm();C.1G=0;if(C.e1==1d.cj)S=C.6r>1;1k S=1t}1k if(C.1G>=1d.hg){C.1D=1d.7t;C.1G=0;C.2F=1e}1x;1E 1d.7t:1E 1d.ag:if((C.by<1d.8z)&&(C.1G>1d.hf)){C.1D=1d.7m;C.1G=0}1x;7l:1x}C.br=C.1D!=hj;11 S};1d.Z.bk=M(){C.3r.3G();C.3f=0;C.7w=0;C.a6=0;C.6r=0;C.5x=0;C.7p=0;C.bL=0;C.2Z=0;C.2F=1t;C.9E.1r();C.9S.1r();C.9T.1r()};1d.Z.hm=M(){C.5x+=C.1G;J t=0.5*C.5x;C.7p=C.5y*t*t/2;C.6r=12.iM(C.3r.q[1],C.3r.q[2]);C.4e.1y(0,C.9E.2a,C.9S.2a,C.9T.2a);C.a6=C.4e.1X();C.9d=C.4e.q[3];C.8m=(C.3r.q[1]*C.4e.q[2])+(C.3r.q[2]*-C.4e.q[1]);if(C.6r>0)C.8m/=C.6r};1d.Z.6I=M(x,y,z,2d){11((C.39.q[1]<x+2d)&&(C.39.q[1]>x-2d)&&(C.39.q[2]<y+2d)&&(C.39.q[2]>y-2d)&&(C.39.q[3]<z+2d)&&(C.39.q[3]>z-2d))};1d.Z.bF=M(x,y,z,2d){11((C.3m.q[1]<x+2d)&&(C.3m.q[1]>x-2d)&&(C.3m.q[2]<y+2d)&&(C.3m.q[2]>y-2d)&&(C.3m.q[3]<z+2d)&&(C.3m.q[3]>z-2d))};1d.Z.ha=M(2x,7L){J S;if((2x!==0)&&(7L!==0)){J bD=7L*7L;J bJ=2x*2;S=12.1o(bD+4*2x*2x);S+=(bD/bJ)*12.iE(bJ/7L)}1k S=12.1C(2*2x);11 S};1d.Z.hc=M(2x,h6,2Z){J S=0;if((2x!==0)&&(2Z>0)){S=2Z*0.5;S*=S;S-=h6;S=12.1o(S)}11 S};1d.Z.iI=M(2x,2Z){J S=0;if((2x!==0)&&(2Z>0)){J hb=2x*2x;J l;J 2Y=0;J i,gT=iL;S=C.hc(2x,hb,2Z);17(i=0;i<gT;i++){l=C.ha(2x,S);2Y=(l-2Z)/2Z;if(12.1C(2Y)<=0.eP)1x;S*=1-2Y}}11 S};M bA(){C.1r()}bA.Z.1r=M(){C.1n=W 14(1,0,0,0);C.bu=1l(3,3);C.a7=1l(3,3);C.I=bq(3);C.9H=bq(3);C.9Q=1l(3,3);C.cG=1l(3,3);C.1c=1l(3,3);C.7G=1l(3,3);C.cn=1l(3,3)};bA.Z.6f=M(gx,gy,gz){J h9=[0,-gz,gy,gz,0,-gx,-gy,gx,0];6z(C.a7,C.bu);bw(h9,C.a7);3J(C.a7,C.bu,C.1c);3D(C.1c,0.25*C.1j,C.9Q);3D(C.9Q,-1,C.cG);3J(C.I,C.9Q,C.cn);3J(C.I,C.cG,C.7G);C.1c=6t(C.7G);6z(C.1c,C.7G);1O(C.9H,C.cn,C.1c);1O(C.1c,C.7G,C.9H);h8(C.9H,C.1n)};M 7r(){C.1r()}7r.Z.1r=M(){C.1n=W 14(1,0,0,0);C.3L=1t;C.1W=1.5;C.50=9.18;C.85=0.13*C.50};7r.Z.h5=M(ax,ay,az,mx,my,mz,q){J 2T=W 14(0,0,0,0);J a=W 14(0,0,0,0);a.1y(0,ax,ay,az);a.3n(a);ax=a.q[1];ay=a.q[2];az=a.q[3];if(az>=0){a.q[0]=12.1o((az+1)*0.5);a.q[1]=-ay/(2.0*a.q[0]);a.q[2]=ax/(2.0*a.q[0]);a.q[3]=0}1k{J X=12.1o((1-az)*0.5);a.q[0]=-ay/(2.0*X);a.q[1]=X;a.q[2]=0;a.q[3]=ax/(2.0*X)}J lx=(a.q[0]*a.q[0]+a.q[1]*a.q[1]-a.q[2]*a.q[2])*mx+2.0*(a.q[1]*a.q[2])*my-2.0*(a.q[0]*a.q[2])*mz;J ly=2.0*(a.q[1]*a.q[2])*mx+(a.q[0]*a.q[0]-a.q[1]*a.q[1]+a.q[2]*a.q[2])*my+2.0*(a.q[0]*a.q[1])*mz;J 3x=lx*lx+ly*ly;J 1W=12.1o(3x+lx*12.1o(3x));2T.1y(1W/(12.1o(2.0*3x)),0,0,ly/(12.1o(2.0)*1W));a.5c(2T,q)};7r.Z.ab=M(1j,gx,gy,gz,ax,ay,az,mx,my,mz){if(C.3L){if((mx===0.0)&&(my===0.0)&&(mz===0.0))11;1k{C.h5(ax,ay,az,mx,my,mz,C.1n);C.1n.62(C.1n);C.3L=1e;11}}J 1i=C.1n.q[0];J 1h=C.1n.q[1];J 1b=C.1n.q[2];J 1a=C.1n.q[3];J 1Q=1.0/1j;J 1W=C.1W;J 1m;J 3d,3w,3t,3u;J 4S,4W,4L,4I;J hx,hy;J af,a3,ad,97,1U,1T,9p,99,4R,43,42,4M,6R,78,3s,2w,2p,3R,26,3P,2b,1K,3p,2g;if((mx===0.0)&&(my===0.0)&&(mz===0.0)){C.6f(1j,gx,gy,gz,ax,ay,az);11}4S=0.5*(-1h*gx-1b*gy-1a*gz);4W=0.5*(1i*gx+1b*gz-1a*gy);4L=0.5*(1i*gy-1h*gz+1a*gx);4I=0.5*(1i*gz+1h*gy-1b*gx);if(!((ax===0.0)&&(ay===0.0)&&(az===0.0))){J 6V=12.1o(ax*ax+ay*ay+az*az);if(12.1C(6V-C.50)<=C.85){1m=2E(ax*ax+ay*ay+az*az);ax*=1m;ay*=1m;az*=1m;1m=2E(mx*mx+my*my+mz*mz);mx*=1m;my*=1m;mz*=1m;af=2.0*1i*mx;a3=2.0*1i*my;ad=2.0*1i*mz;97=2.0*1h*mx;4R=2.0*1i;43=2.0*1h;42=2.0*1b;4M=2.0*1a;6R=2.0*1i*1b;78=2.0*1b*1a;3s=1i*1i;2w=1i*1h;2p=1i*1b;3R=1i*1a;26=1h*1h;3P=1h*1b;2b=1h*1a;1K=1b*1b;3p=1b*1a;2g=1a*1a;hx=mx*3s-a3*1a+ad*1b+mx*26+43*my*1b+43*mz*1a-mx*1K-mx*2g;hy=af*1a+my*3s-ad*1h+97*1b-my*26+my*1K+42*mz*1a-my*2g;1U=12.1o(hx*hx+hy*hy);1T=-af*1b+a3*1h+mz*3s+97*1a-mz*26+42*my*1a-mz*1K+mz*2g;9p=2.0*1U;99=2.0*1T;3d=-42*(2.0*2b-6R-ax)+43*(2.0*2w+78-ay)-1T*1b*(1U*(0.5-1K-2g)+1T*(2b-2p)-mx)+(-1U*1a+1T*1h)*(1U*(3P-3R)+1T*(2w+3p)-my)+1U*1b*(1U*(2p+2b)+1T*(0.5-26-1K)-mz);3w=4M*(2.0*2b-6R-ax)+4R*(2.0*2w+78-ay)-4.0*1h*(1-2.0*26-2.0*1K-az)+1T*1a*(1U*(0.5-1K-2g)+1T*(2b-2p)-mx)+(1U*1b+1T*1i)*(1U*(3P-3R)+1T*(2w+3p)-my)+(1U*1a-99*1h)*(1U*(2p+2b)+1T*(0.5-26-1K)-mz);3t=-4R*(2.0*2b-6R-ax)+4M*(2.0*2w+78-ay)-4.0*1b*(1-2.0*26-2.0*1K-az)+(-9p*1b-1T*1i)*(1U*(0.5-1K-2g)+1T*(2b-2p)-mx)+(1U*1h+1T*1a)*(1U*(3P-3R)+1T*(2w+3p)-my)+(1U*1i-99*1b)*(1U*(2p+2b)+1T*(0.5-26-1K)-mz);3u=43*(2.0*2b-6R-ax)+42*(2.0*2w+78-ay)+(-9p*1a+1T*1h)*(1U*(0.5-1K-2g)+1T*(2b-2p)-mx)+(-1U*1i+1T*1b)*(1U*(3P-3R)+1T*(2w+3p)-my)+1U*1h*(1U*(2p+2b)+1T*(0.5-26-1K)-mz);1m=2E(3d*3d+3w*3w+3t*3t+3u*3u);3d*=1m;3w*=1m;3t*=1m;3u*=1m;4S-=1W*3d;4W-=1W*3w;4L-=1W*3t;4I-=1W*3u}}1i+=4S*(1.0/1Q);1h+=4W*(1.0/1Q);1b+=4L*(1.0/1Q);1a+=4I*(1.0/1Q);1m=2E(1i*1i+1h*1h+1b*1b+1a*1a);1i*=1m;1h*=1m;1b*=1m;1a*=1m;C.1n.q[0]=1i;C.1n.q[1]=1h;C.1n.q[2]=1b;C.1n.q[3]=1a};7r.Z.6f=M(1j,gx,gy,gz,ax,ay,az){J 1i=C.1n.q[0];J 1h=C.1n.q[1];J 1b=C.1n.q[2];J 1a=C.1n.q[3];J 1Q=1.0/1j;J 1W=C.1W;J 1m;J 3d,3w,3t,3u;J 4S,4W,4L,4I;J 4R,43,42,4M,9i,8i,8V,9n,9l,3s,26,1K,2g;4S=0.5*(-1h*gx-1b*gy-1a*gz);4W=0.5*(1i*gx+1b*gz-1a*gy);4L=0.5*(1i*gy-1h*gz+1a*gx);4I=0.5*(1i*gz+1h*gy-1b*gx);if(!((ax===0.0)&&(ay===0.0)&&(az===0.0))){J 6V=12.1o(ax*ax+ay*ay+az*az);if(12.1C(6V-C.50)>C.85){1m=2E(ax*ax+ay*ay+az*az);ax*=1m;ay*=1m;az*=1m;4R=2.0*1i;43=2.0*1h;42=2.0*1b;4M=2.0*1a;9i=4.0*1i;8i=4.0*1h;8V=4.0*1b;9n=8.0*1h;9l=8.0*1b;3s=1i*1i;26=1h*1h;1K=1b*1b;2g=1a*1a;3d=9i*1K+42*ax+9i*26-43*ay;3w=8i*2g-4M*ax+4.0*3s*1h-4R*ay-8i+9n*26+9n*1K+8i*az;3t=4.0*3s*1b+4R*ax+8V*2g-4M*ay-8V+9l*26+9l*1K+8V*az;3u=4.0*26*1a-43*ax+4.0*1K*1a-42*ay;1m=2E(3d*3d+3w*3w+3t*3t+3u*3u);3d*=1m;3w*=1m;3t*=1m;3u*=1m;4S-=1W*3d;4W-=1W*3w;4L-=1W*3t;4I-=1W*3u}}1i+=4S*(1.0/1Q);1h+=4W*(1.0/1Q);1b+=4L*(1.0/1Q);1a+=4I*(1.0/1Q);1m=2E(1i*1i+1h*1h+1b*1b+1a*1a);1i*=1m;1h*=1m;1b*=1m;1a*=1m;C.1n.q[0]=1i;C.1n.q[1]=1h;C.1n.q[2]=1b;C.1n.q[3]=1a};M 9F(){C.1r()}9F.Z.1r=M(){C.1n=W 14(1,0,0,0);C.1W=2;C.hi=(10.0*0.5);C.h4=(8x.0*0.0);C.6g=C.hi;C.4w=C.h4;C.6c=0.0;C.6x=0.0;C.6u=0.0;C.1n=W 14(1,0,0,0)};9F.Z.ab=M(1j,gx,gy,gz,ax,ay,az,mx,my,mz){J 1i=C.1n.q[0];J 1h=C.1n.q[1];J 1b=C.1n.q[2];J 1a=C.1n.q[3];J 1Q=1.0/1j;J 1m;J 3s,2w,2p,3R,26,3P,2b,1K,3p,2g;J hx,hy,bx,bz;J 4T,4F,4H,9B,9C,9K;J 5g,5o,5n;J 4i,45,3W;if((mx===0.0)&&(my===0.0)&&(mz===0.0)){C.6f(1j,gx,gy,gz,ax,ay,az);11}if(!((ax===0.0)&&(ay===0.0)&&(az===0.0))){1m=2E(ax*ax+ay*ay+az*az);ax*=1m;ay*=1m;az*=1m;1m=2E(mx*mx+my*my+mz*mz);mx*=1m;my*=1m;mz*=1m;3s=1i*1i;2w=1i*1h;2p=1i*1b;3R=1i*1a;26=1h*1h;3P=1h*1b;2b=1h*1a;1K=1b*1b;3p=1b*1a;2g=1a*1a;hx=2.0*(mx*(0.5-1K-2g)+my*(3P-3R)+mz*(2b+2p));hy=2.0*(mx*(3P+3R)+my*(0.5-26-2g)+mz*(3p-2w));bx=12.1o(hx*hx+hy*hy);bz=2.0*(mx*(2b-2p)+my*(3p+2w)+mz*(0.5-26-1K));4T=2b-2p;4F=2w+3p;4H=3s-0.5+2g;9B=bx*(0.5-1K-2g)+bz*(2b-2p);9C=bx*(3P-3R)+bz*(2w+3p);9K=bx*(2p+2b)+bz*(0.5-26-1K);5g=(ay*4H-az*4F)+(my*9K-mz*9C);5o=(az*4T-ax*4H)+(mz*9B-mx*9K);5n=(ax*4F-ay*4T)+(mx*9C-my*9B);if(C.4w>0.0){C.6c+=C.4w*5g*(1.0/1Q); C.6x+=C.4w*5o*(1.0/1Q);C.6u+=C.4w*5n*(1.0/1Q);gx+=C.6c;gy+=C.6x;gz+=C.6u}1k{C.6c=0.0;C.6x=0.0;C.6u=0.0}gx+=C.6g*5g;gy+=C.6g*5o;gz+=C.6g*5n}gx*=(0.5*(1.0/1Q)); gy*=(0.5*(1.0/1Q));gz*=(0.5*(1.0/1Q));4i=1i;45=1h;3W=1b;1i+=(-45*gx-3W*gy-1a*gz);1h+=(4i*gx+3W*gz-1a*gy);1b+=(4i*gy-45*gz+1a*gx);1a+=(4i*gz+45*gy-3W*gx);1m=2E(1i*1i+1h*1h+1b*1b+1a*1a);1i*=1m;1h*=1m;1b*=1m;1a*=1m;C.1n.q[0]=1i;C.1n.q[1]=1h;C.1n.q[2]=1b;C.1n.q[3]=1a};9F.Z.6f=M(1j,gx,gy,gz,ax,ay,az){J 1i=C.1n.q[0];J 1h=C.1n.q[1];J 1b=C.1n.q[2];J 1a=C.1n.q[3];J 1Q=1.0/1j;J 1m;J 4T,4F,4H;J 5g,5o,5n;J 4i,45,3W;if(!((ax===0.0)&&(ay===0.0)&&(az===0.0))){1m=2E(ax*ax+ay*ay+az*az);ax*=1m;ay*=1m;az*=1m;4T=1h*1a-1i*1b;4F=1i*1h+1b*1a;4H=1i*1i-0.5+1a*1a;5g=(ay*4H-az*4F);5o=(az*4T-ax*4H);5n=(ax*4F-ay*4T);if(C.4w>0.0){C.6c+=C.4w*5g*(1.0/1Q); C.6x+=C.4w*5o*(1.0/1Q);C.6u+=C.4w*5n*(1.0/1Q);gx+=C.6c;gy+=C.6x;gz+=C.6u}1k{C.6c=0.0;C.6x=0.0;C.6u=0.0}gx+=C.6g*5g;gy+=C.6g*5o;gz+=C.6g*5n}gx*=(0.5*(1.0/1Q)); gy*=(0.5*(1.0/1Q));gz*=(0.5*(1.0/1Q));4i=1i;45=1h;3W=1b;1i+=(-45*gx-3W*gy-1a*gz);1h+=(4i*gx+3W*gz-1a*gy);1b+=(4i*gy-45*gz+1a*gx);1a+=(4i*gz+45*gy-3W*gx);1m=2E(1i*1i+1h*1h+1b*1b+1a*1a);1i*=1m;1h*=1m;1b*=1m;1a*=1m;C.1n.q[0]=1i;C.1n.q[1]=1h;C.1n.q[2]=1b;C.1n.q[3]=1a};M 36(){C.1r()}36.Z.1r=M(){C.50=9.81;C.9g=0.2;C.85=0.5C;C.9h=0.5C;C.7P=0.5C;C.ht=0.5C;C.9q=0.5C;C.dR=1t;C.e0=1t;C.8F=1e;C.et=1e;C.8a=W 14(0,0,0,0);C.35=W 14(0,0,0,0);C.6w=W 14(0,0,0,0);C.4j=W 14(0,0,0,0);C.6l=W 14(0,0,0,0);C.2r=W 14(1,0,0,0);C.1n=W 14(1,0,0,0)};36.Z.ab=M(1j,gx,gy,gz,ax,ay,az,mx,my,mz){if((mx===0.0)&&(my===0.0)&&(mz===0.0)){C.6f(1j,gx,gy,gz,ax,ay,az);11}if(!C.8F){C.hp(ax,ay,az,mx,my,mz,C.2r);C.2r.62(C.1n);C.8F=1t;11}J 1c=W 14(0,0,0,0);if(C.dR)C.ea(ax,ay,az,gx,gy,gz);C.dz(1j,gx,gy,gz,C.6w);C.4j.1y(0,ax,ay,az);C.dq(C.4j,C.6w);J 3a=(C.e0)?C.cO(C.7P,ax,ay,az):C.7P;C.9t(3a,C.4j);C.6w.5c(C.4j,1c);C.6l.1y(0,mx,my,mz);C.hr(C.6l,1c);C.9t(C.ht,C.6l);1c.5c(C.6l,C.2r);C.2r.3n(C.2r);C.2r.62(C.1n)};36.Z.hp=M(ax,ay,az,mx,my,mz,q){J a=C.4j;a.1y(0,ax,ay,az);a.3n(a);ax=a.q[1];ay=a.q[2];az=a.q[3];if(az>=0){a.q[0]=12.1o((az+1)*0.5);a.q[1]=-ay/(2.0*a.q[0]);a.q[2]=ax/(2.0*a.q[0]);a.q[3]=0}1k{J X=12.1o((1-az)*0.5);a.q[0]=-ay/(2.0*X);a.q[1]=X;a.q[2]=0;a.q[3]=ax/(2.0*X)}J lx=(a.q[0]*a.q[0]+a.q[1]*a.q[1]-a.q[2]*a.q[2])*mx+2.0*(a.q[1]*a.q[2])*my-2.0*(a.q[0]*a.q[2])*mz;J ly=2.0*(a.q[1]*a.q[2])*mx+(a.q[0]*a.q[0]-a.q[1]*a.q[1]+a.q[2]*a.q[2])*my+2.0*(a.q[0]*a.q[1])*mz;J 3x=lx*lx+ly*ly;J 1W=12.1o(3x+lx*12.1o(3x));C.6l.1y(1W/(12.1o(2.0*3x)),0,0,ly/(12.1o(2.0)*1W));a.5c(C.6l,q)};36.Z.hr=M(2T,p){J l=W 14(0,0,0,0);J 9u=W 14(p.q[0],-p.q[1],-p.q[2],-p.q[3]);2T.5b(9u,l);J 3x=l.q[1]*l.q[1]+l.q[2]*l.q[2];J 1W=12.1o(3x+l.q[1]*12.1o(3x));2T.1y(1W/(12.1o(2.0*3x)),0,0,l.q[2]/(12.1o(2.0)*1W))};36.Z.6f=M(1j,gx,gy,gz,ax,ay,az){if(!C.8F){C.ez(ax,ay,az,C.2r);C.2r.62(C.1n);C.8F=1t;11}J 1c=W 14(0,0,0,0);if(C.dR)C.ea(ax,ay,az,gx,gy,gz);C.dz(1j,gx,gy,gz,C.6w);C.4j.1y(0,ax,ay,az);C.dq(C.4j,C.6w);J 3a=(C.e0)?C.cO(C.7P,ax,ay,az):C.7P;C.9t(3a,C.4j);C.6w.5c(C.4j,C.2r);C.2r.3n(C.2r);C.2r.62(C.1n)};36.Z.ez=M(ax,ay,az,q){q.1y(0,ax,ay,az);q.3n(q);ax=q.q[1];ay=q.q[2];az=q.q[3];if(az>=0){q.q[0]=12.1o((az+1)*0.5);q.q[1]=-ay/(2.0*q.q[0]);q.q[2]=ax/(2.0*q.q[0]);q.q[3]=0}1k{J X=12.1o((1-az)*0.5);q.q[0]=-ay/(2.0*X);q.q[1]=X;q.q[2]=0;q.q[3]=ax/(2.0*X)}};36.Z.ea=M(gx,gy,gz,ax,ay,az){C.et=C.9w(gx,gy,gz,ax,ay,az);if(C.et){C.35.q[1]+=C.9q*(gx-C.35.q[1]);C.35.q[2]+=C.9q*(gy-C.35.q[2]);C.35.q[3]+=C.9q*(gz-C.35.q[3])}C.8a.1y(0,gx,gy,gz)};36.Z.9w=M(gx,gy,gz,ax,ay,az){J 6V=12.1o(ax*ax+ay*ay+az*az);if(12.1C(6V-C.50)>C.85)11 1e;if(12.1C(gx-C.8a.q[1])>C.9h||12.1C(gy-C.8a.q[2])>C.9h||12.1C(gz-C.8a.q[3])>C.9h)11 1e;if(12.1C(gx-C.35.q[1])>C.9g||12.1C(gy-C.35.q[2])>C.9g||12.1C(gz-C.35.q[3])>C.9g)11 1e;11 1t};36.Z.dz=M(1j,gx,gy,gz,q){J 7N=gx-C.35.q[1];J 8J=gy-C.35.q[2];J 89=gz-C.35.q[3];J 87=C.2r.q[0];J 8G=C.2r.q[1];J 8O=C.2r.q[2];J 7X=C.2r.q[3];q.q[0]=87+0.5*1j*(7N*8G+8J*8O+89*7X);q.q[1]=8G+0.5*1j*(-7N*87-8J*7X+89*8O);q.q[2]=8O+0.5*1j*(7N*7X-8J*87-89*8G);q.q[3]=7X+0.5*1j*(-7N*8O+8J*8G-89*87);q.3n(q)};36.Z.dq=M(2t,p){2t.3n(2t);J g=W 14(0,0,0,0);J 9u=W 14(p.q[0],-p.q[1],-p.q[2],-p.q[3]);2t.5b(9u,g);2t.q[0]=12.1o((g.q[3]+1)*0.5);2t.q[1]=-g.q[2]/(2.0*2t.q[0]);2t.q[2]=g.q[1]/(2.0*2t.q[0]);2t.q[3]=0.0};36.Z.cO=M(eQ,ax,ay,az){J eO=12.1o(ax*ax+ay*ay+az*az);J 2Y=12.1C(eO-C.50)/C.50;J 7W;J 92=0.1;J d0=0.2;J m=1.0/(92-d0);J b=1.0-m*92;if(2Y<92)7W=1.0;1k if(2Y<d0)7W=m*2Y+b;1k 7W=0.0;11 7W*eQ};36.Z.9t=M(3a,q){if(q.q[0]<0.0){J 7B=12.ch(q.q[0]);J A=12.4U(7B*(1.0-3a))/12.4U(7B);J B=12.4U(7B*3a)/12.4U(7B);q.q[0]=A+B*q.q[0];q.q[1]=B*q.q[1];q.q[2]=B*q.q[2];q.q[3]=B*q.q[3]}1k{q.q[0]=(1.0-3a)+3a*q.q[0];q.q[1]*=3a;q.q[2]*=3a;q.q[3]*=3a}q.3n(q)};2X.3E="1.3";M 2X(37){C.1r(37)}2X.Z.1r=M(5H){J 2O=3;C.5H=5H;C.38=W 5a(e6);C.3i=W 3S();C.4k=W 5a(e6);C.2W=W 3I(2O);C.31=W 4h(1,0,0);C.2c=W 4h(8.1,15.9);C.2D=W 14(0,10,10,10);C.5R=0.mI;C.av=0.eP;C.cM=1.5;C.7q=1t;C.3E=2X.3E;C.91=W 3K();C.8o=W 3K();C.9e=W 3K()};2X.gD=M(37){J S=W 2X(37);J 1g=dB.mH(37);if(1g!==1f){1g=eJ.mG(1g);if(1g.3E==2X.3E){C.5H=1g.5H;S.38.3Z(1g.38);S.31.3Z(1g.31);S.3i.3Z(1g.3i);S.2c.3Z(1g.2c);S.4k.3Z(1g.4k);S.2W.3Z(1g.2W);S.2D.1y(1g.2D.q[0],1g.2D.q[1],1g.2D.q[2],1g.2D.q[3]);S.5R=1g.5R;S.av=1g.5R;S.7q=1g.7q}1k{cX.9b("mJ 5t mK mN 3E: is "+1g.3E+", mM be "+2X.3E)}}11 S};2X.Z.1S=M(4D,59,du,2t,7D,2T){if(4D){C.38.3v(59);C.3i.3v(2t);C.4k.3v(2T);C.2W.3v(2T)}C.2c.3v(7D);J S=C.4V(4D,59,du,2t,7D,2T);if(C.2W.1v)C.8o.1S(2T.1X());J 1X=C.2D.1X();if(C.38.1v&&(1X<C.5R))C.91.1S(59.1X());if(C.2W.1v&&(1X>C.cM))C.8o.1S(2T.1X());if(C.3i.1v&&(1X<C.av))C.9e.1S(2t.1X());11 S};2X.Z.as=M(){dB.mL(C.5H);C.1r()};2X.Z.f2=M(){dB.mF(C.5H,eJ.mE(C))};2X.Z.4V=M(4D,59,du,2t,7D,2T){J 3y=1e;C.2D.q[1]=(C.2D.q[1]*0.90)+(59.q[1]*0.1);C.2D.q[2]=(C.2D.q[2]*0.90)+(59.q[2]*0.1);C.2D.q[3]=(C.2D.q[3]*0.90)+(59.q[3]*0.1);J 82=C.2D.1X();if(4D)if(!C.2W.1v&&C.4k.1v)3y|=C.2W.4V(C.2W.2k);if(82<C.5R)if(4D)if(!C.38.1v)3y|=C.38.8t(C.38.2k);if(82<C.av){C.7q=1e;if(4D)if(!C.3i.1v)3y|=C.3i.4V(2t)}if(82>C.cM){if(4D){if(!C.4k.1v)3y|=C.4k.8t(C.4k.2k)}}if(82>=C.5R){if(!C.7q)C.2D.1y(0,10,10,10);C.7q=1t}if(C.3i.1v===1t){if((!C.2c.1v[0])||(!C.2c.1v[1])||(!C.2c.1v[2]))3y|=C.2c.4V(2t,7D)}if(3y)C.f2();11 3y};M 5a(4C){C.1r(4C)}5a.Z.1r=M(4C){C.2k=W 14(0,0,0,0);C.2z=W 14(0,0,0,0);C.1v=1e;C.4C=4C;C.21=0};5a.Z.as=M(1g){C.2z.1y(0,0,0,0);C.21=0};5a.Z.3Z=M(1g){C.2z.1y(1g.2z.q[0],1g.2z.q[1],1g.2z.q[2],1g.2z.q[3]);C.21=1g.21;C.1v=1g.1v;C.4C=1g.4C};5a.Z.8t=M(q){++C.21;if(C.21==1)q.1I(C.2z);1k{J 1c=W 14(0,0,0,0);q.1I(1c);1c.7c(C.2z,1c);1c.1V(1.0/C.21,1c);C.2z.2L(1c,C.2z);if(C.21>=C.4C)C.1v=1t}11 C.1v};5a.Z.3v=M(q){q.1I(C.2k);C.2k.7c(C.2z,q)};M 3I(2O){C.1r(2O)}3I.Z.1r=M(2O){C.bb=[W 14(0,1,1,1),W 14(0,1,1,-1),W 14(0,1,-1,1),W 14(0,1,-1,-1),W 14(0,-1,1,1),W 14(0,-1,1,-1),W 14(0,-1,-1,1),W 14(0,-1,-1,-1),W 14(0,0,0.1P,1.1P),W 14(0,0,0.1P,-1.1P),W 14(0,0,-0.1P,1.1P),W 14(0,0,-0.1P,-1.1P),W 14(0,0.1P,1.1P,0),W 14(0,0.1P,-1.1P,0),W 14(0,-0.1P,1.1P,0),W 14(0,-0.1P,-1.1P,0),W 14(0,1.1P,0,0.1P),W 14(0,1.1P,0,-0.1P),W 14(0,-1.1P,0,0.1P),W 14(0,-1.1P,0,-0.1P),];C.5U=C.bb.19;C.1v=1e;C.2O=2O;C.5V=0;C.21=W 2G(C.5U);C.2k=W 14(0,0,0,0);C.n=C.5U*C.2O;C.i=W 2G(C.5U);C.bU=0;C.1L=1l(C.n,3);C.H=1l(C.n,9);C.b=1l(C.n,1);C.A=1l(4,4);C.v=1l(4,1);C.r=1l(4,1);C.2q=-1;C.eS()};3I.Z.eS=M(){J i;C.1v=1e;C.5V=0;C.2q=-1;c2(C.A);17(i=0;i<C.5U;i++){C.21[i]=0;C.i[i]=0}};3I.Z.3Z=M(1g){C.1v=1g.1v;C.5U=1g.5U;C.2O=1g.2O;C.5V=1g.5V;C.21=1g.21;C.n=1g.n;C.i=1g.i;C.1L=1g.1L;C.H=1g.H;C.b=1g.b;C.A=1g.A;C.v=1g.v;C.r=1g.r;C.2q=1g.2q};3I.Z.4V=M(q){J b2=1e;J 2u=C.aS(C.2k);if(2u!=C.bU){C.bU=2u;if(!C.1v){if(C.21[2u]<C.2O)b2=1t}}if(b2){C.8t(C.2k,2u);if(C.5V>=C.n){C.al();if(!C.1v)C.1r()}}11 b2};3I.Z.ev=M(){J i;J q=W 14(0,0,0,0);J g,2Y=0;17(i=0;i<C.n;i++){q.1y(0,C.1L[i][0],C.1L[i][1],C.1L[i][2]);C.3v(q);g=q.1X();2Y+=12.1C(1-g)}2Y/=C.n;C.2q=2Y;C.1v=1t;11 2Y};3I.Z.3v=M(q){q.1I(C.2k);C.v[0][0]=q.q[1];C.v[1][0]=q.q[2];C.v[2][0]=q.q[3];C.v[3][0]=1;1O(C.A,C.v,C.r);q.1y(0,C.r[0][0],C.r[1][0],C.r[2][0])};3I.Z.8t=M(q,2u){J i=2u*C.2O+C.i[2u];J x=C.1L[i][0]=q.q[1];J y=C.1L[i][1]=q.q[2];J z=C.1L[i][2]=q.q[3];if((x==-1)||(y==-1)||(z==-1))11;C.H[i][0]=y*y;C.H[i][1]=z*z;C.H[i][2]=2*x;C.H[i][3]=2*y;C.H[i][4]=2*z;C.H[i][5]=2*x*y;C.H[i][6]=2*x*z;C.H[i][7]=2*y*z;C.H[i][8]=1;C.b[i][0]=-(x*x);++C.i[2u];C.i[2u]%=C.2O;if(C.21[2u]<C.2O)++C.21[2u];if(C.5V<C.n)++C.5V};3I.Z.aS=M(q){J i;J 2j=0;J cK=0;el=W 14(0,0,0,0);q.3n(el);17(i=0;i<C.bb.19;i++){J da=el.cp(C.bb[i]);if(da>cK){cK=da;2j=i}}11 2j};3I.Z.al=M(){J b3=1l(9,C.n);J T=1l(9,9);J 1c=1l(9,9);J dI=1l(9,9);J bP=1l(9,C.n);J x=1l(9,1);J A=1l(4,4);J 3V;6q(C.H,b3);1O(b3,C.H,T);if(!6t(T,1c,dI))11;1O(dI,b3,bP);1O(bP,C.b,x);A[0][0]=1;A[0][1]=x[5][0];A[0][2]=x[6][0];A[0][3]=x[2][0];A[1][0]=0;3V=x[0][0]-(x[5][0]*x[5][0]);if(3V<=0)11;A[1][1]=12.1o(3V);A[1][2]=(x[7][0]-(x[6][0]*x[5][0]))/A[1][1];A[1][3]=(x[3][0]-(x[5][0]*x[2][0]))/A[1][1];A[2][0]=0;A[2][1]=0;3V=x[1][0]-(x[6][0]*x[6][0])-(A[1][2]*A[1][2]);if(3V<=0)11;A[2][2]=12.1o(3V);A[2][3]=(x[4][0]-(x[6][0]*x[2][0])-(A[1][2]*A[1][3]))/A[2][2];A[3][0]=0;A[3][1]=0;A[3][2]=0;3V=(x[2][0]*x[2][0])+(A[1][3]*A[1][3])+(A[2][3]*A[2][3])-x[8][0];if(3V<=0)11;A[3][3]=12.1o(3V);3D(A,1.0/A[3][3],C.A);C.ev()};M 4h(5l,5j){C.1r(5l,5j)}4h.Z.1r=M(5l,5j){C.aH=20;C.5l=5l;C.5j=5j;C.1v=[1e,1e,1e];C.1H=[C.aM(),C.aM(),C.aM()];C.2k=W 14(0,0,0,0);C.5T=[1,1,1]};4h.Z.3Z=M(1g){C.aH=1g.aH;C.5l=1g.5l;C.5j=1g.5j;C.1v=1g.1v;C.5T=1g.5T;C.bn(1g.1H[0],C.1H[0]);C.bn(1g.1H[1],C.1H[1]);C.bn(1g.1H[2],C.1H[2])};4h.Z.aM=M(){11{n:0,40:0,41:0,2Q:0,2J:0,m:1,b:0}};4h.Z.bn=M(1g,S){S.n=5w(1g.n);S.40=5w(1g.40);S.41=5w(1g.41);S.2Q=5w(1g.2Q);S.2J=5w(1g.2J);S.m=5w(1g.m);S.b=5w(1g.b)};4h.Z.3v=M(q){J i;q.1I(C.2k);17(i=0;i<3;i++){q.q[i+1]-=C.1H[i].b;q.q[i+1]*=C.1H[i].m}};4h.Z.4V=M(f8,mv){J i;J 3y=1e;J a=f8.q;J b=C.2k.q;17(i=0;i<3;i++){J cb=12.1C(a[i+1]);if((b[i+1]!==0)&&(cb>C.5l)&&(cb<C.5j)&&((a[i+1]>0)==(C.5T[i]>0))){C.5T[i]*=-1;C.1v[i]=C.eY(a[i+1],b[i+1],C.1H[i]);3y=1t}}11 3y};4h.Z.eY=M(bm,aW,1H){J v=1H;++v.n;J 2S=1/v.n;J 5Z=(v.n-1)*2S;J 44=bm-v.40;J 4N=aW-v.41;J 4P,6E;v.2Q+=(5Z*44*44-v.2Q)*2S;v.2J+=(5Z*44*4N-v.2J)*2S;v.40+=44*2S;v.41+=4N*2S;if((v.2Q===0)||(v.2J===0))11 1e;4P=v.2J/v.2Q;6E=v.41-(4P*v.40);v.m=1/4P;v.b=6E;if(v.n<C.aH)11 1e;11 1t};3S.eB=0.mu;M 3S(){C.1r()}3S.Z.1r=M(){C.B=W 14(0,0,0,0);C.G=W 14(0,1,1,1);C.4A=W 14(0,1,1,1);C.2q=-1;C.21=0;C.1L=W 2G(6);C.6D=[1e,1e,1e,1e,1e,1e];C.1L[0]=W 14(0,0,0,0);C.1L[1]=W 14(0,0,0,0);C.1L[2]=W 14(0,0,0,0);C.1L[3]=W 14(0,0,0,0);C.1L[4]=W 14(0,0,0,0);C.1L[5]=W 14(0,0,0,0);C.2k=W 14(0,0,0,0);C.1v=1t;C.3q=W 14(0,0,0,0);C.eZ=1e};3S.Z.as=M(1g){C.21=0;C.6D=[1e,1e,1e,1e,1e,1e];C.b.1y(0,0,0,0);C.G.1y(0,1,1,1);C.4A.1y(0,1,1,1)};3S.Z.3Z=M(1g){J B=1g.B.q;J G=1g.G.q;J aL=1g.4A.q;C.B.1y(0,B[1],B[2],B[3]);C.G.1y(0,G[1],G[2],G[3]);C.4A.1y(0,aL[1],aL[2],aL[3]);C.2q=1g.2q;C.21=1g.21;C.6D=1g.6D;C.1v=1g.1v;J i;17(i=0;i<6;i++)C.1L[i].1y(0,1g.1L[i].q[1],1g.1L[i].q[2],1g.1L[i].q[3])};3S.Z.3v=M(q){q.1I(C.2k);q.7c(C.B,q);q.8h(C.4A,q)};3S.Z.4V=M(q){J bt=1e;J 2u=C.aS(q);if(!C.6D[2u]){C.eZ=1e;C.6D[2u]=1t;C.2k.1I(C.1L[2u]);++C.21;bt=1t;if(C.21==6){C.1v=C.al();if(!C.1v)C.1r()}}11 bt};3S.Z.aS=M(q){J 2j;J x=12.1C(q.q[1]);J y=12.1C(q.q[2]);J z=12.1C(q.q[3]);2j=(x>y)?((x>z)?0:2):((y>z)?1:2);if(q.q[2j+1]<0)2j+=3;11 2j};3S.Z.al=M(){J eg=1e;J i;J 4B=1l(6,1);J dW=1l(6,1);J 3Q=1l(6,6);J dU=1l(6,6);J f4=1l(6,6);J 2B=W 14(0,0,0,0);J 3O=W 14(0,0,0,0);J 2q=0;J bj;17(bj=0;bj<6;bj++){17(i=0;i<6;i++){C.1L[i].1I(C.3q);C.3v(C.3q);3Q[i][0]=C.3q.q[1]*C.3q.q[1];3Q[i][1]=C.3q.q[2]*C.3q.q[2];3Q[i][2]=C.3q.q[3]*C.3q.q[3];3Q[i][3]=C.3q.q[1];3Q[i][4]=C.3q.q[2];3Q[i][5]=C.3q.q[3];dW[i][0]=3Q[i][0]+3Q[i][1]+3Q[i][2]-1}if(!6t(3Q,f4,dU))1x;1O(dU,dW,4B);2B.q[1]=1.0/12.1o(12.1C(1-4B[0][0]));2B.q[2]=1.0/12.1o(12.1C(1-4B[1][0]));2B.q[3]=1.0/12.1o(12.1C(1-4B[2][0]));3O.q[1]=0.5*4B[3][0]*C.G.q[1]*2B.q[1]*2B.q[1];3O.q[2]=0.5*4B[4][0]*C.G.q[2]*2B.q[2]*2B.q[2];3O.q[3]=0.5*4B[5][0]*C.G.q[3]*2B.q[3]*2B.q[3];C.G.8h(2B,C.G);C.B.2L(3O,C.B);if((C.G.q[1]<=0)||(C.G.q[2]<=0)||(C.G.q[3]<=0))1x;C.4A.q[1]=1.0/C.G.q[1];C.4A.q[2]=1.0/C.G.q[2];C.4A.q[3]=1.0/C.G.q[3];C.G.8h(C.G,2B);3O.8h(3O,3O);2q=3O.q[1]/2B.q[1];2q+=3O.q[1]/2B.q[1];2q+=3O.q[1]/2B.q[1];if(2q<3S.eB){C.2q=2q;eg=1t;1x}}11 eg};M 4n(){C.eo=0.bI;C.L=9;C.86=eo*L;C.ey=(C.86-C.L)/C.86;C.eH=1/(2*86);C.cJ=C.ey+1-C.eo+2;C.d6=C.eH;C.29=1l(9,1);C.D=1l(3,3);C.b=1l(3,1)}4n.Z.mt=M(){};4n.Z.3v=M(q){q.1I(C.2k);C.v[0][0]=q.q[1];C.v[1][0]=q.q[2];C.v[2][0]=q.q[3];1O(C.D,C.v,C.r);e3(C.r,C.b,C.r);q.1y(0,C.r[0][0],C.r[1][0],C.r[2][0])};4n.Z.mw=M(q,29){J L=1l(1,9);J 3C=1l(1,1);J c=1l(3,1);J bR=1l(1,3);J de=1l(1,3);J 1c=1l(3,3);J di=1l(3,3);J E=1l(3,3);J d8=1l(3,3);J dA=1l(3,3);dg(C.d,dA);1O(dA,C.b,c);6q(c,bR);1O(C.D,C.D,d8);3J(C.D,C.D,E);3J(E,d8,E);dg(E,E);6t(E,1c,di);1O(bR,di,de);1O(de,c,3C);L[0][0]=2*x-3C;L[0][1]=2*y-3C;L[0][2]=2*z-3C;L[0][3]=-x*x-3C;L[0][4]=-y*y-3C;L[0][5]=-z*z-3C;L[0][6]=-2*x*y-3C;L[0][7]=-2*x*z-3C;L[0][8]=-2*y*z-3C};4n.Z.mA=M(x,P,5i){J dk=1l(9,9);J dt=1l(9,9);6z(P,eI);3D(dk,C.86,dk);mD(eI,mC);J i=0,j=0;17(j=0;j<C.L;j++)5i[0][j]=x[0][j];17(i=1;i<=C.L;i++)17(j=0;j<C.L;j++)5i[i][j]=x[0][j]+dt[i-1][j];17(i=L+1;i<=2*C.L;i++)17(j=0;j<C.L;j++)5i[i][j]=x[0][j]+dt[i-C.L-1][j]};4n.Z.mB=M(5i,5Q){};4n.Z.mO=M(5Q,y){J i,j;3D(y,0,y);17(i=1;i<=2*C.L;i++)17(j=0;j<C.L;j++)y[j][0]+=5Q[i][j];3D(y,C.mP,y);17(j=0;j<C.L;j++)y[j][0]+=C.n5*5Q[0][j]};4n.Z.n4=M(5i,x,5Q,y,P,98,95){J 5f=1l(9,9);J K=1l(9,9);J 5k=1l(C.L,1);J 80=1l(C.L,1);J 5M=1l(1,C.L);J 5L=1l(C.L,C.L);J 5O=1l(C.L,C.L);J i,j;17(i=1;i<=2*C.L;i++){17(j=0;j<C.L;j++){5k[j][0]=5Q[i][j]-y[j][0];80[j][0]=5i[i][j]-x[j][0]}6q(5k,5M);1O(5k,5M,5L);1O(80,5M,5O);3J(4l,5L,4l);3J(5f,5O,5f)}3D(4l,C.d6,4l);3D(5f,C.d6,5f);17(j=0;j<L;j++){5k[j][0]=5Q[0][j]-y[j][0];80[j][0]=5i[0][j]-x[j][0]}6q(5k,5M);1O(5k,5M,5L);1O(80,5M,5O);3D(5L,C.cJ,5L);3D(5O,C.cJ,5O);3J(4l,5L,4l);3J(5f,5O,5f);J eN=1l(C.L,C.L);J 1c=1l(C.L,C.L);6t(4l,1c,eN);1O(5f,4l,K);1O(K,5k,95);3J(x,95,95);J ed=1l(C.L,C.L);6q(K,ed);1O(K,4l,1c);1O(1c,ed,98);e3(P,98,98)};4n.Z.n3=M(29,D,b){J E=1l(3,3);E[0][0]=29[3][0];E[1][1]=29[4][0];E[2][2]=29[5][0];E[0][1]=29[6][0];E[0][2]=29[7][0];E[1][2]=29[8][0];E[1][0]=29[6][0];E[2][0]=29[7][0];E[2][1]=29[8][0];J U=1l(3,3);J V=1l(3,3);J 7H=1l(3,3);J 1c=1l(3,3);eC(E,1c,U,V);6q(U,7H);V[0][0]=-1+12.1o(1+V[0][0]);V[1][1]=-1+12.1o(1+V[1][1]);V[2][2]=-1+12.1o(1+V[2][2]);1O(U,V,1c);1O(1c,7H,D);J c=1l(3,1);c[0][0]=29[0][0];c[0][1]=29[1][0];c[0][2]=29[2][0];6z(D,U);U[0][0]+=1;U[1][1]+=1;U[2][2]+=1;6t(U,1c,7H);1O(7H,c,b)};1s.cf=0;1s.9U=1;1s.9W=2;1s.7v=3;1s.77=0;1s.bG=1;1s.bQ=2;1s.f6=0.5;1s.7K=1;1s.7b=2;1s.eV=0.3;1s.bT=5;1s.8z=0.5C;1s.9L=0.3;M 1s(){C.1r()}1s.Z.1r=M(){C.f0=1t;C.bv=W 14(0,0,0,0);C.3L=1t;C.cA=0;C.3f=0;C.6y=0;C.8r=0;C.7x=0;C.9J=0;C.1D=1s.cf;C.1G=0;C.f1=0.22;C.ex=C.f1*0.5;C.ew=0;C.eT=W 51();C.3T=W 14(0,0,0,0);C.2n=W 14(0,0,0,0);C.8H=W 14(0,0,0,0);C.3Y=0;C.9G=0;C.4o=0;C.eU=0;C.bB=W 14(1,0,0,0);C.6n=W 14(1,0,0,0);C.9P=1e;C.8E=W 14(0,0,0,0);C.d1=W 51();C.9X=0;C.6j=1s.77;C.4O=W 14(0,0,0,0);C.8q=W 14(0,0,0,0);C.dr=W 51(0,0,0,0)};1s.Z.1S=M(1j,1n,g,a){J 9m=1e;J 8v=a.1X();J 9I=W 14(0,0,0,0);a.5b(1n,9I);9I.q[3]=0;J ci=9I.1X();J 5h=g.1X();C.1G+=1j;g.5b(1n,C.2n);C.2n.q[3]=C.2n.q[2];C.2n.q[2]=-C.2n.q[1];C.2n.q[1]=C.2n.q[3];C.2n.q[3]=0;C.2n.7c(C.bB,C.bB);C.2n.1V(C.ex,C.bv);C.2n.3n(C.2n);a.5b(1n,C.6n);C.6n.q[3]-=9.bE;C.d1.6m(1j,C.6n,C.8E);6k(C.6j){1E 1s.77:if((C.6n.1X()>1s.7b)){C.9X=0;C.4O.1I(C.8E);C.6j=1s.bG}1x;1E 1s.bG:if(C.9X>1s.f6)C.6j=1s.77;1k if(C.6I(C.6n,0,0,-9.bE,1s.7K)){C.9P=1t;C.6j=1s.bQ}1x;1E 1s.bQ:if(C.6n.q[3]>0){C.9P=1e;C.6j=1s.77}1x;7l:C.6j=1s.77}if(C.f0&&C.9P)C.8E.1I(C.4O);1k C.bv.1I(C.4O);C.dr.6m(1j,C.4O,C.8q);if(!C.3L){C.9G=(C.2n.q[1]*-C.8H.q[2])+(C.2n.q[2]*C.8H.q[1]);C.9G=(C.9G>0)?-1:1;C.3Y=C.2n.cp(C.8H);if(C.3Y>1)C.3Y=1;if(C.3Y<-1)C.3Y=-1;C.3Y=12.ch(C.3Y);C.eT.6m(1j,C.4O,C.3T);if(5h<1s.8z)C.3Y=0;J 9M=0.5C*(ci-C.cA)/1j;J 4o=C.3Y*12.1C(9M);C.4o=4o;C.eU=9M;6k(C.1D){1E 1s.cf:{if(C.1G>1s.9L)C.1D=1s.9U}1x;1E 1s.9U:if(4o>1s.bT){C.1D=1s.9W;C.3f=8v;C.6y=5h;C.7x=0;C.3T.3G();C.8r=0;C.1G=0}1x;1E 1s.9W:if(8v>C.3f)C.3f=8v;if(5h>C.6y)C.6y=5h;if(C.1G>1s.eV){C.1D=1s.7v;C.1G=0}1k if(9M<=0){C.1D=1s.7v;9m=1t;C.1G=0}1x;1E 1s.7v:if((5h<1s.8z)&&(C.1G>1s.9L)){C.1D=1s.9U;C.3f=0;C.6y=0;C.8r=C.1G;C.7x=C.3T.1X();C.9J=12.9Y(C.3T.q[2],C.3T.q[1]);C.1G=0;9m=1t}1k if((4o>1s.bT)&&(C.1G>1s.9L)){C.1D=1s.9W;C.3f=8v;C.6y=5h;C.7x=C.3T.1X();C.9J=12.9Y(C.3T.q[2],C.3T.q[1]);C.8r=C.1G;C.3T.3G();C.1G=0}1x;7l:C.1D=1s.7v;1x}}C.3L=1e;C.9X+=1j;C.cA=ci;C.ew=5h;C.2n.1I(C.8H);11 9m};1s.Z.n6=M(){C.8q.3G();C.dr.1r();C.8E.3G();C.d1.1r()};1s.Z.6I=M(a,x,y,z,2d){11((a.q[1]<x+2d)&&(a.q[1]>x-2d)&&(a.q[2]<y+2d)&&(a.q[2]>y-2d)&&(a.q[3]<z+2d)&&(a.q[3]>z-2d))};5A.dY=W 14(0,0,0,-0.1);M 5A(){C.ej=W 9f(6);C.dO=W 14(0,0,0,0);C.73=W 14(0,0,0,0);C.3L=1t;5A.dY.1I(C.73);C.8w=0.7V;C.3M=[0,0,0];C.94=e6;C.9r=0.n7}5A.Z.aR=M(){C.3L=1t;C.ej.1r()};5A.Z.1S=M(1j,g,a){J 8M=W 14(0,0,0,0);J dM=W 14(0,0,0,0);C.ej.hA(1j,g,C.dO);g.9c(C.73,dM);g.9c(dM,8M);a.2L(8M,a);if(!C.3L){C.dO.9c(C.73,8M);a.2L(8M,a)}1k C.3L=1e};5A.Z.eM=M(g,a){J 8w=0.7V;J 8K=g.q[1]*g.q[1];J 8C=g.q[2]*g.q[2];J 8L=g.q[3]*g.q[3];J r,6L,7g,7e,74;7g=7e=74=0;r=C.73;6L=5A.dY;if(C.3M[0]<C.94)if((8C+8L)>25){7g=a.q[1]/(8C+8L);++C.3M[0]}if(C.3M[1]<C.94)if((8L+8K)>25){7e=a.q[2]/(8L+8K);++C.3M[1]}if(C.3M[2]<C.94)if((8K+8C)>25){74=a.q[3]/(8K+8C);++C.3M[2]}r.q[1]+=C.8w*7g;r.q[2]+=C.8w*7e;r.q[3]+=C.8w*74;if((12.1C(r.q[1]-6L.q[1])>C.9r)||(12.1C(r.q[2]-6L.q[2])>C.9r)||(12.1C(r.q[3]-6L.q[3])>C.9r)){6L.1I(r);C.3M[0]=0;C.3M[1]=0;C.3M[2]=0}11!((7g===0)&&(7e===0)&&(74===0))};J $7R={\'ms\':\'cv<6N\',\'n9\':\'cv<6N\',\'n8\':\'cv<6N\',\'1Z\':\'c0<6N\',\'n2\':\'c0<6N\',\'n1\':\'c0<6N\',\'bg\':\'mS<mR\',\'dn\':\'mQ<76\',\'7d\':\'mT<76\',\'ir\':\'mU<1J\',\'n0\':\'mW<1J\',\'mV\':\'mp<1J\',\'mo\':\'lY<1J\',\'lX\':\'lW<1J\',\'lZ\':\'m0<1J\',\'m3\':\'m2>hN\',\'nb\':\'lV>hN\',\'lU\':\'lO<1J\',\'lN\':\'lM<1J\',\'lP\':\'lQ<1J\',\'lT\':\'lS<1J\',\'lR\':\'m4<1J\',\'m5\':\'mi<1J\',\'mh\':\'mg<76\',\'mj\':\'mk<76\',\'mn\':\'mm<76\',\'~ml\':\'mf<gI\',\'me\':\'m8<1J\',\'m7\':\'m6<1J\',\'ax\':\'m9<1u\',\'ay\':\'ma<1u\',\'az\':\'md<1u\',\'mc\':\'mb<1u\',\'na\':\'nC<1u\',\'o6\':\'o1<1u\',\'ar\':\'iX<1u\',\'mx\':\'nW<1u\',\'my\':\'o2<1u\',\'mz\':\'o3<1u\',\'o4\':\'nV<1u\',\'nZ\':\'nY<1u\',\'nX\':\'o0<1u\',\'mr\':\'o5<1u\',\'gx\':\'nS<1u\',\'gy\':\'no<1u\',\'gz\':\'nq<1u\',\'nr\':\'ns<1u\',\'nm\':\'nl<1u\',\'ne\':\'nT<1u\',\'eh\':\'nd<1u\',\'er\':\'nc<1u\',\'ep\':\'ng<1u\',\'ge\':\'nh<1u\',\'gd\':\'nk<1u\',\'g5\':\'nj<1u\',\'fX\':\'ni<1u\',\'nv\':\'nw<1J\',\'nL\':\'nK<9D\',\'nN\':\'nO<1J\',\'nR\':\'nQ<9D\',\'nP\':\'nJ<1J\',\'nB\':\'nF<9D\',\'nG\':\'nH<1J\',\'nE\':\'nD<9D\',\'cx\':\'nA<1u\',\'cy\':\'nI<1u\',\'cz\':\'nM<1u\',\'7g\':\'nf<1u\',\'7e\':\'nt<1u\',\'74\':\'nu<1u\',\'nn\':\'np<1J\',\'cs\':\'nU<1J\',\'m1\':\'lK<1J\',\'jS\':\'jR<1J\',\'jQ\':\'jT<1J\',\'~jU\':\'jX<gI\',\'jW\':\'jV<1J\',\'aX\':\'jP>1u\',\'aY\':\'jO>1u\',\'aZ\':\'jI>1u\',\'cW\':\'jH>1u\',\'gX\':\'jG>1u\',\'gY\':\'jF>1u\',\'gZ\':\'jJ>1u\',\'mX\':\'jK<1u\',\'mY\':\'jN<1u\',\'mZ\':\'jM<1u\',\'jL\':\'jY<1J\',\'6h\':\'jZ<1u\',\'6v\':\'kh<1u\',\'6s\':\'kg<1u\',\'kf\':\'ki<1J\',\'kj\':\'km>76\',\'8Q\':\'kl>1u\',\'8R\':\'kk>1u\',\'8U\':\'ke>1u\',\'kc\':\'k6<1J\',\'k5\':\'k4<k3\',\'k7\':\'k8<1J\',};J $1N=$1N||{hR:1e,aA:1f,93:1f,dL:1f,9V:1f,cd:1f,hF:1f,cI:{},fM:M(){J $5F=C;[\'hQ\',\'b7\',\'8D\'].5Y(M(1F){[8,16,24,32,64].5Y(M(2y){[\'<\',\'>\'].5Y(M(e4){if(!(\'8D\'==1F&&32!=2y&&64!=2y)&&!((\'hQ\'==1F||\'b7\'==1F)&&64==2y)){J e9=1F.5W(0).c8()+1F.55(1)+2y;$5F.cI[e4+1F+2y]={1F:1F,2y:2y,1B:2y/8,5m:\'<\'==e4?1t:1e,hs:\'cT\'+e9,kb:\'1y\'+e9}}})})});11 C},gp:M(70){if(!/^hK:\\/\\//i.6O(70))70=\'hK://\'+70+\'/\';C.hG=70;ka{C.2R=W hT(70)}k9(jE){11 0}C.8g={};C.2R.jD=\'jb\';J $5F=C;C.2R.aA=M(e){$5F.fQ(e)};C.2R.93=M(e){$5F.fR(e)};C.2R.dL=M(e){$5F.fS(e)};C.2R.9V=M(e){$5F.68(e)};11 1},ja:M(){if(!C.2R)11 0;C.2R.j9();11 1},au:M(){11 C.2R&&(hT.lL==C.2R.jc)},5z:M(2e){if(!C.aU||!C.2R)11 0;if(C.hR)cX.9b(\'jd:\',2e);C.2R.5z(2e);11 1},2R:1f,hG:1f,aU:1e,8g:{},8W:0,5v:M(hv,2C){C.8W=jg*hu+(C.8W+1)%hu;J 5d=fx(C.8W);J d3=hv.6F(\',\');J 5J={ak:[],2C:2C};J cL=\'\';17(J i=0;i<d3.19;i++){J 6a=d3[i].dj(/\\s+/g,\'\');if(!6a.19)jf;if($7R.bo(6a)){6a=\'$R\'+$7R[6a].dj(/([<>])/,":$1")+\':\'+6a}J a=6a.6F(\':\');J 5q={6T:a[0],6K:a[1]?a[1].dZ():\'\',};if(5q.6K){5q.id=a[2]?a[2]:5J.ak.19;5J.ak.3o(5q)}cL+=5q.6T}C.8g[5d]=5J;11 C.5z(\'$O\'+fw(5d)+cL)},fO:M(e,5d){J 5J=C.8g[5d];J 3k=bO(e.2e);J dv=W 3j(3k,4);J 2s=0;J S={};5J.ak.5Y(M(5q){J fi=$1N.cI[5q.6K];S[5q.id]=dv[fi.hs](2s,fi.5m);2s+=fi.1B});if(je.j8(S).19===0){J 6S=e.2e.55(8);J a=[];2v(6S.19>=2){a.3o(2K(6S.hq(0,2),16));6S=6S.hq(2,6S.19)}S={84:a}}C.53(5J.2C,S)},65:1f,j7:1f,d7:0,aD:M(2f,6U){C.d7++;J s={j1:\'aD#\'+C.d7,66:\'aD\',6U:6U};if(!C.dl(s,2f))11 0;C.5z(s.63);C.65=s;11 1},fK:M(e){C.dp(C.65,bO(e.2e));C.53(C.hF,C.65);C.65=1f},61:1f,ef:M(2f,4t,4v,6U){C.3L=1t;J s={66:\'8k\',6U:6U,4t:4t,4v:4v,6Z:0,};if(\'6Z:1\'==2f){s.6Z=1;2f=\'1Z,aX,aY,aZ,cW,gX,gY,gZ,mX,mY,mZ,6h,6v,6s\'}if(!C.dl(s,2f))11 0;if(1==s.6Z)s.63=\'$j0\';C.5z(s.63);C.61=s;11 1},fU:M(){C.5z(\'$b$e\')},fP:M(e){J 3k=e.2e;if(1==C.61.6Z)3k=fb(3k,3k.6H);C.dp(C.61,3k);C.53(C.cd,C.61)},dp:M(s,3k){J 9k=[];J 72=[];J 6W=0;if(0!==(3k.6H-s.5D)%s.7f){11 C.68({2e:"fy iZ("+3k.6H+")-5D("+s.5D+") is iY j2 j3 7f("+s.7f+")."},1f)}2v(6W<3k.6H){J 2s=(6W>0)?s.5D:0;J 7a={};17(J i=(6W>0)?s.cU:0;i<s.5G.19;i++){J f=s.5G[i];J dv=W 3j(3k,6W,f.1B);17(J 9j=0;9j<f.1B;9j+=f.27){J v=dv[\'cT\'+f.1F](9j,f.aC);9k.3o(v);J 5e=s.db[2s];7a[5e]=v;2s+=f.27}6W+=f.1B}72.3o(7a)}s.S={};s.S.72=72;s.S.9k=9k;11 1},fD:W gi(\'^\\s*\'+\'([0-9A-F][0-9A-F])\'+\'([0-9A-F][0-9A-F])\'+\'([0-9A-F][0-9A-F])\'+\'([<>])\'+\'(u?b7|8D)(0|8|16|24|32|64)\'+\'\\s*$\',\'i\'),dl:M(s,2f){J dh=0;if(\'8k\'==s.66){J 88=2f.6F(\';\');if(2==88.19){dh=88[0].6F(\',\').19;2f=88.fF(\',\')}1k if(88.19>2){11 C.68({2e:"j6 j5 j4 d9 ; jh"},1f)}}J df=2f.6F(\',\');s.2f=[];s.5r=[];s.db={};s.5G=[];s.cU=0;s.ao=0;s.63=\'\';s.5D=0;s.7f=0;J 69=-1;17(J i=0;i<df.19;i++){J 5e=df[i].dj(/\\s+/g,\'\');J fz=/^ji/.6O(5e)?1t:1e;J 83=(i<dh)?1t:1e;J 1M=$7R.bo(5e)?$7R[5e]:5e;J m=C.fD.5v(1M);if(!m)11 C.68({2e:"jx 1M:"+1M},1f);J 1R=2K(m[1],16);J 7Y=(1R<jw)?1t:1e;if(-1==69&&7Y&&!83)69=1;J 1B=7Y?2K(m[3],16):0;J 2y=2K(m[6]);s.db[s.5D+s.7f]=5e;if(83){s.5D+=1B}1k{s.7f+=1B}if(2y>0&&0!==1B%(2y/8)) 11 C.68({2e:"fy/jv jy:"+1M},1f);if(\'8D\'==m[5]&&!(32==2y||64==2y))11 C.68({2e:"jz jC be 32/64 jB:"+1M},1f);J b={1R:m[1],aO:m[2],1B:m[3]};J 5I=s.5r.19?s.5r[s.5r.19-1]:1f;J bi=0;J aw=0;if(5I){bi=2K(5I.1B,16);aw=bi+1B}if(7Y&&1!=69&&!fz&&5I&&5I.1R==b.1R&&2K(5I.aO,16)+bi==2K(b.aO,16)&&aw<7T){5I.1B=56(aw)}1k{s.5r.3o(b);if(83)s.ao++}if(7Y){J f={aC:\'<\'==m[4]?1t:1e,1F:m[5].5W(0).c8()+m[5].55(1).dZ()+m[6],1B:1B,27:2y/8};J 7Z=s.5G.19?s.5G[s.5G.19-1]:1f;if(7Z&&1!=69&&7Z.1F==f.1F&&7Z.aC==f.aC){7Z.1B+=f.1B}1k{s.5G.3o(f);if(83)s.cU++}}if(1==69)69=0}J 4t=s.4t?s.4t:20;4t=12.d4(0,12.aI(d5,2K(4t)));J 4v=s.4v?s.4v:0;4v=12.d4(0,12.aI(d5,2K(4v)));if(\'8k\'==s.66)s.63=\'$B\'+56(s.ao)+56(s.5r.19-s.ao)+56(4t)+56(4v);17(i=0;i<s.5r.19;i++){J aJ=s.5r[i];J h=aJ.1R+aJ.aO+aJ.1B;if(\'8k\'==s.66){s.63+=h}1k{s.63+=\'$R\'+h}}11 1},53:M(em,fI,fJ){if(\'M\'==gr em)11 em(fI);11 fJ},fQ:M(e){C.aU=1t;C.53(C.aA,e)},fR:M(e){C.aU=1e;C.53(C.93,e)},fS:M(e){C.53(C.dL,e);if(e.2e jA fd){if(C.61&&\'8k\'==C.61.66)C.fP(e)}1k{J 5d=e.2e?e.2e.3X(0,8):\'\';if(C.8g.bo(5d)){C.fO(e,5d)}1k{if(C.65&&\'aD\'==C.65.66)C.fK(e)}}},68:M(e,fL){C.53(C.9V,e);11 fL},}.fM();M gB(7a,b8){17(J i in b8)if(b8.bo(i))7a[i]=b8[i];11 7a}M 56(b){11(\'fN\'+b.3N(16)).55(-2)}M ju(w){11(\'7z\'+w.3N(16)).55(-4)}M fx(dw){11(\'gc\'+dw.3N(16)).55(-8)}M fg(6B){J 6C=\'\';17(J i=0;i<6B.19;i++)6C+=56(6B.jt(i));11 6C}M fw(6B){11 56(6B.19)+fg(6B)}M jm(6C){J 7Q=[];17(2s=0;2s<6C.19;2s+=4){7Q.3o(jl(6C,2s))}11 7Q}M bO(aF){J 4s=12.bK(aF.19/2);J 1B=W jk(4s);17(J i=0;i<4s;i++)1B[i]=2K(aF.5W(i*2)+aF.5W(i*2+1),16);11 1B.6G}if(!3j.Z.fh)3j.Z.fh=M(3U,5m){11 5m?C.bl(3U+1,1t)*7T+C.28(3U,1t):C.bl(3U,1e)*7T+C.28(3U+2)};if(!3j.Z.fj)3j.Z.fj=M(3U,5m){11 5m?C.fk(3U+1,1t)*7T+C.28(3U,1t):C.fk(3U,1e)*7T+C.28(3U+2)};J ft=jj;J fu=0;J jn=0;J fr=fe;J fn=2;J fq=jo;J js=fe;J fs=8x;J 34=30;J fc=3.4;M 8N(4r,49,3F){11((4r)&49)>>3F}M fb(aP,2M){J aQ=0;J 60=0;J 57=0;J fl=12.jq(2M*fc);J 7F=W fd(fl);J 2V,1Y;if(2M>=34){2V=W 3j(aP,60,34);1Y=W 3j(7F,57,34);17(i=0;i<34;i++)1Y.2U(57+i,2V.28(57+i));60+=34;57+=34;++aQ}2v(60<2M){J n=12.aI(34,aP.6H-60);2V=W 3j(aP,60,n);1Y=W 3j(7F,57,34);J 2H=W 3j(7F,57-34,34);60+=fm(2V,1Y,2H);57+=34;++aQ}11 7F.55(0,aQ*34)}M fm(3H,2I,58){J i;J 2M;J 3h=0;J 1Y=0;J 2H=0;J 4r;J 49,3F;J 1Z,6Q;J 8P;J 2o;J 8A;J cw;J cF;4r=3H.28(3h++);4r|=3H.28(3h++)<<8;2M=8N(4r,ft,fu);1Z=3H.28(3h++);if(2M>=1){1Z|=3H.28(3h++)<<8;if(2M>=2){1Z|=3H.28(3h++)<<16;if(2M>=3)1Z|=3H.28(3h++)<<24}}cw=1Z&fv;cF=1Z&jp;1Z>>=2;8P=1Z;if(cF)8P=-8P;1Z=8P+fs;6Q=58.28(2H++);6Q|=58.28(2H++)<<8;6Q|=58.28(2H++)<<16;6Q|=58.28(2H++)<<24;1Z+=6Q;2I.2U(1Y++,1Z&4y);2I.2U(1Y++,(1Z>>8)&4y);2I.2U(1Y++,(1Z>>16)&4y);2I.2U(1Y++,(1Z>>24)&4y);49=fr;3F=fn;17(i=0;i<7;i++){if(i==3){1Y+=2;2H+=2}1k{2o=3H.28(3h++);if(8N(4r,49,3F))2o|=3H.28(3h++)<<8;++3F;49<<=1;if(i==6){if(cw)2o=-2o}1k{if(8N(4r,49,3F))2o=-2o;++3F;49<<=1}8A=58.bl(2H);2H+=2;2o+=8A;2I.2U(1Y++,(2o>>8)&4y);2I.2U(1Y++,2o&4y)}}17(i=0;i<6;i++){J bW=i<3;J 6O=1e;if(bW){6O=(1===8N(4r,49,3F));++3F;49<<=1}1k{2o=-20;8A=2I.bl(1Y+2o);6O=12.1C(8A)>=fq}if(6O){2I.2U(1Y++,3H.28(3h++));2I.2U(1Y++,3H.28(3h++));2H+=2}1k{if(bW){2I.2U(1Y++,58.28(2H++));2I.2U(1Y++,58.28(2H++))}1k{2I.2U(1Y++,0);2I.2U(1Y++,0);2H+=2}}}11 3h}M 7u(6K){J 5K=C;J gq=6K.6F(\',\');J cg={};J 2f=C.2f=[];gq.5Y(M(c9){J m=5K.gm.5v(c9);if(!m)kn"7u ko 6K 1M: ["+c9+"]";J 1M={37:m[1],cN:m[2]?1t:1e,5m:(\'<\'==m[3])?1t:1e,1F:m[4].5W(0).c8()+m[4].55(1).dZ()+m[5],1B:2K(m[5])/8,aq:m[6]?2K(m[6]):1};cg[1M.37]=1M.aq;2f.3o(1M)});C.dE=0;2f.5Y(M(1M){if(cg[1M.37]>1)1M.cN=1t;5K.dE+=1M.1B*1M.aq})}7u.Z.gm=W gi(\'^\\s*\'+\'([\\\\d\\\\w]+)\'+\'(\\\\*)?\'+\'\\s*:\\\\s*\'+\'([<>])\'+\'\\\\s*\'+\'(u?b7|8D)(8|16|24|32|64)\'+\'(?:\\\\s*:\\\\s*\'+\'(\\\\d+)\'+\')?\\\\s*$\',\'i\');7u.Z.li=M(6G){C.6G=6G;C.gl=W 3j(6G);C.2s=0;11 C};7u.Z.gE=M(){J 5K=C;J 2V={};if(C.2s+C.dE<=C.6G.6H){C.2f.5Y(M(1M){17(J i=0;i<1M.aq;i++){J v=5K.gl[\'cT\'+1M.1F](5K.2s,1M.5m);if(1M.cN){if(\'4p\'!==gr 2V[1M.37]){2V[1M.37].3o(v)}1k{2V[1M.37]=[v]}}1k{2V[1M.37]=v}5K.2s+=1M.1B}});11 2V}1k{11 1f}};7u.Z.lh=M(){J c7=[];2v((2V=C.gE())!==1f)c7.3o(2V);11 c7};$1N.3E="2.2.13";$1N.fB=lg;$1N.cP=0.lj;M ff(2m,gt){J m;6k(2m){1E $1N.bM:m="lk";1x;1E $1N.dQ:m="ln";1x;1E $1N.dD:m="lm";1x}C.3A="ll";C.2m=2m;C.gt=m}M fa(2f){C.3A="2m";C.lf=2f.dn*0.7V;C.bg=-12.1C(2f.bg);C.7d=2f.7d}M c3(1w){C.3A="fW";C.le=1w.38.2z.q[1];C.l8=1w.38.2z.q[2];C.l7=1w.38.2z.q[3];C.l6=[1w.31.1H[0].n.2h(2),1w.31.1H[1].n.2h(2),1w.31.1H[2].n.2h(2)];C.l5=1w.31.1v;C.l9=[1w.31.1H[0].m.2h(4),1w.31.1H[1].m.2h(4),1w.31.1H[2].m.2h(4)];C.la=[1w.31.1H[0].b.2h(4),1w.31.1H[1].b.2h(4),1w.31.1H[2].b.2h(4)];C.ld=1w.3i.21;C.lc=1w.3i.1v;C.lb=1w.3i.2q;C.lo=[1w.2c.1H[0].n.2h(2),1w.2c.1H[1].n.2h(2),1w.2c.1H[2].n.2h(2)];C.lp=1w.2c.1v;C.lE=[1w.2c.1H[0].m.2h(4),1w.2c.1H[1].m.2h(4),1w.2c.1H[2].m.2h(4)];C.lD=[1w.2c.1H[0].b.2h(4),1w.2c.1H[1].b.2h(4),1w.2c.1H[2].b.2h(4)];C.lC=1w.2W.21;C.lF=1w.2W.1v;C.lG=1w.2W.2q}M ca(1w){C.3A="fW 2m";C.cs=1f;C.cs=0;if(1w.38.1v)C.cs|=g6<<6;if(1w.3i.1v)C.cs|=g6<<4;if(1w.4k.1v)C.cs|=9x<<3;if(1w.2W.1v)C.cs|=9x<<2;if(1w.2c.1v[0]&&1w.2c.1v[1])C.cs|=9x<<1;if(1w.2c.1v[2])C.cs|=9x<<0;C.cs=C.cs.3N(2);C.cs="gc".3X(C.cs.19)+C.cs;C.lJ=1w.91.2a;C.lI=1w.91.3c;C.lH=1w.9e.2a;C.lB=1w.9e.3c;C.lA=1w.8o.2a;C.ls=1w.8o.3c}M f3(1j,3b){C.3A="lr";C.1j=1j;C.x=3b.8q.q[1];C.y=3b.8q.q[2];C.dx=3b.4O.q[1];C.dy=3b.4O.q[2]}M eE(1j,3b){C.3A="3b";C.1j=1j;C.g8=3b.6y;C.gf=3b.3f*$1N.cP;C.lq=0;C.lt=3b.8r;C.lu=3b.7x;C.lz=3b.9J}M eG(1j,t){J m;6k(t.1D){1E 1d.7m:m="6i lw 17 lv";1x;1E 1d.7M:m="6i l4";1x;1E 1d.4Q:m="6i l3 ga";1x;1E 1d.7t:m="6i kC kB";1x;1E 1d.7v:m="6i kA";1x;1E 1d.5B:m="6i ga kD kE";1x;1E 1d.ag:m="6i kH kG kF";1x;7l:m="kz???";1x}C.1j=1j;C.3A="ky";C.ks=t.1D;C.kr=m;C.x=t.3r.q[1];C.y=t.3r.q[2];C.z=t.3r.q[3];C.9o=t.9o;C.kq=t.6r;C.2x=t.7p;C.7O=t.7w;C.g8=t.a6;C.8m=t.8m;C.9d=t.9d;C.5x=t.5x;C.gf=t.3f*$1N.cP;C.2Z=t.2Z}M dK(1j,g,G,a,A,m,q){C.3A="84";C.1j=1j;C.gx=g.q[1];C.gy=g.q[2];C.gz=g.q[3];C.8Q=G.q[1];C.8R=G.q[2];C.8U=G.q[3];C.ax=a.q[1];C.ay=a.q[2];C.az=a.q[3];C.6h=A.q[1];C.6v=A.q[2];C.6s=A.q[3];C.mx=m.q[1];C.my=m.q[2];C.mz=m.q[3];C.ge=q.q[0];C.gd=q.q[1];C.g5=q.q[2];C.fX=q.q[3]}M cD(cS,d2){C.3A="kp";C.cS=cS;C.d2=d2}M hl(1j){C.3A="kt";C.1j=1j}M eK(r,n){C.3A="ku";C.x=r.q[1];C.y=r.q[2];C.z=r.q[3];C.nx=n[0];C.ny=n[1];C.nz=n[2]}gB($1N,{8y:1f,8u:1f,ec:1f,aT:1f,bV:1f,dF:1f,aB:1f,bC:1f,bS:1f,ce:1f,ct:1f,ck:1f,cQ:1f,2F:1e,e5:-1,bM:1,dQ:0,dD:-1,c4:1e,5P:W 1d(),7i:W 5A(),5E:W 7r(),5t:2X.gD("kx"),go:\'kw.kv.4.1\',aj:0.5C,dN:90,7S:W 1s(),7E:0,kI:"",kJ:10,kX:1f,kW:1e,aa:1e,bf:[],9Z:0,am:0,5S:1f,b1:1f,aG:0,h0:W 14(0,0,0,0),he:W 14(0,0,0,0),gH:W 14(0,0,0,0),hd:W 14(0,0,0,0),h7:W 14(0,0,0,0),9N:W 14(0,0,0,0),c1:W 14(0,0,0,0),9O:1t,kV:W 14(0,0,0,0),bk:M(){C.c4=1t;if(C.2F)11;C.cd=C.dJ.2l(C);C.fp();if(C.au())C.cV();1k C.gp(C.go)},bY:M(){if(C.2F)$1N.fU();C.2F=1e;C.c4=1e},kY:M(){C.bf=[];C.9Z=0;C.aa=1t},eu:M(){C.aa=1e},kZ:M(2e){C.bY();C.l2();C.dJ(2e)},l1:M(2e){if(C.5S===1f){C.bY();C.e8();if(C.b1!==2e){C.b1=2e;C.cc()}C.bZ()}},fp:M(){if(C.5S!==1f){l0(C.5S);C.5S=1f}},cc:M(){C.aG=0;C.am=0},kU:M(){C.5t.as();C.9v()},e8:M(){C.5P.1r();C.7S.1r();C.5E.1r();C.7i.aR();C.7E=-1;C.9O=1t;C.9v()},9v:M(){if(C.8y!==1f)C.8y(W c3(C.5t));if(C.8u!==1f)C.8u(W ca(C.5t))},fE:M(S){if(C.bS!==1f)C.bS(W fa(S))},aV:M(2m){C.2m=2m;J s=W ff(2m,"");if(C.bC!==1f)C.bC(s)},eL:M(e){C.aV(C.bM);C.cV()},eA:M(e){if(!C.au()){C.2F=1e;C.aV(C.dQ)}},eW:M(e){if(!C.au()){C.2F=1e;C.aV(C.dD)}},cV:M(){C.5v("7d",C.fA.2l(C))},fA:M(e){J 3E=5w(e.7d);C.e5=3E;C.5v("bg, dn, 7d",C.fE.2l(C));C.9v();C.hw()},hw:M(){if(C.2F)11;J ek;J ee;ek="$kT"+"$kN"+"$kM";C.aj=0.7V;ee="1Z,aX,aY,aZ,cW,gX,gY,gZ,mX,mY,mZ,6h,6v,6s,8Q,8R,8U";C.5z(ek);C.e8();if(C.e5<32)C.ef(ee,8x*C.aj,C.dN,1f);1k C.ef("6Z:1",8x*C.aj,C.dN,1f);C.2F=1t},dJ:M(s){J n=s.S.72.19;J i;17(i=0;i<n;i++){J d=s.S.72[i];C.aK(d,1e)}},aK:M(d,c5){J g=C.h0,G=C.gH,a=C.he,A=C.hd,m=C.h7;J ae;J kL;J 1j;d.1Z*=0.bI;if(C.7E<0)1j=0;1k 1j=hk(d.1Z,C.7E);C.7E=d.1Z;if(C.ck!==1f)C.ck(W hl(1j));if(c5){g.1y(0,d.gx,d.gy,d.gz);a.1y(0,d.ax,d.ay,d.az);m.1y(0,d.mx,d.my,d.mz);G.1y(0,d.8Q,d.8R,d.8U);A.1y(0,d.6h,d.6v,d.6s)}1k{g.1y(0,d.gX,d.gY,d.gZ);a.1y(0,d.aX,d.aY,d.aZ);m.1y(0,d.mY,d.mX,-d.mZ);G.1y(0,d.8Q,d.8R,d.8U);A.1y(0,-d.6h,-d.6v,d.6s);if(C.9O){C.9O=1e;m.1I(C.9N)}J gO=m.gN(C.9N);m.1I(C.9N);if(gO)m.1I(C.c1);1k C.c1.1I(m);a.1V((16/8B.0),a); A.1V((kK/8B.0),A); g.1V(kO*12.4f/(8B.0*gV),g); G.1V(kP*12.4f/(8B.0*gV),G); m.1V((0.kS*kR/8B.0),m); if(C.bV!==1f)C.bV(W dK(1j,g,G,a,A,m,C.5E.1n));ae=C.5t.1S(1t,g,G,a,A,m);if(ae&&(C.8y!==1f))C.8y(W c3(C.5t));if(ae&&(C.8u!==1f))C.8u(W ca(C.5t));a.1V(C.5P.5y,a);A.1V(C.5P.5y,A)}if(C.aa&&!c5){d.gx=g.q[1];d.gy=g.q[2];d.gz=g.q[3];d.ax=a.q[1];d.ay=a.q[2];d.az=a.q[3];d.mx=m.q[1];d.my=m.q[2];d.mz=m.q[3];d.6h=A.q[1];d.6v=A.q[2];d.6s=A.q[3];J bX=C.bf.19<C.fB;if(bX){C.bf.3o(d);C.9Z+=1j}1k C.eu();if(C.ce!==1f)C.ce(W cD(C.9Z,bX))}a.q[1]=C.at(a.q[1],A.q[1],10*9.81,16*9.81);a.q[2]=C.at(a.q[2],A.q[2],10*9.81,16*9.81);a.q[3]=C.at(a.q[3],A.q[3],10*9.81,16*9.81);C.7i.1S(1j,g,a);C.5E.ab(1j,g.q[1],g.q[2],g.q[3],a.q[1],a.q[2],a.q[3],m.q[1],m.q[2],m.q[3]);if(C.dF!==1f)C.dF(W dK(1j,g,G,a,A,m,C.5E.1n));if(C.ec!==1f){C.5P.1S(1j,C.5E.1n,g,a);C.ec(W eG(1j,C.5P));if(C.5P.1D==1d.5B)if(C.7i.eM(g,a))if(C.cQ!==1f)C.cQ(W eK(C.7i.73,C.7i.3M))}if((C.aT!==1f)||(C.aB!==1f)){J e7=C.aT!==1f;e7&=C.7S.1S(1j,C.5E.1n,g,a);if(e7)C.aT(W eE(1j,C.7S));if(C.aB!==1f)C.aB(W f3(1j,C.7S))}},bZ:M(){J cm=0.1;J i=C.aG;J d=C.b1;J 6P=0;2v(i<d.19-1){C.aK(d[i],1t);J cq=(d[0].ms)?((d[i+1].ms-d[i].ms)*0.7V):((d[i+1].1Z-d[i].1Z)*0.bI);++i;if(cq<=0)1x;6P+=cq;if(6P>=cm)1x}J cu=(6P>=cm);if(i==(d.19-1))C.aK(d[i++],1t);C.aG=i;C.am+=6P;if(C.ct!==1f)C.ct(W cD(C.am,cu));if(cu){C.5S=kQ(C.bZ.2l(C),6P*8x)}1k{C.5S=1f;C.cc()}},at:M(a,A,bH,eX){J 2i=12.1C((a*0.75)+(A*0.25));2i=((2i-bH)/(eX-bH));if(2i<0)2i=0;if(2i>1)2i=1;A*=2i;a*=1-2i;11(A*2i)+(a*(1-2i))},});$1N.aA=$1N.eL.2l($1N);$1N.93=$1N.eA.2l($1N);$1N.9V=$1N.eW.2l($1N);',62,1495,'||||||||||||||||||||||||||||||||||||||this|||||||var|||function||||||result||||new|||prototype||return|Math||Quaternion|||for||length|q3|q2|temp|Flightkick|false|null|generic|q1|q0|sample_interval|else|matrix_new|recipNorm|orientation|sqrt|MMap|FIR|init|Rollkick|true|int16|calibrated|calib|break|set|AQ|order|bytes|abs|state|case|type|state_timer|regression_vars|copy|uint8|q2q2|samples|field|IC|matrix_multiply|61803398875|sample_freq|address|update|_2bz|_2bx|multiply_real|beta|norm|output|us||num_collected_samples|||||q1q1|size|getUint8|theta|mean|q1q3|ACC_calibrator|tolerance|data|fields|q3q3|toFixed|coefficient|index|uncorrected|bind|status|rotation_axis|value|q0q2|epsilon|orientation_|offset|acc|reference_vector|while|q0q1|height|bits|offsets|previous|G_tilde|callback|filtered_gyro|inverse_sqrt|is_tracking|Array|prev_out|curr|covariance|parseInt|add|num_bytes|cutoff|samples_per_reference_vector|q_2|a_variance|_websocket|one_over_n|mag|setUint8|packet|mag_calibrator|Calibration|error|arc_length||GYRO_calibrator||bin|COMPRESSION_SAMPLE_FRAME_NUM_BYTES|g_bias_|ValentiAHRS|name|gyro_calibrator|accel|gain|rollkick|variance|s0|bandwidth|max_accel|sample_rate|in_offset|acc_calibrator|DataView|buf|tmp|order_4|normalize|push|q2q3|temp_q|position|q0q0|s2|s3|correct_measurement|s1|gamma|sample_added|window_type|event_type|max_order|b_theta_2|matrix_multiply_scalar|version|shift|zero|input|BalutaCalibrator|matrix_add|OnlineAverage|first_time|num_calibration_samples|toString|B_tilde|q1q2|Accel|q0q3|WonCalibrator|corrected_kick_position|byteOffset|sanity|qc|substr|rotation_axis_deriv|inflate|a_mean|b_mean|_2q2|_2q1|d_a|qb||inv_norm|exp|mask|phase|ssss|bbbb|tmp1|rotated_spin|PI|tmp2|RegressionCalibrator|qa|acc_|mag_offset_calibrator|Pyy|thet|NASA_Calibrator|onset_signal|undefined|msg|header|len|interval_ms_min|coeff|loops_desired|twoKi|next_sample|0xFF|scratch|G_inverse|Cal|maxnum_samples|should_do_main_sensor|order_plus_1|halfvy|sample|halfvz|qDot4|i_minus_m_over_2|m_over_2|qDot3|_2q3|d_b|corrected_velocity|new_m|STATE_POSSIBLY_FLYING|_2q0|qDot1|halfvx|sin|monitor_and_pick_samples|qDot2|window|init_window|binary|kGravity|QuaternionTrapezoidIntegral|is_little_endian|_callback||slice|uint8_hex|output_offset|prev|gyro|OffsetCalibrator|rotate|multiply|earmark_hex|field_name|Pxy|halfex|spin_mag|fancy_x|reference_max|Y_minus_y|reference_min|littleEndian|halfez|halfey|exponent|part|blocks|delta|calibration|delta_x|exec|parseFloat|flight_time|gravity|send|Centripetal_Accel|STATE_IN_FREEFALL|01|expected_head_bytes|ahrs|_ic|formats|storage_name|b_prev|request|_this|Y_minus_y_2|Y_minus_y_t|127|X_minus_y_2|flightkick|fancy_y|gyro_motion_threshold|_data_playback_thread|sign|num_reference_vectors|total_collected_samples|charAt|pivrow|forEach|n_minus_1_over_n|packet_offset|_session_batch|conjugate|send_cmd||_session_read|session_type|intPart|_onerror|block_loop_read_first|part_str|tr|integralFBx|order_3|order_2|update_imu|twoKp|AX|ball|dead_state|switch|mag_|integrate|accel_accel|order_1|f_t_1|matrix_transpose|total_xy_distance|AZ|matrix_invert|integralFBz|AY|prediction_|integralFBy|max_spin|matrix_copy|value_prev|str|hex|reference_vector_has_sample|new_b|split|buffer|byteLength|check_acceleration|delta_max|format|r_init|prefix|uint32|test|duration|prev_us|_2q0q2|sliced|cmd|output_type|acc_magnitude|buf_i|sample_index|phase_increment|custom|url|coeffs|objects|ball_center|rz||uint16|DEAD_STATE_AT_REST|_2q2q3|running_result|obj|MAX_REST_ACCELERATION|subtract|fwv|ry|expected_loop_bytes|rx|rounded|centripetal|old_mean|CALIBRATION_MATRIX_NUM_BYTES|default|STATE_AT_REST|online_average|delta_min|max_height|was_moving|MadgwickAHRS|next|STATE_BEING_CARRIED|ICPacketDecoder|STATE_ROLLING|max_linear_speed|roll_distance|sqy|0000|MovingAverage|angle|velocity|ACC|_prev_sample_time|output_buffer|I_plus_neg_theta|U_t|sqz|lastBit|MIN_FREEFALL_TOLERANCE|half_distance_between_zeros|STATE_DROPKICK_DROPPING|wx_unb|linear_speed|gain_acc_|array|IC_MAP|_rollkick|256|floatPart|001|factor|q3_|is_read|f_prev|X_minus_x||angular_vel|is_head|raw|kAccelerationThreshold|L_plus_lambda|q0_|fields_parts|wz_unb|g_prev_|init_coeffs|std_dev|sqw|sgn|avg|_exec_requests|multiply_pointwise|_4q1|cos|batch|128|topspin|Infinity|mag_error|f_t_2|corrected_position|roll_duration|ADDRESS_INITIAL|add_sample|oncalibratestatus|accel_mag|correction_rate|1000|oncalibrate|GYRO_MOTION_THRESHOLD|prev_val|32767|gy2|float|dead_velocity|initialized_|q1_|prev_rotation_axis|pivrows|wy_unb|gx2|gz2|temp_1|compression_get_header_value|q2_|us_delta|GX|GY|oldest_sample|sqx|GZ|_4q2|_exec_earmark|delta_sum|prev_samples|prev_delta||gyro_error|error1|onclose|needed_calibration_samples|updated_x|BAND_PASS_TYPE|_2q1mx|updated_P|_4bz|HIGH_PASS_TYPE|log|vector_cross_product|rightspin|acc_error|QuaternionDerivative|kAngularVelocityThreshold|kDeltaAngularVelocityThreshold|_4q0|dv_i|values|_8q2|did_impact|_8q1|ball_did_land|_4bx|bias_alpha_|max_calibration_error|set_cutoff|scale_quaternion|p_inv|_send_calibration_status|check_state|0x1|quat|sin_theta_2||halfwx|halfwy|int8|avg_spin_x|MahoneyAHRS|rotation_axis_deriv_sign|lambda|a_rotated|roll_direction|halfwz|DEBOUNCE_DURATION|accel_derivative|_m_prev|_first_time|is_dead_reckoning|pos_theta|b_variance|avg_spin_y|avg_spin_z|STATE_STATIONARY|onerror|STATE_COLLIDING|dead_timer|atan2|_running_record_duration||||_2q0my|init_mean|old_s|max_angular_speed|omega_1|filtered_x|b_normal|recording_is_armed|update_marg|past_samples|_2q0mz|should_call|_2q0mx|STATE_BOUNCING|new_mean|init_variance|_ic_interval|read_parts|calculate_calibration_parameters|_running_playback_duration|val|block_head_count|delta_function|count||reset|_weighted_average|is_connected|accel_gyro_motion_threshold|bytes_new||||onopen|onsurveyorswheel|endianess|read|new_value|hexString|_playing_data_current_i|min_samples|min|__b|_update|Gi|new_regression_vars|number|reg|packet_buffer|num_sample_frames|clear|index_of_nearest_reference_vector|onrollkick|_connected|_connection_state_did_change|b_data||||num_floats|_playing_data|should_add_sample|H_t|significandBase|floats|nonsingular|int|extension|filter_type||reference_vectors|mantissa|construct_read_message||recorded_data|rssi|significandBin|bytes_prev|iteration|start_tracking|getInt16|a_data|inflate_regression_vars|hasOwnProperty|126|matrix_make_identity|state_did_change|write_bytes|did_add_sample|omega_0|surveyors_wheel_velocity|matrix_set||angular_speed||McGinnisAHRS|rotation_accel|onconnection|a_2|80665|check_filtered_acceleration|DEAD_STATE_AWAITING_FREEFALL|cutoff_min|000001|two_h|floor|sample_count|STATUS_CONNECTED|OnlineRegression|hex_to_arraybuffer|T_H_t|DEAD_STATE_RECKONING|c_t|onstatus|ONSET_THRESHOLD|prev_reference_vector|onraw_uncalibrated|is_mag|will_continue_recording|stop_tracking|_data_playback_thread_run_loop|000404|_m_last_valid|matrix_fill_identity|IC_Calibrate_Event_Info|should_be_tracking|is_recorded_data|b_inv|packets|toUpperCase|field_str|IC_Calibrate_Status_Event_Info|magnitude|rewind_playing_data|onbatch|onrecord|STATE_INITIAL|fieldTotalCount|acos|accel_rotated_mag|DROPKICK_MODE|ondatarate|MAX_ADDRESS_PLUS_1|PACKET_DURATION|I_plus_pos_theta|js_number_to_ieee_754_32|vector_dot_product|inc|strange_workaround_self||onplayback|will_continue_playing|000004|gZ_is_negative||||prev_accel_mag|QuaternionSimpsonsIntegral|prev_prev|IC_Record_Playback_Event_Info|significand|us_is_negative|neg_theta|new_linear_speed|_format_info|W_c_0|max_dot_product|cmd_all|mag_gyro_motion_threshold|isArray|get_adaptive_gain|BALL_MASS|onrevent|ALL_PASS_TYPE|running_duration|get|formats_head_count|_track_check_ball_type_before_batch_start|tT|console|nxt|exec_parse_float_32_and_dispatch_callback|error2|dead_velocity_integral|will_continue|parts_str|max|255|W_c_i|_earmark|D2|separator|dot|field_name_by_offset|matrix_swap_rows||c_t_E|field_list|matrix_add_I|field_head_count|E_inv|replace|temp_P|_parse_fields|signal|batt||_parse_buffer|get_acc_correction|corrected_integral|set_window_type|sqrt_P|GYRO|||||get_prediction|D_plus_I|localStorage|check_order|STATUS_ERROR|packetLength|onraw|smoothing|in_min|T_inv|_track_onbatch|IC_Raw_Event_Info|onmessage|temp_2|_ic_packets|angular_accel|out_min|STATUS_DISCONNECTED|do_bias_estimation_|raw_accel|DeltaCalculator|A_inv|AdaptiveThreshold|Error|accel_magnitude|BALL_CENTER_INITIAL_ESTIMATE|toLowerCase|do_adaptive_gain_|mode|BAND_STOP_TYPE|matrix_subtract|endian|firmware_version|10000|should_call_onrollkick|soft_init|Type_bits|update_biases|f_t|onflight|K_t|batch_fields|batch_start|success||init_allpass_coeffs|angular_accel_deriv|configuration|q_normal|func|half_bandwidth|alpha_2||two_pi_f_t_1||two_pi_f_t_2|steady_state_|disarm_recording|verify_calibration|prev_spin_mag|ball_radius|W_m_0|get_measurement_imu|_track_onclose|MAX_ERROR|matrix_3_3_eigndecomposition|in_max|IC_Rollkick_Event_Info|out_max|IC_Flight_Event_Info|W_m_i|temp_p|JSON|IC_R_Event_Info|_track_onopen|estimate_ball_center|Pyy_inv|a_mag|005|alpha|vy|init_matrices|corrected_kick_integral|accel_deriv|MAX_COLLISION_DURATION|_track_onerror|cutoff_max|online_update_regression|user_requested_sample|use_dead_reckoning|ball_diameter|save|IC_Surveyors_Wheel_Event_Info|A_temp|cos_theta_2|DEAD_MAX_FREFALL_DELAY|vx|q_reference|init_hann_window|IC_Status_Event_Info|compression_uncompress_packet|COMPRESSION_MAX_COMPRESSION_RATE|ArrayBuffer|0x0004|IC_Connection_Event_Info|str2hex|getInt24||getUint24|getUint16|max_bytes|compression_uncompress_one_sample_frame|COMPRESSION_HEADER_aX_SHIFT|result_array|pause_playing_data|COMPRESSION_HIGH_G_THRESHHOLD|COMPRESSION_HEADER_aX_MASK|COMPRESSION_EXPECTED_US|COMPRESSION_HEADER_us_MASK|COMPRESSION_HEADER_us_SHIFT|0x01|str2lenhex|uint32_hex|Bytes|do_not_combine|_track_check_ball_type_before_batch_start_callback|MAX_NUM_RECORDED_SAMPLES|WINDOW_RESERVED|_FIELD_REGEX|_status_message_notify_user|join|LOW_PASS_TYPE|NUMBER_OF_TYPES|param|return_default|_onread|return_value|_init|00|_onexec|_onbatch|_onopen|_onclose|_onmessage|matrix_fill_zeros|batch_end|CALIBRATION_MATRIX_NUM_ENTRIES|calibrate|qz|CALIBRATION_MATRIX_COLS|CALIBRATION_FLOAT_NUM_BYTES|ADDRESS_CHECKSUM|ADDRESS_LOW_ACCEL_CALIBRATION_MATRIX|ADDRESS_LOW_GYRO_CALIBRATION_MATRIX|ADDRESS_MMAP_VERSION|ADDRESS_SIZE|qy|0x3|random|spin|threshold|flying|CALIBRATION_MATRIX_ROWS|00000000|qx|qw|force|ADDRESS_MAG_CALIBRATION_MATRIX|ADDRESS_HIGH_ACCEL_CALIBRATION_MATRIX|RegExp|ieee_754_to_js_number_32|matrix_lup_inverse|dataview|FORMAT_REGEX|matrix_lup_decompose|_ic_ip_address|connect|fields_str|typeof|matrix_invert_gauss_jordan_2|message|maxsteps|FLASH_SIZE|ADDRESS_HIGH_GYRO_CALIBRATION_MATRIX||||exec_dispatch_callback|obj_extend|matrix_gauss_jordan|_new|decodeNext|WINDOW_RECT|129|_G|uint0|update_velocity_and_position|FREEKICK_MODE|velocity_integral|position_integral|is_equal_to|is_equal|MAX_DROPKICK_DROP_DURATION|psi|phi|two_over_m|max_iterations|init_rect_window|180|rho||||_g|init_blackmann_window|init_hamming_window|MAX_CONTACT_WITH_FOOT_DURATION|twoKiDef|get_absolute_orientation|height_squared|_m|matrix_to_quaternion|skew_symmetric|arc_length_of_parabola|h_2|estimated_half_distance_between_zeros_of_parabola|_A|_a|MIN_BOUNCE_DURATION|MAX_FREEFALL_DURATION|MIN_ACCEL_UPON_LANDING|twoKpDef|prev_state|uint32_diff|IC_Data_Rate_Event_Info|end_of_trajectory_calculations|two_pi_f_t_R|init_bartlett_window|get_measurement_marg|substring|get_mag_correction|getFunc|gain_mag_|0x10000|exec_str|_track_batch_start|||vz|differentiate|WINDOW_BARTLETT|WINDOW_HANN|WINDOW_HAMMING|WINDOW_BLACKMANN|onread|_url|cols|inverse_norm|dot_product|ws|invert|rows|uint24|two_pi_f_t_L|init_bandpass_bandstop_coeffs|uint|_debug|num_samples|WebSocket|init_lowpass_highpass_coeffs|two_pi_f_t|r_2|get_angle_axis|newValue|__matrix_to_quaternion|read_bytes|asin|matrix_cholesky_decomposition|100000|to_matrix|E6|random_normal|MMAP_VERSION|0x00|to_euler_angles|filter|1024|ADDRESS_R_CALIBRATION_MATRIX||matrix_cols||uint8_diff|process|result_i|get_window_type|0xff800000|0x7f800000|281||0x7fc00000|scalef|matrix_subtract_I|||0x100|get_sample_rate|get_cuttoff|set_order|set_sample_rate|get_filter_type|0x80000000|result_j|set_filter_type|pow|0x100000000|asinh|matrix_invert_gauss_jordan_1|00000000000000000000000000000000|write_floats_32|half_distance_between_zeros_of_parabola|write_float_32|read_floats_32|100|hypot|indexOf|MIN_DROPKICK_ACCELERATION|05|print|matrix_get_array|matrix_num_entries|set_angle_axis|get_order|matrix_rows|read_float_32|286702|not|received|C01|earmark|multiple|of|head|one|Only|_parse_read|keys|close|disconnect|arraybuffer|readyState|Send|Object|continue|0xEAAE|allowed|_|0x0003|Uint8Array|hexLH_sint32_parse|hexLH_sint32_array|COMPRESSION_FRAME_us_INDEX|0x1FFF|0x02|ceil||COMPRESSION_FRAME_aX_INDEX|charCodeAt|uint16_hex|Bits|0x80|Invalid|mismatch|Floats|instanceof|only|can|binaryType|err|084502|084302|084102|083F02|084702|084902|mpu_who|084D02|084B02|083D02|083B02|se|283901|ss|283A01|p1|280A01|_gc|A80701|087501|18A802||||int24|5CA803|ps|687501|bar_who|5C0F01|catch|try|setFunc|GYR_who||684702|ACC_who|18AC02|18AA02|180F01|GT|684502|684302|684102|throw|invalid|record|horizontal_distance|flight_state_message|flight_state|datarate|r_event|168|192|ic_calibration_|flight|whaaa|rolling|carried|being|through|air|landing|after|bouncing|_status_fields|_status_interval|400|sample_time|w681B19|w1823B0|2000|4000|setTimeout|4900|02222|w18203F|reset_calibration|_q|_status_thread_running|_status_thread|arm_recording|render_data|clearTimeout|start_playing_data|stop_playing_data|possibly|dropped|GYRO_calibrated|GYRO_num_calibration_samples|gyro_z_offset|gyro_y_offset|GYRO_m|GYRO_b|acc_calibration_error|acc_calibated|acc_num_calibration_samples|gyro_x_offset|volts|12000|decodeAll|setBuffer|4446|YES|connection|ERROR|NO|ACC_num_calibration_samples|ACC_calibrated|energy|surveyorswheel|mag_sigma|duration_since_prev|distance_since_prev|kick|ready|||direction|mag_mu|acc_sigma|mag_num_calibration_samples|ACC_b|ACC_m|mag_calibated|mag_calibration_error|acc_mu|gyro_sigma|gyro_mu|283601|OPEN|002E01|hws|002F01|bal|003001|brl|003101|bam|hwv|002503|001401|ie_ms5|001301|ie_mpu|001501|st|002203|MACH|003201|brf|280001|bno_who|283D01|280802|280A02|285502|aox|280C02|opr|A80700|003402|bsq|003301|blc|003602|p0|003802|bls|ie_itg|001201||||calculate_theta|0000000001|corrected|calculate_theta_from_measurement||||calculate_fancy_x|calculate_fancy_y|sqrt_p|matrix_choleski_decomposition|stringify|setItem|parse|getItem|04|stored|has|removeItem|should|wrong|calculate_y|W_i_m|000C02|int32|000804|000E02|001001|ie_h3l|001101||||ie_bno|us1|us0|calculate_D_and_b_from_theta|calculate_P_and_updated_x|W_0_m|init_position|02|ms1|ms0|aoy|MACL|281C02|281A02|goz|282E02|281E02|282002|282602|282402|282202|286302|goy|tt|281602|283401|281802|gox|286102|283002|283202|_qwL|282001||||282802|_qyH|285702|282701|_qzH|282501|_qzL|282601|282A02|282401|282101|_qwH|282C02|_qxL|282201|_qyL|282301|_qxH|281402|286502|283501|285B02|280E02|moz|285D02|moy|285F02|285902|281002|281202|mox|286902|aoz'.split('|'),0,{}))

var global_audio_context = null;

if('webkitAudioContext' in window)
  global_audio_context = new webkitAudioContext();
else if('AudioContext' in window)
  global_audio_context = new AudioContext();

/*------------------------------------------------------------*/
function Audio_File_Player(filename, audio_element_id, should_loop)
{
  this.audio_nodes    = {};
  this.audio_buffer   = null;
  this.audio_element  = null;
  this.audio_source   = null;
  this.source_type    = "";
  this.filename       = filename;
  //this.gain           = 1.0;
  //this.target_gain    = 1.0;
  //this.gain_filter_coeff = 0.001;
  //this.one_minus_gain_filter_coeff = 1 - this.gain_filter_coeff;
  
  this.cordova_media  = null;
  this.loop           = should_loop;
  
  if(audio_element_id !== undefined)
    this.audio_element = document.getElementById(audio_element_id);
  
  this.init(filename, this.audio_element);
}

/*------------------------------------------------------------*/
Audio_File_Player.prototype.init = function(filename, audio_element)
{
  //var browser = navigator.userAgent.toLowerCase();
  //browser = (browser.match(/msie|firefox|chrome|safari|opera/g) || "other")[0];
  //console.log("Browser", browser);
  
  //this.create_cordova_plugin_source(filename);
  
  //if(browser == 'safari')
  if(global_audio_context !== null)
    {
      this.audio_nodes.gain       = global_audio_context.createGain();
      //this.audio_nodes.gain       = global_audio_context.createScriptProcessor(1024, 1, 1);;
      this.audio_nodes.gain.connect(global_audio_context.destination);
      this.audio_nodes.gain.gain.value   =  1;
      //this.audio_nodes.gain.onaudioprocess = this.process_gain.bind(this);
      this.create_buffer_source(filename);
      //this.create_media_element_source(filename, audio_element);
    }
  else
    this.create_no_web_audio_source(filename, audio_element);
}

//MOVE THIS DOWN LATER
/*------------------------------------------------------------*/
/*
Audio_File_Player.prototype.process_gain = function(audioProcessingEvent)
{
  var input_buffer  = audioProcessingEvent.inputBuffer;
  var output_buffer = audioProcessingEvent.outputBuffer;
  
  var chan, sample;
  
  for(chan=0; chan<output_buffer.numberOfChannels; chan++) 
    {
      var input_data  = input_buffer.getChannelData(chan);
      var output_data = output_buffer.getChannelData(chan);

      for(sample=0; sample<input_buffer.length; sample++) 
        {
          output_data[sample] = input_data[sample] * this.gain;
          this.gain = (this.gain_filter_coeff * this.target_gain) + (this.one_minus_gain_filter_coeff * this.gain);
        }
    }
}
*/

/*------------------------------------------------------------*/
Audio_File_Player.prototype.create_buffer_source = function(filename) 
{
  //console.log("create_buffer_source");
  this.source_type = 'buffer';
  
  var request = new XMLHttpRequest();
  
  request.open("GET", filename, true);
  request.responseType = 'arraybuffer';
  request.addEventListener('load', this.file_opened_callback.bind(this), false);
  request.send();
}

/*------------------------------------------------------------*/
Audio_File_Player.prototype.file_opened_callback = function(event)
{
  var request = event.target;
  if(request.response != null)
    {
      //console.log(request.response);
      //this.audio_buffer = global_audio_context.createBuffer(request.response, false);
      global_audio_context.decodeAudioData(request.response, function(buffer)
        {this.audio_buffer = buffer;}.bind(this));
      //var source = global_audio_context.createBufferSource();
      //source.buffer = this.audio_buffer;
      //this.connect_audio_source_to_graph(source);
    }
  else console.log('invalid http request response');
}

/*------------------------------------------------------------*/
Audio_File_Player.prototype.create_media_element_source = function(filename, audio_element) 
{
  //console.log("create_media_element_source");
  this.source_type = 'media_element';
  var source = global_audio_context.createMediaElementSource(audio_element);
  //audio_element.src = filename;
  audio_element.innerHTML = "<source src='" + filename + "' type='audio/mpeg' />";
  audio_element.volume = 1;
  
  this.connect_audio_source_to_graph(source);
}

/*------------------------------------------------------------*/
Audio_File_Player.prototype.create_no_web_audio_source = function(filename, audio_element) 
{
  //console.log("create_no_web_audio_source");
  this.source_type = 'no_web_audio';
  //audio_element.src = filename;
  audio_element.innerHTML = "<source src='" + filename + "' type='audio/mpeg' />";
  audio_element.volume = 1;
}

/*------------------------------------------------------------*/
Audio_File_Player.prototype.create_cordova_plugin_source = function(filename)
{
  console.log("created cordova source");
  this.source_type = 'cordova';
  this.cordova_media = new Media(filename, null /*mediaSuccess*/, null /*[mediaError]*/, null/*[mediaStatus]*/);
}

/*------------------------------------------------------------*/
Audio_File_Player.prototype.play = function()
{
  if(this.source_type == "buffer")
  {
    var source = global_audio_context.createBufferSource();
    source.loop = this.loop;
    //todo: how to remove the old node?
    
    if(source !== null) // didn't load yet
      {
        source.buffer = this.audio_buffer;
        this.connect_audio_source_to_graph(source);
        this.audio_source.start();
      }
    }
  else if(this.source_type == "cordova")
    this.cordova_media.play();
  else
    this.audio_element.play();
}

/*------------------------------------------------------------*/
Audio_File_Player.prototype.set_gain = function(gain)
{
  if(this.source_type == 'no_web_audio')
    this.audio_element.volume = gain;
  else if(this.source_type == "cordova")
    this.cordova_media.setVolume(gain);
  else
    //this.target_gain = gain;
    this.audio_nodes.gain.gain.value = gain;
}

/*------------------------------------------------------------*/
Audio_File_Player.prototype.stop = function(gain)
{
  if(this.source_type == "buffer")
    {
      if(this.audio_source)
        this.audio_source.stop();
    }
  else if(this.source_type == "cordova")
    this.cordova_media.stop();
  else
    this.audio_element.pause();
}

/*------------------------------------------------------------*/
Audio_File_Player.prototype.connect_audio_source_to_graph = function(source)
{
  source.connect (this.audio_nodes.gain);
  this.audio_source = source;
}

/*-___------------_------------_____-_----------------------------------
  / __| ___ _____(_)___ _ _   |_   _(_)_ __  ___ _ _ 
  \__ \/ -_|_-<_-< / _ \ ' \    | | | | '  \/ -_) '_|
  |___/\___/__/__/_\___/_||_|   |_| |_|_|_|_\___|_|
  
  Provides timing for game sessions. The idea is that the timer counts
  up forever as long as the session is marked as active 
  (e.g. whenever the ball is moving around). If the timer is not
  marked as active for duration_to_pause secs, it will pause, indicating
  perhpas that an encouraging message should be spoken to the user to
  keep going. If the timer is not marked active for a total of
  duration_to_stop secs, the timer will stop indicating that
  the session is over and the score should be logged. It is the caller's
  duty to increment the timer, as timing should be provided by the ball.
  
  
  
  
----------------------------------------------------------------------*/
//PUBLIC
Session_Timer.TIMER_STATE_WAITING_START     = 0;
Session_Timer.TIMER_STATE_STARTING          = 1;
Session_Timer.TIMER_STATE_RUNNING           = 2;
Session_Timer.TIMER_STATE_PAUSED            = 3;
Session_Timer.TIMER_STATE_RESUMING          = 4;
Session_Timer.TIMER_STATE_STOPPED           = 5;

Session_Timer.TIMER_NOTIFICATION_NONE       = 0;
Session_Timer.TIMER_NOTIFICATION_DID_START  = 1;
Session_Timer.TIMER_NOTIFICATION_DID_PAUSE  = 2;
Session_Timer.TIMER_NOTIFICATION_DID_RESUME = 3;
Session_Timer.TIMER_NOTIFICATION_DID_STOP   = 4;

//PUBLIC
/*--------------------------------------------------------------------*/
function Session_Timer(duration_to_pause, duration_to_stop)
{
  this.clear();
  this.duration_to_pause = duration_to_pause;
  this.duration_to_stop  = duration_to_stop;
}

//PUBLIC
/*--------------------------------------------------------------------*/
Session_Timer.prototype.clear = function()
{
  this.play_duration            = 0;
  this.start_time               = 0;
  this.end_time                 = 0;
  
  this.stop_timer               = 0;
  this.state                    = Session_Timer.TIMER_STATE_WAITING_START;
  //this.did_issue_warning        = false;
  //this.did_stop                 = false;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Session_Timer.prototype.increment = function(secs)
{
  var notice = Session_Timer.TIMER_NOTIFICATION_NONE;

  if(this.state != Session_Timer.TIMER_STATE_WAITING_START)
    this.stop_timer    += secs;

  switch(this.state)
    {
      case Session_Timer.TIMER_STATE_STARTING:
        this.play_duration += secs;
        this.state = Session_Timer.TIMER_STATE_RUNNING;
        notice = Session_Timer.TIMER_NOTIFICATION_DID_START;
        break;
        
      case Session_Timer.TIMER_STATE_RUNNING:
        this.play_duration += secs;
        if(this.stop_timer >= this.duration_to_pause)
          {
            this.state = Session_Timer.TIMER_STATE_PAUSED;
            notice = Session_Timer.TIMER_NOTIFICATION_DID_PAUSE;
          }
        break;
        
      case Session_Timer.TIMER_STATE_PAUSED:
        if(this.stop_timer >= this.duration_to_stop)
          {
            this.end_session(); //state changed in function call
            notice = Session_Timer.TIMER_NOTIFICATION_DID_STOP;
          }
        break;
      
      case Session_Timer.TIMER_STATE_RESUMING:
        this.play_duration += secs;
        this.state = Session_Timer.TIMER_STATE_RUNNING;
        notice = Session_Timer.TIMER_NOTIFICATION_DID_RESUME;
        break;

      default: break;
    }

  return notice;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Session_Timer.prototype.mark_as_active = function()
{
  this.stop_timer    = 0;
  if(this.state == Session_Timer.TIMER_STATE_WAITING_START)
    this.start_session();

  else if(this.state == Session_Timer.TIMER_STATE_PAUSED)
    this.state = Session_Timer.TIMER_STATE_RESUMING;
  else
    this.state = Session_Timer.TIMER_STATE_RUNNING;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Session_Timer.prototype.get_timer_string = function()
{
  var val = Math.round(this.play_duration);
  var secs = val % 60;
  var mins = (val-secs) / 60;
  var time = mins.toFixed(0) + ":" + ("0" + secs).slice(-2);
  return time;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Session_Timer.prototype.get_play_duration = function()
{
  return this.play_duration;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Session_Timer.prototype.start_session = function()
{
  //this.clear();
  this.start_time = this.get_datetime();
  this.state = Session_Timer.TIMER_STATE_STARTING;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Session_Timer.prototype.end_session = function()
{
  this.end_time = this.get_datetime();
  this.state = Session_Timer.TIMER_STATE_STOPPED;
};

//PRIVATE-ISH
/*--------------------------------------------------------------------*/
Session_Timer.prototype.get_datetime = function()
{
/*
  var d = new Date();
  var e = Math.floor(d.getTime() * 0.001);  
  return e;
*/

//The timezone is always zero UTC offset, as denoted by the suffix "Z".
  var d = new Date();
  var s = d.toISOString();
  s = s.replace("T", " ");
  s = s.replace("Z", "");
  s = s.split(".")[0];
  return s;
};

/*-_----------_-_----------------_-_---_-------------------_----_-------   _
  | |__  __ _| | |  _ __  ___ __(_) |_(_)___ _ _   __ __ _(_)__| |__ _ ___| |_ 
  | '_ \/ _` | | | | '_ \/ _ (_-< |  _| / _ \ ' \  \ V  V / / _` / _` / -_)  _|
  |_.__/\__,_|_|_| | .__/\___/__/_|\__|_\___/_||_|  \_/\_/|_\__,_\__, \___|\__|
-------------------|_|-------------------------------------------|___/-- 

//PUBLIC
/*--------------------------------------------------------------------*/
function Ball_Position_Widget(canvas_id, path_to_widgets)
{
  this.cursor           = this.create_image(path_to_widgets + "ball_position/soccer_ball.svg");
  this.cone             = this.create_image(path_to_widgets + "ball_position/cone.png");
  this.grass            = this.create_image(path_to_widgets + "ball_position/grass.png");
  this.canvas           = document.getElementById(canvas_id);
  this.context          = this.canvas.getContext('2d');
  
  this.init();
}

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.init = function()
{
  //PUBLIC
  raw_position             = {x:0, y:0, z:0};
  drift_corrected_position = {x:0, y:0, z:0};
  
  //PUBLIC
  this.decimation_interval = 0.1;   //update every 0.1 seconds
  this.N                   = 50;   //the filter order
  this.motion_threshold    = 0.01;
  
  //PUBLIC
  this.camera_should_pan   = true;
  this.camera_should_zoom  = true;
  this.drift_correction    = false;

  //PUBLIC
  this.min_zoom_width_2    = 1.5;  //half the canvas width in meters
  
  //PRIVATE
  this.canvas_width_2      = 0.5 * this.canvas.width;
  this.canvas_height_2     = 0.5 * this.canvas.height;

  //PRIVATE
  this.cursor_size_2       = 0.11; //half the cursor width in meters
  this.cone_size_2         = 0.11; //half the cone width in meters
  this.grass_size_2        = 0.5 ; //half the grass image tile width in meters
  
  this.avg_x_normal        = new MovingAverage(this.N, 0, 0);
  this.avg_y_normal        = new MovingAverage(this.N, 0, 0);
  this.avg_x_drift         = new MovingAverage(this.N, 0, 0);
  this.avg_y_drift         = new MovingAverage(this.N, 0, 0);
  
  this.cone_locations = [];
  this.wall_endpoints = null;
  
  //drawing it twice helps eliminate gaps in repeating background image
  this.clear();
  this.place_cones_in_1_meter_square();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.clear = function()
{
  this.running_duration      = 0;
  this.avg_x_normal.init(this.N, 0, 0);
  this.avg_y_normal.init(this.N, 0, 0);
  this.avg_x_drift.init (this.N, 0, 0);
  this.avg_y_drift.init (this.N, 0, 0);
  this.wall_endpoints = null;

  this.redraw_samples();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.place_cones_in_1_meter_square = function()
{
  this.cone_locations = [{x:-0.5, y:0.5}, {x:0.5, y:0.5}, {x:0.5, y:-0.5}, {x:-0.5, y:-0.5}];
  this.redraw_samples();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.set_cone_locations = function(locations)
{
  this.cone_locations = locations;
  this.redraw_samples();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.append_cone_location = function(location)
{
  this.cone_locations.push(location);
  this.redraw_samples();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.draw_wall_at_current_location_with_length_and_kick_direction = function(length /*meters*/, kick_direction /*radians*/)
{
  this.draw_wall_with_position_length_and_kick_direction(this.drift_corrected_position, length, kick_direction);
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.draw_wall_with_position_length_and_kick_direction = function(position /*{x:x y:y}*/, length /*meters*/, kick_direction /*radians*/)
{
  length *= 0.5;
  var angle = kick_direction + 0.5 * Math.PI;
  
  this.wall_endpoints = 
    {
      a:{
          x: position.x + length * Math.cos(angle),
          y: position.y - length * Math.sin(angle),
        },
      b:{
          x: position.x - length * Math.cos(angle),
          y: position.y + length * Math.sin(angle),
        },
    };
};

/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.clear_wall = function()
{
  this.wall_endpoints = null;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.set_N = function(N)
{
  this.avg_x_normal.N = N;
  this.avg_y_normal.N = N;
  this.avg_x_drift.N  = N;
  this.avg_y_drift.N  = N;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.set_min_zoom_width = function(width_meters)
{
  this.min_zoom_width_2 = 0.5 * width_meters;
  this.redraw_samples();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.update = function(sample_interval, x, y, z)
{
  var did_add_sample = false;
  this.running_duration += sample_interval;
  
  if(this.running_duration >= this.decimation_interval)
    {
      did_add_sample = true;
      this.running_duration -= this.decimation_interval;
    }

  if(did_add_sample)
    {
      y = -y;
      var new_position = {x:x, y:y, z:z};
      var dist = this.motion_threshold;
      if(this.avg_x_normal.past_samples.length > 1)
        dist = this.get_distance(new_position, this.raw_position);
      
      if((!this.drift_correction) || (dist >= this.motion_threshold))
        {
          this.avg_x_normal.update(x);
          this.avg_y_normal.update(y);
          this.drift_corrected_position = {x: x - this.avg_x_normal.mean, y:y - this.avg_y_normal.mean};
          this.avg_x_drift.update (this.drift_corrected_position.x);
          this.avg_y_drift.update (this.drift_corrected_position.y);
          this.raw_position = new_position;
          this.redraw_samples();
        }
    }
  return did_add_sample;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.get_distance = function(a, b)
{
  var dx = a.x-b.x;
  var dy = a.y-b.y;
  var dz = a.z-b.z;
  return Math.sqrt(dx*dx + dy*dy + dz*dz);
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.redraw_samples = function()
{
  var i;
  var size, x1, x2=this.canvas_width_2, y1, y2=this.canvas_height_2;
  var zoom = 0;
  var samples_x = this.avg_x_normal.past_samples;
  var samples_y = this.avg_y_normal.past_samples;
  var mean_x    = this.avg_x_normal.mean;
  var mean_y    = this.avg_y_normal.mean;
  var var_x     = this.avg_x_normal.variance;
  var var_y     = this.avg_y_normal.variance;
 
  this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
 
  if(this.drift_correction)
    {
      samples_x = this.avg_x_drift.past_samples;
      samples_y = this.avg_y_drift.past_samples;
      mean_x    = this.avg_x_drift.mean;
      mean_y    = this.avg_y_drift.mean;
      var_x     = this.avg_x_drift.variance;
      var_y     = this.avg_y_drift.variance;
    }
   if(this.camera_should_zoom)
    {
      zoom = Math.max(var_x, var_y);
      zoom = Math.sqrt(zoom) * 3;
    }
    
  if(zoom < this.min_zoom_width_2) zoom = this.min_zoom_width_2;
  zoom = this.canvas_width_2 / zoom;


  if(!this.camera_should_pan)
    mean_x = mean_y = 0;
  
  //draw green background  
  this.clear_rect(mean_x, mean_y, zoom);
  
  
  //draw cones
  this.context.fillStyle   = "rgb(0, 0, 0)";
  for(i=0; i<this.cone_locations.length; i++)
    this.draw_image_at_location_in_meters(this.cone, this.cone_locations[i].x, this.cone_locations[i].y, this.cone_size_2, this.cone_size_2, mean_x, mean_y, zoom);

  //draw wall
  if(this.wall_endpoints !== null)
    {
      this.context.strokeStyle = "rgb(0, 0, 0)";
      x1 = this.meters_to_pixels(this.wall_endpoints.a.x, mean_x, zoom, this.canvas_width_2 );
      y1 = this.meters_to_pixels(this.wall_endpoints.a.y, mean_y, zoom, this.canvas_height_2);
      x2 = this.meters_to_pixels(this.wall_endpoints.b.x, mean_x, zoom, this.canvas_width_2 );
      y2 = this.meters_to_pixels(this.wall_endpoints.b.y, mean_y, zoom, this.canvas_height_2);
      this.context.beginPath();
      this.context.moveTo(x1, y1);
      this.context.lineTo(x2, y2);
      this.context.stroke();
    }

  //draw tail
  this.context.lineWidth = 4;
  if(samples_x.length >= 1)
    {
      x1 = this.meters_to_pixels(samples_x[0], mean_x, zoom, this.canvas_width_2 );
      y1 = this.meters_to_pixels(samples_y[0], mean_y, zoom, this.canvas_height_2);
    }
  for(i=1; i<samples_x.length; i++)
    {
      x2 = this.meters_to_pixels(samples_x[i], mean_x, zoom, this.canvas_width_2 );
      y2 = this.meters_to_pixels(samples_y[i], mean_y, zoom, this.canvas_height_2);
      
      var lightness = i / (samples_x.length-1);
      this.context.strokeStyle = "rgba(255, 255, 255, "+lightness+")";
      this.draw_segment(x1, y1, x2, y2);
      x1 = x2;
      y1 = y2;
    }

  //draw ball
  size = zoom * this.cursor_size_2;
  x2 -= size;
  y2 -= size;
  size *= 2;
  this.context.drawImage(this.cursor, x2, y2, size, size);
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.draw_segment = function(start_x, start_y, end_x, end_y)
{
  this.context.beginPath(                );
  this.context.moveTo   (start_x, start_y);
  this.context.lineTo   (end_x  , end_y  );
  this.context.stroke   (                );
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.clear_rect = function(x_mean, y_mean, zoom)
{  
  var size = zoom * 2 * this.grass_size_2;
  var y = this.modulo(this.canvas_height_2 - zoom * (this.grass_size_2 + y_mean), size) - size;
  while(y < this.canvas.height)
    {
      var x = this.modulo(this.canvas_width_2 - zoom * (this.grass_size_2 + x_mean), size) - size;
      while(x < this.canvas.width)
        {
          this.context.drawImage(this.grass, x, y, size, size);
          x += size;
        }
      y += size;
    }
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.meters_to_pixels = function(meters, mean, zoom, canvas_size_2)
{
  return zoom * (meters - mean) + canvas_size_2;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.draw_image_at_location_in_meters = function(img, x, y, width_meters_2, height_meters_2, mean_x, mean_y, zoom)
{
  x = this.meters_to_pixels(x, mean_x, zoom, this.canvas_width_2 );
  y = this.meters_to_pixels(y, mean_y, zoom, this.canvas_height_2);
  size_x = zoom * width_meters_2;
  size_y = zoom * height_meters_2;
  x -= size_y;
  y -= size_x;
  this.context.drawImage(img, x, y, size_x*2, size_y*2);
};
      

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.modulo = function(a, b)
{
  if(a>0)
    return a % b;
  else 
    return b + (a % b);
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget.prototype.create_image = function(src)
{
  var img = document.createElement("IMG");
  img.src = src;
  img.style.display = "none";
  document.body.appendChild(img);
  return img;
};



Ball_Position_Widget_3D.grass_size_meters  = 2;    /* representational size of one grass tile */
Ball_Position_Widget_3D.ball_radius_meters = 0.11; /* representational size of one ball */
Ball_Position_Widget_3D.min_zoom_radius    = 7;   /* min representational size of the grass circle when zooming */

//PUBLIC
/*--------------------------------------------------------------------*/
function Ball_Position_Widget_3D(divname, path_to_widgets, draw_goal)
{
  this.decimation_interval = 0.1;   //update every 0.1 seconds
  this.running_duration      = 0;
  this.draw_goal = draw_goal;
  window.addEventListener('resize', this.window_resize.bind(this), false);
  
  width         = 600;//parseInt(div.width); //this will be resized appropriately when the page loads
  height        = width * 0.6;//parseInt(div.offsetHeight);
  
  this.scene    = new THREE.Scene();
  //this.camera   = new THREE.OrthographicCamera( -10, 10, 10, -10 , -500, 1000 );
  var aspect = width / height;
  this.camera   = new THREE.PerspectiveCamera(45/aspect, aspect, 1, 2000);
  
  this.scene = new THREE.Scene();

  this.ambient = new THREE.AmbientLight( 0x444444 );
  this.scene.add(this.ambient);

  this.directionalLight = new THREE.DirectionalLight(0xffeedd);
  this.directionalLight.position.set(100, 100, 0).normalize();
  this.scene.add(this.directionalLight);
  
  this.goal = null;
  this.soccer_ball    = null;
  this.ball_start_position = {x:0, y:Ball_Position_Widget_3D.ball_radius_meters, z:0};  
  this.goal_did_load = false;
  // Goal (Clara.io loader example)
  if(draw_goal)
    {
      var goal_object_loader = new THREE.ObjectLoader();
      goal_object_loader.load(path_to_widgets + "ball_position_3d/goal.json", 
        function ( _obj )
          {
            //console.log(_obj);
            this.scene.add( _obj );
            this.goal = _obj;
            this.goal_did_load = true;
            if(this.grass_did_load && this.ball_did_load)
              this.render_run_loop_run();
          }.bind(this) );
    }
  else
    this.goal_did_load = true;
    
  /* Ball Path Line */
  this.MAX_LINE_POINTS = 500;
  var line_geometry = new THREE.BufferGeometry();
  var line_positions = new Float32Array( this.MAX_LINE_POINTS * 3 ); // 3 vertices per point
  line_geometry.addAttribute( 'position', new THREE.BufferAttribute( line_positions, 3 ) );
  var line_material = new THREE.LineBasicMaterial( { color: 0xFFFFFF } );
  this.line = new THREE.Line( line_geometry,  line_material );
  this.scene.add( this.line );

  /* Grass */
  this.grass_did_load = false;
  var grass_geometry = new THREE.CircleGeometry(1, 64);
  var grass_texture = new THREE.TextureLoader().load( path_to_widgets + "ball_position_3d/grass.png", 
    function (texture)
      {
        texture.wrapS = THREE.RepeatWrapping;
        texture.wrapT = THREE.RepeatWrapping;
        texture.repeat.set(Ball_Position_Widget_3D.grass_size_meters, Ball_Position_Widget_3D.grass_size_meters);
        this.grass_did_load = true;
        if(this.ball_did_load && this.goal_did_load)
          this.render_run_loop_run();
      }.bind(this) );
  
  var grass_material = new THREE.MeshLambertMaterial({map: grass_texture});
  this.plane = new THREE.Mesh( grass_geometry, grass_material );
  this.plane.rotation.x = -Math.PI / 2;
  this.scene.add( this.plane );
  
    /*Soccer Ball*/
  this.ball_did_load = false;
  var ball_geometry = new THREE.SphereGeometry(Ball_Position_Widget_3D.ball_radius_meters, 15, 15 );
  var ball_texture = new THREE.TextureLoader().load( path_to_widgets + "ball_position_3d/ball_3.png",
    function (texture)
      {
        texture.wrapS = THREE.RepeatWrapping;
        texture.wrapT = THREE.RepeatWrapping;
        texture.repeat.set(1, 1);
        this.ball_did_load = true;
        if(this.grass_did_load && this.goal_did_load)
          this.render_run_loop_run();
      }.bind(this) );  
  
  
  
  ball_texture.wrapS = THREE.RepeatWrapping;
  ball_texture.wrapT = THREE.RepeatWrapping;
  ball_texture.repeat.set(1, 1);
  var ball_material = new THREE.MeshLambertMaterial({map: ball_texture});
  this.soccer_ball = new THREE.Mesh( ball_geometry, ball_material );
  this.soccer_ball.position.x = this.ball_start_position.x;
  this.soccer_ball.position.y = this.ball_start_position.y;
  this.soccer_ball.position.z = this.ball_start_position.z;
  this.scene.add( this.soccer_ball );

  /* circular grid lines */
  var grid_ellipse  = new THREE.EllipseCurve(0, 0, 1, 1, 0, 2.0 * Math.PI, false); //(Center_Xpos, Center_Ypos, Xradius, Yradius, StartAngle, EndAngle, isClockwise)
  var grid_path     = new THREE.CurvePath();
  grid_path.add(grid_ellipse);
  this.grid_geometery = grid_path.createPointsGeometry(100);
  this.grid_material = new THREE.LineBasicMaterial({color:0x99AA99, opacity:1.0});

  this.renderer = new THREE.WebGLRenderer({ alpha: true });
  this.renderer.setClearColor( 0xffffff, 0 );
  this.renderer.setPixelRatio(window.devicePixelRatio);
  this.renderer.setSize(width, height);

  /* user interface */  
  this.div = document.getElementById(divname);
  this.div.appendChild( this.renderer.domElement );		
  this.div.onmousedown = this.onmousedown.bind(this);
  this.div.onmouseup   = this.onmouseup.bind  (this);
  this.div.onmouseout  = this.onmouseup.bind  (this);
  this.div.onmousemove = this.onmousemove.bind(this);
  this.mouse_is_dragging = false;

  /* camera */
  this.camera.position.x = 28.28;
  this.camera.position.y = 10;
  this.camera.position.z = -28.28;
  this.camera.lookAt(  new THREE.Vector3( 0, 0, 0 ) );
  
  this.did_intersect_goal_plane = false;
  this.scored_goal_message = "too low";
  
  this.set_zoom(Ball_Position_Widget_3D.min_zoom_radius);
}

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.init = function()
{
  this.ball_start_position.x = 0;
  this.ball_start_position.y = Ball_Position_Widget_3D.ball_radius_meters;
  this.ball_start_position.z = 0;

  this.clear();
};


//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.clear = function()
{
  if(this.soccer_ball === null) return;
  this.running_duration      = 0;
  
  if(this.soccer_ball !== null)
    {
      this.soccer_ball.position.x = this.ball_start_position.x;
      this.soccer_ball.position.y = this.ball_start_position.y;
      this.soccer_ball.position.z = this.ball_start_position.z;
    }
    
  this.did_intersect_goal_plane = false;
  this.scored_goal_message = "too low";
  
  var line_positions = this.line.geometry.attributes.position.array;
  for(var i=0; i<this.MAX_LINE_POINTS*3; i+=3)
  {
    line_positions[i+0] = this.soccer_ball.position.x;
    line_positions[i+1] = this.soccer_ball.position.y;
    line_positions[i+2] = this.soccer_ball.position.z;    
  }
  this.line.geometry.attributes.position.needsUpdate = true;
  this.set_zoom(Ball_Position_Widget_3D.min_zoom_radius);
  
  this.window_resize();
  
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.goal_scored_message = function()
{
  return this.scored_goal_message;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.set_zoom = function(ground_radius)
{
  if(ground_radius < Ball_Position_Widget_3D.min_zoom_radius)
    ground_radius = Ball_Position_Widget_3D.min_zoom_radius;
 
      
  this.plane.scale.x = this.plane.scale.y = ground_radius;
  var tile_size = ground_radius / Ball_Position_Widget_3D.grass_size_meters;
  this.plane.material.map.repeat.set(tile_size, tile_size);
  this.plane.material.map.offset.x = -0.5 * tile_size;
  if(!this.draw_goal)
    this.plane.material.map.offset.y = this.plane.material.map.offset.x;
  this.plane.material.map.needsUpdate = true;

  var camera = this.get_camera_rho_theta();
  
  camera.rho = 0.4 * ground_radius / Math.tan(0.5 * (this.camera.fov * Math.PI/180));
  this.set_camera_rho_theta(camera);
   
  this.camera.position.y = camera.rho * 0.4;
  this.camera.lookAt(  new THREE.Vector3( 0, 0, 0 ) );

  if(this.draw_goal)
    this.plane.position.z = -(ground_radius - Ball_Position_Widget_3D.min_zoom_radius);

  else
    {
      var circle;
      while((circle = this.scene.getObjectByName("circle")))
        this.scene.remove(circle);
    
      for(var i=2; i<=ground_radius; i+=2)
        {
          var grid_line = new THREE.Line(this.grid_geometery, this.grid_material);
          grid_line.name = "circle";
          grid_line.rotation.x = -Math.PI / 2;
          grid_line.scale.x = i;
          grid_line.scale.y = i;
          this.scene.add( grid_line );
        }
    }
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.draw_ideal_trajectory = function(start_x, start_y, end_x, end_y, height)
{
  var dist_x = end_x - start_x;
  var dist_y = end_y - start_y;
  var dist   = Math.hypot(dist_x, dist_y);
  var middle = 0.5*dist;

  c = -height / (middle*middle);
  
  this.clear();
  var i;
  var N = this.MAX_LINE_POINTS;
  
  for(i=0; i<N; i++)
    {
      var _x = dist * i/N;
      var x = start_x + _x * dist_x / dist;
      var y = start_y + _x * dist_y / dist;
      var z = _x - middle;
      z *= z;
      z *= c;
      z += height;
      
      //this is inneficient because it redraws all the line segments each time...
      this.update(this.decimation_interval, x, y, z);
    }
};

/*--------------------------------------------------------------------*/
///* returns object of type {rho:r, theta:t} */
Ball_Position_Widget_3D.prototype.get_camera_rho_theta = function()
{
  var t   = Math.atan2(this.camera.position.z, this.camera.position.x);
  var r   = Math.sqrt(this.camera.position.z*this.camera.position.z + this.camera.position.x*this.camera.position.x);
  
  return {rho:r, theta:t};
};

/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.set_camera_rho_theta = function(a /* object of type {rho:r, theta:t} */)
{
  this.camera.position.x = a.rho * Math.cos(a.theta);
  this.camera.position.z = a.rho * Math.sin(a.theta);
  //this.camera.position.y = camera.rho * 0.25;
  this.camera.lookAt(  new THREE.Vector3( 0, 0, 0 ) );
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.update = function(sample_interval, x, y, z)
{
/*
  x = parseFloat(x);
  y = parseFloat(y);
  z = parseFloat(z);
*/
  var did_add_sample = false;
  this.running_duration += sample_interval;
  
  if(this.running_duration >= this.decimation_interval)
    {
      did_add_sample = true;
      this.running_duration -= this.decimation_interval;
    }
  
  if(did_add_sample)
    {  
      z = (z<0.0) ? 0.0 : z;
      this.soccer_ball.position.x = this.ball_start_position.x + y;
      this.soccer_ball.position.y = this.ball_start_position.y + z;
      this.soccer_ball.position.z = this.ball_start_position.z + x;
   
      var positions = this.line.geometry.attributes.position.array;
      
      //cannot push and pop, cannot dynamically add segments, cannot memmove(), but there must be a better way...
      for(var i=0; i<(this.MAX_LINE_POINTS-1)*3; i+=3)
        {
          positions[i+0] = positions[i+3];
          positions[i+1] = positions[i+4];
          positions[i+2] = positions[i+5];
        }
  
      positions[(this.MAX_LINE_POINTS-1)*3 + 0] = this.soccer_ball.position.x;
      positions[(this.MAX_LINE_POINTS-1)*3 + 1] = this.soccer_ball.position.y;
      positions[(this.MAX_LINE_POINTS-1)*3 + 2] = this.soccer_ball.position.z;
      
      var prev_position = 
      {
        x: positions[(this.MAX_LINE_POINTS-2)*3 + 0],
        y: positions[(this.MAX_LINE_POINTS-2)*3 + 1],
        z: positions[(this.MAX_LINE_POINTS-2)*3 + 2]
      };
      
      this.check_goal_scored(this.soccer_ball.position, prev_position);
      
      this.line.geometry.attributes.position.needsUpdate = true;
      
      this.set_zoom(1.1 * Math.hypot(this.soccer_ball.position.x, this.soccer_ball.position.z));
    }
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.onmousedown = function(e) 
{
  this.mouse_is_dragging = true;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.onmouseup = function(e)
{
  this.mouse_is_dragging = false;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.onmousemove = function(e) 
{
  if(this.mouse_is_dragging)
    {
      var camera = this.get_camera_rho_theta();
      camera.theta += e.movementX * 0.01;
      this.set_camera_rho_theta(camera);
    }
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.render_run_loop_run = function() 
{
  requestAnimationFrame( this.render_run_loop_run.bind(this) );
  var camera = this.get_camera_rho_theta();
  camera.theta += 0.003;
  this.set_camera_rho_theta(camera);
  this.renderer.render( this.scene, this.camera );
};

/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.check_goal_scored = function(a /* segment start {x:x, y:y, z:z} */, b /* segment end {x:x, y:y, z:z} */)
{
  if(this.did_intersect_goal_plane)
    return;

  var intersection = this.check_ball_segment_intersects_goal_plane(a, b);

  if(intersection !== false)
    {
      this.did_intersect_goal_plane = true;
      var result;
      
      if(intersection.y > 2.44)
        result = "Too high";
      else if (intersection.x > 3.66)
        result = "Too far right";
      else if (intersection.x < -3.66)
        result = "Too far left";
      else 
        result = "Goal!";
        
      this.scored_goal_message = result;
    }
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.check_ball_segment_intersects_goal_plane = function(a /* segment start {x:x, y:y, z:z} */, b /* segment end {x:x, y:y, z:z} */)
{
  var any_point_on_goal_plane = new Quaternion(0, 0, 0, 0);
  var goal_plane_normal = new Quaternion(0, 0, 0, 1);
  var start = new Quaternion(0, a.x, a.y, a.z);
  var length = new Quaternion(0, b.x-a.x, b.y-a.y, b.z-a.z);
  
  var d = goal_plane_normal.vector_dot_product(any_point_on_goal_plane);
  var dot_normal_length = goal_plane_normal.vector_dot_product(length);
  
  //segment is parellel to goal plane
  if(dot_normal_length === 0)
    return false;
  
  var x = (d - goal_plane_normal.vector_dot_product(start)) / dot_normal_length;
  length.normalize(length);
  length.multiply_real(x, length);
  length.add(start, length);
  
  if (x >= 0.0 && x <= 1.0)
    return {x: length.q[1], y: length.q[2], z: length.q[3]};
  
  return false;
};

/*--------------------------------------------------------------------*/
Ball_Position_Widget_3D.prototype.window_resize = function(event) 
{
  var width  = this.div.clientWidth;
  var height = 0.5 * width;//container.clientHeight;
  this.renderer.setSize(width, height);
  this.camera.aspect = width / height;
  this.camera.updateProjectionMatrix();
};

/*-_----------_-_------_--------_--------------------_----_----------_--
  | |__  __ _| | |  __| |_ __ _| |_ _  _ ___ __ __ _(_)__| |__ _ ___| |_ 
  | '_ \/ _` | | | (_-<  _/ _` |  _| || (_-< \ V  V / / _` / _` / -_)  _|
  |_.__/\__,_|_|_| /__/\__\__,_|\__|\_,_/__/  \_/\_/|_\__,_\__, \___|\__|
-----------------------------------------------------------|___/--------
----------------------------------------------------------------------*/


//PUBLIC
/*--------------------------------------------------------------------*/
function Ball_Status_Widget(IC, container_id, path_to_widgets)
{
  this.container  = document.getElementById(container_id);
  var b = this.container.getElementsByClassName("battery_icon")[0];
  //var w = this.container.getElementsByClassName("wifi_icon")[0];
  var c = this.container.getElementsByClassName("calibrated_icon")[0];
  //var s = this.container.getElementsByClassName("server_icon")[0];
  
  this.volts      = new Level_Indicator(path_to_widgets + "ball_status/batt/"  , 0, 5, ".png", 3.2, 4.2, 0, b);
  //this.rssi       = new Level_Indicator(path_to_widgets + "ball_status/wifi/"  , 0, 4, ".png", -90, -30, -90, w);
  this.calibrated = new Level_Indicator(path_to_widgets + "ball_status/calib/" , 0, 1, ".png",   0,   1, 0, c);
  //this.server     = new Level_Indicator(path_to_widgets + "ball_status/server/", 0, 1, ".png",   0,   1, 0, s);
  
  this.IC         = IC;
  this.init_ic_callbacks();
  
  //this.connect_thread = null;
  this.should_keep_trying_to_connect = false;
  this.calibration_dispatch = null;
  this.connection_dispatch  = null;
  
  
  //this.container.innerHTML = "";
  //this.container.appendChild(this.volts.img);
  //this.container.appendChild(this.rssi.img);
  //this.container.appendChild(this.calibrated.img);
}

/*--------------------------------------------------------------------*/
Ball_Status_Widget.prototype.init = function()
{
  this.volts.set_level(0);
  //this.rssi.set_level(-90);
  this.calibrated.set_level(0);
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Status_Widget.prototype.update = function(volts, rssi)
{
  this.volts.set_level(volts);
};

//PUBLIC
/*--------------------------------------------------------------------*/
// caliration game needs this
Ball_Status_Widget.prototype.receive_calibrated_notice = function(funct)
{
  this.calibration_dispatch = funct;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Status_Widget.prototype.stop_receiving_calibrated_notice = function()
{
  this.calibration_dispatch = null;
};

//PUBLIC
/*--------------------------------------------------------------------*/
// caliration game needs this
Ball_Status_Widget.prototype.receive_connection_notice = function(funct)
{
  this.connection_dispatch = funct;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Ball_Status_Widget.prototype.stop_receiving_connection_notice = function()
{
  this.connection_dispatch = null;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Ball_Status_Widget.prototype.update_calibrated = function(calibrated)
{
  var calibrated_level = (calibrated == "11111111") ? 1 : 0;
  this.calibrated.set_level(calibrated_level);
};

/*--------------------------------------------------------------------*/
Ball_Status_Widget.prototype.init_ic_callbacks  = function()
{
  this.IC.onstatus          = this.onstatus.bind(this);
  this.IC.onconnection      = this.onconnection.bind(this);
  this.IC.oncalibratestatus = this.oncalibratestatus.bind(this);
};

/*--------------------------------------------------------------------*/
Ball_Status_Widget.prototype.onstatus = function(e)
{
  this.update(e.volts, e.rssi);
};

/*--------------------------------------------------------------------*/
Ball_Status_Widget.prototype.oncalibratestatus = function(e)
{
  if(this.calibration_dispatch !== null)
    this.calibration_dispatch(e);
  this.update_calibrated(e.cs);
};

/*--------------------------------------------------------------------*/
Ball_Status_Widget.prototype.onconnection = function(e)
{
  if(this.connection_dispatch !== null)
    this.connection_dispatch(e);

  switch(e.status)
    {
      case this.IC.STATUS_CONNECTED:
      break;

      case this.IC.STATUS_DISCONNECTED:
        this.update(0, -90, 0);
        if(this.should_keep_trying_to_connect)
          this.keep_trying_to_connect();
      break;     

      case this.IC.STATUS_ERROR:
        this.update(0, -90, 0);
        if(this.should_keep_trying_to_connect)
          {
            this.stop_trying_to_connect();
            this.keep_trying_to_connect();
          }
      break;    
    }
};

/*--------------------------------------------------------------------*/
/*
Ball_Status_Widget.prototype.keep_trying_to_connect = function()
{
  console.log("Trying to connect");
  this.should_keep_trying_to_connect = true;
  //var connected = this.IC.is_connected();
  //if(connected === null) connected = false;

  //connected = this.IC.is_tracking();

  //if(!connected)
    {
      //this.transport.play();
      this.IC.start_tracking();
      //this is might cause a number of problems... (e.g. with playback of saved data)
      //this.connect_thread = setTimeout(this.keep_trying_to_connect.bind(this), 2000);
    }
}
*/
/*--------------------------------------------------------------------*/

/*Ball_Status_Widget.prototype.stop_trying_to_connect = function()
{
  console.log("Stop trying to connect");
  this.should_keep_trying_to_connect = false;
  
  //if(this.connect_thread != null)
    //this.connect_thread.clearTimeout();
  this.IC.stop_tracking();
}
*/
/*--------------------------------------------------------------------*/
/*-_-------------_---_---------_-_---------_----------------------------
  | |_____ _____| | (_)_ _  __| (_)__ __ _| |_ ___ _ _ 
  | / -_) V / -_) | | | ' \/ _` | / _/ _` |  _/ _ \ '_|
  |_\___|\_/\___|_| |_|_||_\__,_|_\__\__,_|\__\___/_| 
----------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
function Level_Indicator(folder, start_image_number, end_image_number, extension, start_range, end_range, initial_level, img_element)
{
  var i;
  this.image_names = [];
  this.current_image_name = "";
  for(i=start_image_number; i<=end_image_number; i++)
    {
      var name = folder+i+extension;
      this.image_names.push(name);
    }
  this.start_range = start_range;
  this.end_range = end_range;
  this.img = img_element; 
  this.set_level(initial_level);
}

/*--------------------------------------------------------------------*/
Level_Indicator.prototype.set_level = function(level)
{
  var index = this.scalef(level, this.start_range, this.end_range, 0, this.image_names.length);
  index = this.clip(index, 0, this.image_names.length-1);
  index = parseInt(index);
  
  this.img.src = this.image_names[index];
};

/*--------------------------------------------------------------------*/
Level_Indicator.prototype.scalef = function(x, in_min, in_max, out_min, out_max)
{
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
};

/*--------------------------------------------------------------------*/
Level_Indicator.prototype.clip = function(x, in_min, in_max)
{
  if(x < in_min)
    x = in_min;
  if(x > in_max)
    x = in_max;
  return x;
};


/*----------------------_--------------------_----_----------_----------
   ___ __ ___ _ _ ___  | |___  __ _  __ __ _(_)__| |__ _ ___| |_ 
  (_-</ _/ _ \ '_/ -_) | / _ \/ _` | \ V  V / / _` / _` / -_)  _|
  /__/\__\___/_| \___| |_\___/\__, |  \_/\_/|_\__,_\__, \___|\__|
------------------------------|___/----------------|___/----------------
----------------------------------------------------------------------*/

//PUBLIC
function Score_Log_Widget(table_id, game_name, column_names /* array of column names */, blank_row/*array of values*/, score_ranges /* array of {min:0, max:100} */)
{
  this.table = document.getElementById(table_id);
  
  //blank_row.push("&mdash;");
  //column_names.push("Share");
  
  this.blank_row              = blank_row;
  this.load_new_column_names(column_names);
  this.table.style.width      = "100%";
  /*this.table.style.fontFamily = "Arial";*/
  this.table.style.fontSize = "0.9em";
  this.table.style.lineHeight = "1.75em";
  this.num_rows               = 5;
  //this.data                   = null;
  this.log                    = [];
  this.game_name              = game_name;
  this.ranges = score_ranges;
  this.init();
}

//PRIVATE
/*--------------------------------------------------------------------*/
Score_Log_Widget.prototype.load_new_column_names = function(column_names)
{
  var table_html =
    "<thead>"                       +
      "<tr style='text-align:left'>";
      for(var i=0; i<column_names.length; i++)
        {
          if(this.blank_row[i] == "*")
            table_html += "<th style='display:none'>" + column_names[i]+ "</th>" ;
          else 
            table_html += "<th>" + column_names[i].initCap() + "</th>" ;
        }
      table_html +=
      "</tr>"                       +
    "</thead>"                      ;
  this.table.innerHTML = table_html;
  
  this.column_names = column_names;
  this.table_body = document.createElement('TBODY');
  this.table.appendChild(this.table_body);
};

//PUBLIC
/*--------------------------------------------------------------------*/
Score_Log_Widget.prototype.init = function(event)
{
  this.log = null;
  this.storage_name  = this.game_name;// + " " + server_get_username_from_local_storage();

  if(this.game_name)
    this.log = localStorage.getItem(this.storage_name);
  if(this.log !== null)
    this.log = JSON.parse(this.log);
  else
    this.log = [];
    
  this.table_body.innerHTML = "";
  var i, j;
  for(i=0; i<this.num_rows; i++)
    {
      var d = (!this.log[i]);
      var row = this.table_body.insertRow(i);
      for(j=0; j<this.column_names.length; j++)
        {
          var cell = row.insertCell(j);
          cell.innerHTML = d ? this.blank_row[j] : this.log[i][j];
          if(this.blank_row[j] == "*")
            cell.style.display = "none";
        }
      row.style.cursor = "pointer";
    }
    
  this.table_body.rows[0].style.color = "#16C816";
  this.table_body.rows[0].style.fontWeight = "bold";
  this.insert_new_first_row();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Score_Log_Widget.prototype.clear = function()
{
  localStorage.removeItem(this.game_name);
  this.init();
};

//PUBLIC
/*--------------------------------------------------------------------*/
/*user is responsible for ensuring the right number of colums*/
Score_Log_Widget.prototype.set_game_name = function(name, columns)
{
  if(columns !== undefined)
    this.load_new_column_names(columns);
  this.game_name = name;
  this.init();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Score_Log_Widget.prototype.set_user_id = function(user_id)
{
  this.user_id = user_id;
  this.init();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Score_Log_Widget.prototype.live_update_first_row = function(values /*array*/)
{
  var i;
  
  //values.push("<i class='fa fa-share-alt' aria-hidden='true'></i>");
  values.push ("*");
  
  for(i=0; i<this.column_names.length; i++)
    this.table_body.rows[0].cells[i].innerHTML = this.log[0][i] = values[i];
  
};

//PUBLIC
/*--------------------------------------------------------------------*/
Score_Log_Widget.prototype.commit_first_row = function()
{
  var s = JSON.stringify(this.log);
  localStorage.setItem(this.storage_name, s);
  
  //server_record_score(this.column_names, this.log[0], this.game_name);
  this.insert_new_first_row();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Score_Log_Widget.prototype.insert_new_first_row = function()
{
  var i;
  this.log.unshift(this.blank_row.slice());
  while(this.log.length >this.num_rows) this.log.pop();
  for(i=this.num_rows-1; i>0; i--)
    this.table_body.rows[i].innerHTML = this.table_body.rows[i-1].innerHTML;
  
  this.live_update_first_row(this.blank_row);
};

//PRIVATE
//expects string in mm:ss format
/*--------------------------------------------------------------------*/
Score_Log_Widget.prototype.time_to_seconds = function(time)
{
  var a = time.split(":");
  return (60 * parseInt(a[0])) + parseInt(a[1]);
};

//PRIVATE
/*--------------------------------------------------------------------*/
Score_Log_Widget.prototype.scalef = function(x, in_min, in_max, out_min, out_max)
{
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
};

/*--------------------------------------------------------------------*/
String.prototype.initCap = function () 
{
  return this.toLowerCase().replace(/(?:^|\s)[a-z]/g, function (m) 
  {
      return m.toUpperCase();
   });
};

/*----------------------------_-------------------------_----------_----
   ____ __  ___ ___ __| |_   | |___  __ _  __ __ _(_)__| |__ _ ___| |_ 
  (_-< '_ \/ -_) -_) _| ' \  | / _ \/ _` | \ V  V / / _` / _` / -_)  _|
  /__/ .__/\___\___\__|_||_| |_\___/\__, |  \_/\_/|_\__,_\__, \___|\__|
-----|_|----------------------------|___/----------------|___/----------   
----------------------------------------------------------------------*/

//PUBLIC
/*--------------------------------------------------------------------*/
function Speech_Log_Widget(div_id)
{
  this.message_div = document.getElementById(div_id);
  this.init();
}

//PUBLIC
/*--------------------------------------------------------------------*/
Speech_Log_Widget.prototype.init = function()
{
  //this.clear();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speech_Log_Widget.prototype.clear = function()
{
  this.message_div.innerHTML = "";
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speech_Log_Widget.prototype.display = function(message)
{
  this.message_div.innerHTML = message;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speech_Log_Widget.prototype.display_and_speak = function(message)
{
  if(window.SpeechSynthesisUtterance)
    window.speechSynthesis.speak(new SpeechSynthesisUtterance(message));
  this.message_div.innerHTML = message;
};

/*---------------------_---------------_--------------------_----_------    _
   ____ __  ___ ___ __| |___ _ __  ___| |_ ___ _ _  __ __ _(_)__| |__ _ ___| |_ 
  (_-< '_ \/ -_) -_) _` / _ \ '  \/ -_)  _/ -_) '_| \ V  V / / _` / _` / -_)  _|
  /__/ .__/\___\___\__,_\___/_|_|_\___|\__\___|_|    \_/\_/|_\__,_\__, \___|\__|
-----|_|----------------------------------------------------------|___/-  
----------------------------------------------------------------------*/
//these must be hex
Speedometer_Widget.MAIN_COLOR      = "#5F6B77";
Speedometer_Widget.PASS_COLOR      = "#025FBC";
Speedometer_Widget.TOUCH_COLOR     = "#FF7C00";
Speedometer_Widget.FONT            = "Quicksand";

Speedometer_Widget.STYLE_TIMER       = 0;
Speedometer_Widget.STYLE_SPEEDOMETER = 1;


Speedometer_Widget.GOAL_TYPE_LESS_THAN    = 0;
Speedometer_Widget.GOAL_TYPE_AT_LEAST     = 1;
Speedometer_Widget.GOAL_TYPE_RANGE        = 2;
Speedometer_Widget.GOAL_TYPE_NONE         = 3;


//PUBLIC
/*--------------------------------------------------------------------*/
function Speedometer_Widget(canvas_id, level_text, num_text, path_to_widgets, style, goal_type)
{
  this.canvas             = document.getElementById(canvas_id);
  this.context            = this.canvas.getContext('2d');
  this.level_text         = level_text;
  this.num_text           = num_text;
  this.style              = style;
  this.goal_type          = goal_type;
  this.init();

  this.canvas.addEventListener("touchstart", this.touchstart.bind(this), false);
  this.canvas.addEventListener("touchend"  , this.touchend.bind(this)  , false);
  this.canvas.addEventListener("touchmove" , this.touchmove.bind(this)  , false);

  document.body.addEventListener("touchmove", this.prevent_touch_scroll.bind(this), {passive:false, capture:false});

  this.canvas.onmousedown = this.onmousedown.bind(this);
  //this.canvas.onmouseenter= this.onmousedown.bind(this);
  this.canvas.onmouseup   = this.onmouseup.bind  (this);
  this.canvas.onmouseout  = this.onmouseup.bind  (this);
  this.canvas.onmousemove = this.onmousemove.bind(this);
  
  this.is_updating   = false;
  this.update_thread = null;
}

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.init = function()
{
  this.outline_angle = 2.15;
  this.level_min     = 0; 
  this.level_max     = 200;
  this.num_min       = 0; 
  this.num_max       = 999;
  this.num_digits    = 0; //after decimal point
  this.level_digits  = 0; //after decimal point
  this.target_level  = 0;
  this.current_level = this.target_level;
  this.target_num    = 0;
  this.current_num   = this.target_num;
  this.target_goal   = this.level_max * 0.3;
  this.current_goal  = this.target_goal;
  this.goal_angle    = 0; //calculated when drawn for hit detection
  this.target_goal_2   = this.level_max;
  this.current_goal_2  = this.target_goal_2;
  this.goal_angle_2    = 0; //calculated when drawn for hit detection
  this.mouse_is_down = false;
  this.mouse_is_down_in_goal_indicator = false;
  this.mouse_is_down_in_goal_indicator_2 = false;
  this.interpolation_thread_runloop_duration = 75; //ms
  this.num_ticks     = 9;
  this.tick_spacing  = 2 * Math.PI / 13; //radians
  this.tick_start    = Math.floor(this.num_ticks * 0.5) * -this.tick_spacing;
  this.tick_end      = this.tick_start + this.tick_spacing * (this.num_ticks-1);
  
  if(this.style == Speedometer_Widget.STYLE_TIMER)
    {
      this.tick_start    = 0;
      this.tick_end      = 2 * Math.PI - Math.PI/6;
      this.num_ticks     = 12;
      this.tick_spacing  = this.tick_end / (this.num_ticks-1);
      this.outline_angle = Math.PI;
      this.set_level_and_num_ranges(0, 55);
      this.target_goal   = 10;
      this.current_goal  = this.target_goal;
    }
  
  this.clear();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.stop_updating = function()
{
  clearTimeout(this.update_thread);
  this.is_updating = false;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.resume_updating = function()
{
  if(this.is_updating === false)
    this.interpolation_thread_run_loop_run();
  this.is_updating = true;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.clear = function()
{
  this.set_level(this.level_min, true, this.num_min, true);
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.set_level_range = function(min, max)
{
  this.level_min = min; this.level_max = max;
  this.set_level(this.target_level, false, this.target_num, false);
  this.set_goal_range(this.target_goal, this.target_goal_2, false);
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.set_num_range = function(min, max)
{
  this.num_min = min; this.num_max = max;
  this.set_level(this.target_level, false, this.target_num, false);
  this.set_goal_range(this.target_goal, this.target_goal_2, false);
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.set_level_and_num_ranges = function(min, max)
{
  this.set_level_range(min, max);
  this.set_num_range(min, max);
};

//PUBLIC
/*--------------------------------------------------------------------*/
// the dial value is set independently of the center number.
// either can be set immediately, or interpolated
Speedometer_Widget.prototype.set_level = function(level, level_immediate, num, num_immediate)
{
  //interpolation_thread_run_loop_lock()
  this.target_level = this.clip(level, this.level_min, this.level_max);
  this.target_num   = this.clip(num  , this.num_min  , this.num_max  );
  
  if(level_immediate)
    this.current_level = this.target_level;
  if(num_immediate)
    this.current_num = this.target_num;    
  //interpolation_thread_run_loop_unlock()
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.set_goal = function(goal, immediate)
{
  //interpolation_thread_run_loop_lock()
  this.target_goal = this.clip(goal, this.level_min, this.level_max);  
  if(immediate)
    this.current_goal = this.target_goal;
  //interpolation_thread_run_loop_unlock()
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.set_goal_2 = function(goal, immediate)
{
  //interpolation_thread_run_loop_lock()
  this.target_goal_2 = this.clip(goal, this.level_min, this.level_max);  
  if(immediate)
    this.current_goal_2 = this.target_goal_2;
  //interpolation_thread_run_loop_unlock()
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.set_goal_range = function(goal, goal_2, immediate)
{
  this.set_goal  (goal  , immediate);
  this.set_goal_2(goal_2, immediate);
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.set_challenge = function(less_than, at_least)
{
  var type = Speedometer_Widget.GOAL_TYPE_NONE;
  if((at_least !== "") && (less_than !== ""))
    {
      type  = Speedometer_Widget.GOAL_TYPE_RANGE;
      this.set_goal_range(at_least, less_than, false);
    }
  else if(less_than !== "")
    {
      type  = Speedometer_Widget.GOAL_TYPE_LESS_THAN;
      this.set_goal_range(less_than, less_than, false);
    }
  else if(at_least !== "")
   {
      type  = Speedometer_Widget.GOAL_TYPE_AT_LEAST;
      this.set_goal_range(at_least, at_least, false);  
   }
   
  this.goal_type = type;
  console.log(type);
};

//PRIVATE
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.draw = function(level, num, goal, goal_2)
{
  var i;
  var font_size;
  var red_line     = this.scalef(level, this.level_min, this.level_max, this.tick_start, this.tick_end);
  this.goal_angle  = this.scalef(goal , this.level_min, this.level_max, this.tick_start, this.tick_end);
  this.goal_angle_2= this.scalef(goal_2,this.level_min, this.level_max, this.tick_start, this.tick_end);
  var big_radius   = 0.5 * Math.min(this.canvas.width, this.canvas.height); //to the edge of the drawing
  var radius       = 0.85 * big_radius; //to the edge of the clock
  this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
  
  //this.context.drawImage(this.background, 0.5*this.canvas.width - radius, 0.5*this.canvas.height - radius, 2*radius, 2*radius); 
  this.context.beginPath();
  this.context.lineCap="round";
  this.context.strokeStyle = Speedometer_Widget.MAIN_COLOR;
  this.context.lineWidth   = 0.025 * radius;
  this.context.arc         (big_radius, big_radius, radius, 1.5*Math.PI - this.outline_angle, 1.5*Math.PI + this.outline_angle);
  this.context.stroke();

  this.context.textBaseline = "middle";
  this.context.textAlign    = "center"; 
  
  this.context.save();
  this.context.translate(0.5*this.canvas.width, 0.5*this.canvas.height);
  
  //draw ticks and numbers
  this.context.save();
  this.context.rotate(this.tick_start);
  this.context.font = 0.08*radius + "px " + Speedometer_Widget.FONT;
  this.context.fillStyle = Speedometer_Widget.MAIN_COLOR;
  
  for(i=0; i<this.num_ticks; i++)
    {
      var n = this.scalef(i, 0, this.num_ticks-1, this.level_min, this.level_max);
      this.context.beginPath   ();
      this.context.moveTo      (0, 0.875 * -radius);
      this.context.lineTo      (0, 0.925 * -radius);
      this.context.lineWidth   = 4;
      this.context.strokeStyle = Speedometer_Widget.MAIN_COLOR;
      this.context.stroke      ();
      this.context.fillText    (Math.round(n), 0, -radius*0.75);
      this.context.rotate      (this.tick_spacing);
    }
  this.context.restore();
  
  this.context.lineWidth   = 0.1 * radius;
  //draw red or green arc to red line
  if(this.value_is_in_goal_range() === 0)
    this.context.strokeStyle   = Speedometer_Widget.TOUCH_COLOR + "B2";
  else
    this.context.strokeStyle   = Speedometer_Widget.MAIN_COLOR + "B2";
  this.context.beginPath   ();
  if(this.style == Speedometer_Widget.STYLE_TIMER)
    this.context.arc(0, 0, 0.9 * radius, - 0.5*Math.PI, red_line - 0.5*Math.PI);
  else
    this.context.arc(0, 0, 0.9 * radius, this.tick_start-0.5*Math.PI, red_line - 0.5*Math.PI);
    
  this.context.stroke      ();
    
  //draw red line
  this.context.save        ();
  this.context.rotate      (red_line);
  this.context.beginPath   ();
  this.context.moveTo      (0, 0.4 * -radius);
  this.context.lineTo      (0, 0.8 * -radius);
  this.context.lineWidth   = radius * 0.05;
  this.context.strokeStyle = Speedometer_Widget.TOUCH_COLOR;
  this.context.stroke      ();
  this.context.restore     ();

  //second hand
  if(this.style == Speedometer_Widget.STYLE_TIMER)
  {
    red_line = this.scalef(60 * (level - Math.floor(level)), this.level_min, this.level_max, this.tick_start, this.tick_end);
    this.context.save        ();
    this.context.rotate      (red_line);
    this.context.beginPath   ();
    this.context.moveTo      (0, 0.4 * -radius);
    this.context.lineTo      (0, 0.75 * -radius);
    this.context.lineWidth   = radius * 0.025;
    this.context.strokeStyle = Speedometer_Widget.TOUCH_COLOR;
    this.context.stroke      ();
    this.context.restore     ();    
  }

  if(this.goal_type != Speedometer_Widget.GOAL_TYPE_NONE)
    {
      this.context.lineWidth   = 0.05 * radius;
      this.context.strokeStyle = Speedometer_Widget.TOUCH_COLOR;
      this.context.fillStyle = this.context.strokeStyle;

  
      this.context.save        ();
      this.context.rotate      (this.goal_angle + 1.5*Math.PI);
      this.context.beginPath   ();
  
      //draw goal indicators
      //todo: surely this could be cleaner!
      if(this.goal_type == Speedometer_Widget.GOAL_TYPE_AT_LEAST)
        {
          if(this.style == Speedometer_Widget.STYLE_SPEEDOMETER)
            this.context.arc       (0, 0, 1.033*radius, 0, this.outline_angle - this.goal_angle);
          else if(this.style == Speedometer_Widget.STYLE_TIMER)
            this.context.arc       (0, 0, 1.033*radius, 0, 2*Math.PI - this.goal_angle, 0, true);
        }
      else if(this.goal_type == Speedometer_Widget.GOAL_TYPE_LESS_THAN)
        {
          if(this.style == Speedometer_Widget.STYLE_SPEEDOMETER)
            this.context.arc       (0, 0, 1.033*radius, -this.outline_angle - this.goal_angle, 0);
          else if(this.style == Speedometer_Widget.STYLE_TIMER)
            this.context.arc       (0, 0, 1.033*radius, 2*Math.PI - this.goal_angle, 0, false);
          //this.context.rotate    (-challenge_text.length * char_sapacing);
        }
      else if(this.goal_type == Speedometer_Widget.GOAL_TYPE_RANGE)
        {
          this.context.arc       (0, 0, 1.033*radius, 0, this.goal_angle_2 - this.goal_angle, this.goal_angle_2 < this.goal_angle);
          //this.context.rotate    ((0.5*(this.goal_angle_2 - this.goal_angle)) - (0.5* challenge_text.length * char_sapacing));
        }
  
      this.context.stroke      ();
  
      //draw the word "target"
      /*
      font_size = 0.1 * radius;
      this.context.font = "bold " + font_size + "px Muli Extrabold";
      var challenge_text       = "target";
      var char_sapacing        = 0.06;
      for(i=0; i<challenge_text.length; i++)
        {
          this.context.rotate    (char_sapacing);
          this.context.save();
          this.context.translate (1.14*radius, 0);
          this.context.rotate    (0.5*Math.PI);
          this.context.fillText(challenge_text.charAt(i), 0, 0); 
          this.context.restore();
        }
      */
  
      this.context.restore     ();
      
      //draw goal indicator
      this.context.fillStyle   = Speedometer_Widget.TOUCH_COLOR;
      this.context.save        ();
      this.context.rotate      (this.goal_angle);
      this.context.translate   (0, 0.817 * -radius);
      this.context.beginPath   ();
      this.context.arc         (0, 0, (1.09 * radius) - (0.85 * radius), 1.5*Math.PI - 0.45, 1.5*Math.PI + 0.45);
      this.context.lineTo      (0, 0);
      this.context.fill        ();
      this.context.restore     ();
  
  
      //draw second goal indicator. hey, mike, have you heard of functions?
      if(this.goal_type == Speedometer_Widget.GOAL_TYPE_RANGE)
        {
          this.context.save        ();
          this.context.rotate      (this.goal_angle_2);
          this.context.translate   (0, 0.817 * -radius);
          this.context.beginPath   ();
          this.context.arc         (0, 0, (1.09 * radius) - (0.85 * radius), 1.5*Math.PI - 0.45, 1.5*Math.PI + 0.45);
          this.context.lineTo      (0, 0);
          this.context.fill        ();
          this.context.restore     ();
        }
    } //end goal_type_none
  
  //draw text
  this.context.restore     ();
  font_size = 0.5*radius;
  this.context.font = "bold " + font_size + "px " + Speedometer_Widget.FONT + " Bold";
  
  this.context.fillStyle = Speedometer_Widget.PASS_COLOR;
  if(this.style == Speedometer_Widget.STYLE_TIMER)
    this.context.fillText(Math.floor(num), this.canvas.width*0.5, this.canvas.height*0.5);
  else
    this.context.fillText(num.toFixed(this.num_digits), this.canvas.width*0.5, this.canvas.height*0.5);
  
  
  this.context.fillStyle = Speedometer_Widget.MAIN_COLOR;
  this.context.font = 0.25 * font_size + "px " + Speedometer_Widget.FONT + " Bold";
  this.context.fillText(this.num_text, this.canvas.width*0.5, 0.47 * (this.canvas.height - font_size));
  
  this.context.font = 0.25 * font_size + "px " + Speedometer_Widget.FONT + " Bold";
  if(this.style == Speedometer_Widget.STYLE_TIMER)
    this.context.fillText(this.get_timer_string(num), this.canvas.width*0.5, 0.58 * (this.canvas.height + font_size));
  else
    this.context.fillText(level.toFixed(this.level_digits) + " " + this.level_text, this.canvas.width*0.5, 0.58 * (this.canvas.height + font_size));
};

//PRIVATE
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.onmousedown = function(e)
{ 
  this.mouse_is_down = true;
  var x = e.offsetX - this.canvas.offsetWidth * 0.5;
  var y = e.offsetY - this.canvas.offsetHeight * 0.5;
  var r = Math.sqrt(x*x + y*y);
  var big_radius   = 0.5 * Math.min(this.canvas.offsetWidth, this.canvas.offsetHeight);
    
  if(r > big_radius * 0.6)
    {
      //var t = Math.atan2(y, x) + Math.PI * 0.5;
      var t = Math.atan2(y, x) + Math.PI * 0.5;
      if(this.style == Speedometer_Widget.STYLE_TIMER)
        {if(t<0) t += 2*Math.PI;}
      else
        {if(t > Math.PI) t -= Math.PI*2;}
      if((t > (this.goal_angle - 0.35)) &&  (t < (this.goal_angle + 0.35)))
        this.mouse_is_down_in_goal_indicator = true;
      else if((this.goal_type == Speedometer_Widget.GOAL_TYPE_RANGE) && (t > (this.goal_angle_2 - 0.35)) &&  (t < (this.goal_angle_2 + 0.35)))
        this.mouse_is_down_in_goal_indicator_2 = true;
    }
};

//PRIVATE
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.onmouseup   = function(e)
{
  this.mouse_is_down_in_goal_indicator   = false;
  this.mouse_is_down_in_goal_indicator_2 = false;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.onmousemove = function(e)
{
  if(this.mouse_is_down_in_goal_indicator || this.mouse_is_down_in_goal_indicator_2)
    {
      var big_radius   = 0.5 * Math.min(this.canvas.offsetWidth, this.canvas.offsetHeight);
      var x = e.offsetX - this.canvas.offsetWidth * 0.5;
      var y = e.offsetY - this.canvas.offsetHeight * 0.5;
      var r = Math.sqrt(x*x + y*y);
      if(r > 0)
        {
          var t = Math.atan2(y, x) + Math.PI * 0.5;
          if(this.style == Speedometer_Widget.STYLE_TIMER)
            {if(t<0) t += 2*Math.PI;}
          else
            {if(t > Math.PI) t -= Math.PI*2;}
          var g  = this.scalef(t , this.tick_start, this.tick_end, this.level_min, this.level_max);
          if(this.mouse_is_down_in_goal_indicator)
            this.set_goal(g, false);
          else
            this.set_goal_2(g, false);
        }
  }
};

/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.touchstart = function(e)
{
  var mousePos = this.get_touch_position(this.canvas, e);
  var touch = e.touches[0];
  var mouseEvent = new MouseEvent("mousedown", 
    {
      clientX: touch.clientX,
      clientY: touch.clientY
    });
  this.canvas.dispatchEvent(mouseEvent);
};

/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.touchend = function(e)
{
  var mouseEvent = new MouseEvent("mouseup", {});
  this.canvas.dispatchEvent(mouseEvent);
};

/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.touchmove = function(e)
{
  var touch = e.touches[0];
  var mouseEvent = new MouseEvent("mousemove",
    {
      clientX: touch.clientX,
      clientY: touch.clientY
    });
  this.canvas.dispatchEvent(mouseEvent);
};

/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.prevent_touch_scroll = function(e)
{
  if ((e.target == this.canvas) && (this.mouse_is_down_in_goal_indicator)) 
    e.preventDefault();
  else if ((e.target == this.canvas) && (this.mouse_is_down_in_goal_indicator_2) && (this.style == Speedometer_Widget.STYLE_RANGE)) 
    e.preventDefault();
};

/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.get_touch_position = function(canvas, e) 
{
  var rect = canvas.getBoundingClientRect();
  var result =
    {
      x: e.touches[0].clientX - rect.left,
      y: e.touches[0].clientY - rect.top
    };
  return result;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.get_timer_string = function(value)
{
  /* expects value to be minutes */
  value *= 60;
  var val = Math.round(value);
  var secs = val % 60;
  var mins = (val-secs) / 60;
  var time = mins.toFixed(0) + ":" + ("0" + secs).slice(-2);
  return time;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.scalef = function(x, in_min, in_max, out_min, out_max)
{
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.clip = function(x, min, max)
{
  return (x < min) ? min : (x > max) ? max : x;
};

//PRIVATE
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.create_image = function(src)
{
  var img = document.createElement("IMG");
  img.src = src;
  img.style.display = "none";
  document.body.appendChild(img);
  return img;
};

//PRIVATE
/*--------------------------------------------------------------------*/
// for widgets of STYLE_RANGE
//returns 0 if in range, -1 if lower, +1 if higher
Speedometer_Widget.prototype.value_is_in_goal_range = function()
{
  if(this.goal_type == Speedometer_Widget.GOAL_TYPE_LESS_THAN)
    {
      return (this.target_level <= this.current_goal) ? 0 : 1;
    }
  else if(this.goal_type == Speedometer_Widget.GOAL_TYPE_AT_LEAST)
    {
      return (this.target_level >= this.current_goal) ? 0 : -1;
    }
  else if(this.goal_type == Speedometer_Widget.GOAL_TYPE_RANGE)
    {
      var larger = this.current_goal > this.current_goal_2;
      var max = (larger) ? this.current_goal : this.current_goal_2;
      var min = (larger) ? this.current_goal_2 : this.current_goal;
      var result = 0;
      if(this.target_level < min)
        result = -1;
      else if (this.target_level > max)
        result = 1;
      return result;
    }
  else if(this.goal_type == Speedometer_Widget.GOAL_TYPE_NONE)
    {
      return 0;
    }
};

//PRIVATE
/*--------------------------------------------------------------------*/
Speedometer_Widget.prototype.interpolation_thread_run_loop_run = function()
{
  this.current_level  = (0.8 * this.current_level ) + (0.2 * this.target_level  );
  this.current_num    = (0.8 * this.current_num   ) + (0.2 * this.target_num    );
  this.current_goal   = (0.5 * this.current_goal  ) + (0.5 * this.target_goal   );
  this.current_goal_2 = (0.5 * this.current_goal_2) + (0.5 * this.target_goal_2 );
  this.draw(this.current_level, this.current_num, this.current_goal, this.current_goal_2);
  this.update_thread = setTimeout(this.interpolation_thread_run_loop_run.bind(this), this.interpolation_thread_runloop_duration);
};




/*-----_----_-------------------------_------_----------_----_----------_
  __ _(_)__| |___ ___   _ __  ___  __| |__ _| | __ __ _(_)__| |__ _ ___| |_ 
  \ V / / _` / -_) _ \ | '  \/ _ \/ _` / _` | | \ V  V / / _` / _` / -_)  _|
   \_/|_\__,_\___\___/ |_|_|_\___/\__,_\__,_|_|  \_/\_/|_\__,_\__, \___|\__|
--------------------------------------------------------------|___/-----  
----------------------------------------------------------------------*/

//PUBLIC
/*--------------------------------------------------------------------*/
function Video_Modal_Widget(button_id, video_path)
{
  this.open_modal_button = document.getElementById(button_id);
  this.video_modal_div = document.createElement("DIV");
  this.video_modal_div.style.display           = "none";
  this.video_modal_div.style.position          = "fixed";
  this.video_modal_div.style.zIndex            = "10";
  this.video_modal_div.style.left              = "0px";
  this.video_modal_div.style.top               = "0px";
  this.video_modal_div.style.width             = "100%";
  this.video_modal_div.style.height            = "100%";
  this.video_modal_div.style.overflow          = "auto";
  this.video_modal_div.style.backgroundColor   = "rgba(0, 0, 0, 0.4)";
  
  this.modal_content_div = document.createElement("DIV");
  //this.modal_content_div.style.backgroundColor = "#fefefe";
  this.modal_content_div.style.position        = "absolute";
  this.modal_content_div.style.top             = "0px";
  this.modal_content_div.style.left            = "0px";
  this.modal_content_div.style.width           = "100%";
  this.modal_content_div.style.height          = "100%";
  this.modal_content_div.style.textAlign       = "center";
  this.modal_content_div.style.display         = "block";
  
  this.modal_video = document.createElement("VIDEO");
  this.modal_video.src                         = video_path;
  this.modal_video.style.position              = "absolute";
  this.modal_video.style.left                  = "0px";
  this.modal_video.style.top                   = "0px";
  this.modal_video.style.width                 = "100%";
  this.modal_video.style.height                = "100%";
  this.modal_video.style.backgroundColor       = "rgba(0, 0, 0, 0.8)";
  
  this.close_modal_button = document.createElement("DIV");
  this.close_modal_button.style.color          = "#888";
  this.close_modal_button.style.fontSize       = "28px";
  this.close_modal_button.style.fontWeight     = "bold";
  this.close_modal_button.style.position       = "relative";
  this.close_modal_button.style.backgroundColor= "black";
  this.close_modal_button.style.cursor         = "pointer";
  this.close_modal_button.innerHTML            = "DISMISS";
  //todo: make hover and focus white, make it look clickable for
  //devices with no hover / click
  //also, the button will cover the top of the video in landscape mode
  
  this.modal_content_div.appendChild(this.modal_video       );
  this.modal_content_div.appendChild(this.close_modal_button);
  this.video_modal_div.appendChild  (this.modal_content_div );
  document.body.appendChild         (this.video_modal_div   );
  
  this.close_modal_button.onclick = this.hide_modal.bind(this);
  //this.open_modal_button.onclick  = this.show_modal.bind(this);
}

//PUBLIC
/*--------------------------------------------------------------------*/
Video_Modal_Widget.prototype.show_modal = function()
{
  this.video_modal_div.style.display = "block";
  this.modal_video.play();
};

//PUBLIC
/*--------------------------------------------------------------------*/
Video_Modal_Widget.prototype.hide_modal = function()
{
  this.video_modal_div.style.display = "none";
  this.modal_video.pause();
  this.modal_video.currentTime = 0;
};

//PUBLIC
/*--------------------------------------------------------------------*/
Video_Modal_Widget.prototype.set_video = function(video_path)
{
  this.modal_video.src = video_path;
  this.modal_video.load();
};


/*--------------------------------------------------------------------*/
Linguistics.compliments =
[
  "Good Job!",
  "Nice Work!",
  "Great!",
  "Cool!",
  "Unbelievable Work!",
  "Way To Go!",
  "You've Outdone Yourself!",
  "Amazing Effort!",
  "Keep Up The Good Work!",
  "You Should Be Proud!",
  "Stupendous!",
  "Good For You!",
  "Take A Bow!",
  "That Was Everything I Hoped For!",
  "You're Tops!",
  "You're  Number 1!",
  "Remarkable!",
  "You're A Winner!",
  "5 Star Work!",
  "You're The Greatest!",
  "Magnificent!",
  "Outstanding Job!",
  "Beautiful!",
  "That's Perfect!",
  "Perfect!",
  "Nice One!",
  "Incredible!",
  "Great Job!",
  "You Rock!",
  "Good For You!",
  "Way To Use Your Feet!",
  "Fancy Footwork!",
  "Getting Better All The Time!",
  "Super!",
  "Super Duper!",
  "Hats Off To You!",
  "Lovely!",
  "Phenomenal!",
  "Two Thumbs Up!",
  "Terrific!",
  "Marvelous!",
  "Bravo!",
  "Wonderful!",
  "First Rate Work!",
  "I Knew You Had It In You!",
  "Sensational!",
  "Awesome!",
  "Super Job!",
  "Well Done!",
  "Wow!",
  "You're Amazing!",
  "You've Got What It Takes!",
  "You're Super!",
  "Sweet!",
  "What A Genius!",
  "Congratulations!",
  "I'm Impressed!",
  "You're A Champ!",
  "You've Earned My Respect!",
  "Neat Work!",
  "Right On!",
  "You're Improving!",
  "Stunning!",
  "A Job Well Done!",
  "Wonderful!",
  "Great Dedication!",
  "Spectacular!",
  "Superb!",
  "Excellent!",
  "You've Got It!",
  "Outstanding Performance!",
  "Exceptional!",
  "Fantastic Work!",
  "Very Good!",
  "A-Plus Effort!",
  "You're A Great Example For Others!",
  "Nice Going!",
  "You're Inspiring!",
  "Hooray For You!",
  "You're Getting Better!",
  "Spectacular Work!",
  "The Time You Put In Really Shows!",
  "How Extraordinary!",
  "That's Incredible!",
  "You Can Do It!",
  "Great Job!",
  "You're A Natural!",
  "Way To Go!",
  "You're Very Talented!",
  "Right On!",
  "You're A-OK!",
  "You've Made Progress!",
  "Brilliant!",
  "Your Best Work!",
  "Keep It Up!",
  "You Rule!",
  "That's The Way!",
  "Alright!",
  "Better Than Ever!",
  "Top Notch!",
  "Great Enthusiasm!",
  "You Make It Look Easy!",
  "Tremendous!",
  "Everything is Awesome!",
];

/*--------------------------------------------------------------------*/
Linguistics.motivations = 
[
  "Keep Going!",
  "Don't Give Up Now!",
  "Almost There!",
  "Just a Little More!",
  "You've Almost Got It",
  "Keep Going Strong!",
  "You Can Do It!",
  "You've Got This!",
  "Don't Stop Now!",
];

/*--------------------------------------------------------------------*/
Linguistics.virtual_coach_cues = 
[
  "Maradona",
  "Speed up forward",
  "Scissors",
  "Step over",
  "Cut Left",
  "Cut Right",
  "Ronaldo Cut",
  "La Crocketa",
];

/*--------------------------------------------------------------------*/
function Linguistics()
{

}

/*--------------------------------------------------------------------*/
Linguistics.prototype.get_random_statement = function(statements)
{
  var r = Math.floor(Math.random() * statements.length);
  return statements[r];
};

/*--------------------------------------------------------------------*/
Linguistics.prototype.get_random_compliment = function()
{
  return this.get_random_statement(Linguistics.compliments);
};

/*--------------------------------------------------------------------*/
Linguistics.prototype.get_random_motivation = function()
{
  return this.get_random_statement(Linguistics.motivations);
};

/*--------------------------------------------------------------------*/
Linguistics.prototype.get_random_virtual_coach_cue = function()
{
  return this.get_random_statement(Linguistics.virtual_coach_cues);
};

/*--------------------------------------------------------------------*/
Linguistics.prototype.get_colloquial_duration = function(seconds)
{
  var result = "";
  var secs = Math.round(seconds);
  var mins = 0;
  if(seconds < 53) //less than about a minute, say how many seconds
    result = parseInt(secs) + " seconds";
  else if(seconds < 600) //about a minute to 10 minutes, say the mintes and seconds rounded to 15 secs
    {
      //round to the nearest 15 seconds
      secs = 15 * Math.round(secs / 15);
      mins = Math.floor(secs / 60);
      secs %= 60;
      var plural_mins = (mins > 1) ? "minutes" : "minute";
      
      result = "about " + parseInt(mins);
      switch(secs)
        {
          case 0: 
            result += " " + plural_mins;
            break;
          case 15: 
            result += " " + plural_mins + " and 15 seconds";
            break;
          case 30: 
            result += " and a half minutes";
            break;
          case 45: 
            result += " " + plural_mins + " and 45 seconds";
            break;
          default:
            result += " " + plural_mins;
            break;
        }
    }
  else if (mins < 1800) //between 10 and 30 minutes say the minutes only
    {
      mins = Math.floor(secs / 60);
      result = "about " + parseInt(mins) + "minutes";
    }
  else //at least 30 minutes round to the nearest 5 minutes
    {
      mins = Math.floor(secs / 60);
      mins = 5 * Math.round(mins/5);
      result = "about " + parseInt(mins) + "minutes";
    }
  return result;
};

//gloabally defined singleton instance
var linguistics = new Linguistics();

/*---------_-_-_--------_---------------------------_------------------_      _
   _ _ ___| | | |_(_)__| |__  _ __  __ _ __ _ ___  | |_ ___ _ __  _ __| |__ _| |_ ___ 
  | '_/ _ \ | | / / / _| / / | '_ \/ _` / _` / -_) |  _/ -_) '  \| '_ \ / _` |  _/ -_)
  |_| \___/_|_|_\_\_\__|_\_\ | .__/\__,_\__, \___|  \__\___|_|_|_| .__/_\__,_|\__\___|
-----------------------------|_|--------|___/--------------------|_|----
----------------------------------------------------------------------*/
Rollkick_Page_Template.STATE_WAITING_TO_BECOME_CONNECTED  = 0;
Rollkick_Page_Template.STATE_WAITING_TO_BECOME_STATIONARY = 1;
Rollkick_Page_Template.STATE_STATIONARY                   = 2;

Rollkick_Page_Template.SOLE_ROLL_MODE                     = 0;
Rollkick_Page_Template.DIRECTION_MODE                     = 1;


/*--------------------------------------------------------------------*/
function Rollkick_Page_Template(IC, video_modal_id, time_dial_id, kicks_dial_id, score_log_id, speech_log_id, widgets_directory, audio_player_id, best_score_id)
{
  //this.transport                           = new Transport_Widget    (IC, transport_id, widgets_directory);
  //this.ball_status                       = new Ball_Status_Widget  (ball_status_id, widgets_directory);
  this.video_modal                         = new Video_Modal_Widget  (video_modal_id, ""); //set the video src when the page loads
  this.time_dial                           = new Speedometer_Widget(time_dial_id, "", "MINUTES", "", Speedometer_Widget.STYLE_TIMER, Speedometer_Widget.GOAL_TYPE_AT_LEAST);
  this.kicks_dial                          = new Speedometer_Widget(kicks_dial_id, "kicks", "KICKS", "", Speedometer_Widget.STYLE_SPEEDOMETER, Speedometer_Widget.GOAL_TYPE_AT_LEAST); //"kicks" will be overwritten later with 'rolls' or whatever
  //this.ball_position                       = new Ball_Position_Widget(ball_position_id, widgets_directory);

  this.kicks_dial.set_level_and_num_ranges  (0, 1600);

  this.score_log                           = new Score_Log_Widget    (score_log_id, "", ["Start Time", "End Time", "Minutes", "Kicks", "Avg Duration", "Duration Variance", "Avg Force", "Force Variance", "Avg Distance", "Dist Variance", "session_count", "count_type", "session_duration"], ["*", "*", "0.00", 0, 0, "*", 0, "*", 0, "*", "*", "*", "*"], []);
  this.speech_log                          = new Speech_Log_Widget   (speech_log_id);
  this.best_score_element                  = document.getElementById(best_score_id);
  this.best_k_per_m                        = 0;
  this.best_minutes                        = 0;
  this.IC                                  = IC;
  this.timer_running                       = false;
  this.timer_interval                      = 50; //milliseconds
  this.audio_volume                        = 0;
  this.audio_volume_decay                  = 0.99;
  var motionless_duration_before_pause     = 7;
  var motionless_duration_before_stop      = 15;
  this.session_timer                       = new Session_Timer(motionless_duration_before_pause, motionless_duration_before_stop);
  this.force_average                       = new OnlineAverage();
  this.spin_average                        = new OnlineAverage();
  this.dist_average                        = new OnlineAverage();
  this.dur_average                         = new OnlineAverage();
  this.divide_by_n                         = 1;
  this.state                               = Rollkick_Page_Template.STATE_WAITING_TO_BECOME_STATIONARY;
  this.mode                                = Rollkick_Page_Template.SOLE_ROLL_MODE;
  this.prev_force                          = 0;
  this.prev_spin                           = 0;
  this.vel_motion_threshold                = 0.001;

  this.wall_position_x                     = new OnlineAverage();
  this.wall_position_y                     = new OnlineAverage();
  this.wall_position_t                     = new OnlineAverage();
  
  this.audio_player_id = audio_player_id;
  this.audio_player = new Audio_File_Player("sounds/music.mp3", audio_player_id, true);
  
  this.timer_thread = null;
  this.clear();
    
}

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.page_load = function(name, video_path, kicks_level_text, kicks_num_text, divide_by, mode)
{
  console.log("rollkick page load");
  this.video_modal.set_video(video_path);
  var column_names = ["Start Time", "End Time", "Minutes", kicks_num_text, "Avg Duration", "Duration Variance", "Avg Force", "Force Variance", "Avg Distance", "Dist Variance", "session_count", "count_type", "session_duration"];
  this.score_log.set_game_name(name, column_names);

  this.speech_log.display_and_speak(""); //This primes IOS, otherwise nothing is spoken
  this.clear();
  this.timer_run();
  
  
  //this.ball_position.drift_correction = true;
  //this.ball_position.set_N(22);
  
  this.kicks_dial.num_text   = kicks_num_text;
  this.kicks_dial.level_text = kicks_level_text;
  this.kicks_dial.set_goal(200, true);
  this.kicks_dial.resume_updating();
  this.time_dial.resume_updating();
  
  this.session_timer.clear();
  
  this.divide_by_n = divide_by;
  
  //this.transport.connect_to_IC(name);
  //this.speech_log.display("Start when you are ready.");
  
  this.play_audio_file();
  //this.transport.play();

  this.mode = mode;

  this.best_k_per_m                        = 0;
  this.best_minutes                        = 0;
  this.display_best_score(0, "0:00");                

  this.IC.onrollkick       = this.onrollkick.bind(this);
  this.IC.onsurveyorswheel = this.onsurveyorswheel.bind(this);
};

Rollkick_Page_Template.prototype.load_song = function(url)
{
  
  this.audio_player = new Audio_File_Player(url, this.audio_player_id, true);
}

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.page_will_unload = function()
{
  console.log("rollkick page will unload");
  //this.IC.stop_tracking();
  this.IC.onrollkick       = null;
  this.IC.onsurveyorswheel = null;
  this.timer_stop();
  this.kicks_dial.stop_updating();
  this.time_dial.stop_updating();
  //this.transport.stop();
  //this.transport.disconnect_from_IC(this.name);
  this.stop_audio_file();
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.page_did_unload = function()
{
  console.log("rollkick page did unload");
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.clear = function()
{
  this.state = Rollkick_Page_Template.STATE_WAITING_TO_BECOME_CONNECTED;
  this.speech_log.display("Your ball is not connected.");
  
  this.audio_volume = 0;
  this.session_timer.clear();
  this.actual_volume  = 0;
  this.target_volume  = 0;

  this.time_dial.set_level(0, false, 0, true);
  this.kicks_dial.set_level(0, false, 0, true);
  this.score_log.live_update_first_row(this.score_log.blank_row);
  //this.ball_position.clear();
  this.IC.soft_init();

  this.filtered_vel = 10 * this.vel_motion_threshold;
  
  this.prev_force                          = 0;
  this.prev_spin                           = 0;
  
  this.force_average.init();
  this.spin_average.init();
  this.dist_average.init();
  this.dur_average.init();
  this.wall_position_x.init();
  this.wall_position_y.init();
  this.wall_position_t.init();
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.live_update_score_table = function()
{
  this.score_log.live_update_first_row
    ([
      this.session_timer.start_time,
      this.session_timer.end_time,
      this.session_timer.get_timer_string(),
      Math.floor(this.force_average.n / this.divide_by_n),
      //this.get_k_min().toFixed(2),
      this.dur_average.mean.toFixed(2) * this.divide_by_n,
      this.dur_average.variance.toFixed(2),
      this.force_average.mean.toFixed(0),
      this.force_average.variance.toFixed(2),
      this.dist_average.mean.toFixed(2) * this.divide_by_n,
      this.dist_average.variance.toFixed(2),
      Math.floor(this.force_average.n / this.divide_by_n),
      this.kicks_dial.num_text,
      this.session_timer.play_duration,
    ]);
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.timer_run = function()
{
  if(this.timer_running === false)
    this.timer_run_loop();
  this.timer_running = true;
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.timer_stop = function()
{
  clearTimeout(this.timer_thread);
  this.timer_running = false;
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.check_best_score = function()
{
  var m     = this.session_timer.get_play_duration();
  if(m <= 0) return;
  
  var k     = this.kicks_dial.target_num;
  var k_m   = 60 * k / m;
  
  if((m > this.best_minutes) && (k_m > this.best_k_per_m))
    {
      this.best_minutes = m;
      this.best_k_per_m = k_m;
      this.display_best_score(k, this.session_timer.get_timer_string());
    }
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.display_best_score = function(k, m)
{
  this.best_score_element.innerHTML = parseInt(k) + " " + this.kicks_dial.level_text + " in " + m; 
};


/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.timer_run_loop = function()
{
  var notice = this.session_timer.increment(this.timer_interval * 0.001);
  this.live_update_score_table();
  
  if(this.session_timer.state == Session_Timer.TIMER_STATE_RUNNING)
    this.time_dial.set_level(this.session_timer.get_play_duration()/60, true, this.session_timer.get_play_duration()/60, true);
  
  switch(notice)
    {
      case Session_Timer.TIMER_NOTIFICATION_DID_START:
        //first kick of new game
        //this.speedometer.set_level(0, false, 0, true);
        //this.speech_log.display_and_speak("Started game. Try to do " + parseInt(this.speedometer.target_goal) + " rolls per minute.");
        this.speech_log.display("Started game.");
        break;
        
      case Session_Timer.TIMER_NOTIFICATION_DID_PAUSE:
        this.speech_log.display_and_speak(linguistics.get_random_motivation());
        break;
        
      case Session_Timer.TIMER_NOTIFICATION_DID_RESUME:
        this.speech_log.display(linguistics.get_random_compliment());
        break;
        
      case Session_Timer.TIMER_NOTIFICATION_DID_STOP:
        this.speech_log.display_and_speak(linguistics.get_random_compliment() + " You did " + this.kicks_dial.target_num + " " + this.kicks_dial.level_text + " in " + linguistics.get_colloquial_duration(this.session_timer.get_play_duration()) + ".");
        this.score_log.commit_first_row();
        this.audio_volume = 0;
        this.force_average.init();
        this.spin_average.init();
        this.dist_average.init();
        this.dur_average.init();
        //this.ball_position.clear();
        this.IC._rollkick.init_position();
        this.check_best_score();
        this.session_timer.clear();
        break;
        
      default:break;
    }
    
  this.audio_volume *= this.audio_volume_decay;

  //deliberately clip the audio volume so it stays fully up for some time after kick.
  this.set_audio_volume(this.audio_volume * 1.75);

  //todo: how accurate is this? can I get system uptime in microseconds?
  this.timer_thread = setTimeout(this.timer_run_loop.bind(this), this.timer_interval);
};

/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/* AUDIO CRAP BEOW HERE */

Rollkick_Page_Template.prototype.set_audio_volume = function(vol)
{
  if(vol > 1) vol = 1;
  if(vol < 0) vol = 0;
  
  //vol [0 ~ 1] to decibels [-100dB - 0dB]
  vol = vol-1;
  vol *= 100;
  
  //decibels to gain [0 ~ 1];
  //(so that equal steps sizes are perceptually the same change in loudness)
  if(vol <= -70)
    vol = 0;
  else
    {
      vol *= 0.1;
      vol = Math.pow(2, vol);
    }
  this.audio_player.set_gain(vol);
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.stop_audio_file = function(element_id)
{
  this.audio_player.stop();
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.play_audio_file = function()
{
/*
  //THE canplay EVENT WILL NOT BE TRIGGERD ON IPHONE FOR DYNAMICALLY CREATED ELEMENTS,
  //AND IF THE USER DOES NOT CLICK ON A BUTTON TO PLAY THE SOUND
  //THIS WORKAROUND WORKS SINCE WE HAVE ONLY 1 AUDIO FILE.
  
  if(this.audio_player.addEventListener)
    this.audio_player.addEventListener("canplay", rollkick_page_template_audio_file_loaded, false);

  else if(this.audio_player.attachEvent)
    this.audio_player.attachEvent("oncanplay", rollkick_page_template_audio_file_loaded);
  else
    this.audio_player["oncanplay"] = rollkick_page_template_audio_file_loaded;
    
  this.audio_player.innerHTML = "<source src='" + filename + "' type='audio/mpeg' />"
*/

  this.audio_player.play();
};

/*--------------------------------------------------------------------*/  
function rollkick_page_template_audio_file_loaded(e)
{
  var audio_element = e.target;
  /*
   * remove the event, because on some browsers (Firefox) jumping to a new location
   * will trigger this event again, recursively ad inf.
   */
  if(audio_element.removeEventListener)
    audio_element.removeEventListener("canplay", rollkick_page_template_audio_file_loaded);
  else if(audio_element.detachEvent)
    audio_element.detachEvent("oncanplay", rollkick_page_template_audio_file_loaded);
  else
    audio_element.oncanplay = null;
    //audio_element["oncanplay"] = null;
    
  audio_element.play();
}

/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.onrollkick = function(e)
{
  //enforce that the game start with the ball sitting on the ground.
  if(this.state == Rollkick_Page_Template.STATE_WAITING_TO_BECOME_STATIONARY)
    return;
      
  //e.distance_since_previous==0 indicates ball kicked from stationary, reports force and spin only
  //so here, ball was not kicked from stationary
  if(e.duration_since_prev !== 0)
    {
      if(this.mode == Rollkick_Page_Template.SOLE_ROLL_MODE)
        {
          this.dist_average.update  (e.distance_since_prev);
          this.dur_average.update   (e.duration_since_prev);        
        }
      
      else //if(this.mode == Rollkick_Page_Template.DIRECTION_MODE)
        {
          var was_initial_direction = true;
          
          if (this.force_average.n === 0)
            this.initial_direction = e.direction;

          if(this.get_min_angle(this.initial_direction, e.direction) > (0.35*Math.PI))
            was_initial_direction = false;
          
          if(was_initial_direction)
            {
              this.force_average.update (this.prev_force);
              this.spin_average.update  (this.prev_spin);
              this.dist_average.update  (e.distance_since_prev);
              this.dur_average.update   (e.duration_since_prev);
            }
        }
    }
    
  //force==0 indicates ball stopped rolling, reports duration and distance only
  //so here, ball was kicked, e.g. it did not roll to a stop
  if(e.force !== 0)
    {
      if(this.mode == Rollkick_Page_Template.SOLE_ROLL_MODE)
        {
          this.force_average.update (e.force);
          this.spin_average.update  (e.spin);
        }
      else //if(this.mode == Rollkick_Page_Template.DIRECTION_MODE)
        {
          this.prev_force = e.force;
          this.prev_spin  = e.spin;
        }
      //in direction mode, if I just kicked it, the new force and spin will appear later...
      this.kicks_dial.set_level(Math.floor(this.force_average.n / this.divide_by_n), true, Math.floor(this.force_average.n / this.divide_by_n), true);
      
      this.audio_volume = 1.0;
      this.session_timer.mark_as_active();
      this.live_update_score_table();
    }
};

/*--------------------------------------------------------------------*/
Rollkick_Page_Template.prototype.onsurveyorswheel = function(e)
{
  //this.ball_position.update(e.sample_interval, e.x, e.y, 0);
  
  if(this.state == Rollkick_Page_Template.STATE_WAITING_TO_BECOME_CONNECTED)
    {
      this.speech_log.display("Please set the ball down");
      this.state = Rollkick_Page_Template.STATE_WAITING_TO_BECOME_STATIONARY;
    }
  else if(this.state == Rollkick_Page_Template.STATE_WAITING_TO_BECOME_STATIONARY)
    {
      var dl = Math.hypot(e.dx, e.dy);
      this.filtered_vel = (0.93 * this.filtered_vel) + (0.07 * dl);
      //console.log(this.filtered_vel, this.vel_motion_threshold);
      if(this.filtered_vel < this.vel_motion_threshold)
        {
          this.state = Rollkick_Page_Template.STATE_STATIONARY;
          this.speech_log.display("Start when you are ready");
        }
    }
};

/*--------------------------------------------------------------------*/
//expects a and b to be on the range -PI ~ PI
Rollkick_Page_Template.prototype.get_min_angle = function(a, b)
{
  var angle = 0;

  if(a<b)
    angle = b-a;
  else
    angle = a-b;

   if(angle >= Math.PI)
     angle -= 2*Math.PI;
   else if(angle < 0)
     angle += 2*Math.PI;

   return Math.abs(angle);
};
/*--------------------------------------------------------------------*/
/*
Rollkick_Page_Template.prototype.get_k_min = function(e)
{  
  var k_min = 0;
  if(this.dur_average.mean > 0)
    k_min = 60.0 * this.divide_by_n / this.dur_average.mean;
  return k_min;
};
*/


/*--__-_-_------_---_---_---_----_---------------------------_----------        _      _
   / _| (_)__ _| |_| |_| |_(_)__| |__  _ __  __ _ __ _ ___  | |_ ___ _ __  _ __| |__ _| |_ ___ 
  |  _| | / _` | ' \  _| / / / _| / / | '_ \/ _` / _` / -_) |  _/ -_) '  \| '_ \ / _` |  _/ -_)
  |_| |_|_\__, |_||_\__|_\_\_\__|_\_\ | .__/\__,_\__, \___|  \__\___|_|_|_| .__/_\__,_|\__\___|
----------|___/-----------------------|_|--------|___/------------------  |_|
----------------------------------------------------------------------*/


/*--------------------------------------------------------------------*/
function Flightkick_Page_Template(IC, height_dial_id, distance_dial_id, speed_dial_id, spin_dial_id, video_modal_id, ball_position_id, score_log_id, speech_log_id, widgets_directory)
{
  //this.transport            = new Transport_Widget    (IC, transport_id, widgets_directory);
  this.height_dial          = new Speedometer_Widget  (height_dial_id  , "meters"       , "HEIGHT"  , widgets_directory, Speedometer_Widget.STYLE_SPEEDOMETER, Speedometer_Widget.GOAL_TYPE_RANGE);
  this.distance_dial        = new Speedometer_Widget  (distance_dial_id, "meters"       , "DISTANCE", widgets_directory, Speedometer_Widget.STYLE_SPEEDOMETER, Speedometer_Widget.GOAL_TYPE_RANGE);
  this.speed_dial           = new Speedometer_Widget  (speed_dial_id   , "meters / sec" , "SPEED"   , widgets_directory, Speedometer_Widget.STYLE_SPEEDOMETER, Speedometer_Widget.GOAL_TYPE_RANGE);
  this.spin_dial            = new Speedometer_Widget  (spin_dial_id    , "radians / sec", "SPIN"    , widgets_directory, Speedometer_Widget.STYLE_SPEEDOMETER, Speedometer_Widget.GOAL_TYPE_RANGE);
  
  this.height_dial.style   = Speedometer_Widget.STYLE_RANGE;
  this.distance_dial.style = Speedometer_Widget.STYLE_RANGE;
  this.speed_dial.style    = Speedometer_Widget.STYLE_RANGE;
  this.spin_dial.style     = Speedometer_Widget.STYLE_RANGE;
    
  this.height_dial.set_level_and_num_ranges  (0, 16);
  this.distance_dial.set_level_and_num_ranges(0, 40);
  this.speed_dial.set_level_and_num_ranges   (0, 40);
  this.spin_dial.set_level_and_num_ranges    (0, 40);
  
  this.height_dial.set_goal_range  (2, 6);
  this.distance_dial.set_goal_range(4, 8);
  this.speed_dial.set_goal_range   (8, 10);
  this.spin_dial.set_goal_range    (10, 20);
  
  this.height_dial.set_level  (0, true, 0, true);
  this.distance_dial.set_level(0, true, 0, true);
  this.speed_dial.set_level   (0, true, 0, true);
  this.spin_dial.set_level    (0, true, 0, true);  
  
  this.spin_dial.level_digits     = 
  this.spin_dial.num_digits       = 
  this.speed_dial.level_digits    = 
  this.speed_dial.num_digits      =
  this.distance_dial.level_digits = 
  this.distance_dial.num_digits   = 
  this.height_dial.level_digits   = 
  this.height_dial.num_digits     = 0;
  
  this.video_modal          = new Video_Modal_Widget  (video_modal_id, ""); //set the video src when the page loads
  //this.ball_position        = new Ball_Position_Widget(ball_position_id, widgets_directory);
  this.ball_position        = new Ball_Position_Widget_3D('ball_position_page_b', widgets_directory, false);
  this.score_log            = new Score_Log_Widget    (score_log_id, "", ["Start Time", "End Time", "Distance", "Height", "Speed", "Spin", "Duration", "Force", "session_count", "count_type", "session_duration"], ["*", "*", 0,0,0,0,0,0, "*", "*", "*"], [{min: 0, max: 10}, {min: 0, max: 10}, {min: 0, max: 10}, {min: 0, max: 100}, {min: 0, max: 5}, {min: 0, max: 800}]);
  this.speech_log           = new Speech_Log_Widget   (speech_log_id);
  this.IC                   = IC;
  
  this.first_possibly_flying = true;
  
  this.speech_log.message_div.style.border = "none";
  this.speech_log.message_div.style.textAlign = "center";
  this.speech_log.message_div.style.backgroundColor = "white";
  
  this.session_timer = new Session_Timer(10, 20); //for now this is only used for getting start / end timestamp
  
  this.state = Flightkick_Page_Template.STATE_WAITING_TO_BECOME_CONNECTED;
}

/*--------------------------------------------------------------------*/
Flightkick_Page_Template.prototype.page_load = function(name, video_path)
{
  this.video_modal.set_video(video_path);
  
  this.score_log.set_game_name(name);
  //this.transport.connect_to_IC(name);
  this.speech_log.display_and_speak("");
  
  this.height_dial.resume_updating();
  this.distance_dial.resume_updating();
  this.speed_dial.resume_updating();
  this.spin_dial.resume_updating();
  
  this.clear();
  this.IC.onflight = this.onflight.bind(this);
  //this.transport.play();
};

/*--------------------------------------------------------------------*/
Flightkick_Page_Template.prototype.page_will_unload = function()
{
  //this.transport.stop();
  this.IC.onflight = null;
  this.height_dial.stop_updating();
  this.distance_dial.stop_updating();
  this.speed_dial.stop_updating();
  this.spin_dial.stop_updating();
  //this.transport.disconnect_from_IC(this.name);
};

/*--------------------------------------------------------------------*/
Flightkick_Page_Template.prototype.page_did_unload = function()
{

};

/*--------------------------------------------------------------------*/
Flightkick_Page_Template.prototype.clear = function()
{
  //this.score_log.live_update_first_row(this.score_log.blank_row);
  
  this.height_dial.clear();
  this.distance_dial.clear();
  this.spin_dial.clear();
  this.speed_dial.clear();
  
  this.speech_log.message_div.style.backgroundColor = "transparent";
  
  this.state = Flightkick_Page_Template.STATE_WAITING_TO_BECOME_CONNECTED;
  this.speech_log.display("Your ball is not connected");
  
  this.ball_position.clear();
  this.IC.soft_init();
};

/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
Flightkick_Page_Template.prototype.onflight = function(e)
{
  var time;
  switch(e.flight_state)
  {
    case Flightkick.STATE_AT_REST:
      this.speech_log.message_div.style.backgroundColor = "#64c864";
      this.first_possibly_flying = true;
      break;
      
    case Flightkick.STATE_POSSIBLY_FLYING:
      this.speech_log.message_div.style.backgroundColor = "transparent";
      //this.ball_position.clear();
       if(this.first_possibly_flying)
        {
          this.ball_position.clear();
          this.first_possibly_flying = false;
        }
      else
        {
          this.ball_position.update(e.sample_interval, e.x, e.y, e.z);
        }
      break;
      
    case Flightkick.STATE_IN_FREEFALL:
      time = this.session_timer.get_datetime();
      this.ball_position.update(e.sample_interval, e.x, e.y, e.z);
      this.first_possibly_flying = true;
      this.speech_log.message_div.style.backgroundColor = "transparent";
      this.score_log.live_update_first_row([time, time, Math.round(e.horizontal_distance), Math.round(e.height), Math.round(e.linear_speed), Math.round(e.spin), e.flight_time.toFixed(2), Math.round(e.force), 1, "Kicks", 0]);
      break;
      
    case Flightkick.STATE_BOUNCING:
      this.speech_log.message_div.style.backgroundColor = "transparent";
      this.first_possibly_flying = true;
      break;
      
    default: 
      this.first_possibly_flying = true;
      break;
    
  }
  if(e.ball_did_land)
    {
      time = this.session_timer.get_datetime();
      //var success = ((e.height >= this.height_dial.target_goal) && (e.horizontal_distance >= this.distance_dial.target_goal) && (e.spin >= this.spin_dial.target_goal)) ? "YES" : "NO";
      this.score_log.live_update_first_row([time, time, Math.round(e.horizontal_distance), Math.round(e.height), Math.round(e.linear_speed), Math.round(e.spin), e.flight_time.toFixed(2), Math.round(e.force), 1, "Kicks", 0]);
      if(e.horizontal_distance > 0)
        {
          this.score_log.commit_first_row();
          this.speech_log.display_and_speak(linguistics.get_random_compliment() + " The ball went about" + Math.round(e.horizontal_distance) + " meters");
        }
      this.ball_position.draw_ideal_trajectory(0, 0, e.x, e.y, e.height);
      this.height_dial.set_level(e.height, false, e.height, false);
      this.distance_dial.set_level(e.horizontal_distance, false, e.horizontal_distance, false);
      this.speed_dial.set_level(e.linear_speed, false, e.linear_speed, false);
      this.spin_dial.set_level(e.spin, false, e.spin, false);
    }
  //probably overkill to do this every 1 ms;
  this.speech_log.display(e.flight_state_message);
};


/*----_-_----_----------------------_---------------_---_---------------                    _                  _      _       
   __| (_)__| |_ __ _ _ _  __ ___  | |_ _ _ __ _ __| |_(_)_ _  __ _   _ __  __ _ __ _ ___  | |_ ___ _ __  _ __| |__ _| |_ ___ 
  / _` | (_-<  _/ _` | ' \/ _/ -_) |  _| '_/ _` / _| / / | ' \/ _` | | '_ \/ _` / _` / -_) |  _/ -_) '  \| '_ \ / _` |  _/ -_)
  \__,_|_/__/\__\__,_|_||_\__\___|  \__|_| \__,_\__|_\_\_|_||_\__, | | .__/\__,_\__, \___|  \__\___|_|_|_| .__/_\__,_|\__\___|
--------------------------------------------------------------|___/--|_|        |___/                    |_| 
----------------------------------------------------------------------*/

Freeplay_Page_Template.STATE_WAITING_TO_BECOME_CONNECTED  = 0;
Freeplay_Page_Template.STATE_CONNECTED                    = 1;

/*--------------------------------------------------------------------*/
function Freeplay_Page_Template(IC, video_modal_id, distance_dial_id, time_dial_id, ball_position_id, score_log_id, speech_log_id, widgets_directory)
{
  this.video_modal                         = new Video_Modal_Widget  (video_modal_id, ""); //set the video src when the page loads
  this.distance_dial                       = new Speedometer_Widget  (distance_dial_id, "meters", "distance" , widgets_directory, Speedometer_Widget.STYLE_SPEEDOMETER, Speedometer_Widget.GOAL_TYPE_AT_LEAST);
  this.time_dial                           = new Speedometer_Widget  (time_dial_id  , "minutes", "minutes", widgets_directory, Speedometer_Widget.STYLE_TIMER, Speedometer_Widget.GOAL_TYPE_AT_LEAST);
  this.ball_position                       = new Ball_Position_Widget(ball_position_id, widgets_directory);
  this.ball_position.set_cone_locations([]);
  
  this.score_log                           = new Score_Log_Widget    (score_log_id, "", ["start_time", "end_time", "Active Duration", "Meters", "session_count", "count_type", "session_duration"], ["*", "*", "0.00", 0, "*", "*", "*"], []);
  this.speech_log                          = new Speech_Log_Widget   (speech_log_id);
  this.IC                                  = IC;
  var motionless_duration_before_pause     = 15;
  var motionless_duration_before_stop      = 20;
  this.session_timer                       = new Session_Timer(motionless_duration_before_pause, motionless_duration_before_stop);
  this.total_distance_integrator           = new QuaternionTrapezoidIntegral();
  this.total_distance                      = new Quaternion(0, 0, 0, 0);

    
  this.distance_dial.set_level_and_num_ranges (0, 1600);
  this.distance_dial.set_goal                 (500);
  
  this.distance_dial.set_level  (0, true, 0, true);
  this.time_dial.set_level      (0, true, 0, true);
  
  this.vel_motion_threshold = 0.02;

  this.state = Freeplay_Page_Template.STATE_WAITING_TO_BECOME_CONNECTED;

  this.should_speak_cues    = true;
  this.cue_countdown_timer  = 0;
  this.cue_duration_mean    = 10;
  this.cue_duration_std_dev = 3;

  this.clear();
}

/*--------------------------------------------------------------------*/
Freeplay_Page_Template.prototype.page_load = function(name, video_path)
{
  this.time_dial.resume_updating();
  this.distance_dial.resume_updating();
  this.video_modal.set_video(video_path);
  this.IC.onsurveyorswheel = this.onsurveyorswheel.bind(this);
  this.clear();
  this.ball_position.drift_correction = false;
  this.session_timer.clear();
  this.init_cue_timer();
  this.score_log.set_game_name(name, ["start_time", "end_time", "Active Duration", "Meters", "session_count", "count_type", "session_duration"]);
  this.speech_log.display_and_speak("");
};

/*--------------------------------------------------------------------*/
Freeplay_Page_Template.prototype.page_will_unload = function()
{
  this.IC.onsurveyorswheel = null;
  this.time_dial.stop_updating();
  this.distance_dial.stop_updating();
};

/*--------------------------------------------------------------------*/
Freeplay_Page_Template.prototype.page_did_unload = function()
{

};

/*--------------------------------------------------------------------*/
Freeplay_Page_Template.prototype.clear = function()
{
  this.session_timer.clear();
  this.time_dial.clear();
  this.distance_dial.clear();
  this.score_log.live_update_first_row(this.score_log.blank_row);
  this.ball_position.clear();
  this.IC.soft_init();

  this.state = Freeplay_Page_Template.STATE_WAITING_TO_BECOME_CONNECTED;
  this.speech_log.display("Your ball is not connected.");

  this.total_distance_integrator.init();
  this.total_distance.zero();
};

/*--------------------------------------------------------------------*/
Freeplay_Page_Template.prototype.live_update_score_table = function()
{
  //["start_time", "end_time", "Active Duration", "Meters", "session_count", "count_type", "session_duration"]
  this.score_log.live_update_first_row
    ([
      this.session_timer.start_time,
      this.session_timer.end_time,
      this.session_timer.get_timer_string(),
      this.total_distance.q[0].toFixed(0),
      this.total_distance.q[0].toFixed(0),
      this.distance_dial.num_text,
      this.session_timer.get_play_duration(),
    ]);
};


/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/



/*--------------------------------------------------------------------*/
Freeplay_Page_Template.prototype.onsurveyorswheel = function(e)
{
  if(this.state == Freeplay_Page_Template.STATE_WAITING_TO_BECOME_CONNECTED)
    {
      this.state = Freeplay_Page_Template.STATE_CONNECTED;
      this.speech_log.display("Start when you are ready");
    }
  
  //todo: update this whole thing only as often as ball_position.update returns true;
  this.ball_position.update(e.sample_interval, e.x, e.y, 0);
  
  //console.log(Math.hypot(e.dx, e.dy))
  var speed = Math.hypot(e.dx, e.dy);
  if(speed > this.vel_motion_threshold)
    {
      //todo: it seems a little silly to use a quaternion to represent a real number
      var dl = new Quaternion(speed, 0, 0, 0);
      this.total_distance_integrator.integrate(e.sample_interval, dl, this.total_distance);
      this.session_timer.mark_as_active();
      
      if(this.should_speak_cues)
        this.update_cue_timer(e.sample_interval);
    }

  var notice = this.session_timer.increment(e.sample_interval);
  this.live_update_score_table();
  
  if(this.session_timer.state == Session_Timer.TIMER_STATE_RUNNING)
    {
      this.distance_dial.set_level(this.total_distance.q[0], true, this.total_distance.q[0], true);
      this.time_dial.set_level(this.session_timer.get_play_duration() / 60.0, true, this.session_timer.get_play_duration() / 60.0, true);
    }
    
  switch(notice)
    {
      case Session_Timer.TIMER_NOTIFICATION_DID_START:
        this.speech_log.display("Started game");
        break;
        
      case Session_Timer.TIMER_NOTIFICATION_DID_PAUSE:
        this.speech_log.display_and_speak(linguistics.get_random_motivation());
        break;
        
      case Session_Timer.TIMER_NOTIFICATION_DID_RESUME:
        this.speech_log.display_and_speak(linguistics.get_random_compliment());
        break;
        
      case Session_Timer.TIMER_NOTIFICATION_DID_STOP:
        this.speech_log.display_and_speak(linguistics.get_random_compliment() + " You did " + this.distance_dial.target_num.toFixed(0) + " meters in " + linguistics.get_colloquial_duration(this.session_timer.get_play_duration()) + ".");
        this.score_log.commit_first_row();
        this.total_distance_integrator.init();
        this.total_distance.zero();
        this.session_timer.clear();
        this.ball_position.clear();
        this.IC._rollkick.init_position();
        this.init_cue_timer();
        break;
        
      default:break;
    }
};

/*--------------------------------------------------------------------*/
Freeplay_Page_Template.prototype.update_cue_timer = function(sample_interval)
{
  this.cue_countdown_timer -= sample_interval;
  if(this.cue_countdown_timer <= 0)
    {
      this.speech_log.display_and_speak(linguistics.get_random_virtual_coach_cue());
      this.init_cue_timer();
    }
};

/*--------------------------------------------------------------------*/
Freeplay_Page_Template.prototype.init_cue_timer = function()
{
  this.cue_countdown_timer = random_normal(this.cue_duration_mean, this.cue_duration_std_dev);
};


Cone_Weaving_Page_Template.STATE_WAITING_FOR_BALL_TO_BECOME_CONNECTED  = 1;
Cone_Weaving_Page_Template.STATE_WAITING_FOR_BALL_TO_BECOME_STATIONARY = 2;
Cone_Weaving_Page_Template.STATE_WAITING_TO_MOVE_TO_NEXT_CONE          = 3;
Cone_Weaving_Page_Template.STATE_MOVING_TO_NEXT_CONE                   = 4;
Cone_Weaving_Page_Template.STATE_PLAYING_GAME                          = 5;

Cone_Weaving_Page_Template.CONE_PAUSE_TIMER_TIMEOUT                    = 8;

/*--------------------------------------------------------------------*/
function Cone_Weaving_Page_Template(IC, video_modal_id, ball_position_id, score_log_id, speech_log_id, widgets_directory)
{
  this.video_modal                         = new Video_Modal_Widget  (video_modal_id, ""); //set the video src when the page loads
  this.ball_position                       = new Ball_Position_Widget(ball_position_id, widgets_directory);
  this.score_log                           = new Score_Log_Widget    (score_log_id, "", ["Start Time", "End Time", "Active Duration", "Laps", "Ball Control", "Num Cones", "Total Dist", "session_count", "count_type", "session_duration"], ["*", "*", "0:00", 0, 0, 0, 0, "*", "*","*",], [{min: 0, max: 100}, {min: 0, max: 100}, {min:0, max:100}, {min:0, max:100000}, {min:0, max:100}]);
  this.speech_log                          = new Speech_Log_Widget   (speech_log_id);
  this.IC                                  = IC;

  //this.MIN_COURSE_LENGTH           = 1.0; //todo: implement this
  //this.COURSE_CLOSE_RADIUS         = 1.0;//0.3;
  //this.MIN_INTERSECTION_SEPARATION = 1.0; //todo: implement this

  this.ball_position.drift_correction = true;
  this.ball_position.min_zoom_width_2 = 3;

  this.vel_motion_threshold = 0.01;

  var motionless_duration_before_pause   = 10;
  var motionless_duration_before_stop    = 20;
  this.session_timer = new Session_Timer(motionless_duration_before_pause, motionless_duration_before_stop);
  
  this.avg_dist_to_nearest_cone = new OnlineAverage();
  this.cone_pause_timer = 0;
  
  this.clear();
}

/*--------------------------------------------------------------------*/
Cone_Weaving_Page_Template.prototype.clear = function()
{
  //PRIVATE
  this.state = Cone_Weaving_Page_Template.STATE_WAITING_FOR_BALL_TO_BECOME_CONNECTED;
  this.filtered_vel = 20 * this.vel_motion_threshold;
  this.prev_position    = {x:0, y:0};
  
  this.ball_position.set_N(500);
  this.ball_position.set_cone_locations([]);
  this.ball_position.clear();
  
  this.speech_log.display("Your ball is not connected.");
  
  this.laps                     = 0;
  this.avg_dist_to_nearest_cone.init();
  this.total_distance           = 0;
  this.nearest_cone             = {cone:0, dist:0};
  this.cone_increment           = 1; //will become -1 on the return trip
  this.score_log.live_update_first_row(this.score_log.blank_row);
  this.IC.soft_init();
  this.ball_position.clear();
  this.session_timer.clear();
};
  
  
/*--------------------------------------------------------------------*/
Cone_Weaving_Page_Template.prototype.page_load = function(name, video_path, speedometer_level_text, speedometer_num_text)
{
  this.video_modal.set_video(video_path);
  this.score_log.set_game_name(name);
  this.speech_log.display_and_speak("");
  this.clear();
  //this.transport.connect_to_IC(name);
  //this.transport.disconnect_from_IC(this.name);
  
  //this.transport.play();
  this.IC.onsurveyorswheel = this.onsurveyorswheel.bind(this);
};

/*--------------------------------------------------------------------*/
Cone_Weaving_Page_Template.prototype.page_will_unload = function()
{
  //this.transport.stop();
  this.IC.onsurveyorswheel = null;
  //this.transport.disconnect_from_IC(this.name);
};

/*--------------------------------------------------------------------*/
Cone_Weaving_Page_Template.prototype.page_did_unload = function()
{

};

/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
/*--------------------------------------------------------------------*/
Cone_Weaving_Page_Template.prototype.onsurveyorswheel = function(e)
{
  //todo: use an integrator for this
  this.total_distance += e.sample_interval * Math.sqrt(e.dx*e.dx + e.dy*e.dy);
  
  if(this.ball_position.update(e.sample_interval, e.x, e.y, 0))
    {
      var position = this.ball_position.raw_position;
      var dl = this.get_distance(position, this.prev_position);
      this.prev_position = position;
      this.filtered_vel = (0.93 * this.filtered_vel) + (0.07 * dl);

      /*--------------------------------------------------------------*/
      if(this.state == Cone_Weaving_Page_Template.STATE_WAITING_FOR_BALL_TO_BECOME_CONNECTED)
        {
          this.state = Cone_Weaving_Page_Template.STATE_WAITING_FOR_BALL_TO_BECOME_STATIONARY;
          this.speech_log.display("Set the ball next to the first cone and wait a moment.");
        }
      
      /*--------------------------------------------------------------*/
      else if(this.state == Cone_Weaving_Page_Template.STATE_WAITING_FOR_BALL_TO_BECOME_STATIONARY)
        {
          if(this.filtered_vel < this.vel_motion_threshold)
            {
              this.filtered_vel = 0;
              this.state = Cone_Weaving_Page_Template.STATE_WAITING_TO_MOVE_TO_NEXT_CONE;
              this.ball_position.clear();
              this.ball_position.set_cone_locations([{x:0, y:0}]);
              this.speech_log.display_and_speak("OK, carefully roll the ball to the next cone and then take your foot off of the ball.");
              this.cone_pause_timer = 0;
            }
        }
      
      /*--------------------------------------------------------------*/
      else if(this.state == Cone_Weaving_Page_Template.STATE_WAITING_TO_MOVE_TO_NEXT_CONE)
        {
          if(dl > 2 * this.vel_motion_threshold)
            {
              this.filtered_vel = 20 * this.vel_motion_threshold;
              this.state = Cone_Weaving_Page_Template.STATE_MOVING_TO_NEXT_CONE;
            }
          else
            {
              this.cone_pause_timer += this.ball_position.decimation_interval;
              if(this.ball_position.cone_locations.length > 1)
                if(this.cone_pause_timer >= Cone_Weaving_Page_Template.CONE_PAUSE_TIMER_TIMEOUT)
                  {
                    this.speech_log.display_and_speak(linguistics.get_random_compliment() + " You have " + this.ball_position.cone_locations.length + " cones. Go ahead and start the game");
                    this.state = Cone_Weaving_Page_Template.STATE_PLAYING_GAME;
                    this.center_cones();
                  }
            }
        }
        
      /*--------------------------------------------------------------*/
      else if(this.state == Cone_Weaving_Page_Template.STATE_MOVING_TO_NEXT_CONE)
        {
          if(this.filtered_vel < this.vel_motion_threshold)
            {
              this.speech_log.display_and_speak(linguistics.get_random_compliment() + " Roll the ball to the next cone if there is one.");
              this.state = Cone_Weaving_Page_Template.STATE_WAITING_TO_MOVE_TO_NEXT_CONE;
              this.cone_pause_timer = 0;
              this.ball_position.append_cone_location({x: this.ball_position.raw_position.x, y:this.ball_position.raw_position.y});
            }
        }
      
      /*--------------------------------------------------------------*/
      if(this.state == Cone_Weaving_Page_Template.STATE_PLAYING_GAME)
        {
          var cone = this.nearest_cone.cone;
          this.get_distance_to_nearest_cone(this.ball_position.drift_corrected_position, this.nearest_cone);
          this.avg_dist_to_nearest_cone.update(this.nearest_cone.dist);
          
          if(this.filtered_vel > this.vel_motion_threshold)
            this.session_timer.mark_as_active();

          var notice = this.session_timer.increment(this.ball_position.decimation_interval);
  
          switch(notice)
            {
              case Session_Timer.TIMER_NOTIFICATION_DID_START:
                break;
        
              case Session_Timer.TIMER_NOTIFICATION_DID_PAUSE:
                this.speech_log.display_and_speak(linguistics.get_random_motivation() + " You can do one more lap!");
                break;
        
              case Session_Timer.TIMER_NOTIFICATION_DID_RESUME:
                this.speech_log.display_and_speak(linguistics.get_random_compliment());
                break;
        
              case Session_Timer.TIMER_NOTIFICATION_DID_STOP:
                if(this.laps > 0)
                  {
                    this.speech_log.display_and_speak(linguistics.get_random_compliment() + ", you did " + this.laps + " laps");
                    this.live_update_score_table();
                    this.score_log.commit_first_row();
                  }
                this.laps                     = 0;
                this.avg_dist_to_nearest_cone.init();
                this.total_distance           = 0;
                this.session_timer.clear();
                break;
        
              default:break;
            }

          if(this.session_timer.state == Session_Timer.TIMER_STATE_RUNNING)
            {
              if(cone+this.cone_increment == this.nearest_cone.cone)
                {
                  if(this.nearest_cone.cone === 0)
                    { 
                      ++this.laps;
                      this.speech_log.display_and_speak(this.laps + " laps");
                      this.cone_increment = 1;
                    }
                  if(this.nearest_cone.cone == this.ball_position.cone_locations.length-1)
                    {
                      this.cone_increment = -1;
                    }
                }
              this.live_update_score_table();
            }
        }
    }
};

/*--------------------------------------------------------------------*/
Cone_Weaving_Page_Template.prototype.live_update_score_table = function()
{
  //"Start Time", "End Time", "Active Duration", "Laps", "Ball Control", "Num Cones", "Total Dist"  
  this.score_log.live_update_first_row(
    [
      this.session_timer.start_time,  
      this.session_timer.end_time, 
      this.session_timer.get_timer_string(), 
      this.laps, 
      this.avg_dist_to_nearest_cone.mean.toFixed(2), 
      this.ball_position.cone_locations.length, 
      this.total_distance.toFixed(2),
      this.laps,
      "laps",
      this.session_timer.play_duration,
    ]);
};

/*--------------------------------------------------------------------*/
Cone_Weaving_Page_Template.prototype.get_distance = function(a, b)
{
  var a2 = b.x - a.x;
  var b2 = b.y - a.y;
  return Math.sqrt(a2*a2 + b2*b2);
};

/*--------------------------------------------------------------------*/
Cone_Weaving_Page_Template.prototype.get_distance_to_nearest_cone = function(position, result)
{
  result.dist = 1000000; //FLOAT_MAX
  var i, d;
  for(i=0; i < this.ball_position.cone_locations.length; i++)
    {
      d = this.get_distance(position, this.ball_position.cone_locations[i]);
      if(d < result.dist)
        {
          result.dist = d;
          result.cone = i;
        }
    }
};

/*--------------------------------------------------------------------*/
/* for the drift-corrector */
/* also put them in reverse order, sine we are now standing next to the last one */
Cone_Weaving_Page_Template.prototype.center_cones = function()
{
  var i;
  var center_x = 0;
  var center_y = 0;
  var cones = [];
  var l = this.ball_position.cone_locations.length;

  if(l <= 0)
    return;

  for(i=0; i<l; i++)
    {
      center_x += this.ball_position.cone_locations[i].x;
      center_y += this.ball_position.cone_locations[i].y;
    }
  center_x /= l;
  center_y /= l;
  
  for(i=0; i<l; i++)
    {
      cones.unshift({
        x: this.ball_position.cone_locations[i].x - center_x,
        y: this.ball_position.cone_locations[i].y - center_y,
      });
    }    

  /* PTHREAD_MUTEX_LOCK */
  this.ball_position.set_cone_locations(cones);
};


var navigation_back_history = [];
var navigation_hamburger_menu = document.getElementById("hamburgler-menu");
var navigation_back_history = [];
var navigation_back_button = document.getElementById("back_button");

var navigation_current_page_js = null;

/*--------------------------------------------------------------------*/
function navigation_go_back()
{
  navigation_back_history.pop();
  if(navigation_back_history.length > 0)
    navigation_load_page.apply(this, navigation_back_history.pop());
}

/*--------------------------------------------------------------------*/
function navigation_clear_back_history()
{
  navigation_back_history = navigation_back_history.splice(0);
  navigation_back_button.style.visibility = "hidden";
}

/*--------------------------------------------------------------------*/
function navigation_has_back_history()
{
  return (navigation_back_history.length > 1);
}

/*--------------------------------------------------------------------*/
function navigation_load_routine(routine_name)
{
  var routine  = $ROUTINES[routine_name];
  var new_page = GLOBAL_JS_PAGE_OBJECTS[routine.type];
  
  var routine_video_url = routine.video;
  
  //do this before calling page_load so 3d widget can set size
  document.getElementById(new_page.id).style.display = "block";
  
  if(routine.type == 'rollkick')
    {
      Rollkick.GYRO_MOTION_THRESHOLD = routine.gyro_motion_thresh;
      Rollkick.ONSET_THRESHOLD       = routine.impact_sensitivity;
      Rollkick.DEBOUNCE_DURATION     = routine.min_duration;
      
      //rollkick_template is declared in index.php
      //and defined in rollkick_page_template.js
      new_page.obj.page_load(routine.id, routine_video_url, routine.speedometer_level_text, routine.speedometer_num_text, parseInt(routine.divide_by), parseInt(routine.mode));        
    }
  else if(routine.type == 'flightkick')
    {
      //flightkick_template is declared in _page_routine_type_B.php
      //and defined in build/widgets/flightkick_page_template/widget.js
      new_page.obj.page_load(routine.id, routine_video_url);
      var mode = (routine.flightkick_mode == 'freekick') ? Flightkick.FREEKICK_MODE : Flightkick.DROPKICK_MODE;
      $IC.flightkick.mode = mode;
    }

  else if(routine.type == 'cones')
    {
      new_page.obj.page_load(routine.id, routine_video_url);
    }

  else if(routine.type == 'freeplay')
    {
      new_page.obj.page_load(routine.id, routine_video_url);
    }
      
  $IC.start_tracking();
  return new_page;
}

/*--------------------------------------------------------------------*/
function navigation_load_page(page_name)
{
  var is_routine = false;
  var new_page = null;
  var i;
  
  server_offline_queue_try_to_sync();
  
  navigation_back_button.style.visibility = (navigation_back_history.length > 0) ? "visible" : "hidden";
  while(navigation_back_history.length > 100)
    navigation_back_history.shift();
  navigation_back_history.push(arguments); 
  
  document.getElementById("page_title").innerHTML = page_name.toUpperCase().replace("-", " ");
  
  if(navigation_current_page_js !== null)
    {
      navigation_current_page_js.obj.page_will_unload();
      document.getElementById(navigation_current_page_js.id).style.display = "none";
    }
    
  new_page = GLOBAL_JS_PAGE_OBJECTS[page_name];
  
  if(new_page == null)
    {
      is_routine = true;
      new_page = navigation_load_routine(page_name);
    }
  else
    {
      $IC.stop_tracking();
      new_page.obj.page_load();
      document.getElementById(new_page.id).style.display = "block";
    }
  
  if(navigation_current_page_js !== null)
    if(navigation_current_page_js != new_page)
      navigation_current_page_js.obj.page_did_unload();
  
  navigation_current_page_js = new_page;
  
  navigation_show_top_and_bottom_menus();
  
  navigation_close_menu();
}


/*--------------------------------------------------------------------*/
jQuery(document).ready(function($){

    $('.dropdown-item > a').on('click', function (e) {
        e.preventDefault();
        $(this).parent().find('ul').slideToggle(function () {
            $(this).parents().eq(0).toggleClass('open-submenu');
        });
    });

    // Offset for Main Navigation
    $('#mainNav').affix({
        offset: {
            top: 1
        }
    });
});

/*--------------------------------------------------------------------*/
function close_nav_on_tap_outside_menu(e)
{
  if(e.target.className != "icon hamburger")
    if(e.target != navigation_hamburger_menu)
      if(!navigation_hamburger_menu.contains(e.target))
        navigation_close_menu();
}

/*--------------------------------------------------------------------*/
function navigation_close_menu() 
{
  navigation_hamburger_menu.className = "hamburgler-menu";
  window.removeEventListener("click", close_nav_on_tap_outside_menu, false);
}

/*--------------------------------------------------------------------*/
function navigation_open_menu() 
{
  navigation_hamburger_menu.className = "hamburgler-menu hamburgler-active";
  window.addEventListener("click", close_nav_on_tap_outside_menu, false);
}

/*--------------------------------------------------------------------*/
function navigation_show_top_and_bottom_menus()
{
  document.getElementById("top_business").style.display = "block";
  //document.getElementById("bottom_business").style.display = "block";
}

/*--------------------------------------------------------------------*/
function navigation_hide_top_and_bottom_menus()
{
  document.getElementById("top_business").style.display = "none";
  //document.getElementById("bottom_business").style.display = "none";
}

/*--------------------------------------------------------------------*/
function navigation_clear_form(form_id)
{
  var form = document.getElementById(form_id);
  
  var elements = form.elements; 
  form.reset();

  for(i=0; i<elements.length; i++) 
    {
      field_type = elements[i].type.toLowerCase();
  
      switch(field_type)
        {
          case "text": 
          case "password":
          case "email": 
          case "textarea":
          case "hidden":   
            elements[i].value = ""; 
            break;
        
          case "radio":
          case "checkbox":
            if(elements[i].checked)
              elements[i].checked = false; 
            break;

          case "select-one":
          case "select-multi":
            elements[i].selectedIndex = -1;
            break;

          default: 
            break;
        }
    }
}

/*--------------------------------------------------------------------*/
function tabs_table_show_tab(e, active_div_id)
{
  e = e || window.event;
  
  var clicked = e.target;
  var tabs = clicked.parentElement.parentElement.cells;
  
  var active_table = document.getElementById(active_div_id);
  var tables = active_table.parentElement.children;
  var i;
  
  for(i=0; i<tabs.length; i++)
    {
      var span = tabs[i].firstChild;
    
      if(span == clicked)
        span.className = "active";
      else
        span.className = "";
    }

  for(i=0; i<tables.length; i++)
    {
      if(tables[i] == active_table)
        tables[i].className = "active";
      else
        tables[i].className = "inactive";
    }
}

var SERVER_SCRIPT_LOCATION                  = "http://server-stage.insidecoach.net/api/";
var SERVER_LOGIN_LOCAL_STORAGE_NAME         = "SERVER_LOGIN_INFO";
var SERVER_OFFLINE_QUEUE_MAX_SIZE           = 500;
var SERVER_OFFLINE_QUEUE_LOCAL_STORAGE_NAME = "SERVER_OFFLINE_QUEUE";

/*--------------------------------------------------------------------*/
function server_init()
{
  server_load_profile_image_from_local_storage();
}

/*--------------------------------------------------------------------*/
function server_offline_queue_add(endpoint, params, callback)
{
  params.offline_queue = true;
  var offline_queue = JSON.parse(localStorage.getItem(SERVER_OFFLINE_QUEUE_LOCAL_STORAGE_NAME));
  if(!offline_queue) 
    offline_queue = [];
    
  while(offline_queue.length > SERVER_OFFLINE_QUEUE_MAX_SIZE)
    offline_queue.shift();
  //todo: how to call the callback later?
  offline_queue.push({endpoint:endpoint, params:params, callback:null/*callback*/});
  
  localStorage.setItem(SERVER_OFFLINE_QUEUE_LOCAL_STORAGE_NAME, JSON.stringify(offline_queue));
  
  server_offline_queue_try_to_sync();
}

/*--------------------------------------------------------------------*/
function server_offline_queue_try_to_sync()
{
  if(server_user_is_online())
    {
      var offline_queue = JSON.parse(localStorage.getItem(SERVER_OFFLINE_QUEUE_LOCAL_STORAGE_NAME));
      if(!offline_queue) return;
      if(offline_queue.length < 1) return;
      //go ahead and remove it from the queue now. It might be better to wait unitl the
      //server responds so we could try again if needbe, but if there is an uncaught
      //error this will clog the queue forever, so just try once and if it fails, oh well.
      var next = offline_queue.shift();
      server_send_request(next.endpoint, next.params, next.callback);
      localStorage.setItem(SERVER_OFFLINE_QUEUE_LOCAL_STORAGE_NAME, JSON.stringify(offline_queue));
    }
}

/*--------------------------------------------------------------------*/
//this gets called on log out
function server_clear_offline_queue()
{
  localStorage.removeItem(SERVER_OFFLINE_QUEUE_LOCAL_STORAGE_NAME);
}

/*--------------------------------------------------------------------*/
function server_send_request(endpoint, params, callback)
{
   console.log(endpoint, params, callback);
   
  if(!server_user_is_online())
    return;
  
  $.ajax({  
    type    : "POST",
    headers : {Accept: "application/json"},
    url     : SERVER_SCRIPT_LOCATION + endpoint,
    data    : params,
    
    success : function(msg)
      {
        console.log("success", params.inactive_button_id);
        if(params.inactive_button_id)
          server_reactivate_button(document.getElementById(params.inactive_button_id));
          
        server_login_token_has_expired(msg.message);
          
        if(msg.error)
          {
            if(!params.offline_queue)
              server_generic_notify(msg.error);
          }
        else if((msg.message) && (msg.success !== true))
          {
            if(!params.offline_queue)
              server_generic_notify(msg.message);
          }
        else if((msg.status !== false) && (callback !== null))
          {
            if(msg.message)
              if(msg.message != "ok")
                if(!params.offline_queue)
                  server_generic_notify(msg.message);
            if(callback !== null)
              callback(msg, params);
          }
        server_offline_queue_try_to_sync();
      },
      
    error: function(msg)
      {
        console.log("error", params.inactive_button_id);
        if(params.inactive_button_id)
          server_reactivate_button(document.getElementById(params.inactive_button_id));
          
        var response = msg.responseText;
        if(response.message)
          if(!params.offline_queue)
            server_generic_notify(response.message);
        server_offline_queue_try_to_sync();
      },
      
    statusCode: 
      {
        422: function(d)
          {
            console.log("422", params.inactive_button_id);
            if(params.inactive_button_id)
              server_reactivate_button(document.getElementById(params.inactive_button_id));
              
            var resp_data = JSON.parse(d.responseText);
            for (var key in resp_data)
              if(!params.offline_queue)
                server_generic_notify(resp_data[key]);
            server_offline_queue_try_to_sync();
          }
      }
  });
}

/*--------------------------------------------------------------------*/
function server_generic_notify(msg)
{
  $.notify(msg, {style:"ic"});
}

/*--------------------------------------------------------------------*/
function server_login_token_has_expired(token)
{
  var result = false;
  if(token)
    {
      var token_invalid = "Token is invalid";
      var token_expired = "Your login token has expired";    
      if((token == token_invalid) || (token == token_expired))
        {
          server_log_out();
          result = true;
        }
    }
  return result;
}

/*--------------------------------------------------------------------*/
function server_set_login_variables(token, nickname, full_name, profile_image)
{
  localStorage.setItem(SERVER_LOGIN_LOCAL_STORAGE_NAME, JSON.stringify({token:token, nickname:nickname, full_name:full_name, profile_image:profile_image}));
  server_load_profile_image_from_local_storage();
}

/*--------------------------------------------------------------------*/
function server_update_profile_image(profile_image)
{
  var login = JSON.parse(localStorage.getItem(SERVER_LOGIN_LOCAL_STORAGE_NAME));
  if(login)
    {
      login.profile_image = profile_image;
      localStorage.setItem(SERVER_LOGIN_LOCAL_STORAGE_NAME, JSON.stringify(login));
      server_load_profile_image_from_local_storage(profile_image);
    }
}

/*--------------------------------------------------------------------*/
function server_load_profile_image_from_local_storage(profile_image)
{
  var src = "images/default_profile_image.png";
  
  var login = JSON.parse(localStorage.getItem(SERVER_LOGIN_LOCAL_STORAGE_NAME));
  if(login)
    if(login.profile_image)
      src = login.profile_image;
      
  $(".profile_image").attr("src", src);
}

/*--------------------------------------------------------*/
function server_clear_login_variables()
{
  var login = localStorage.removeItem(SERVER_LOGIN_LOCAL_STORAGE_NAME);
  $(".profile_image").attr("src", "images/default_profile_image.png");
}

/*--------------------------------------------------------------------*/
//navigating to the log in page is equivalent to logging out
function server_log_out()
{
  navigation_load_page("login");
}

/*--------------------------------------------------------------------*/
function server_ping()
{
  server_send_request("auth/ping", "", null);
}

/*--------------------------------------------------------------------*/
function server_get_username_from_local_storage()
{
  var login = JSON.parse(localStorage.getItem(SERVER_LOGIN_LOCAL_STORAGE_NAME));

  if(login === null)
    return "Guest";
    
  return login.nickname;
}

/*--------------------------------------------------------------------*/
function server_get_login_token()
{
  var login = JSON.parse(localStorage.getItem(SERVER_LOGIN_LOCAL_STORAGE_NAME));
  if(login === null)
    return "";
  return login.token;
}

/*
the token and password are saved in localStorage
until the user logs out.
*/
/*--------------------------------------------------------------------*/
function server_user_is_logged_in()
{
  var result = true;
  var login = JSON.parse(localStorage.getItem(SERVER_LOGIN_LOCAL_STORAGE_NAME));
  if(login === null) result = false;

  return result;
}

/*--------------------------------------------------------------------*/
function server_validate_user_is_logged_in_and_notify()
{
  var result = server_user_is_logged_in();
  if(!result)
    $.notify("You must be logged in to use this page", {style:"needs-login"});
  
  return result;
}

/*--------------------------------------------------------------------*/
function server_user_is_online()
{
  return navigator.onLine;
}

/*--------------------------------------------------------------------*/
function server_validate_user_is_online_and_notify()
{
  var result = server_user_is_online();
  if(!result)
    server_generic_notify("You are not connected to the internet");
  
  return result;
}

/*--------------------------------------------------------------------*/
function server_validate_letters_spaces_only_and_notify(str, str_name)
{
  var result = (str.length < 50);
  if(!result)
    {
      server_generic_notify(str_name + " is too long");
      return result;
    }
  result = /[^\p{L} ]/.test(str);
  if(!result)
    {
      server_generic_notify(str_name + " must contain only letters");
      return result;
    }
  
  return true;
}

/*--------------------------------------------------------------------*/
function server_validate_phone_and_notify(str)
{
  var result = (str.length > 5);
  if(result)
    {
      result = (/^\d{7,}$/).test(str.replace(/[\s()+\-\.]|ext/gi, ''));
    }
  if(!result)
    server_generic_notify("Your phone number is not valid");

  return result;
}
/*--------------------------------------------------------------------*/
function server_validate_email_and_notify(str) 
{
    var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    var result = re.test(str);
    if(!result)
      server_generic_notify("Please enter a valid email address");
      
    return result;
}

/*--------------------------------------------------------------------*/
function server_validate_passwords_match_and_notify(str1, str2)
{
  var result = (str1 == str2);
  
  if(!result)
    server_generic_notify("Your passwords do not match each other");
  else
    result = server_validate_password_and_notify(str1);
  
  return result;  
}

/*--------------------------------------------------------------------*/
function server_validate_password_and_notify(str)
{
  // at least one number, one lowercase letter and 6 characters
  /*
  var re = /(?=.*\d)(?=.*[a-z]).{6,}/;
  return re.test(str);
  */
  
  // at least 6 characters
  var result = str.length >= 6;
  if(!result)
    server_generic_notify("Your password must be at least 6 characters long");
  return result;  
}

/*--------------------------------------------------------------------*/
function server_validate_empty_string_and_notify(str, str_name)
{
  var result = str.length > 0;
  if(!result)
    server_generic_notify(str_name + " must not be blank");
  return result;   
}

/*--------------------------------------------------------------------*/
function server_validate_year_and_notify(year)
{
  var result = false;
  if(year)
    if((year > 1920) && (year < 2100))
      result = true;
  
  if(!result)
    server_generic_notify("Please enter a valid year of birth");
    
  return result;   
}

/*--------------------------------------------------------------------*/
function server_validate_numbers_only_and_notify(str, str_name)
{
  var result = str.length < 20;
  if(!result)
    {
      server_generic_notify(str_name + " is too long");
      return result;
    }
  
  result = /^[0-9]+$/.test(str);
  if(!result)
    {
      server_generic_notify(str_name + " should contain only numbers");
      return result;
    }
    
  return true;
}

/*--------------------------------------------------------------------*/
function server_inactivate_button(button, timeout)
{
  var html = button.innerHTML;
  button.setAttribute("disabled", "disabled");
  button.setAttribute("data-active-html", html);
  button.innerHTML = '<img class="spinny_ball" src="images/default_profile_image.png" alt="loading">';
  if(timeout > 0)
    setTimeout(server_reactivate_button.bind(window, button), timeout);
}

/*--------------------------------------------------------------------*/
function server_reactivate_button(button)
{
  var html = button.getAttribute("data-active-html", html);
  if(html)
    {
      button.removeAttribute("data-active-html");
      button.removeAttribute("disabled");
      button.innerHTML = html;
    }
}

/*--------------------------------------------------------------------*/
function server_trim_form(form)
{
  //var form = document.getElementById(form_id);
  var elements = form.elements; 

  for(i=0; i<elements.length; i++) 
    {
      field_type = elements[i].type.toLowerCase();
  
      switch(field_type)
        {
          case "text": 
          case "password": 
          case "email": 
          case "textarea":
            elements[i].value = elements[i].value.trim(); 
            break;
          default: 
            break;
        }
    }
}



var ball_status = new Ball_Status_Widget($IC, 'ball_status_widget', "widgets/");

var rollkick_template = new Rollkick_Page_Template($IC, "video_modal_page_a", "time_dial_page_a", "kicks_dial_page_a", "score_log_page_a", "speech_log_page_a", "widgets/", "audio_player_page_a", "best_score_page_a");
var flightkick_template = new Flightkick_Page_Template($IC, "height_dial_page_b", "distance_dial_page_b", "speed_dial_page_b", "spin_dial_page_b", "video_modal_page_b", "ball_position_page_b", "score_log_page_b", "speech_log_page_b", "widgets/");
var cone_weaving_template = new Cone_Weaving_Page_Template($IC, "video_modal_page_c", "ball_position_page_c", "score_log_page_c", "speech_log_page_c", "widgets/");
var freeplay_template = new Freeplay_Page_Template($IC, "video_modal_page_d", "distance_dial_page_d", "time_dial_page_d", "ball_position_page_d", "score_log_page_d", "speech_log_page_d", "widgets/");

GLOBAL_JS_PAGE_OBJECTS['rollkick']   = {id:"routine-rollkick"  , obj:rollkick_template};
GLOBAL_JS_PAGE_OBJECTS['flightkick'] = {id:"routine-flightkick", obj:flightkick_template};
GLOBAL_JS_PAGE_OBJECTS['cones']      = {id:"routine-cones"     , obj:cone_weaving_template};
GLOBAL_JS_PAGE_OBJECTS['freeplay']   = {id:"routine-freeplay"  , obj:freeplay_template};

server_init();
if(!carousel.has_been_fully_viewed())
  navigation_load_page("setup-guide");
else
  navigation_load_page("games");
</script>

</body>
</html>
